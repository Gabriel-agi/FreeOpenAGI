<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="page_title">Knowledge Check: Module 22 - Complete Python</title>
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Base Styles & Variables (Copied from Dashboard) --- */
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-page: #f0f2f5;
            --background-card: #ffffff;
            --background-sidebar: #ffffff; /* Not used directly here, but keeps consistency */
            --background-header: linear-gradient(135deg, #0d6efd, #0a58ca);
            --text-light: #f8f9fa;
            --text-dark: #343a40;
            --text-muted: #6c757d;
            --accent-color: #ffc107;
            --success-color: #198754;
            --error-color: #dc3545;
            --info-color: #0dcaf0;
            --video-color: #fd7e14;
            --check-color: #6f42c1;
            --certificate-color: #d63384;
            --progress-bg: #e9ecef;
            --progress-fill: var(--check-color);
            --border-color: #dee2e6;
            --border-radius: 8px;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            --card-shadow-hover: 0 6px 18px rgba(0, 0, 0, 0.1); /* Keep for potential future use */
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
            /* Quiz specific colors */
            --quiz-correct-bg: #d1e7dd;
            --quiz-correct-text: var(--success-color);
            --quiz-incorrect-bg: #f8d7da;
            --quiz-incorrect-text: var(--error-color);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.6;
            background-color: var(--background-page); color: var(--text-dark);
            overflow-x: hidden;
            padding-top: 80px; /* Account for fixed header */
        }

        /* --- Quiz Page Header --- */
        .quiz-page-header {
            background: var(--background-header);
            color: var(--text-light);
            padding: 1rem 1.5rem;
            position: fixed; /* Fixed header */
            top: 0;
            left: 0;
            width: 100%;
            z-index: 900;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .return-button {
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            background-color: rgba(255, 255, 255, 0.15);
            color: var(--text-light);
            border: none;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: background-color var(--transition-speed) ease;
        }
        .return-button i { margin-right: 8px; }
        .return-button:hover { background-color: rgba(255, 255, 255, 0.25); color: var(--text-light); }

        .quiz-page-header h1 {
            font-family: var(--font-title);
            font-size: 1.6rem; /* Slightly smaller than dashboard */
            margin: 0;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.15);
            flex-grow: 1;
            text-align: center;
            padding: 0 1rem; /* Space around title */
        }

         /* Language Switcher Styles (Copied from Dashboard) */
         .language-switcher-container { position: relative; }
         #languageSelect {
            background: var(--background-card);
            color: var(--text-dark);
            border: 1px solid var(--check-color); /* Use check color border */
            border-radius: 5px;
            padding: 8px 35px 8px 15px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            appearance: none; -webkit-appearance: none; -moz-appearance: none;
             /* SVG Arrow - Adjust color slightly if needed */
             background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23${encodeURIComponent(getComputedStyle(document.documentElement).getPropertyValue('--check-color').trim().substring(1))}%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 10px auto;
            transition: border-color 0.3s ease;
         }
         #languageSelect:hover { border-color: var(--primary-color); }
         #languageSelect:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25); }
         #languageSelect option { background: var(--background-card); color: var(--text-dark); padding: 5px; }


        /* --- Quiz Container --- */
        .quiz-container {
            max-width: 800px;
            margin: 2rem auto; /* Spacing below fixed header */
            padding: 2rem 2.5rem;
            background-color: var(--background-card);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
        }

        .quiz-instructions {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px dashed var(--border-color);
            font-size: 0.95rem;
            color: var(--text-muted);
        }
        .quiz-instructions strong { color: var(--text-dark); }
        .quiz-instructions .pass-info { color: var(--success-color); font-weight: 500; }
        .quiz-instructions .attempts-info { color: var(--info-color); font-weight: 500; }

        /* --- Questions Area --- */
        .question-block {
            margin-bottom: 2.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #eee;
        }
        .question-block:last-child { margin-bottom: 0; border-bottom: none; }

        .question-text {
            font-weight: 500;
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: var(--text-dark);
        }
        .question-text code {
            background-color: #e9ecef;
            padding: 0.1em 0.4em;
            border-radius: 3px;
            font-size: 0.95em;
            color: #c7254e; /* Consistent code color */
            font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
        }

        .options-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .option-item {
            margin-bottom: 0.7rem;
        }

        .option-item label {
            display: block;
            padding: 0.8rem 1.2rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            background-color: #fdfdff; /* Slightly off-white */
        }
         .option-item label:hover {
            background-color: #f0f5ff;
            border-color: var(--primary-color);
            box-shadow: 0 1px 4px rgba(0, 123, 255, 0.1);
         }

         .option-item input[type="radio"] {
            display: none; /* Hide the default radio button */
         }

         /* Style for selected option */
         .option-item input[type="radio"]:checked + label {
            background-color: #e2eefe;
            border-color: var(--primary-color);
            color: var(--primary-color);
            font-weight: 500;
            box-shadow: 0 2px 6px rgba(0, 123, 255, 0.15);
         }

        /* Styles for showing correct/incorrect after submission */
         .option-item.correct label {
            background-color: var(--quiz-correct-bg);
            border-color: var(--success-color);
            color: var(--quiz-correct-text);
            font-weight: 500;
         }
         .option-item.incorrect label {
            background-color: var(--quiz-incorrect-bg);
            border-color: var(--error-color);
            color: var(--quiz-incorrect-text);
            font-weight: 500;
         }
         /* Add icons for feedback */
         .option-item.correct label::after {
            content: " \f00c"; /* FontAwesome check */
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: var(--success-color);
            float: right;
         }
          .option-item.incorrect label::after {
            content: " \f00d"; /* FontAwesome times */
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: var(--error-color);
            float: right;
         }
         /* Only show icon on the one they selected if it was wrong */
         .option-item.incorrect.selected label::after { display: inline-block; }
         .option-item.incorrect:not(.selected) label::after { display: none; } /* Hide X on non-selected wrong answers */


        /* --- Submit Button --- */
        .submit-button {
            display: block;
            width: 100%;
            padding: 0.9rem 1.5rem;
            margin-top: 2rem;
            font-size: 1.1rem;
            font-weight: 700;
            font-family: var(--font-title);
            background-color: var(--check-color); /* Use check color */
            color: var(--text-light);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color var(--transition-speed) ease, transform 0.1s ease;
            text-align: center;
        }
        .submit-button:hover { background-color: #5a3a9a; /* Darker shade of check-color */ }
        .submit-button:active { transform: scale(0.99); }
        .submit-button:disabled { background-color: var(--secondary-color); cursor: not-allowed; opacity: 0.7; }

        /* --- Results Area --- */
        .results-area {
            margin-top: 2.5rem;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            text-align: center;
            font-size: 1.2rem;
            font-weight: 500;
            display: none; /* Hidden initially */
            border: 1px solid transparent; /* Placeholder for border */
        }
        .results-area.pass {
            background-color: var(--quiz-correct-bg);
            color: var(--quiz-correct-text);
            border-color: var(--success-color);
        }
        .results-area.fail {
            background-color: var(--quiz-incorrect-bg);
            color: var(--quiz-incorrect-text);
            border-color: var(--error-color);
        }
        .results-area p { margin-bottom: 0.8rem; }
        .results-area strong { font-size: 1.4rem; }
        .results-area .retry-button {
             display: inline-block;
             padding: 0.6rem 1.2rem;
             margin-top: 1rem;
             font-size: 0.95rem;
             font-weight: 500;
             background-color: var(--primary-color);
             color: var(--text-light);
             border: none;
             border-radius: 5px;
             cursor: pointer;
             transition: background-color var(--transition-speed) ease;
        }
         .results-area .retry-button:hover { background-color: #0b5ed7; }


        /* --- Utility --- */
        .hidden { display: none; }

        /* --- Responsive Adjustments --- */
        @media (max-width: 992px) {
            .quiz-page-header h1 { font-size: 1.4rem; }
            .quiz-container { padding: 1.5rem 2rem; margin: 1.5rem auto; }
        }
        @media (max-width: 768px) {
            body { padding-top: 110px; } /* More padding for smaller header */
            .quiz-page-header { flex-wrap: wrap; justify-content: center; padding: 0.8rem 1rem; }
            .return-button { order: 1; margin-bottom: 0.5rem; }
            .quiz-page-header h1 { order: 3; width: 100%; text-align: center; font-size: 1.3rem; margin-top: 0.5rem; padding: 0; }
             .language-switcher-container { order: 2; margin-bottom: 0.5rem; margin-left: 10px; /* Add some space if needed */ }
             #languageSelect { font-size: 0.85rem; padding: 6px 30px 6px 12px; }
            .quiz-container { padding: 1rem 1.5rem; margin: 1rem auto; max-width: 95%; }
            .question-text { font-size: 1rem; }
            .option-item label { padding: 0.7rem 1rem; }
        }
         @media (max-width: 480px) {
              body { padding-top: 95px; } /* Adjust if header wraps differently */
              .quiz-page-header { padding: 0.6rem 0.8rem; }
              .quiz-page-header h1 { font-size: 1.2rem; }
              .return-button { padding: 0.4rem 0.8rem; font-size: 0.85rem; }
              .language-switcher-container { margin-left: 5px; }
              .quiz-container { padding: 1rem; }
              .option-item label { font-size: 0.9rem; }
              .submit-button { padding: 0.8rem; font-size: 1rem; }
              .results-area { font-size: 1.1rem; }
              .results-area strong { font-size: 1.2rem; }
         }

    </style>
</head>
<body>

    <header class="quiz-page-header">
        <a href="ctp-dashboard.html" class="return-button">
            <i class="fas fa-arrow-left"></i> <span data-translate="return_button">Return to Dashboard</span>
        </a>
        <h1><i class="fas fa-check-double" style="color: var(--check-color); margin-right: 10px;"></i> <span data-translate="quiz_header_title">Knowledge Check</span>: <span data-translate="module_22_title_short">Module 22</span></h1>
         <!-- Language Switcher -->
         <div class="language-switcher-container">
            <select id="languageSelect" data-translate-aria-label="lang_select_aria" aria-label="Select Language">
                <option value="en" data-translate="lang_en">🇬🇧 English</option>
                <option value="pt" data-translate="lang_pt">🇧🇷 Português</option>
                <option value="zh" data-translate="lang_zh">🇨🇳 中文</option>
            </select>
        </div>
    </header>

    <main>
        <div class="quiz-container">
            <div class="quiz-instructions">
                <p data-translate="quiz_instructions_p1">Test your understanding of the concepts covered in this module.</p>
                <p><span data-translate="quiz_instructions_p2">You need to answer</span> <strong class="pass-info"><span data-translate="quiz_pass_score">6</span></strong> <span data-translate="quiz_instructions_p3">out of 10 questions correctly to pass.</span></p>
                <p><span data-translate="quiz_instructions_p4">You can</span> <strong class="attempts-info"><span data-translate="quiz_attempts_info">retake this check as many times</span></strong> <span data-translate="quiz_instructions_p5">as you need. Passing will mark this module as complete on your dashboard.</span></p>
            </div>

            <form id="quiz-form">
                <div id="questions-area">
                    <!-- Questions will be dynamically inserted here by JavaScript -->
                </div>

                <button type="submit" class="submit-button" id="submit-button" data-translate="submit_button">Check Answers</button>
            </form>

            <div id="results-area" class="results-area hidden">
                <!-- Results will be displayed here -->
            </div>
        </div>
    </main>

    <script>
        const MODULE_ID = 22;
        const PASSING_SCORE = 6;
        const TOTAL_QUESTIONS = 10;
        const KNOWLEDGE_CHECK_STORAGE_KEY = 'knowledgeCheckStatus_v1'; // Same key as dashboard
        const LANGUAGE_STORAGE_KEY = 'userLanguage';

        // --- Quiz Questions and Answers ---
        const quizData = [
            { // Q1
                question_key: "q1_text",
                options: [
                    { text_key: "q1_opt1", value: "a" },
                    { text_key: "q1_opt2", value: "b" },
                    { text_key: "q1_opt3", value: "c" },
                    { text_key: "q1_opt4", value: "d" }
                ],
                correct_answer: "b" // ()
            },
            { // Q2
                question_key: "q2_text",
                options: [
                    { text_key: "q2_opt1", value: "a" },
                    { text_key: "q2_opt2", value: "b" },
                    { text_key: "q2_opt3", value: "c" },
                    { text_key: "q2_opt4", value: "d" }
                ],
                correct_answer: "c" // (5,) - The trailing comma is crucial
            },
            { // Q3
                question_key: "q3_text",
                options: [
                    { text_key: "q3_opt1", value: "a" }, // "apple"
                    { text_key: "q3_opt2", value: "b" }, // "banana"
                    { text_key: "q3_opt3", value: "c" }, // "cherry"
                    { text_key: "q3_opt4", value: "d" }  // Error
                ],
                correct_answer: "b" // my_tuple[1] is 'banana'
            },
            { // Q4
                question_key: "q4_text",
                options: [
                    { text_key: "q4_opt1", value: "a" }, // Changes the tuple
                    { text_key: "q4_opt2", value: "b" }, // Causes a TypeError
                    { text_key: "q4_opt3", value: "c" }, // Creates a new tuple
                    { text_key: "q4_opt4", value: "d" }  // Does nothing
                ],
                correct_answer: "b" // Tuples are immutable
            },
            { // Q5
                question_key: "q5_text",
                options: [
                    { text_key: "q5_opt1", value: "a" }, // len()
                    { text_key: "q5_opt2", value: "b" }, // .length()
                    { text_key: "q5_opt3", value: "c" }, // size()
                    { text_key: "q5_opt4", value: "d" }  // .count()
                ],
                correct_answer: "a" // len() function
            },
            { // Q6
                question_key: "q6_text",
                options: [
                    { text_key: "q6_opt1", value: "a" }, // .append()
                    { text_key: "q6_opt2", value: "b" }, // + (Concatenation)
                    { text_key: "q6_opt3", value: "c" }, // .insert()
                    { text_key: "q6_opt4", value: "d" }  // del my_tuple[0]
                ],
                correct_answer: "b" // Concatenation creates a new tuple
            },
            { // Q7
                question_key: "q7_text",
                options: [
                    { text_key: "q7_opt1", value: "a" }, // Fixed collection, like coordinates
                    { text_key: "q7_opt2", value: "b" }, // Data that changes often
                    { text_key: "q7_opt3", value: "c" }, // When you need methods like .sort()
                    { text_key: "q7_opt4", value: "d" }  // Storing only strings
                ],
                correct_answer: "a" // Immutability suits fixed collections
            },
            { // Q8
                question_key: "q8_text",
                options: [
                    { text_key: "q8_opt1", value: "a" }, // True
                    { text_key: "q8_opt2", value: "b" }  // False
                ],
                correct_answer: "a" // Tuples can hold mixed data types
            },
            { // Q9
                question_key: "q9_text",
                options: [
                    { text_key: "q9_opt1", value: "a" }, // True
                    { text_key: "q9_opt2", value: "b" }, // False
                    { text_key: "q9_opt3", value: "c" }, // Error
                    { text_key: "q9_opt4", value: "d" }  // Only works on lists
                ],
                correct_answer: "a" // The `in` operator works
            },
            { // Q10
                question_key: "q10_text",
                options: [
                    { text_key: "q10_opt1", value: "a" }, // Lists are mutable, tuples are immutable
                    { text_key: "q10_opt2", value: "b" }, // Tuples can't be indexed
                    { text_key: "q10_opt3", value: "c" }, // Lists can only hold one data type
                    { text_key: "q10_opt4", value: "d" }  // Tuples use {} for creation
                ],
                correct_answer: "a" // The core difference is mutability
            }
        ];

        // --- Translations Object ---
        const translations = {
            en: {
                "page_title": `Knowledge Check: Module ${MODULE_ID} - Complete Python`,
                "quiz_header_title": "Knowledge Check",
                "module_22_title_short": "Module 22",
                "return_button": "Return to Dashboard",
                "quiz_instructions_p1": "Test your understanding of the concepts covered in this module.",
                "quiz_instructions_p2": "You need to answer",
                "quiz_pass_score": "6",
                "quiz_instructions_p3": `out of ${TOTAL_QUESTIONS} questions correctly to pass.`,
                "quiz_instructions_p4": "You can",
                "quiz_attempts_info": "retake this check as many times",
                "quiz_instructions_p5": "as you need. Passing will mark this module as complete on your dashboard.",
                "submit_button": "Check Answers",
                "submit_button_submitted": "Answers Submitted",
                "result_pass": `Passed! You scored <strong>{score}/${TOTAL_QUESTIONS}</strong>. Module ${MODULE_ID} marked as complete!`,
                "result_fail": `Keep trying! You scored <strong>{score}/${TOTAL_QUESTIONS}</strong>. You need ${PASSING_SCORE} to pass.`,
                "retry_button": "Retry Quiz",
                "lang_select_aria": "Select Language",
                "lang_en": "🇬🇧 English",
                "lang_pt": "🇧🇷 Português",
                "lang_zh": "🇨🇳 中文",
                // Module 22 Questions & Options (English)
                "q1_text": "1. How do you create an empty tuple in Python?",
                "q1_opt1": "a) `[]`",
                "q1_opt2": "b) `()`",
                "q1_opt3": "c) `{}`",
                "q1_opt4": "d) `tuple[]`",
                "q2_text": "2. Which syntax correctly creates a tuple containing only the integer `5`?",
                "q2_opt1": "a) `(5)`",
                "q2_opt2": "b) `{5}`",
                "q2_opt3": "c) `(5,)`",
                "q2_opt4": "d) `[5]`",
                "q3_text": "3. Given `my_tuple = (\"apple\", \"banana\", \"cherry\")`, what does `my_tuple[1]` return?",
                "q3_opt1": "a) `\"apple\"`",
                "q3_opt2": "b) `\"banana\"`",
                "q3_opt3": "c) `\"cherry\"`",
                "q3_opt4": "d) An `IndexError`",
                "q4_text": "4. What happens if you try to execute `my_tuple = (1, 2, 3); my_tuple[0] = 5`?",
                "q4_opt1": "a) The first element of `my_tuple` becomes `5`.",
                "q4_opt2": "b) It raises a `TypeError` because tuples are immutable.",
                "q4_opt3": "c) It creates a new tuple `(5, 2, 3)`.",
                "q4_opt4": "d) Nothing happens, the line is ignored.",
                "q5_text": "5. Which function is used to find the number of elements in a tuple `t`?",
                "q5_opt1": "a) `len(t)`",
                "q5_opt2": "b) `t.length()`",
                "q5_opt3": "c) `size(t)`",
                "q5_opt4": "d) `t.count()`",
                "q6_text": "6. Which of the following operations is allowed on tuples and results in a *new* tuple?",
                "q6_opt1": "a) `my_tuple.append(item)`",
                "q6_opt2": "b) `tuple1 + tuple2`",
                "q6_opt3": "c) `my_tuple.insert(0, item)`",
                "q6_opt4": "d) `del my_tuple[0]`",
                "q7_text": "7. When might you prefer using a tuple over a list?",
                "q7_opt1": "a) To store a fixed collection of items that should not change, like RGB color values or coordinates.",
                "q7_opt2": "b) When you need to frequently add or remove items from the collection.",
                "q7_opt3": "c) When you need to sort the collection in place.",
                "q7_opt4": "d) When you are only storing string data types.",
                "q8_text": "8. Can a single tuple contain elements of different data types (e.g., integers, strings, floats)?",
                "q8_opt1": "a) True",
                "q8_opt2": "b) False",
                "q9_text": "9. Given `my_tuple = (10, 20, 30)`, what will `20 in my_tuple` evaluate to?",
                "q9_opt1": "a) `True`",
                "q9_opt2": "b) `False`",
                "q9_opt3": "c) It will cause an error.",
                "q9_opt4": "d) This operation only works on lists.",
                "q10_text": "10. What is the primary difference between a list and a tuple in Python?",
                "q10_opt1": "a) Lists are mutable (changeable), while tuples are immutable (unchangeable).",
                "q10_opt2": "b) Tuples cannot be accessed by index, while lists can.",
                "q10_opt3": "c) Lists can only hold elements of the same data type.",
                "q10_opt4": "d) Tuples are created using curly braces `{}`."
            },
            pt: {
                "page_title": `Verificação de Conhecimento: Módulo ${MODULE_ID} - Python Completo`,
                "quiz_header_title": "Verificação de Conhecimento",
                 "module_22_title_short": "Módulo 22",
                "return_button": "Voltar ao Painel",
                "quiz_instructions_p1": "Teste sua compreensão dos conceitos abordados neste módulo.",
                "quiz_instructions_p2": "Você precisa responder",
                "quiz_pass_score": "6",
                "quiz_instructions_p3": `de ${TOTAL_QUESTIONS} perguntas corretamente para passar.`,
                "quiz_instructions_p4": "Você pode",
                "quiz_attempts_info": "refazer esta verificação quantas vezes",
                "quiz_instructions_p5": "precisar. Passar marcará este módulo como concluído no seu painel.",
                "submit_button": "Verificar Respostas",
                "submit_button_submitted": "Respostas Enviadas",
                "result_pass": `Aprovado! Você acertou <strong>{score}/${TOTAL_QUESTIONS}</strong>. Módulo ${MODULE_ID} marcado como completo!`,
                "result_fail": `Continue tentando! Você acertou <strong>{score}/${TOTAL_QUESTIONS}</strong>. Você precisa de ${PASSING_SCORE} para passar.`,
                "retry_button": "Tentar Novamente",
                "lang_select_aria": "Selecionar Idioma",
                "lang_en": "🇬🇧 English",
                "lang_pt": "🇧🇷 Português",
                "lang_zh": "🇨🇳 中文",
                 // Module 22 Questions & Options (Portuguese)
                "q1_text": "1. Como você cria uma tupla vazia em Python?",
                "q1_opt1": "a) `[]`",
                "q1_opt2": "b) `()`",
                "q1_opt3": "c) `{}`",
                "q1_opt4": "d) `tuple[]`",
                "q2_text": "2. Qual sintaxe cria corretamente uma tupla contendo apenas o inteiro `5`?",
                "q2_opt1": "a) `(5)`",
                "q2_opt2": "b) `{5}`",
                "q2_opt3": "c) `(5,)`",
                "q2_opt4": "d) `[5]`",
                "q3_text": "3. Dado `minha_tupla = (\"maçã\", \"banana\", \"cereja\")`, o que `minha_tupla[1]` retorna?",
                "q3_opt1": "a) `\"maçã\"`",
                "q3_opt2": "b) `\"banana\"`",
                "q3_opt3": "c) `\"cereja\"`",
                "q3_opt4": "d) Um `IndexError`",
                "q4_text": "4. O que acontece se você tentar executar `minha_tupla = (1, 2, 3); minha_tupla[0] = 5`?",
                "q4_opt1": "a) O primeiro elemento de `minha_tupla` torna-se `5`.",
                "q4_opt2": "b) Levanta um `TypeError` porque tuplas são imutáveis.",
                "q4_opt3": "c) Cria uma nova tupla `(5, 2, 3)`.",
                "q4_opt4": "d) Nada acontece, a linha é ignorada.",
                "q5_text": "5. Qual função é usada para encontrar o número de elementos em uma tupla `t`?",
                "q5_opt1": "a) `len(t)`",
                "q5_opt2": "b) `t.length()`",
                "q5_opt3": "c) `size(t)`",
                "q5_opt4": "d) `t.count()`",
                "q6_text": "6. Qual das seguintes operações é permitida em tuplas e resulta em uma *nova* tupla?",
                "q6_opt1": "a) `minha_tupla.append(item)`",
                "q6_opt2": "b) `tupla1 + tupla2`",
                "q6_opt3": "c) `minha_tupla.insert(0, item)`",
                "q6_opt4": "d) `del minha_tupla[0]`",
                "q7_text": "7. Quando você pode preferir usar uma tupla em vez de uma lista?",
                "q7_opt1": "a) Para armazenar uma coleção fixa de itens que não devem mudar, como valores de cor RGB ou coordenadas.",
                "q7_opt2": "b) Quando você precisa adicionar ou remover itens da coleção frequentemente.",
                "q7_opt3": "c) Quando você precisa ordenar a coleção no local (in-place).",
                "q7_opt4": "d) Quando você está armazenando apenas tipos de dados string.",
                "q8_text": "8. Uma única tupla pode conter elementos de diferentes tipos de dados (ex: inteiros, strings, floats)?",
                "q8_opt1": "a) Verdadeiro",
                "q8_opt2": "b) Falso",
                "q9_text": "9. Dado `minha_tupla = (10, 20, 30)`, qual será o resultado de `20 in minha_tupla`?",
                "q9_opt1": "a) `True`",
                "q9_opt2": "b) `False`",
                "q9_opt3": "c) Causará um erro.",
                "q9_opt4": "d) Esta operação funciona apenas em listas.",
                "q10_text": "10. Qual é a principal diferença entre uma lista e uma tupla em Python?",
                "q10_opt1": "a) Listas são mutáveis (podem ser alteradas), enquanto tuplas são imutáveis (não podem ser alteradas).",
                "q10_opt2": "b) Tuplas não podem ser acessadas por índice, enquanto listas podem.",
                "q10_opt3": "c) Listas só podem conter elementos do mesmo tipo de dados.",
                "q10_opt4": "d) Tuplas são criadas usando chaves `{}`."
            },
            zh: {
                "page_title": `知识测验：模块 ${MODULE_ID} - Python 完全指南`,
                "quiz_header_title": "知识测验",
                 "module_22_title_short": "模块 22",
                "return_button": "返回仪表板",
                "quiz_instructions_p1": "测试您对本模块所涵盖概念的理解。",
                "quiz_instructions_p2": "您需要正确回答",
                "quiz_pass_score": "6",
                "quiz_instructions_p3": `道题（共 ${TOTAL_QUESTIONS} 题）才能通过。`,
                "quiz_instructions_p4": "您可以",
                "quiz_attempts_info": "根据需要多次重做此测验",
                "quiz_instructions_p5": "。通过后，该模块将在您的仪表板上标记为完成。",
                "submit_button": "检查答案",
                "submit_button_submitted": "答案已提交",
                "result_pass": `通过！您的得分是 <strong>{score}/${TOTAL_QUESTIONS}</strong>。模块 ${MODULE_ID} 已标记为完成！`,
                "result_fail": `请继续努力！您的得分是 <strong>{score}/${TOTAL_QUESTIONS}</strong>。您需要答对 ${PASSING_SCORE} 题才能通过。`,
                "retry_button": "重试测验",
                "lang_select_aria": "选择语言",
                "lang_en": "🇬🇧 English",
                "lang_pt": "🇧🇷 Português",
                "lang_zh": "🇨🇳 中文",
                // Module 22 Questions & Options (Chinese)
                "q1_text": "1. 在 Python 中如何创建一个空元组？",
                "q1_opt1": "a) `[]`",
                "q1_opt2": "b) `()`",
                "q1_opt3": "c) `{}`",
                "q1_opt4": "d) `tuple[]`",
                "q2_text": "2. 哪种语法正确地创建了只包含整数 `5` 的元组？",
                "q2_opt1": "a) `(5)`",
                "q2_opt2": "b) `{5}`",
                "q2_opt3": "c) `(5,)`",
                "q2_opt4": "d) `[5]`",
                "q3_text": "3. 给定 `my_tuple = (\"apple\", \"banana\", \"cherry\")`，`my_tuple[1]` 返回什么？",
                "q3_opt1": "a) `\"apple\"`",
                "q3_opt2": "b) `\"banana\"`",
                "q3_opt3": "c) `\"cherry\"`",
                "q3_opt4": "d) 一个 `IndexError` 错误",
                "q4_text": "4. 如果尝试执行 `my_tuple = (1, 2, 3); my_tuple[0] = 5` 会发生什么？",
                "q4_opt1": "a) `my_tuple` 的第一个元素变为 `5`。",
                "q4_opt2": "b) 引发 `TypeError` 错误，因为元组是不可变的。",
                "q4_opt3": "c) 创建一个新元组 `(5, 2, 3)`。",
                "q4_opt4": "d) 什么也不发生，该行被忽略。",
                "q5_text": "5. 使用哪个函数来查找元组 `t` 中的元素数量？",
                "q5_opt1": "a) `len(t)`",
                "q5_opt2": "b) `t.length()`",
                "q5_opt3": "c) `size(t)`",
                "q5_opt4": "d) `t.count()`",
                "q6_text": "6. 以下哪项操作在元组上是允许的，并且会产生一个*新*元组？",
                "q6_opt1": "a) `my_tuple.append(item)`",
                "q6_opt2": "b) `tuple1 + tuple2`",
                "q6_opt3": "c) `my_tuple.insert(0, item)`",
                "q6_opt4": "d) `del my_tuple[0]`",
                "q7_text": "7. 在什么情况下您可能更倾向于使用元组而不是列表？",
                "q7_opt1": "a) 存储一组不应更改的固定项，例如 RGB 颜色值或坐标。",
                "q7_opt2": "b) 当您需要频繁地从集合中添加或删除项目时。",
                "q7_opt3": "c) 当您需要对集合进行原地排序时。",
                "q7_opt4": "d) 当您只存储字符串数据类型时。",
                "q8_text": "8. 一个元组可以包含不同数据类型的元素（例如整数、字符串、浮点数）吗？",
                "q8_opt1": "a) 正确 (True)",
                "q8_opt2": "b) 错误 (False)",
                "q9_text": "9. 给定 `my_tuple = (10, 20, 30)`，`20 in my_tuple` 的计算结果是什么？",
                "q9_opt1": "a) `True`",
                "q9_opt2": "b) `False`",
                "q9_opt3": "c) 会导致错误。",
                "q9_opt4": "d) 这个操作只适用于列表。",
                "q10_text": "10. Python 中列表和元组的主要区别是什么？",
                "q10_opt1": "a) 列表是可变的（可以更改），而元组是不可变的（不能更改）。",
                "q10_opt2": "b) 元组不能通过索引访问，而列表可以。",
                "q10_opt3": "c) 列表只能包含相同数据类型的元素。",
                "q10_opt4": "d) 元组使用花括号 `{}` 创建。"
            }
        };

        // --- Helper Functions ---
        function getStoredLanguage() {
            const storedLang = localStorage.getItem(LANGUAGE_STORAGE_KEY);
            if (storedLang && translations[storedLang]) return storedLang;
            const browserLang = navigator.language || navigator.userLanguage;
            if (browserLang.startsWith('pt')) return 'pt';
            if (browserLang.startsWith('zh')) return 'zh';
            return 'en'; // Default to English
        }

        function getTranslation(key, lang, replacements = {}) {
            let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`; // Fallback chain
            for (const placeholder in replacements) {
                const regex = new RegExp(`\\{${placeholder}\\}`, 'g');
                text = text.replace(regex, replacements[placeholder]);
            }
            return text;
        }

         function translatePage(lang) {
             document.documentElement.lang = lang;
             document.querySelectorAll('[data-translate]').forEach(el => {
                 const key = el.getAttribute('data-translate');
                 const translation = getTranslation(key, lang);
                 if (el.tagName === 'TITLE') {
                     document.title = translation;
                 } else if (translation.includes('<') && translation.includes('>')) { // Basic check for HTML
                     el.innerHTML = translation;
                 } else {
                     el.textContent = translation;
                 }
             });
              document.querySelectorAll('[data-translate-placeholder]').forEach(el => {
                 const key = el.getAttribute('data-translate-placeholder');
                 el.setAttribute('placeholder', getTranslation(key, lang));
             });
             document.querySelectorAll('[data-translate-aria-label]').forEach(el => {
                 const key = el.getAttribute('data-translate-aria-label');
                 el.setAttribute('aria-label', getTranslation(key, lang));
             });

             // Update dynamic text (like pass score in instructions)
             const passScoreElement = document.querySelector('.quiz-instructions .pass-info span');
             if (passScoreElement) {
                 passScoreElement.textContent = getTranslation('quiz_pass_score', lang);
             }
             const attemptsInfoElement = document.querySelector('.quiz-instructions .attempts-info span');
              if (attemptsInfoElement) {
                 attemptsInfoElement.textContent = getTranslation('quiz_attempts_info', lang);
             }
         }

        function loadKnowledgeCheckStatus() {
            try {
                const storedStatus = localStorage.getItem(KNOWLEDGE_CHECK_STORAGE_KEY);
                const parsed = storedStatus ? JSON.parse(storedStatus) : {};
                // Ensure it's a valid object
                return typeof parsed === 'object' && parsed !== null ? parsed : {};
            } catch (e) {
                console.error("Error reading KC status from localStorage:", e);
                return {}; // Return empty object on error
            }
        }

        function saveKnowledgeCheckStatus(statusObject) {
            try {
                localStorage.setItem(KNOWLEDGE_CHECK_STORAGE_KEY, JSON.stringify(statusObject));
            } catch (e) {
                console.error("Error saving KC status to localStorage:", e);
            }
        }

        // --- Quiz Logic ---
        function renderQuiz() {
            const questionsArea = document.getElementById('questions-area');
            questionsArea.innerHTML = ''; // Clear previous questions if retrying
            const lang = getStoredLanguage();

            quizData.forEach((q, index) => {
                const questionBlock = document.createElement('div');
                questionBlock.classList.add('question-block');
                questionBlock.setAttribute('data-question-index', index);

                const questionText = document.createElement('p');
                questionText.classList.add('question-text');
                // Use innerHTML for potential <code> tags in question text keys
                questionText.innerHTML = getTranslation(q.question_key, lang);
                questionBlock.appendChild(questionText);

                const optionsList = document.createElement('ul');
                optionsList.classList.add('options-list');

                q.options.forEach(opt => {
                    const optionItem = document.createElement('li');
                    optionItem.classList.add('option-item');

                    const radioInput = document.createElement('input');
                    radioInput.type = 'radio';
                    radioInput.name = `question_${index}`;
                    radioInput.value = opt.value;
                    radioInput.id = `q${index}_opt${opt.value}`;
                    radioInput.required = true; // Make selection mandatory

                    const label = document.createElement('label');
                    label.htmlFor = radioInput.id;
                    // Use textContent for option text as it's less likely to contain HTML
                    label.textContent = getTranslation(opt.text_key, lang);

                    optionItem.appendChild(radioInput);
                    optionItem.appendChild(label);
                    optionsList.appendChild(optionItem);
                });

                questionBlock.appendChild(optionsList);
                questionsArea.appendChild(questionBlock);
            });
        }

        function handleSubmit(event) {
            event.preventDefault();
            const resultsArea = document.getElementById('results-area');
            const submitButton = document.getElementById('submit-button');
            const form = document.getElementById('quiz-form');
            const lang = getStoredLanguage();
            let score = 0;

            // Disable form elements during processing
            submitButton.disabled = true;
            submitButton.textContent = getTranslation('submit_button_submitted', lang);
            form.querySelectorAll('input[type="radio"]').forEach(radio => radio.disabled = true);

             // Remove previous result classes/content
             resultsArea.classList.remove('pass', 'fail', 'hidden');
             resultsArea.innerHTML = ''; // Clear previous results

             // Remove previous feedback classes
             document.querySelectorAll('.option-item').forEach(item => {
                 item.classList.remove('correct', 'incorrect', 'selected');
             });


            quizData.forEach((q, index) => {
                const questionBlock = document.querySelector(`.question-block[data-question-index="${index}"]`);
                const selectedOption = form.querySelector(`input[name="question_${index}"]:checked`);
                const optionsItems = questionBlock.querySelectorAll('.option-item');

                optionsItems.forEach(item => {
                    const radio = item.querySelector('input[type="radio"]');
                    const isCorrect = radio.value === q.correct_answer;
                    const isSelected = selectedOption && radio.value === selectedOption.value;

                    if (isSelected) {
                        item.classList.add('selected');
                    }

                    if (isCorrect) {
                        item.classList.add('correct'); // Always mark correct answer
                    } else if (isSelected && !isCorrect) {
                         item.classList.add('incorrect'); // Mark selected incorrect answer
                    }
                });


                if (selectedOption && selectedOption.value === q.correct_answer) {
                    score++;
                }
            });

            resultsArea.style.display = 'block'; // Show results area

            if (score >= PASSING_SCORE) {
                // Pass
                resultsArea.classList.add('pass');
                resultsArea.innerHTML = `<p>${getTranslation('result_pass', lang, { score: score })}</p>`;

                // Update localStorage
                const currentStatus = loadKnowledgeCheckStatus();
                currentStatus[MODULE_ID] = true;
                saveKnowledgeCheckStatus(currentStatus);

                // Optionally, prevent retrying immediately after passing
                // submitButton.textContent = "Passed!"; // Or similar indicator
                // No retry button on pass

            } else {
                // Fail
                resultsArea.classList.add('fail');
                const retryButtonHTML = `<button class="retry-button" id="retry-button">${getTranslation('retry_button', lang)}</button>`;
                resultsArea.innerHTML = `<p>${getTranslation('result_fail', lang, { score: score })}</p>${retryButtonHTML}`;

                // Add event listener for the new retry button
                document.getElementById('retry-button').addEventListener('click', handleRetry);
            }

            // Scroll to results
             resultsArea.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

         function handleRetry() {
             const resultsArea = document.getElementById('results-area');
             const submitButton = document.getElementById('submit-button');
             const form = document.getElementById('quiz-form');
             const lang = getStoredLanguage();

             // Hide results and reset classes
             resultsArea.style.display = 'none';
             resultsArea.classList.remove('pass', 'fail');
             resultsArea.innerHTML = '';

             // Reset feedback classes on options
             document.querySelectorAll('.option-item').forEach(item => {
                 item.classList.remove('correct', 'incorrect', 'selected');
             });

             // Reset the form (uncheck radios) and re-enable
             form.reset();
             form.querySelectorAll('input[type="radio"]').forEach(radio => radio.disabled = false);

             // Re-enable and reset submit button
             submitButton.disabled = false;
             submitButton.textContent = getTranslation('submit_button', lang);

             // Optional: Scroll back to the top of the quiz
             document.querySelector('.quiz-container').scrollIntoView({ behavior: 'smooth', block: 'start' });
         }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            const currentLang = getStoredLanguage();

             // Setup Language Switcher
             const languageSelectElement = document.getElementById('languageSelect');
             if (languageSelectElement) {
                 languageSelectElement.value = currentLang; // Set initial value
                 languageSelectElement.addEventListener('change', (e) => {
                     const newLang = e.target.value;
                     localStorage.setItem(LANGUAGE_STORAGE_KEY, newLang);
                     translatePage(newLang); // Translate static elements
                     renderQuiz(); // Re-render the quiz with new language
                     // If results are showing, potentially hide them or re-translate results text? Hiding is simpler on retry.
                     const resultsArea = document.getElementById('results-area');
                     if (resultsArea.style.display !== 'none'){
                        handleRetry(); // Reset the quiz state on language change after submission
                     }
                 });
             }

            renderQuiz(); // Build the quiz HTML
            translatePage(currentLang); // Translate all static text elements

            // Attach submit listener
            const quizForm = document.getElementById('quiz-form');
            quizForm.addEventListener('submit', handleSubmit);
        });

    </script>

</body>
</html>
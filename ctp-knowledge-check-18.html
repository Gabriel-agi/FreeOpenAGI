<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="kc18_page_title">Knowledge Check: Module 18 - Function Return Values</title>
    <!-- Fonts & Icons (Copied from dashboard) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Base Styles & Variables (Copied from dashboard) --- */
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-page: #f0f2f5;
            --background-card: #ffffff;
            --text-light: #f8f9fa;
            --text-dark: #343a40;
            --text-muted: #6c757d;
            --accent-color: #ffc107;
            --success-color: #198754;
            --error-color: #dc3545;
            --check-color: #6f42c1; /* Keep KC color */
            --border-color: #dee2e6;
            --border-radius: 8px;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
             /* Colors for lang switcher */
             --lang-select-border: var(--certificate-color); /* Using a defined color */
             --lang-select-bg: rgba(255, 255, 255, 0.1);
             --lang-select-bg-hover: rgba(255, 255, 255, 0.15);
             --lang-option-bg: var(--background-card);
             --lang-option-text: var(--text-dark);
             --lang-arrow-color: var(--certificate-color);
             --certificate-color: #d63384; /* Added for lang switcher if needed */
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.6;
            background-color: var(--background-page); color: var(--text-dark);
            display: flex; flex-direction: column; min-height: 100vh;
        }

        /* --- Header for Knowledge Check --- */
        .kc-header {
            background: linear-gradient(135deg, #0d6efd, #0a58ca); /* Similar to dashboard header */
            color: var(--text-light);
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        .kc-header-title {
            font-family: var(--font-title);
            font-size: 1.6rem;
            margin: 0;
        }
        .return-link {
            color: var(--text-light);
            text-decoration: none;
            font-size: 0.95rem;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            background-color: rgba(255, 255, 255, 0.15);
            transition: background-color var(--transition-speed);
            display: inline-flex;
            align-items: center;
        }
        .return-link i { margin-right: 6px; }
        .return-link:hover { background-color: rgba(255, 255, 255, 0.25); }

        /* --- Main Content Area --- */
        .kc-container {
            max-width: 900px;
            margin: 0 auto 2rem auto; /* Add bottom margin */
            padding: 0 1.5rem;
            flex-grow: 1; /* Make container grow to push footer down */
            width: 100%;
        }

        /* --- Quiz Styling --- */
        .quiz-card {
            background-color: var(--background-card);
            border-radius: var(--border-radius);
            padding: 2rem 2.5rem;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
        }
        .quiz-form h2 {
            font-family: var(--font-title);
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            text-align: center;
            font-size: 1.8rem;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 1rem;
        }
        .question-block {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px dashed var(--border-color);
        }
        .question-block:last-of-type { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
        .question-text {
            font-weight: 500;
            margin-bottom: 1rem;
            font-size: 1.1rem;
            color: var(--text-dark);
        }
        .question-text code {
            background-color: #e9ecef;
            padding: 0.15em 0.4em;
            border-radius: 4px;
            font-size: 0.9em;
            color: #c7254e; /* Bootstrap code color */
            font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        }
        .options { display: flex; flex-direction: column; gap: 0.7rem; }
        .options label {
            display: block;
            background-color: #f8f9fa;
            padding: 0.8rem 1.2rem;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all var(--transition-speed);
            position: relative;
            padding-left: 35px; /* Space for custom radio */
        }
        .options label:hover { background-color: #e9ecef; border-color: var(--secondary-color); }
        .options input[type="radio"] {
             opacity: 0; /* Hide default */
             position: absolute;
             width: 1px; height: 1px; /* Still focusable */
        }
        /* Custom Radio Button */
        .options label::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            width: 18px;
            height: 18px;
            border: 2px solid var(--secondary-color);
            border-radius: 50%;
            background-color: #fff;
            transition: border-color 0.2s, background-color 0.2s;
        }
        .options label::after { /* Checkmark */
            content: '';
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%) scale(0); /* Hidden initially */
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--primary-color);
            transition: transform 0.2s;
        }
        .options input[type="radio"]:checked + label {
            background-color: #e7f1ff;
            border-color: var(--primary-color);
            color: var(--primary-color);
            font-weight: 500;
        }
        .options input[type="radio"]:checked + label::before {
            border-color: var(--primary-color);
        }
        .options input[type="radio"]:checked + label::after {
            transform: translateY(-50%) scale(1); /* Show checkmark */
        }
        .options input[type="radio"]:focus + label { /* Accessibility */
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }
         /* Feedback styles */
        .options label.correct {
            background-color: #d1e7dd; /* Light green */
            border-color: var(--success-color);
            color: var(--success-color);
            font-weight: bold;
        }
        .options label.incorrect {
            background-color: #f8d7da; /* Light red */
            border-color: var(--error-color);
            color: var(--error-color);
        }
        .options label.correct::before { border-color: var(--success-color); }
        .options label.incorrect::before { border-color: var(--error-color); }
        .options input[type="radio"]:checked + label.correct::after { background-color: var(--success-color); }
        .options input[type="radio"]:checked + label.incorrect::after { background-color: var(--error-color); }

        /* --- Buttons --- */
        .button-container { text-align: center; margin-top: 2.5rem; }
        .quiz-button {
            background-color: var(--check-color); /* Use KC color */
            color: var(--text-light);
            border: none;
            padding: 0.8rem 2rem;
            font-size: 1.1rem;
            font-weight: 500;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: background-color var(--transition-speed), transform var(--transition-speed);
            min-width: 150px;
        }
        .quiz-button:hover { background-color: #5a35a2; transform: translateY(-2px); }
        .quiz-button:disabled { background-color: var(--secondary-color); cursor: not-allowed; transform: none; }
        .quiz-button#retry-quiz { background-color: var(--secondary-color); }
        .quiz-button#retry-quiz:hover { background-color: #5a6268; }
        .quiz-button#return-dashboard-button { background-color: var(--success-color); } /* Green for success */
        .quiz-button#return-dashboard-button:hover { background-color: #157347; }

        /* --- Results Area --- */
        #results-area {
            margin-top: 2rem;
            padding: 1.5rem 2rem;
            border-radius: var(--border-radius);
            text-align: center;
            font-size: 1.1rem;
        }
        #results-area.result-pass { background-color: #d1e7dd; border: 1px solid var(--success-color); color: #0f5132; }
        #results-area.result-fail { background-color: #f8d7da; border: 1px solid var(--error-color); color: #842029; }
        #results-area h3 { font-family: var(--font-title); margin-bottom: 0.8rem; font-size: 1.5rem; }
        #results-area p { margin-bottom: 0.5rem; }

         /* --- Language Switcher --- */
         .language-switcher-container { text-align: right; margin-bottom: 1rem; }
         #languageSelect {
            display: inline-block; /* Don't take full width */
            width: auto; /* Adjust width based on content */
            min-width: 150px; /* Ensure minimum size */
            background: var(--background-card);
            color: var(--text-dark);
            border: 1px solid var(--lang-select-border);
            border-radius: 5px;
            padding: 8px 35px 8px 15px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            appearance: none; -webkit-appearance: none; -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23${encodeURIComponent(getComputedStyle(document.documentElement).getPropertyValue('--certificate-color').trim().substring(1))}%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 10px auto;
            transition: border-color 0.3s ease;
         }
         #languageSelect:hover { border-color: #b02a6e; }
         #languageSelect:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25); }
         #languageSelect option { background: var(--lang-option-bg); color: var(--lang-option-text); padding: 5px; }

        /* --- Footer --- */
        footer {
            text-align: center; padding: 1.5rem; margin-top: auto; /* Pushes footer down */
            background-color: var(--background-card); border-top: 1px solid var(--border-color);
            color: var(--text-muted); font-size: 0.9rem;
        }

        /* --- Responsive Design --- */
        @media (max-width: 992px) {
            .kc-container { max-width: 720px; }
            .quiz-card { padding: 1.5rem 2rem; }
            .kc-header-title { font-size: 1.4rem; }
        }
        @media (max-width: 768px) {
            html { font-size: 15px; }
            .kc-header { padding: 0.8rem 1rem; }
            .kc-header-title { font-size: 1.3rem; }
            .return-link { font-size: 0.9rem; padding: 0.4rem 0.8rem; }
            .quiz-card { padding: 1.5rem; }
            .quiz-form h2 { font-size: 1.6rem; }
            .language-switcher-container { margin-bottom: 0.5rem; } /* Less space on mobile */
        }
        @media (max-width: 576px) {
            html { font-size: 14px; }
            .kc-header { flex-direction: column; align-items: flex-start; }
            .return-link { margin-top: 0.5rem; }
            .quiz-card { padding: 1rem; }
            .quiz-form h2 { font-size: 1.4rem; margin-bottom: 1rem; padding-bottom: 0.8rem; }
            .question-text { font-size: 1rem; }
            .options label { padding: 0.7rem 1rem; padding-left: 30px; }
            .options label::before { left: 8px; width: 16px; height: 16px; }
            .options label::after { left: 12px; width: 8px; height: 8px; }
            .button-container { margin-top: 1.5rem; }
            .quiz-button { font-size: 1rem; padding: 0.7rem 1.5rem; }
            #results-area { padding: 1rem 1.5rem; font-size: 1rem;}
            #results-area h3 { font-size: 1.3rem; }
            .language-switcher-container { text-align: center; } /* Center on very small screens */
        }
    </style>
</head>
<body>

    <header class="kc-header">
        <h1 class="kc-header-title" data-translate="kc18_header_title">Module 18: Function Return Values</h1>
        <a href="ctp-dashboard.html" class="return-link">
            <i class="fas fa-arrow-left"></i> <span data-translate="kc_return_dashboard">Return to Dashboard</span>
        </a>
    </header>

    <div class="kc-container">
         <!-- Language Switcher -->
        <div class="language-switcher-container">
            <select id="languageSelect" data-translate-aria-label="lang_select_aria" aria-label="Select Language">
                <option value="en" data-translate="lang_en">ðŸ‡¬ðŸ‡§ English</option>
                <option value="pt" data-translate="lang_pt">ðŸ‡§ðŸ‡· PortuguÃªs</option>
                <option value="zh" data-translate="lang_zh">ðŸ‡¨ðŸ‡³ ä¸­æ–‡</option>
            </select>
        </div>

        <div class="quiz-card">
            <form id="quiz-form" class="quiz-form">
                <h2 data-translate="kc18_quiz_title">Knowledge Check</h2>

                <!-- Question 1 -->
                <div class="question-block" data-question-id="q1">
                    <p class="question-text" data-translate="kc18_q1_text">What is the main purpose of the <code>return</code> statement in a Python function?</p>
                    <div class="options">
                        <input type="radio" id="q1_a" name="q1" value="a" required>
                        <label for="q1_a" data-translate="kc18_q1_opt_a">To print output directly to the console.</label>
                        <input type="radio" id="q1_b" name="q1" value="b">
                        <label for="q1_b" data-translate="kc18_q1_opt_b">To send a value back from the function to where it was called.</label>
                        <input type="radio" id="q1_c" name="q1" value="c">
                        <label for="q1_c" data-translate="kc18_q1_opt_c">To stop the entire script's execution immediately.</label>
                        <input type="radio" id="q1_d" name="q1" value="d">
                        <label for="q1_d" data-translate="kc18_q1_opt_d">To define a new variable within the function.</label>
                    </div>
                </div>

                <!-- Question 2 -->
                <div class="question-block" data-question-id="q2">
                    <p class="question-text">
                        <span data-translate="kc18_q2_text">Consider this function:</span><br>
                        <code>def add_numbers(x, y):</code><br>
                        <code>&nbsp;&nbsp;&nbsp;&nbsp;result = x + y</code><br>
                        <code>&nbsp;&nbsp;&nbsp;&nbsp;return result</code><br>
                        <br>
                        <span data-translate="kc18_q2_text_2">How would you store the value returned by calling <code>add_numbers(5, 3)</code> into a variable named <code>total</code>?</span>
                    </p>
                    <div class="options">
                        <input type="radio" id="q2_a" name="q2" value="a" required>
                        <label for="q2_a" data-translate="kc18_q2_opt_a"><code>print(add_numbers(5, 3))</code></label>
                        <input type="radio" id="q2_b" name="q2" value="b">
                        <label for="q2_b" data-translate="kc18_q2_opt_b"><code>result = add_numbers(5, 3)</code></label>
                        <input type="radio" id="q2_c" name="q2" value="c">
                        <label for="q2_c" data-translate="kc18_q2_opt_c"><code>total = add_numbers(5, 3)</code></label>
                        <input type="radio" id="q2_d" name="q2" value="d">
                        <label for="q2_d" data-translate="kc18_q2_opt_d"><code>add_numbers(5, 3) -> total</code></label>
                    </div>
                </div>

                <!-- Question 3 -->
                <div class="question-block" data-question-id="q3">
                    <p class="question-text" data-translate="kc18_q3_text">What happens if a function doesn't have an explicit <code>return</code> statement?</p>
                    <div class="options">
                        <input type="radio" id="q3_a" name="q3" value="a" required>
                        <label for="q3_a" data-translate="kc18_q3_opt_a">It causes a syntax error.</label>
                        <input type="radio" id="q3_b" name="q3" value="b">
                        <label for="q3_b" data-translate="kc18_q3_opt_b">It implicitly returns the value 0.</label>
                        <input type="radio" id="q3_c" name="q3" value="c">
                        <label for="q3_c" data-translate="kc18_q3_opt_c">It implicitly returns the special value <code>None</code>.</label>
                        <input type="radio" id="q3_d" name="q3" value="d">
                        <label for="q3_d" data-translate="kc18_q3_opt_d">It returns the last calculated value in the function.</label>
                    </div>
                </div>

                <!-- Question 4 -->
                <div class="question-block" data-question-id="q4">
                    <p class="question-text">
                        <span data-translate="kc18_q4_text">What will be printed by the following code?</span><br>
                        <code>def greet(name):</code><br>
                        <code>&nbsp;&nbsp;&nbsp;&nbsp;message = "Hello, " + name</code><br>
                        <code>&nbsp;&nbsp;&nbsp;&nbsp;# No return statement here</code><br><br>
                        <code>result = greet("Alice")</code><br>
                        <code>print(result)</code>
                     </p>
                    <div class="options">
                        <input type="radio" id="q4_a" name="q4" value="a" required>
                        <label for="q4_a" data-translate="kc18_q4_opt_a"><code>Hello, Alice</code></label>
                        <input type="radio" id="q4_b" name="q4" value="b">
                        <label for="q4_b" data-translate="kc18_q4_opt_b"><code>None</code></label>
                        <input type="radio" id="q4_c" name="q4" value="c">
                        <label for="q4_c" data-translate="kc18_q4_opt_c">An empty string <code>""</code></label>
                        <input type="radio" id="q4_d" name="q4" value="d">
                        <label for="q4_d" data-translate="kc18_q4_opt_d">It will cause an error.</label>
                    </div>
                </div>

                <!-- Question 5 -->
                <div class="question-block" data-question-id="q5">
                    <p class="question-text" data-translate="kc18_q5_text">Can a function return multiple values in Python? If so, how are they typically returned?</p>
                    <div class="options">
                        <input type="radio" id="q5_a" name="q5" value="a" required>
                        <label for="q5_a" data-translate="kc18_q5_opt_a">No, a function can only return a single value.</label>
                        <input type="radio" id="q5_b" name="q5" value="b">
                        <label for="q5_b" data-translate="kc18_q5_opt_b">Yes, by using multiple <code>return</code> statements.</label>
                        <input type="radio" id="q5_c" name="q5" value="c">
                        <label for="q5_c" data-translate="kc18_q5_opt_c">Yes, often as a tuple (or list/dictionary).</label>
                        <input type="radio" id="q5_d" name="q5" value="d">
                        <label for="q5_d" data-translate="kc18_q5_opt_d">Yes, by separating them with commas without a <code>return</code> keyword.</label>
                    </div>
                </div>

                <!-- Question 6 -->
                <div class="question-block" data-question-id="q6">
                     <p class="question-text">
                        <span data-translate="kc18_q6_text">What does the <code>return</code> statement do to the execution flow of a function?</span>
                     </p>
                    <div class="options">
                        <input type="radio" id="q6_a" name="q6" value="a" required>
                        <label for="q6_a" data-translate="kc18_q6_opt_a">It pauses the function, allowing it to be resumed later.</label>
                        <input type="radio" id="q6_b" name="q6" value="b">
                        <label for="q6_b" data-translate="kc18_q6_opt_b">It immediately stops the execution of the function and goes back to the calling code.</label>
                        <input type="radio" id="q6_c" name="q6" value="c">
                        <label for="q6_c" data-translate="kc18_q6_opt_c">It restarts the function from the beginning.</label>
                        <input type="radio" id="q6_d" name="q6" value="d">
                        <label for="q6_d" data-translate="kc18_q6_opt_d">It continues execution until the end of the function block, then returns.</label>
                    </div>
                </div>

                <!-- Question 7 -->
                <div class="question-block" data-question-id="q7">
                    <p class="question-text">
                        <span data-translate="kc18_q7_text">Consider the function:</span><br>
                        <code>def check_number(num):</code><br>
                        <code>&nbsp;&nbsp;&nbsp;&nbsp;if num > 10:</code><br>
                        <code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "Large"</code><br>
                        <code>&nbsp;&nbsp;&nbsp;&nbsp;elif num > 5:</code><br>
                        <code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "Medium"</code><br>
                        <code>&nbsp;&nbsp;&nbsp;&nbsp;else:</code><br>
                        <code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "Small"</code><br>
                        <br>
                        <span data-translate="kc18_q7_text_2">What is the value of <code>check_number(7)</code>?</span>
                     </p>
                    <div class="options">
                        <input type="radio" id="q7_a" name="q7" value="a" required>
                        <label for="q7_a" data-translate="kc18_q7_opt_a"><code>"Large"</code></label>
                        <input type="radio" id="q7_b" name="q7" value="b">
                        <label for="q7_b" data-translate="kc18_q7_opt_b"><code>"Medium"</code></label>
                        <input type="radio" id="q7_c" name="q7" value="c">
                        <label for="q7_c" data-translate="kc18_q7_opt_c"><code>"Small"</code></label>
                        <input type="radio" id="q7_d" name="q7" value="d">
                        <label for="q7_d" data-translate="kc18_q7_opt_d"><code>None</code></label>
                    </div>
                </div>

                <!-- Question 8 -->
                <div class="question-block" data-question-id="q8">
                     <p class="question-text" data-translate="kc18_q8_text">Why is it generally better to use <code>return</code> to get a result from a function rather than printing it inside the function?</p>
                    <div class="options">
                        <input type="radio" id="q8_a" name="q8" value="a" required>
                        <label for="q8_a" data-translate="kc18_q8_opt_a">Printing is slower than returning.</label>
                        <input type="radio" id="q8_b" name="q8" value="b">
                        <label for="q8_b" data-translate="kc18_q8_opt_b">Printing can cause errors if the console is not available.</label>
                        <input type="radio" id="q8_c" name="q8" value="c">
                        <label for="q8_c" data-translate="kc18_q8_opt_c">Returning makes the function more reusable, as the calling code can decide what to do with the result (store, print, use in calculations).</label>
                        <input type="radio" id="q8_d" name="q8" value="d">
                        <label for="q8_d" data-translate="kc18_q8_opt_d">Returning uses less memory than printing.</label>
                    </div>
                </div>

                 <!-- Question 9 -->
                <div class="question-block" data-question-id="q9">
                    <p class="question-text">
                        <span data-translate="kc18_q9_text">What value is returned by <code>return</code> without any expression after it (i.e., just <code>return</code>)?</span>
                    </p>
                    <div class="options">
                        <input type="radio" id="q9_a" name="q9" value="a" required>
                        <label for="q9_a" data-translate="kc18_q9_opt_a"><code>0</code></label>
                        <input type="radio" id="q9_b" name="q9" value="b">
                        <label for="q9_b" data-translate="kc18_q9_opt_b"><code>True</code></label>
                        <input type="radio" id="q9_c" name="q9" value="c">
                        <label for="q9_c" data-translate="kc18_q9_opt_c"><code>None</code></label>
                        <input type="radio" id="q9_d" name="q9" value="d">
                        <label for="q9_d" data-translate="kc18_q9_opt_d">It causes a SyntaxError.</label>
                    </div>
                </div>

                <!-- Question 10 -->
                <div class="question-block" data-question-id="q10">
                    <p class="question-text">
                        <span data-translate="kc18_q10_text">If you have <code>result = calculate_area(10, 5)</code>, what does this imply about the <code>calculate_area</code> function?</span>
                    </p>
                    <div class="options">
                        <input type="radio" id="q10_a" name="q10" value="a" required>
                        <label for="q10_a" data-translate="kc18_q10_opt_a">It must print the calculated area.</label>
                        <input type="radio" id="q10_b" name="q10" value="b">
                        <label for="q10_b" data-translate="kc18_q10_opt_b">It must have exactly two parameters named <code>length</code> and <code>width</code>.</label>
                        <input type="radio" id="q10_c" name="q10" value="c">
                        <label for="q10_c" data-translate="kc18_q10_opt_c">It must use a <code>return</code> statement to send back the calculated area.</label>
                        <input type="radio" id="q10_d" name="q10" value="d">
                        <label for="q10_d" data-translate="kc18_q10_opt_d">It must not take any arguments.</label>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="button-container">
                    <button type="submit" id="submit-quiz" class="quiz-button" data-translate="kc_submit">Submit Answers</button>
                    <button type="button" id="retry-quiz" class="quiz-button" style="display: none;" data-translate="kc_retry">Retry Quiz</button>
                     <button type="button" id="return-dashboard-button" class="quiz-button" style="display: none;" data-translate="kc_return_dashboard_button">Return to Dashboard</button>
                </div>
            </form>

             <!-- Results Area -->
             <div id="results-area" style="display: none;">
                 <h3 data-translate="kc_results_title">Quiz Results</h3>
                 <p><span data-translate="kc_score_label">Your Score:</span> <span id="score-value">0</span> / 10</p>
                 <p id="status-message"></p>
                 <p id="feedback-message" style="font-size: 0.9em; margin-top: 10px;"></p>
             </div>
        </div>
    </div>

    <footer>
        <p data-translate="footer_text">Part of the Road to Free Open AGI Project</p>
    </footer>

    <script>
        // --- Configuration ---
        const moduleId = 18;
        const passingScore = 6;
        const totalQuestions = 10;
        const KNOWLEDGE_CHECK_STORAGE_KEY = 'knowledgeCheckStatus_v1';
        const LANGUAGE_STORAGE_KEY = 'userLanguage';

        // --- Quiz Data ---
        const quizData = [
            { id: 'q1', correctAnswer: 'b' },
            { id: 'q2', correctAnswer: 'c' },
            { id: 'q3', correctAnswer: 'c' },
            { id: 'q4', correctAnswer: 'b' },
            { id: 'q5', correctAnswer: 'c' },
            { id: 'q6', correctAnswer: 'b' },
            { id: 'q7', correctAnswer: 'b' },
            { id: 'q8', correctAnswer: 'c' },
            { id: 'q9', correctAnswer: 'c' },
            { id: 'q10', correctAnswer: 'c' }
        ];

        // --- Translations ---
        const translations = {
            en: {
                "kc18_page_title": "Knowledge Check: Module 18 - Function Return Values",
                "kc18_header_title": "Module 18: Function Return Values",
                "kc_return_dashboard": "Return to Dashboard",
                "kc_return_dashboard_button": "Return to Dashboard",
                "kc18_quiz_title": "Knowledge Check",
                "kc_submit": "Submit Answers",
                "kc_retry": "Retry Quiz",
                "kc_results_title": "Quiz Results",
                "kc_score_label": "Your Score:",
                "kc_status_pass": "Congratulations! You passed.",
                "kc_status_fail": "Keep trying! You need {passingScore} out of {totalQuestions} to pass.",
                "kc_feedback_saved": "Your progress has been saved.",
                "kc_feedback_retry": "Review the questions and try again!",
                "footer_text": "Part of the Road to Free Open AGI Project",
                "lang_select_aria": "Select Language",
                "lang_en": "ðŸ‡¬ðŸ‡§ English", "lang_pt": "ðŸ‡§ðŸ‡· PortuguÃªs", "lang_zh": "ðŸ‡¨ðŸ‡³ ä¸­æ–‡",
                // Module 18 Questions & Options
                "kc18_q1_text": "What is the main purpose of the `return` statement in a Python function?",
                "kc18_q1_opt_a": "To print output directly to the console.",
                "kc18_q1_opt_b": "To send a value back from the function to where it was called.",
                "kc18_q1_opt_c": "To stop the entire script's execution immediately.",
                "kc18_q1_opt_d": "To define a new variable within the function.",
                "kc18_q2_text": "Consider this function:",
                "kc18_q2_text_2": "How would you store the value returned by calling `add_numbers(5, 3)` into a variable named `total`?",
                "kc18_q2_opt_a": "`print(add_numbers(5, 3))`",
                "kc18_q2_opt_b": "`result = add_numbers(5, 3)`",
                "kc18_q2_opt_c": "`total = add_numbers(5, 3)`",
                "kc18_q2_opt_d": "`add_numbers(5, 3) -> total`",
                "kc18_q3_text": "What happens if a function doesn't have an explicit `return` statement?",
                "kc18_q3_opt_a": "It causes a syntax error.",
                "kc18_q3_opt_b": "It implicitly returns the value 0.",
                "kc18_q3_opt_c": "It implicitly returns the special value `None`.",
                "kc18_q3_opt_d": "It returns the last calculated value in the function.",
                "kc18_q4_text": "What will be printed by the following code?",
                "kc18_q4_opt_a": "`Hello, Alice`",
                "kc18_q4_opt_b": "`None`",
                "kc18_q4_opt_c": "An empty string `\"\"`",
                "kc18_q4_opt_d": "It will cause an error.",
                "kc18_q5_text": "Can a function return multiple values in Python? If so, how are they typically returned?",
                "kc18_q5_opt_a": "No, a function can only return a single value.",
                "kc18_q5_opt_b": "Yes, by using multiple `return` statements.",
                "kc18_q5_opt_c": "Yes, often as a tuple (or list/dictionary).",
                "kc18_q5_opt_d": "Yes, by separating them with commas without a `return` keyword.",
                "kc18_q6_text": "What does the `return` statement do to the execution flow of a function?",
                "kc18_q6_opt_a": "It pauses the function, allowing it to be resumed later.",
                "kc18_q6_opt_b": "It immediately stops the execution of the function and goes back to the calling code.",
                "kc18_q6_opt_c": "It restarts the function from the beginning.",
                "kc18_q6_opt_d": "It continues execution until the end of the function block, then returns.",
                "kc18_q7_text": "Consider the function:",
                "kc18_q7_text_2": "What is the value of `check_number(7)`?",
                "kc18_q7_opt_a": "`\"Large\"`",
                "kc18_q7_opt_b": "`\"Medium\"`",
                "kc18_q7_opt_c": "`\"Small\"`",
                "kc18_q7_opt_d": "`None`",
                "kc18_q8_text": "Why is it generally better to use `return` to get a result from a function rather than printing it inside the function?",
                "kc18_q8_opt_a": "Printing is slower than returning.",
                "kc18_q8_opt_b": "Printing can cause errors if the console is not available.",
                "kc18_q8_opt_c": "Returning makes the function more reusable, as the calling code can decide what to do with the result (store, print, use in calculations).",
                "kc18_q8_opt_d": "Returning uses less memory than printing.",
                "kc18_q9_text": "What value is returned by `return` without any expression after it (i.e., just `return`)?",
                 "kc18_q9_opt_a": "`0`",
                 "kc18_q9_opt_b": "`True`",
                 "kc18_q9_opt_c": "`None`",
                 "kc18_q9_opt_d": "It causes a SyntaxError.",
                "kc18_q10_text": "If you have `result = calculate_area(10, 5)`, what does this imply about the `calculate_area` function?",
                "kc18_q10_opt_a": "It must print the calculated area.",
                "kc18_q10_opt_b": "It must have exactly two parameters named `length` and `width`.",
                "kc18_q10_opt_c": "It must use a `return` statement to send back the calculated area.",
                "kc18_q10_opt_d": "It must not take any arguments.",
            },
            pt: {
                "kc18_page_title": "VerificaÃ§Ã£o de Conhecimento: MÃ³dulo 18 - Valores de Retorno de FunÃ§Ã£o",
                "kc18_header_title": "MÃ³dulo 18: Valores de Retorno de FunÃ§Ã£o",
                "kc_return_dashboard": "Voltar ao Painel",
                "kc_return_dashboard_button": "Voltar ao Painel",
                "kc18_quiz_title": "VerificaÃ§Ã£o de Conhecimento",
                "kc_submit": "Enviar Respostas",
                "kc_retry": "Tentar Novamente",
                "kc_results_title": "Resultados do Quiz",
                "kc_score_label": "Sua PontuaÃ§Ã£o:",
                "kc_status_pass": "ParabÃ©ns! VocÃª passou.",
                "kc_status_fail": "Continue tentando! VocÃª precisa de {passingScore} de {totalQuestions} para passar.",
                "kc_feedback_saved": "Seu progresso foi salvo.",
                "kc_feedback_retry": "Revise as questÃµes e tente novamente!",
                "footer_text": "Parte do Projeto Road to Free Open AGI",
                "lang_select_aria": "Selecionar Idioma",
                "lang_en": "ðŸ‡¬ðŸ‡§ English", "lang_pt": "ðŸ‡§ðŸ‡· PortuguÃªs", "lang_zh": "ðŸ‡¨ðŸ‡³ ä¸­æ–‡",
                // Module 18 Questions & Options (PT)
                "kc18_q1_text": "Qual Ã© o principal propÃ³sito da instruÃ§Ã£o `return` em uma funÃ§Ã£o Python?",
                "kc18_q1_opt_a": "Imprimir a saÃ­da diretamente no console.",
                "kc18_q1_opt_b": "Enviar um valor de volta da funÃ§Ã£o para onde ela foi chamada.",
                "kc18_q1_opt_c": "Parar a execuÃ§Ã£o de todo o script imediatamente.",
                "kc18_q1_opt_d": "Definir uma nova variÃ¡vel dentro da funÃ§Ã£o.",
                "kc18_q2_text": "Considere esta funÃ§Ã£o:",
                "kc18_q2_text_2": "Como vocÃª armazenaria o valor retornado pela chamada `add_numbers(5, 3)` em uma variÃ¡vel chamada `total`?",
                "kc18_q2_opt_a": "`print(add_numbers(5, 3))`",
                "kc18_q2_opt_b": "`result = add_numbers(5, 3)`",
                "kc18_q2_opt_c": "`total = add_numbers(5, 3)`",
                "kc18_q2_opt_d": "`add_numbers(5, 3) -> total`",
                "kc18_q3_text": "O que acontece se uma funÃ§Ã£o nÃ£o tiver uma instruÃ§Ã£o `return` explÃ­cita?",
                "kc18_q3_opt_a": "Causa um erro de sintaxe.",
                "kc18_q3_opt_b": "Retorna implicitamente o valor 0.",
                "kc18_q3_opt_c": "Retorna implicitamente o valor especial `None`.",
                "kc18_q3_opt_d": "Retorna o Ãºltimo valor calculado na funÃ§Ã£o.",
                "kc18_q4_text": "O que serÃ¡ impresso pelo cÃ³digo a seguir?",
                "kc18_q4_opt_a": "`Hello, Alice`",
                "kc18_q4_opt_b": "`None`",
                "kc18_q4_opt_c": "Uma string vazia `\"\"`",
                "kc18_q4_opt_d": "CausarÃ¡ um erro.",
                "kc18_q5_text": "Uma funÃ§Ã£o pode retornar mÃºltiplos valores em Python? Se sim, como eles sÃ£o tipicamente retornados?",
                "kc18_q5_opt_a": "NÃ£o, uma funÃ§Ã£o sÃ³ pode retornar um Ãºnico valor.",
                "kc18_q5_opt_b": "Sim, usando mÃºltiplas instruÃ§Ãµes `return`.",
                "kc18_q5_opt_c": "Sim, frequentemente como uma tupla (ou lista/dicionÃ¡rio).",
                "kc18_q5_opt_d": "Sim, separando-os por vÃ­rgulas sem a palavra-chave `return`.",
                "kc18_q6_text": "O que a instruÃ§Ã£o `return` faz com o fluxo de execuÃ§Ã£o de uma funÃ§Ã£o?",
                "kc18_q6_opt_a": "Pausa a funÃ§Ã£o, permitindo que seja retomada mais tarde.",
                "kc18_q6_opt_b": "Interrompe imediatamente a execuÃ§Ã£o da funÃ§Ã£o e retorna ao cÃ³digo que a chamou.",
                "kc18_q6_opt_c": "Reinicia a funÃ§Ã£o desde o inÃ­cio.",
                "kc18_q6_opt_d": "Continua a execuÃ§Ã£o atÃ© o final do bloco da funÃ§Ã£o e entÃ£o retorna.",
                "kc18_q7_text": "Considere a funÃ§Ã£o:",
                "kc18_q7_text_2": "Qual Ã© o valor de `check_number(7)`?",
                "kc18_q7_opt_a": "`\"Large\"`",
                "kc18_q7_opt_b": "`\"Medium\"`",
                "kc18_q7_opt_c": "`\"Small\"`",
                "kc18_q7_opt_d": "`None`",
                "kc18_q8_text": "Por que geralmente Ã© melhor usar `return` para obter um resultado de uma funÃ§Ã£o em vez de imprimi-lo dentro da funÃ§Ã£o?",
                "kc18_q8_opt_a": "Imprimir Ã© mais lento que retornar.",
                "kc18_q8_opt_b": "Imprimir pode causar erros se o console nÃ£o estiver disponÃ­vel.",
                "kc18_q8_opt_c": "Retornar torna a funÃ§Ã£o mais reutilizÃ¡vel, pois o cÃ³digo que a chama pode decidir o que fazer com o resultado (armazenar, imprimir, usar em cÃ¡lculos).",
                "kc18_q8_opt_d": "Retornar usa menos memÃ³ria do que imprimir.",
                "kc18_q9_text": "Qual valor Ã© retornado por `return` sem nenhuma expressÃ£o apÃ³s ele (ou seja, apenas `return`)?",
                "kc18_q9_opt_a": "`0`",
                "kc18_q9_opt_b": "`True`",
                "kc18_q9_opt_c": "`None`",
                "kc18_q9_opt_d": "Causa um SyntaxError.",
                "kc18_q10_text": "Se vocÃª tem `result = calculate_area(10, 5)`, o que isso implica sobre a funÃ§Ã£o `calculate_area`?",
                "kc18_q10_opt_a": "Ela deve imprimir a Ã¡rea calculada.",
                "kc18_q10_opt_b": "Ela deve ter exatamente dois parÃ¢metros chamados `length` e `width`.",
                "kc18_q10_opt_c": "Ela deve usar uma instruÃ§Ã£o `return` para enviar de volta a Ã¡rea calculada.",
                "kc18_q10_opt_d": "Ela nÃ£o deve receber nenhum argumento.",
            },
            zh: {
                "kc18_page_title": "çŸ¥è¯†æµ‹éªŒï¼šæ¨¡å— 18 - å‡½æ•°è¿”å›žå€¼",
                "kc18_header_title": "æ¨¡å— 18: å‡½æ•°è¿”å›žå€¼",
                "kc_return_dashboard": "è¿”å›žä»ªè¡¨æ¿",
                "kc_return_dashboard_button": "è¿”å›žä»ªè¡¨æ¿",
                "kc18_quiz_title": "çŸ¥è¯†æµ‹éªŒ",
                "kc_submit": "æäº¤ç­”æ¡ˆ",
                "kc_retry": "é‡æ–°æµ‹éªŒ",
                "kc_results_title": "æµ‹éªŒç»“æžœ",
                "kc_score_label": "ä½ çš„åˆ†æ•°:",
                "kc_status_pass": "æ­å–œï¼ä½ é€šè¿‡äº†ã€‚",
                "kc_status_fail": "ç»§ç»­åŠªåŠ›ï¼ä½ éœ€è¦ç­”å¯¹ {passingScore} / {totalQuestions} é¢˜æ‰èƒ½é€šè¿‡ã€‚",
                "kc_feedback_saved": "ä½ çš„è¿›åº¦å·²ä¿å­˜ã€‚",
                "kc_feedback_retry": "å¤ä¹ é¢˜ç›®å¹¶å†è¯•ä¸€æ¬¡ï¼",
                "footer_text": "é€šå¾€è‡ªç”±å¼€æ”¾AGIä¹‹è·¯é¡¹ç›®çš„ä¸€éƒ¨åˆ†",
                "lang_select_aria": "é€‰æ‹©è¯­è¨€",
                "lang_en": "ðŸ‡¬ðŸ‡§ English", "lang_pt": "ðŸ‡§ðŸ‡· PortuguÃªs", "lang_zh": "ðŸ‡¨ðŸ‡³ ä¸­æ–‡",
                // Module 18 Questions & Options (ZH)
                "kc18_q1_text": "Python å‡½æ•°ä¸­ `return` è¯­å¥çš„ä¸»è¦ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ",
                "kc18_q1_opt_a": "ç›´æŽ¥å°†è¾“å‡ºæ‰“å°åˆ°æŽ§åˆ¶å°ã€‚",
                "kc18_q1_opt_b": "å°†ä¸€ä¸ªå€¼ä»Žå‡½æ•°å‘é€å›žè°ƒç”¨å®ƒçš„åœ°æ–¹ã€‚",
                "kc18_q1_opt_c": "ç«‹å³åœæ­¢æ•´ä¸ªè„šæœ¬çš„æ‰§è¡Œã€‚",
                "kc18_q1_opt_d": "åœ¨å‡½æ•°å†…éƒ¨å®šä¹‰ä¸€ä¸ªæ–°å˜é‡ã€‚",
                "kc18_q2_text": "è€ƒè™‘è¿™ä¸ªå‡½æ•°ï¼š",
                "kc18_q2_text_2": "å¦‚ä½•å°†è°ƒç”¨ `add_numbers(5, 3)` è¿”å›žçš„å€¼å­˜å‚¨åˆ°ä¸€ä¸ªåä¸º `total` çš„å˜é‡ä¸­ï¼Ÿ",
                "kc18_q2_opt_a": "`print(add_numbers(5, 3))`",
                "kc18_q2_opt_b": "`result = add_numbers(5, 3)`",
                "kc18_q2_opt_c": "`total = add_numbers(5, 3)`",
                "kc18_q2_opt_d": "`add_numbers(5, 3) -> total`",
                "kc18_q3_text": "å¦‚æžœä¸€ä¸ªå‡½æ•°æ²¡æœ‰æ˜¾å¼çš„ `return` è¯­å¥ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ",
                "kc18_q3_opt_a": "ä¼šå¯¼è‡´è¯­æ³•é”™è¯¯ã€‚",
                "kc18_q3_opt_b": "å®ƒéšå¼åœ°è¿”å›žå€¼ 0ã€‚",
                "kc18_q3_opt_c": "å®ƒéšå¼åœ°è¿”å›žç‰¹æ®Šå€¼ `None`ã€‚",
                "kc18_q3_opt_d": "å®ƒè¿”å›žå‡½æ•°ä¸­æœ€åŽè®¡ç®—çš„å€¼ã€‚",
                "kc18_q4_text": "ä»¥ä¸‹ä»£ç å°†æ‰“å°ä»€ä¹ˆï¼Ÿ",
                "kc18_q4_opt_a": "`Hello, Alice`",
                "kc18_q4_opt_b": "`None`",
                "kc18_q4_opt_c": "ç©ºå­—ç¬¦ä¸² `\"\"`",
                "kc18_q4_opt_d": "å®ƒå°†å¯¼è‡´ä¸€ä¸ªé”™è¯¯ã€‚",
                "kc18_q5_text": "Python å‡½æ•°å¯ä»¥è¿”å›žå¤šä¸ªå€¼å—ï¼Ÿå¦‚æžœå¯ä»¥ï¼Œå®ƒä»¬é€šå¸¸å¦‚ä½•è¿”å›žï¼Ÿ",
                "kc18_q5_opt_a": "ä¸ï¼Œä¸€ä¸ªå‡½æ•°åªèƒ½è¿”å›žå•ä¸ªå€¼ã€‚",
                "kc18_q5_opt_b": "æ˜¯çš„ï¼Œé€šè¿‡ä½¿ç”¨å¤šä¸ª `return` è¯­å¥ã€‚",
                "kc18_q5_opt_c": "æ˜¯çš„ï¼Œé€šå¸¸ä»¥å…ƒç»„ï¼ˆæˆ–åˆ—è¡¨/å­—å…¸ï¼‰çš„å½¢å¼ã€‚",
                "kc18_q5_opt_d": "æ˜¯çš„ï¼Œé€šè¿‡ç”¨é€—å·åˆ†éš”å®ƒä»¬ï¼Œè€Œä¸éœ€è¦ `return` å…³é”®å­—ã€‚",
                "kc18_q6_text": "`return` è¯­å¥å¯¹å‡½æ•°çš„æ‰§è¡Œæµç¨‹æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ",
                "kc18_q6_opt_a": "å®ƒæš‚åœå‡½æ•°ï¼Œå…è®¸ç¨åŽæ¢å¤ã€‚",
                "kc18_q6_opt_b": "å®ƒç«‹å³åœæ­¢å‡½æ•°çš„æ‰§è¡Œå¹¶è¿”å›žåˆ°è°ƒç”¨ä»£ç å¤„ã€‚",
                "kc18_q6_opt_c": "å®ƒä»Žå¤´å¼€å§‹é‡æ–°å¯åŠ¨å‡½æ•°ã€‚",
                "kc18_q6_opt_d": "å®ƒç»§ç»­æ‰§è¡Œç›´åˆ°å‡½æ•°å—ç»“æŸï¼Œç„¶åŽè¿”å›žã€‚",
                "kc18_q7_text": "è€ƒè™‘å‡½æ•°ï¼š",
                "kc18_q7_text_2": "`check_number(7)` çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ",
                "kc18_q7_opt_a": "`\"Large\"`",
                "kc18_q7_opt_b": "`\"Medium\"`",
                "kc18_q7_opt_c": "`\"Small\"`",
                "kc18_q7_opt_d": "`None`",
                "kc18_q8_text": "ä¸ºä»€ä¹ˆé€šå¸¸ä½¿ç”¨ `return` ä»Žå‡½æ•°èŽ·å–ç»“æžœæ¯”åœ¨å‡½æ•°å†…éƒ¨æ‰“å°ç»“æžœæ›´å¥½ï¼Ÿ",
                "kc18_q8_opt_a": "æ‰“å°æ¯”è¿”å›žæ…¢ã€‚",
                "kc18_q8_opt_b": "å¦‚æžœæŽ§åˆ¶å°ä¸å¯ç”¨ï¼Œæ‰“å°å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯ã€‚",
                "kc18_q8_opt_c": "è¿”å›žä½¿å‡½æ•°æ›´å…·å¯é‡ç”¨æ€§ï¼Œå› ä¸ºè°ƒç”¨ä»£ç å¯ä»¥å†³å®šå¦‚ä½•å¤„ç†ç»“æžœï¼ˆå­˜å‚¨ã€æ‰“å°ã€ç”¨äºŽè®¡ç®—ï¼‰ã€‚",
                "kc18_q8_opt_d": "è¿”å›žæ¯”æ‰“å°ä½¿ç”¨æ›´å°‘çš„å†…å­˜ã€‚",
                "kc18_q9_text": "åŽé¢æ²¡æœ‰ä»»ä½•è¡¨è¾¾å¼çš„ `return`ï¼ˆå³ï¼Œåªæœ‰ `return`ï¼‰è¿”å›žä»€ä¹ˆå€¼ï¼Ÿ",
                "kc18_q9_opt_a": "`0`",
                "kc18_q9_opt_b": "`True`",
                "kc18_q9_opt_c": "`None`",
                "kc18_q9_opt_d": "å®ƒå¯¼è‡´ä¸€ä¸ª SyntaxErrorã€‚",
                "kc18_q10_text": "å¦‚æžœä½ æœ‰ `result = calculate_area(10, 5)`ï¼Œè¿™å¯¹ `calculate_area` å‡½æ•°æ„å‘³ç€ä»€ä¹ˆï¼Ÿ",
                "kc18_q10_opt_a": "å®ƒå¿…é¡»æ‰“å°è®¡ç®—å‡ºçš„é¢ç§¯ã€‚",
                "kc18_q10_opt_b": "å®ƒå¿…é¡»æ°å¥½æœ‰ä¸¤ä¸ªåä¸º `length` å’Œ `width` çš„å‚æ•°ã€‚",
                "kc18_q10_opt_c": "å®ƒå¿…é¡»ä½¿ç”¨ `return` è¯­å¥æ¥è¿”å›žè®¡ç®—å‡ºçš„é¢ç§¯ã€‚",
                "kc18_q10_opt_d": "å®ƒå¿…é¡»ä¸æŽ¥å—ä»»ä½•å‚æ•°ã€‚",
            }
        };

        // --- DOM Elements ---
        const quizForm = document.getElementById('quiz-form');
        const resultsArea = document.getElementById('results-area');
        const scoreValueEl = document.getElementById('score-value');
        const statusMessageEl = document.getElementById('status-message');
        const feedbackMessageEl = document.getElementById('feedback-message');
        const submitButton = document.getElementById('submit-quiz');
        const retryButton = document.getElementById('retry-quiz');
        const returnDashboardButton = document.getElementById('return-dashboard-button');
        const languageSelectElement = document.getElementById('languageSelect');

        // --- Helper Functions ---
        function getStoredLanguage() {
            const storedLang = localStorage.getItem(LANGUAGE_STORAGE_KEY);
            return (storedLang && translations[storedLang]) ? storedLang : 'en';
        }

        function getTranslation(key, lang, replacements = {}) {
            let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`;
            for (const placeholder in replacements) {
                const regex = new RegExp(`\\{${placeholder}\\}`, 'g');
                text = text.replace(regex, replacements[placeholder]);
            }
            return text;
        }

        function translatePage(lang) {
            document.documentElement.lang = lang;
            document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.getAttribute('data-translate');
                const translation = getTranslation(key, lang, { passingScore: passingScore, totalQuestions: totalQuestions }); // Pass replacements
                if (el.tagName === 'TITLE') {
                    document.title = translation;
                } else {
                    // Handle potential HTML in translations (like code tags) carefully
                    el.innerHTML = translation; // Use innerHTML to render tags if needed
                }
            });
            document.querySelectorAll('[data-translate-aria-label]').forEach(el => {
                const key = el.getAttribute('data-translate-aria-label');
                el.setAttribute('aria-label', getTranslation(key, lang));
            });
             // Retranslate results if already visible
             if (resultsArea.style.display !== 'none') {
                const score = parseInt(scoreValueEl.textContent); // Get the current score
                displayResults(score); // Redisplay with new language
            }
        }

        function setLanguage(lang) {
            if (!translations[lang]) lang = 'en'; // Fallback
            localStorage.setItem(LANGUAGE_STORAGE_KEY, lang);
            languageSelectElement.value = lang; // Update dropdown
            translatePage(lang);
        }

        function loadKnowledgeCheckStatus() {
            try {
                const storedStatus = localStorage.getItem(KNOWLEDGE_CHECK_STORAGE_KEY);
                const parsed = storedStatus ? JSON.parse(storedStatus) : {};
                return typeof parsed === 'object' && parsed !== null ? parsed : {};
            } catch (e) {
                console.error("Error reading KC status from localStorage:", e);
                return {};
            }
        }

        function saveKnowledgeCheckStatus(statusObject) {
            try {
                localStorage.setItem(KNOWLEDGE_CHECK_STORAGE_KEY, JSON.stringify(statusObject));
            } catch (e) {
                console.error("Error saving KC status to localStorage:", e);
            }
        }

        function markModuleComplete() {
            const currentStatus = loadKnowledgeCheckStatus();
            currentStatus[moduleId] = true; // Mark this module as complete
            saveKnowledgeCheckStatus(currentStatus);
        }

        function disableForm() {
            quizForm.querySelectorAll('input[type="radio"]').forEach(input => {
                input.disabled = true;
            });
            submitButton.disabled = true;
            submitButton.style.display = 'none'; // Hide submit
        }

        function enableForm() {
            quizForm.querySelectorAll('input[type="radio"]').forEach(input => {
                input.disabled = false;
            });
            submitButton.disabled = false;
            submitButton.style.display = 'inline-block'; // Show submit
            retryButton.style.display = 'none'; // Hide retry
            returnDashboardButton.style.display = 'none'; // Hide return button
        }

        function showFeedback(score) {
            quizData.forEach(q => {
                const questionBlock = document.querySelector(`.question-block[data-question-id="${q.id}"]`);
                const selectedAnswer = quizForm.querySelector(`input[name="${q.id}"]:checked`);
                const options = questionBlock.querySelectorAll('.options label');

                options.forEach(label => {
                    const input = document.getElementById(label.getAttribute('for'));
                    label.classList.remove('correct', 'incorrect'); // Clear previous feedback

                    if (input.value === q.correctAnswer) {
                        label.classList.add('correct'); // Highlight correct answer
                    } else if (selectedAnswer && input === selectedAnswer.nextElementSibling && input.value !== q.correctAnswer) {
                         label.classList.add('incorrect'); // Highlight selected incorrect answer
                    }
                });
            });
        }

         function clearFeedback() {
             document.querySelectorAll('.options label').forEach(label => {
                 label.classList.remove('correct', 'incorrect');
             });
         }

        function displayResults(score) {
            const lang = getStoredLanguage();
            scoreValueEl.textContent = score;
            const passed = score >= passingScore;

            resultsArea.classList.remove('result-pass', 'result-fail'); // Clear previous classes
            if (passed) {
                resultsArea.classList.add('result-pass');
                statusMessageEl.textContent = getTranslation('kc_status_pass', lang);
                feedbackMessageEl.textContent = getTranslation('kc_feedback_saved', lang);
                retryButton.style.display = 'none'; // No need to retry if passed
                returnDashboardButton.style.display = 'inline-block'; // Show return button
            } else {
                resultsArea.classList.add('result-fail');
                statusMessageEl.innerHTML = getTranslation('kc_status_fail', lang, { passingScore: passingScore, totalQuestions: totalQuestions });
                feedbackMessageEl.textContent = getTranslation('kc_feedback_retry', lang);
                retryButton.style.display = 'inline-block'; // Show retry button
                returnDashboardButton.style.display = 'none'; // Hide return button
            }
            resultsArea.style.display = 'block'; // Show results
            resultsArea.scrollIntoView({ behavior: 'smooth', block: 'start' }); // Scroll to results
        }

        function checkAnswers(event) {
            event.preventDefault(); // Prevent form submission
            let score = 0;
            const formData = new FormData(quizForm);
            let answeredCount = 0;

            // Check if all questions are answered
            quizData.forEach(q => {
                if (formData.has(q.id)) {
                    answeredCount++;
                }
            });

            if (answeredCount < totalQuestions) {
                // Maybe add a message later if needed, for now just proceed
                 alert(getTranslation('kc_alert_answer_all', lang) || "Please answer all questions before submitting."); // Simple alert
                 return; // Stop submission if not all answered
            }

            // Calculate score
            quizData.forEach(q => {
                const userAnswer = formData.get(q.id);
                if (userAnswer === q.correctAnswer) {
                    score++;
                }
            });

            disableForm();
            showFeedback(score);
            displayResults(score);

            if (score >= passingScore) {
                markModuleComplete();
            }
        }

        function resetQuiz() {
            quizForm.reset(); // Clear selections
            clearFeedback(); // Remove highlights
            enableForm(); // Re-enable inputs/submit button
            resultsArea.style.display = 'none'; // Hide results area
            window.scrollTo({ top: 0, behavior: 'smooth' }); // Scroll to top
        }

        // --- Event Listeners ---
        document.addEventListener('DOMContentLoaded', () => {
            const initialLang = getStoredLanguage();
            languageSelectElement.value = initialLang;
            setLanguage(initialLang); // Translate page on load

            quizForm.addEventListener('submit', checkAnswers);
            retryButton.addEventListener('click', resetQuiz);
            returnDashboardButton.addEventListener('click', () => {
                window.location.href = 'ctp-dashboard.html'; // Navigate back
            });

            languageSelectElement.addEventListener('change', (e) => {
                setLanguage(e.target.value);
            });
        });

    </script>

</body>
</html>
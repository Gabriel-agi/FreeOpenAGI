<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="page_title">Knowledge Check: Module 25 - Exception Handling</title>
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Base Styles & Variables (Copied from Dashboard for consistency) --- */
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-page: #f0f2f5;
            --background-card: #ffffff;
            --text-light: #f8f9fa;
            --text-dark: #343a40;
            --text-muted: #6c757d;
            --accent-color: #ffc107;
            --success-color: #198754;
            --error-color: #dc3545;
            --check-color: #6f42c1; /* Color for KC checkmarks/buttons */
            --progress-bg: #e9ecef;
            --progress-fill: var(--check-color);
            --border-color: #dee2e6;
            --border-radius: 8px;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            --card-shadow-hover: 0 6px 18px rgba(0, 0, 0, 0.1);
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
             /* Colors for lang switcher */
             --lang-select-border: var(--check-color);
             --lang-select-bg: rgba(255, 255, 255, 0.1);
             --lang-select-bg-hover: rgba(255, 255, 255, 0.15);
             --lang-option-bg: var(--background-card);
             --lang-option-text: var(--text-dark);
             --lang-arrow-color: var(--check-color);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.6;
            background-color: var(--background-page); color: var(--text-dark);
            display: flex; flex-direction: column; min-height: 100vh;
        }

        /* --- Header Styling --- */
        .quiz-header {
            background: linear-gradient(135deg, #0d6efd, #0a58ca); /* Similar to dashboard header */
            color: var(--text-light);
            padding: 1.5rem 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--card-shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap; /* Allow wrapping on small screens */
            gap: 1rem; /* Space between items */
        }
        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        .return-button {
            display: inline-flex; /* Changed to inline-flex */
            align-items: center;
            text-decoration: none;
            color: var(--text-light);
            background-color: rgba(255, 255, 255, 0.15);
            padding: 0.6rem 1rem;
            border-radius: var(--border-radius);
            font-size: 0.9rem;
            font-weight: 500;
            transition: background-color var(--transition-speed) ease;
        }
        .return-button i { margin-right: 8px; }
        .return-button:hover { background-color: rgba(255, 255, 255, 0.25); }

        .quiz-header h1 {
            font-family: var(--font-title);
            font-size: 1.8rem; /* Slightly smaller than dashboard */
            margin: 0; /* Reset margin */
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
            flex-grow: 1; /* Allow title to take space */
            text-align: left; /* Keep title left-aligned */
        }
        .header-right {
            display: flex;
            align-items: center;
        }
        /* Language Switcher Styles (Copied & Adjusted) */
         .language-switcher { margin-left: 1rem; /* Add some space */ }
         #languageSelect {
            background: var(--lang-select-bg);
            color: var(--text-light);
            border: 1px solid var(--lang-select-border);
            border-radius: 5px;
            padding: 8px 35px 8px 12px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            appearance: none; -webkit-appearance: none; -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23${encodeURIComponent(getComputedStyle(document.documentElement).getPropertyValue('--check-color').trim().substring(1))}%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 10px auto;
            transition: border-color 0.3s ease, background-color 0.3s ease;
         }
         #languageSelect:hover { background-color: var(--lang-select-bg-hover); }
         #languageSelect:focus { outline: none; border-color: var(--accent-color); }
         #languageSelect option {
              background: var(--lang-option-bg);
              color: var(--lang-option-text);
              padding: 5px;
         }


        /* --- Quiz Container & Styling --- */
        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background-color: var(--background-card);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            flex-grow: 1; /* Take remaining vertical space */
        }

        #quiz-form { display: flex; flex-direction: column; gap: 2rem; }

        .question-block {
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            background-color: #fdfdfd; /* Slightly off-white */
            transition: border-color var(--transition-speed);
        }
        .question-block.correct { border-left: 5px solid var(--success-color); }
        .question-block.incorrect { border-left: 5px solid var(--error-color); }

        .question-number {
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            display: block;
        }
        .question-text { font-size: 1.1rem; margin-bottom: 1.2rem; font-weight: 500; }
        .question-text code { font-size: 0.95em; background: #eee; padding: 2px 5px; border-radius: 3px; color: #c7254e; }

        .options-list { list-style: none; padding: 0; margin: 0; }
        .options-list li { margin-bottom: 0.8rem; }
        .options-list label {
            display: block; /* Make label clickable area larger */
            padding: 0.7rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            cursor: pointer;
            transition: background-color var(--transition-speed), border-color var(--transition-speed);
            position: relative; /* For feedback icons */
            background-color: var(--background-page);
        }
         .options-list label:hover { background-color: #e9ecef; border-color: var(--secondary-color); }
        .options-list input[type="radio"] { margin-right: 10px; vertical-align: middle; }
         /* Visually hide the actual radio button but keep it accessible */
         .options-list input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .options-list label span.option-text { /* Class added for JS targeting */
            display: inline-block;
            vertical-align: middle;
        }
         .options-list label span.option-text code { font-size: 0.9em; background: #ddd; padding: 1px 4px; border-radius: 3px; color: #c7254e;}

        /* Feedback styles on options */
        .options-list label.correct { background-color: #d1e7dd; border-color: var(--success-color); color: #0f5132; font-weight: 500; }
        .options-list label.incorrect { background-color: #f8d7da; border-color: var(--error-color); color: #842029; font-weight: 500; }
        .options-list label.correct::after { content: '\f00c'; font-family: 'Font Awesome 6 Free'; font-weight: 900; color: var(--success-color); position: absolute; right: 15px; top: 50%; transform: translateY(-50%); }
        .options-list label.incorrect::after { content: '\f00d'; font-family: 'Font Awesome 6 Free'; font-weight: 900; color: var(--error-color); position: absolute; right: 15px; top: 50%; transform: translateY(-50%); }

        /* Selected state */
        .options-list input[type="radio"]:checked + label {
            border-color: var(--primary-color);
            background-color: #e7f1ff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);
        }
         /* Disabled state feedback */
         .options-list input[type="radio"]:disabled + label { cursor: not-allowed; opacity: 0.7; }
         .options-list input[type="radio"]:disabled:checked + label.correct { opacity: 1; } /* Keep correct visible */
         .options-list input[type="radio"]:disabled:checked + label.incorrect { opacity: 1; } /* Keep incorrect visible */


        /* --- Buttons --- */
        .button-area { text-align: center; margin-top: 2.5rem; }
        .quiz-button {
            padding: 0.8rem 2rem;
            font-size: 1.1rem;
            font-weight: 500;
            border-radius: var(--border-radius);
            border: none;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            margin: 0 0.5rem; /* Space between buttons if side-by-side */
        }
        #submit-button { background-color: var(--check-color); color: var(--text-light); }
        #submit-button:hover { background-color: #5a35a3; transform: translateY(-2px); box-shadow: var(--card-shadow-hover); }
        #retake-button { background-color: var(--secondary-color); color: var(--text-light); }
        #retake-button:hover { background-color: #5a6268; transform: translateY(-2px); box-shadow: var(--card-shadow-hover); }
        .quiz-button:disabled { background-color: #adb5bd; cursor: not-allowed; transform: none; box-shadow: none;}


        /* --- Result Area --- */
        #result-area {
            margin-top: 2rem;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            text-align: center;
            font-size: 1.1rem;
            border-width: 3px;
            border-style: solid;
            display: none; /* Hidden by default */
        }
        #result-area.passed { border-color: var(--success-color); background-color: #d1e7dd; color: #0f5132; }
        #result-area.failed { border-color: var(--error-color); background-color: #f8d7da; color: #842029; }
        #result-area h3 { margin-bottom: 0.5rem; font-family: var(--font-title); }
        #result-score { font-weight: 700; font-size: 1.3rem; }
        #result-feedback { margin-top: 0.5rem; }

        /* --- Footer --- */
        footer { text-align: center; padding: 1.5rem; margin-top: 3rem; background-color: var(--background-card); border-top: 1px solid var(--border-color); color: var(--text-muted); font-size: 0.9rem; }

        /* --- Responsive Design --- */
        @media (max-width: 768px) {
            html { font-size: 15px; }
            .quiz-header { padding: 1rem 1.5rem; flex-direction: column; align-items: flex-start; }
             .quiz-header h1 { font-size: 1.6rem; text-align: left; width: 100%; margin-top: 0.5rem;}
             .header-left { width: 100%; justify-content: space-between;} /* Push lang switcher right */
             .header-right { display: none; } /* Hide duplicate lang switcher if needed */
             .language-switcher { margin-left: 0; } /* Reset margin */
            .quiz-container { padding: 1.5rem; margin: 0 1rem; /* Add side margin */ }
            .question-block { padding: 1rem; }
            .question-text { font-size: 1rem; }
            .options-list label { padding: 0.6rem 0.8rem; }
        }
        @media (max-width: 576px) {
            html { font-size: 14px; }
             .quiz-header { padding: 1rem; }
             .quiz-header h1 { font-size: 1.4rem; }
             .return-button { padding: 0.5rem 0.8rem; font-size: 0.8rem; }
             #languageSelect { font-size: 0.85rem; padding: 6px 30px 6px 10px; }
            .quiz-container { padding: 1rem; margin: 0 0.5rem; }
            .question-block { gap: 1.5rem; }
            .options-list li { margin-bottom: 0.6rem; }
            .button-area { margin-top: 2rem; }
            .quiz-button { padding: 0.7rem 1.5rem; font-size: 1rem; }
            #result-area { padding: 1rem; font-size: 1rem; }
            #result-score { font-size: 1.2rem; }
        }

    </style>
</head>
<body>

    <header class="quiz-header">
        <div class="header-left">
             <a href="ctp-dashboard.html" class="return-button">
                <i class="fas fa-arrow-left"></i> <span data-translate="return_button">Return to Dashboard</span>
            </a>
             <!-- Language Switcher -->
             <div class="language-switcher">
                <select id="languageSelect" data-translate-aria-label="lang_select_aria" aria-label="Select Language">
                    <option value="en" data-translate="lang_en">ğŸ‡¬ğŸ‡§ English</option>
                    <option value="pt" data-translate="lang_pt">ğŸ‡§ğŸ‡· PortuguÃªs</option>
                    <option value="zh" data-translate="lang_zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                </select>
            </div>
        </div>
        <h1 data-translate="quiz_title">Module 25: Exception Handling Check</h1>
    </header>

    <main class="quiz-container">
        <form id="quiz-form">
            <!-- Question 1 -->
            <div class="question-block" data-question-id="1">
                <span class="question-number" data-translate="q_num" data-replacements='{"num": 1}'>Question 1</span>
                <p class="question-text" data-translate="q1_text">What is the primary purpose of using a <code>try...except</code> block in Python?</p>
                <ul class="options-list">
                    <li><input type="radio" id="q1_a" name="q1" value="a"><label for="q1_a"><span class="option-text" data-translate="q1_opt_a">To speed up code execution.</span></label></li>
                    <li><input type="radio" id="q1_b" name="q1" value="b"><label for="q1_b"><span class="option-text" data-translate="q1_opt_b">To handle potential errors gracefully without crashing the program.</span></label></li>
                    <li><input type="radio" id="q1_c" name="q1" value="c"><label for="q1_c"><span class="option-text" data-translate="q1_opt_c">To define new types of errors.</span></label></li>
                    <li><input type="radio" id="q1_d" name="q1" value="d"><label for="q1_d"><span class="option-text" data-translate="q1_opt_d">To repeat a block of code multiple times.</span></label></li>
                </ul>
            </div>

            <!-- Question 2 -->
            <div class="question-block" data-question-id="2">
                <span class="question-number" data-translate="q_num" data-replacements='{"num": 2}'>Question 2</span>
                <p class="question-text" data-translate="q2_text">Consider the following code: <br><code>try: <br>Â Â result = 10 / 0 <br>except ZeroDivisionError: <br>Â Â print("Cannot divide by zero!")</code><br>What will be printed?</p>
                <ul class="options-list">
                    <li><input type="radio" id="q2_a" name="q2" value="a"><label for="q2_a"><span class="option-text" data-translate="q2_opt_a">Nothing will be printed.</span></label></li>
                    <li><input type="radio" id="q2_b" name="q2" value="b"><label for="q2_b"><span class="option-text" data-translate="q2_opt_b">The program will crash with a ZeroDivisionError.</span></label></li>
                    <li><input type="radio" id="q2_c" name="q2" value="c"><label for="q2_c"><span class="option-text" data-translate="q2_opt_c">Cannot divide by zero!</span></label></li>
                    <li><input type="radio" id="q2_d" name="q2" value="d"><label for="q2_d"><span class="option-text" data-translate="q2_opt_d">0</span></label></li>
                </ul>
            </div>

            <!-- Question 3 -->
            <div class="question-block" data-question-id="3">
                <span class="question-number" data-translate="q_num" data-replacements='{"num": 3}'>Question 3</span>
                <p class="question-text" data-translate="q3_text">Which keyword is used to specify a block of code that will always execute, regardless of whether an error occurred in the `try` block or not (assuming it's present)?</p>
                <ul class="options-list">
                    <li><input type="radio" id="q3_a" name="q3" value="a"><label for="q3_a"><span class="option-text" data-translate="q3_opt_a"><code>except</code></span></label></li>
                    <li><input type="radio" id="q3_b" name="q3" value="b"><label for="q3_b"><span class="option-text" data-translate="q3_opt_b"><code>else</code> (in a try/except context)</span></label></li>
                    <li><input type="radio" id="q3_c" name="q3" value="c"><label for="q3_c"><span class="option-text" data-translate="q3_opt_c"><code>finally</code></span></label></li>
                    <li><input type="radio" id="q3_d" name="q3" value="d"><label for="q3_d"><span class="option-text" data-translate="q3_opt_d"><code>always</code></span></label></li>
                </ul>
            </div>

            <!-- Question 4 -->
            <div class="question-block" data-question-id="4">
                <span class="question-number" data-translate="q_num" data-replacements='{"num": 4}'>Question 4</span>
                <p class="question-text" data-translate="q4_text">If you want to catch a specific type of error, like a <code>ValueError</code>, how should you write the `except` block?</p>
                <ul class="options-list">
                    <li><input type="radio" id="q4_a" name="q4" value="a"><label for="q4_a"><span class="option-text" data-translate="q4_opt_a"><code>except Error:</code></span></label></li>
                    <li><input type="radio" id="q4_b" name="q4" value="b"><label for="q4_b"><span class="option-text" data-translate="q4_opt_b"><code>except:</code></span></label></li>
                    <li><input type="radio" id="q4_c" name="q4" value="c"><label for="q4_c"><span class="option-text" data-translate="q4_opt_c"><code>catch ValueError:</code></span></label></li>
                    <li><input type="radio" id="q4_d" name="q4" value="d"><label for="q4_d"><span class="option-text" data-translate="q4_opt_d"><code>except ValueError:</code></span></label></li>
                </ul>
            </div>

             <!-- Question 5 -->
            <div class="question-block" data-question-id="5">
                <span class="question-number" data-translate="q_num" data-replacements='{"num": 5}'>Question 5</span>
                 <p class="question-text" data-translate="q5_text">What happens if an error occurs inside a `try` block, but there is no corresponding `except` block to handle that specific type of error (and no general `except` block)?</p>
                 <ul class="options-list">
                    <li><input type="radio" id="q5_a" name="q5" value="a"><label for="q5_a"><span class="option-text" data-translate="q5_opt_a">The error is ignored, and the program continues after the `try...except` block.</span></label></li>
                    <li><input type="radio" id="q5_b" name="q5" value="b"><label for="q5_b"><span class="option-text" data-translate="q5_opt_b">The program stops execution (crashes) and displays the error message.</span></label></li>
                    <li><input type="radio" id="q5_c" name="q5" value="c"><label for="q5_c"><span class="option-text" data-translate="q5_opt_c">The `finally` block (if present) is skipped.</span></label></li>
                    <li><input type="radio" id="q5_d" name="q5" value="d"><label for="q5_d"><span class="option-text" data-translate="q5_opt_d">Python automatically creates a suitable `except` block.</span></label></li>
                </ul>
            </div>

            <!-- Question 6 -->
            <div class="question-block" data-question-id="6">
                <span class="question-number" data-translate="q_num" data-replacements='{"num": 6}'>Question 6</span>
                <p class="question-text" data-translate="q6_text">Consider this code: <br><code>try: <br>Â Â num = int(input("Enter a number: ")) <br>Â Â print("You entered:", num) <br>except ValueError: <br>Â Â print("Invalid input!")</code><br> What will happen if the user enters the text "hello"?</p>
                 <ul class="options-list">
                    <li><input type="radio" id="q6_a" name="q6" value="a"><label for="q6_a"><span class="option-text" data-translate="q6_opt_a">The program will crash with a ValueError.</span></label></li>
                    <li><input type="radio" id="q6_b" name="q6" value="b"><label for="q6_b"><span class="option-text" data-translate="q6_opt_b">It will print "Invalid input!".</span></label></li>
                    <li><input type="radio" id="q6_c" name="q6" value="c"><label for="q6_c"><span class="option-text" data-translate="q6_opt_c">It will print "You entered: hello".</span></label></li>
                    <li><input type="radio" id="q6_d" name="q6" value="d"><label for="q6_d"><span class="option-text" data-translate="q6_opt_d">It will print "You entered: 0".</span></label></li>
                </ul>
            </div>

             <!-- Question 7 -->
            <div class="question-block" data-question-id="7">
                <span class="question-number" data-translate="q_num" data-replacements='{"num": 7}'>Question 7</span>
                <p class="question-text" data-translate="q7_text">Which built-in Python exception is typically raised when you try to open a file that does not exist in read mode (<code>'r'</code>)?</p>
                 <ul class="options-list">
                    <li><input type="radio" id="q7_a" name="q7" value="a"><label for="q7_a"><span class="option-text" data-translate="q7_opt_a"><code>IOError</code></span></label></li>
                    <li><input type="radio" id="q7_b" name="q7" value="b"><label for="q7_b"><span class="option-text" data-translate="q7_opt_b"><code>ValueError</code></span></label></li>
                    <li><input type="radio" id="q7_c" name="q7" value="c"><label for="q7_c"><span class="option-text" data-translate="q7_opt_c"><code>FileNotFoundError</code></span></label></li>
                    <li><input type="radio" id="q7_d" name="q7" value="d"><label for="q7_d"><span class="option-text" data-translate="q7_opt_d"><code>TypeError</code></span></label></li>
                </ul>
            </div>

             <!-- Question 8 -->
            <div class="question-block" data-question-id="8">
                 <span class="question-number" data-translate="q_num" data-replacements='{"num": 8}'>Question 8</span>
                 <p class="question-text" data-translate="q8_text">What is the main benefit of handling exceptions rather than letting the program crash?</p>
                 <ul class="options-list">
                    <li><input type="radio" id="q8_a" name="q8" value="a"><label for="q8_a"><span class="option-text" data-translate="q8_opt_a">It makes the code shorter.</span></label></li>
                    <li><input type="radio" id="q8_b" name="q8" value="b"><label for="q8_b"><span class="option-text" data-translate="q8_opt_b">It improves program robustness and provides a better user experience.</span></label></li>
                    <li><input type="radio" id="q8_c" name="q8" value="c"><label for="q8_c"><span class="option-text" data-translate="q8_opt_c">It allows the use of the `finally` keyword.</span></label></li>
                    <li><input type="radio" id="q8_d" name="q8" value="d"><label for="q8_d"><span class="option-text" data-translate="q8_opt_d">It automatically fixes the errors in the code.</span></label></li>
                </ul>
            </div>

             <!-- Question 9 -->
            <div class="question-block" data-question-id="9">
                 <span class="question-number" data-translate="q_num" data-replacements='{"num": 9}'>Question 9</span>
                 <p class="question-text" data-translate="q9_text">How can you handle multiple specific exceptions with the same block of code?</p>
                 <ul class="options-list">
                    <li><input type="radio" id="q9_a" name="q9" value="a"><label for="q9_a"><span class="option-text" data-translate="q9_opt_a">Use multiple `except:` lines, one after the other.</span></label></li>
                    <li><input type="radio" id="q9_b" name="q9" value="b"><label for="q9_b"><span class="option-text" data-translate="q9_opt_b"><code>except ValueError and TypeError:</code></span></label></li>
                    <li><input type="radio" id="q9_c" name="q9" value="c"><label for="q9_c"><span class="option-text" data-translate="q9_opt_c"><code>except (ValueError, TypeError):</code></span></label></li>
                    <li><input type="radio" id="q9_d" name="q9" value="d"><label for="q9_d"><span class="option-text" data-translate="q9_opt_d">This is not possible; each exception needs its own `except` block.</span></label></li>
                </ul>
            </div>

             <!-- Question 10 -->
            <div class="question-block" data-question-id="10">
                <span class="question-number" data-translate="q_num" data-replacements='{"num": 10}'>Question 10</span>
                <p class="question-text" data-translate="q10_text">If no error occurs in the `try` block, what happens with the `except` block?</p>
                <ul class="options-list">
                    <li><input type="radio" id="q10_a" name="q10" value="a"><label for="q10_a"><span class="option-text" data-translate="q10_opt_a">The `except` block is executed anyway.</span></label></li>
                    <li><input type="radio" id="q10_b" name="q10" value="b"><label for="q10_b"><span class="option-text" data-translate="q10_opt_b">The `except` block is skipped.</span></label></li>
                    <li><input type="radio" id="q10_c" name="q10" value="c"><label for="q10_c"><span class="option-text" data-translate="q10_opt_c">Python asks the user if the `except` block should run.</span></label></li>
                    <li><input type="radio" id="q10_d" name="q10" value="d"><label for="q10_d"><span class="option-text" data-translate="q10_opt_d">The program raises a `NoErrorOccurred` exception.</span></label></li>
                </ul>
            </div>

            <div class="button-area">
                <button type="submit" id="submit-button" class="quiz-button" data-translate="submit_button">Submit Answers</button>
                <button type="button" id="retake-button" class="quiz-button" style="display: none;" data-translate="retake_button">Retake Quiz</button>
            </div>
        </form>

        <div id="result-area">
            <h3 data-translate="result_title">Quiz Results</h3>
            <p><span data-translate="result_score_label">Your Score:</span> <span id="result-score">0 / 10</span></p>
            <p id="result-feedback" data-translate="result_feedback_default">Let's see how you did!</p>
        </div>

    </main>

    <footer>
        <p data-translate="footer_text">Part of the Road to Free Open AGI Project</p>
    </footer>

    <script>
        const MODULE_ID = 25; // *** Set the ID for this specific module quiz ***
        const TOTAL_QUESTIONS = 10;
        const PASSING_SCORE = 6;
        const KNOWLEDGE_CHECK_STORAGE_KEY = 'knowledgeCheckStatus_v1'; // Same key as dashboard
        const LANGUAGE_STORAGE_KEY = 'userLanguage';

        // --- Correct Answers ---
        // Store correct answers (value of the correct radio button)
        const correctAnswers = {
            q1: 'b',
            q2: 'c',
            q3: 'c',
            q4: 'd',
            q5: 'b',
            q6: 'b',
            q7: 'c',
            q8: 'b',
            q9: 'c',
            q10: 'b'
        };

        // --- Translations Object ---
        const translations = {
             en: {
                "page_title": "Knowledge Check: Module 25 - Exception Handling",
                "return_button": "Return to Dashboard",
                "quiz_title": "Module 25: Exception Handling Check",
                "lang_select_aria": "Select Language",
                "lang_en": "ğŸ‡¬ğŸ‡§ English",
                "lang_pt": "ğŸ‡§ğŸ‡· PortuguÃªs",
                "lang_zh": "ğŸ‡¨ğŸ‡³ ä¸­æ–‡",
                "q_num": "Question {num}",
                "q1_text": "What is the primary purpose of using a <code>try...except</code> block in Python?",
                "q1_opt_a": "To speed up code execution.",
                "q1_opt_b": "To handle potential errors gracefully without crashing the program.",
                "q1_opt_c": "To define new types of errors.",
                "q1_opt_d": "To repeat a block of code multiple times.",
                "q2_text": "Consider the following code: <br><code>try: <br>Â Â result = 10 / 0 <br>except ZeroDivisionError: <br>Â Â print(\"Cannot divide by zero!\")</code><br>What will be printed?",
                "q2_opt_a": "Nothing will be printed.",
                "q2_opt_b": "The program will crash with a ZeroDivisionError.",
                "q2_opt_c": "Cannot divide by zero!",
                "q2_opt_d": "0",
                "q3_text": "Which keyword is used to specify a block of code that will always execute, regardless of whether an error occurred in the `try` block or not (assuming it's present)?",
                "q3_opt_a": "<code>except</code>",
                "q3_opt_b": "<code>else</code> (in a try/except context)",
                "q3_opt_c": "<code>finally</code>",
                "q3_opt_d": "<code>always</code>",
                "q4_text": "If you want to catch a specific type of error, like a <code>ValueError</code>, how should you write the `except` block?",
                "q4_opt_a": "<code>except Error:</code>",
                "q4_opt_b": "<code>except:</code>",
                "q4_opt_c": "<code>catch ValueError:</code>",
                "q4_opt_d": "<code>except ValueError:</code>",
                "q5_text": "What happens if an error occurs inside a `try` block, but there is no corresponding `except` block to handle that specific type of error (and no general `except` block)?",
                "q5_opt_a": "The error is ignored, and the program continues after the `try...except` block.",
                "q5_opt_b": "The program stops execution (crashes) and displays the error message.",
                "q5_opt_c": "The `finally` block (if present) is skipped.",
                "q5_opt_d": "Python automatically creates a suitable `except` block.",
                "q6_text": "Consider this code: <br><code>try: <br>Â Â num = int(input(\"Enter a number: \")) <br>Â Â print(\"You entered:\", num) <br>except ValueError: <br>Â Â print(\"Invalid input!\")</code><br> What will happen if the user enters the text \"hello\"?",
                "q6_opt_a": "The program will crash with a ValueError.",
                "q6_opt_b": "It will print \"Invalid input!\".",
                "q6_opt_c": "It will print \"You entered: hello\".",
                "q6_opt_d": "It will print \"You entered: 0\".",
                "q7_text": "Which built-in Python exception is typically raised when you try to open a file that does not exist in read mode (<code>'r'</code>)?",
                "q7_opt_a": "<code>IOError</code>",
                "q7_opt_b": "<code>ValueError</code>",
                "q7_opt_c": "<code>FileNotFoundError</code>",
                "q7_opt_d": "<code>TypeError</code>",
                "q8_text": "What is the main benefit of handling exceptions rather than letting the program crash?",
                "q8_opt_a": "It makes the code shorter.",
                "q8_opt_b": "It improves program robustness and provides a better user experience.",
                "q8_opt_c": "It allows the use of the `finally` keyword.",
                "q8_opt_d": "It automatically fixes the errors in the code.",
                "q9_text": "How can you handle multiple specific exceptions with the same block of code?",
                "q9_opt_a": "Use multiple `except:` lines, one after the other.",
                "q9_opt_b": "<code>except ValueError and TypeError:</code>",
                "q9_opt_c": "<code>except (ValueError, TypeError):</code>",
                "q9_opt_d": "This is not possible; each exception needs its own `except` block.",
                "q10_text": "If no error occurs in the `try` block, what happens with the `except` block?",
                "q10_opt_a": "The `except` block is executed anyway.",
                "q10_opt_b": "The `except` block is skipped.",
                "q10_opt_c": "Python asks the user if the `except` block should run.",
                "q10_opt_d": "The program raises a `NoErrorOccurred` exception.",
                "submit_button": "Submit Answers",
                "retake_button": "Retake Quiz",
                "result_title": "Quiz Results",
                "result_score_label": "Your Score:",
                "result_feedback_default": "Let's see how you did!",
                "result_passed": "Congratulations! You passed the knowledge check for this module. Your progress has been updated.",
                "result_failed": "You need at least {passingScore} correct answers to pass. Feel free to review the material and try again!",
                "footer_text": "Part of the Road to Free Open AGI Project"
             },
             pt: {
                "page_title": "VerificaÃ§Ã£o de Conhecimento: MÃ³dulo 25 - Tratamento de ExceÃ§Ãµes",
                "return_button": "Voltar ao Painel",
                "quiz_title": "VerificaÃ§Ã£o MÃ³dulo 25: Tratamento de ExceÃ§Ãµes",
                "lang_select_aria": "Selecionar Idioma",
                "lang_en": "ğŸ‡¬ğŸ‡§ English",
                "lang_pt": "ğŸ‡§ğŸ‡· PortuguÃªs",
                "lang_zh": "ğŸ‡¨ğŸ‡³ ä¸­æ–‡",
                "q_num": "QuestÃ£o {num}",
                "q1_text": "Qual Ã© o propÃ³sito principal de usar um bloco <code>try...except</code> em Python?",
                "q1_opt_a": "Para acelerar a execuÃ§Ã£o do cÃ³digo.",
                "q1_opt_b": "Para tratar erros potenciais de forma elegante sem travar o programa.",
                "q1_opt_c": "Para definir novos tipos de erros.",
                "q1_opt_d": "Para repetir um bloco de cÃ³digo vÃ¡rias vezes.",
                "q2_text": "Considere o seguinte cÃ³digo: <br><code>try: <br>Â Â result = 10 / 0 <br>except ZeroDivisionError: <br>Â Â print(\"NÃ£o Ã© possÃ­vel dividir por zero!\")</code><br>O que serÃ¡ impresso?",
                "q2_opt_a": "Nada serÃ¡ impresso.",
                "q2_opt_b": "O programa irÃ¡ travar com um ZeroDivisionError.",
                "q2_opt_c": "NÃ£o Ã© possÃ­vel dividir por zero!",
                "q2_opt_d": "0",
                "q3_text": "Qual palavra-chave Ã© usada para especificar um bloco de cÃ³digo que sempre serÃ¡ executado, independentemente de ter ocorrido um erro no bloco `try` ou nÃ£o (assumindo que esteja presente)?",
                "q3_opt_a": "<code>except</code>",
                "q3_opt_b": "<code>else</code> (em um contexto try/except)",
                "q3_opt_c": "<code>finally</code>",
                "q3_opt_d": "<code>always</code>",
                "q4_text": "Se vocÃª quiser capturar um tipo especÃ­fico de erro, como um <code>ValueError</code>, como deve escrever o bloco `except`?",
                "q4_opt_a": "<code>except Error:</code>",
                "q4_opt_b": "<code>except:</code>",
                "q4_opt_c": "<code>catch ValueError:</code>",
                "q4_opt_d": "<code>except ValueError:</code>",
                "q5_text": "O que acontece se ocorrer um erro dentro de um bloco `try`, mas nÃ£o houver um bloco `except` correspondente para tratar esse tipo especÃ­fico de erro (e nenhum bloco `except` geral)?",
                "q5_opt_a": "O erro Ã© ignorado e o programa continua apÃ³s o bloco `try...except`.",
                "q5_opt_b": "O programa para a execuÃ§Ã£o (trava) e exibe a mensagem de erro.",
                "q5_opt_c": "O bloco `finally` (se presente) Ã© pulado.",
                "q5_opt_d": "Python cria automaticamente um bloco `except` adequado.",
                "q6_text": "Considere este cÃ³digo: <br><code>try: <br>Â Â num = int(input(\"Digite um nÃºmero: \")) <br>Â Â print(\"VocÃª digitou:\", num) <br>except ValueError: <br>Â Â print(\"Entrada invÃ¡lida!\")</code><br> O que acontecerÃ¡ se o usuÃ¡rio digitar o texto \"ola\"?",
                "q6_opt_a": "O programa irÃ¡ travar com um ValueError.",
                "q6_opt_b": "IrÃ¡ imprimir \"Entrada invÃ¡lida!\".",
                "q6_opt_c": "IrÃ¡ imprimir \"VocÃª digitou: ola\".",
                "q6_opt_d": "IrÃ¡ imprimir \"VocÃª digitou: 0\".",
                "q7_text": "Qual exceÃ§Ã£o embutida do Python Ã© tipicamente levantada quando vocÃª tenta abrir um arquivo que nÃ£o existe no modo de leitura (<code>'r'</code>)?",
                "q7_opt_a": "<code>IOError</code>",
                "q7_opt_b": "<code>ValueError</code>",
                "q7_opt_c": "<code>FileNotFoundError</code>",
                "q7_opt_d": "<code>TypeError</code>",
                "q8_text": "Qual Ã© o principal benefÃ­cio de tratar exceÃ§Ãµes em vez de deixar o programa travar?",
                "q8_opt_a": "Torna o cÃ³digo mais curto.",
                "q8_opt_b": "Melhora a robustez do programa e oferece uma melhor experiÃªncia ao usuÃ¡rio.",
                "q8_opt_c": "Permite o uso da palavra-chave `finally`.",
                "q8_opt_d": "Corrige automaticamente os erros no cÃ³digo.",
                "q9_text": "Como vocÃª pode tratar mÃºltiplas exceÃ§Ãµes especÃ­ficas com o mesmo bloco de cÃ³digo?",
                "q9_opt_a": "Use mÃºltiplas linhas `except:`, uma apÃ³s a outra.",
                "q9_opt_b": "<code>except ValueError and TypeError:</code>",
                "q9_opt_c": "<code>except (ValueError, TypeError):</code>",
                "q9_opt_d": "Isso nÃ£o Ã© possÃ­vel; cada exceÃ§Ã£o precisa de seu prÃ³prio bloco `except`.",
                "q10_text": "Se nenhum erro ocorrer no bloco `try`, o que acontece com o bloco `except`?",
                "q10_opt_a": "O bloco `except` Ã© executado de qualquer maneira.",
                "q10_opt_b": "O bloco `except` Ã© pulado.",
                "q10_opt_c": "Python pergunta ao usuÃ¡rio se o bloco `except` deve ser executado.",
                "q10_opt_d": "O programa levanta uma exceÃ§Ã£o `NoErrorOccurred`.",
                "submit_button": "Enviar Respostas",
                "retake_button": "Refazer Teste",
                "result_title": "Resultados do Teste",
                "result_score_label": "Sua PontuaÃ§Ã£o:",
                "result_passed": "ParabÃ©ns! VocÃª passou na verificaÃ§Ã£o de conhecimento para este mÃ³dulo. Seu progresso foi atualizado.",
                "result_failed": "VocÃª precisa de pelo menos {passingScore} respostas corretas para passar. Sinta-se Ã  vontade para revisar o material e tentar novamente!",
                "result_feedback_default": "Vamos ver como vocÃª se saiu!",
                "footer_text": "Parte do Projeto Road to Free Open AGI"
             },
             zh: {
                "page_title": "çŸ¥è¯†æµ‹éªŒï¼šæ¨¡å— 25 - å¼‚å¸¸å¤„ç†",
                "return_button": "è¿”å›ä»ªè¡¨æ¿",
                "quiz_title": "æ¨¡å— 25ï¼šå¼‚å¸¸å¤„ç†æµ‹éªŒ",
                "lang_select_aria": "é€‰æ‹©è¯­è¨€",
                "lang_en": "ğŸ‡¬ğŸ‡§ English",
                "lang_pt": "ğŸ‡§ğŸ‡· PortuguÃªs",
                "lang_zh": "ğŸ‡¨ğŸ‡³ ä¸­æ–‡",
                "q_num": "é—®é¢˜ {num}",
                "q1_text": "åœ¨ Python ä¸­ä½¿ç”¨ <code>try...except</code> å—çš„ä¸»è¦ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ",
                "q1_opt_a": "åŠ å¿«ä»£ç æ‰§è¡Œé€Ÿåº¦ã€‚",
                "q1_opt_b": "ä¼˜é›…åœ°å¤„ç†æ½œåœ¨é”™è¯¯ï¼Œé¿å…ç¨‹åºå´©æºƒã€‚",
                "q1_opt_c": "å®šä¹‰æ–°å‹é”™è¯¯ã€‚",
                "q1_opt_d": "å¤šæ¬¡é‡å¤æ‰§è¡Œä»£ç å—ã€‚",
                "q2_text": "æ€è€ƒä»¥ä¸‹ä»£ç ï¼š<br><code>try: <br>Â Â result = 10 / 0 <br>except ZeroDivisionError: <br>Â Â print(\"ä¸èƒ½é™¤ä»¥é›¶ï¼\")</code><br>å°†æ‰“å°ä»€ä¹ˆï¼Ÿ",
                "q2_opt_a": "ä»€ä¹ˆéƒ½ä¸ä¼šæ‰“å°ã€‚",
                "q2_opt_b": "ç¨‹åºå°†å›  ZeroDivisionError è€Œå´©æºƒã€‚",
                "q2_opt_c": "ä¸èƒ½é™¤ä»¥é›¶ï¼",
                "q2_opt_d": "0",
                "q3_text": "å“ªä¸ªå…³é”®å­—ç”¨äºæŒ‡å®šä¸€ä¸ªä»£ç å—ï¼Œæ— è®º `try` å—ä¸­æ˜¯å¦å‘ç”Ÿé”™è¯¯ï¼Œå®ƒæ€»æ˜¯ä¼šæ‰§è¡Œï¼ˆå‡è®¾å®ƒå­˜åœ¨ï¼‰ï¼Ÿ",
                "q3_opt_a": "<code>except</code>",
                "q3_opt_b": "<code>else</code>ï¼ˆåœ¨ try/except ä¸Šä¸‹æ–‡ä¸­ï¼‰",
                "q3_opt_c": "<code>finally</code>",
                "q3_opt_d": "<code>always</code>",
                "q4_text": "å¦‚æœä½ æƒ³æ•è·ç‰¹å®šç±»å‹çš„é”™è¯¯ï¼Œä¾‹å¦‚ <code>ValueError</code>ï¼Œåº”è¯¥å¦‚ä½•ç¼–å†™ `except` å—ï¼Ÿ",
                "q4_opt_a": "<code>except Error:</code>",
                "q4_opt_b": "<code>except:</code>",
                "q4_opt_c": "<code>catch ValueError:</code>",
                "q4_opt_d": "<code>except ValueError:</code>",
                "q5_text": "å¦‚æœåœ¨ `try` å—å†…éƒ¨å‘ç”Ÿé”™è¯¯ï¼Œä½†æ²¡æœ‰ç›¸åº”çš„ `except` å—æ¥å¤„ç†è¯¥ç‰¹å®šç±»å‹çš„é”™è¯¯ï¼ˆä¹Ÿæ²¡æœ‰é€šç”¨çš„ `except` å—ï¼‰ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ",
                "q5_opt_a": "é”™è¯¯è¢«å¿½ç•¥ï¼Œç¨‹åºåœ¨ `try...except` å—ä¹‹åç»§ç»­æ‰§è¡Œã€‚",
                "q5_opt_b": "ç¨‹åºåœæ­¢æ‰§è¡Œï¼ˆå´©æºƒï¼‰å¹¶æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ã€‚",
                "q5_opt_c": "`finally` å—ï¼ˆå¦‚æœå­˜åœ¨ï¼‰å°†è¢«è·³è¿‡ã€‚",
                "q5_opt_d": "Python ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªåˆé€‚çš„ `except` å—ã€‚",
                "q6_text": "æ€è€ƒè¿™æ®µä»£ç ï¼š<br><code>try: <br>Â Â num = int(input(\"è¾“å…¥ä¸€ä¸ªæ•°å­—ï¼š\")) <br>Â Â print(\"ä½ è¾“å…¥äº†ï¼š\", num) <br>except ValueError: <br>Â Â print(\"æ— æ•ˆè¾“å…¥ï¼\")</code><br> å¦‚æœç”¨æˆ·è¾“å…¥æ–‡æœ¬ \"hello\" ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ",
                "q6_opt_a": "ç¨‹åºå°†å›  ValueError è€Œå´©æºƒã€‚",
                "q6_opt_b": "å°†æ‰“å° \"æ— æ•ˆè¾“å…¥ï¼\"ã€‚",
                "q6_opt_c": "å°†æ‰“å° \"ä½ è¾“å…¥äº†ï¼šhello\"ã€‚",
                "q6_opt_d": "å°†æ‰“å° \"ä½ è¾“å…¥äº†ï¼š0\"ã€‚",
                "q7_text": "å½“ä½ å°è¯•ä»¥è¯»å–æ¨¡å¼ï¼ˆ<code>'r'</code>ï¼‰æ‰“å¼€ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶æ—¶ï¼Œé€šå¸¸ä¼šå¼•å‘å“ªä¸ª Python å†…å»ºå¼‚å¸¸ï¼Ÿ",
                "q7_opt_a": "<code>IOError</code>",
                "q7_opt_b": "<code>ValueError</code>",
                "q7_opt_c": "<code>FileNotFoundError</code>",
                "q7_opt_d": "<code>TypeError</code>",
                "q8_text": "å¤„ç†å¼‚å¸¸è€Œä¸æ˜¯è®©ç¨‹åºå´©æºƒçš„ä¸»è¦å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ",
                "q8_opt_a": "å®ƒä½¿ä»£ç æ›´çŸ­ã€‚",
                "q8_opt_b": "å®ƒæé«˜äº†ç¨‹åºçš„å¥å£®æ€§å¹¶æä¾›äº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚",
                "q8_opt_c": "å®ƒå…è®¸ä½¿ç”¨ `finally` å…³é”®å­—ã€‚",
                "q8_opt_d": "å®ƒä¼šè‡ªåŠ¨ä¿®å¤ä»£ç ä¸­çš„é”™è¯¯ã€‚",
                "q9_text": "å¦‚ä½•ç”¨åŒä¸€ä¸ªä»£ç å—å¤„ç†å¤šä¸ªç‰¹å®šçš„å¼‚å¸¸ï¼Ÿ",
                "q9_opt_a": "ä½¿ç”¨å¤šä¸ª `except:` è¡Œï¼Œä¸€ä¸ªæ¥ä¸€ä¸ªã€‚",
                "q9_opt_b": "<code>except ValueError and TypeError:</code>",
                "q9_opt_c": "<code>except (ValueError, TypeError):</code>",
                "q9_opt_d": "è¿™æ˜¯ä¸å¯èƒ½çš„ï¼›æ¯ä¸ªå¼‚å¸¸éƒ½éœ€è¦è‡ªå·±çš„ `except` å—ã€‚",
                "q10_text": "å¦‚æœåœ¨ `try` å—ä¸­æ²¡æœ‰å‘ç”Ÿé”™è¯¯ï¼Œ`except` å—ä¼šæ€ä¹ˆæ ·ï¼Ÿ",
                "q10_opt_a": "`except` å—ä»ç„¶ä¼šæ‰§è¡Œã€‚",
                "q10_opt_b": "`except` å—ä¼šè¢«è·³è¿‡ã€‚",
                "q10_opt_c": "Python ä¼šè¯¢é—®ç”¨æˆ·æ˜¯å¦åº”è¿è¡Œ `except` å—ã€‚",
                "q10_opt_d": "ç¨‹åºä¼šå¼•å‘ä¸€ä¸ª `NoErrorOccurred` å¼‚å¸¸ã€‚",
                "submit_button": "æäº¤ç­”æ¡ˆ",
                "retake_button": "é‡æ–°æµ‹éªŒ",
                "result_title": "æµ‹éªŒç»“æœ",
                "result_score_label": "ä½ çš„åˆ†æ•°ï¼š",
                "result_passed": "æ­å–œï¼ä½ é€šè¿‡äº†æœ¬æ¨¡å—çš„çŸ¥è¯†æµ‹éªŒã€‚ä½ çš„è¿›åº¦å·²æ›´æ–°ã€‚",
                "result_failed": "ä½ éœ€è¦è‡³å°‘ç­”å¯¹ {passingScore} é¢˜æ‰èƒ½é€šè¿‡ã€‚è¯·éšæ—¶å¤ä¹ ææ–™å¹¶é‡è¯•ï¼",
                "result_feedback_default": "è®©æˆ‘ä»¬çœ‹çœ‹ä½ çš„è¡¨ç°ï¼",
                "footer_text": "é€šå¾€è‡ªç”±å¼€æ”¾AGIä¹‹è·¯é¡¹ç›®çš„ä¸€éƒ¨åˆ†"
             }
         };

        // --- DOM Elements ---
        const quizForm = document.getElementById('quiz-form');
        const submitButton = document.getElementById('submit-button');
        const retakeButton = document.getElementById('retake-button');
        const resultArea = document.getElementById('result-area');
        const resultScoreEl = document.getElementById('result-score');
        const resultFeedbackEl = document.getElementById('result-feedback');
        const languageSelectElement = document.getElementById('languageSelect');

         // --- Translation Functions (Copied from Dashboard) ---
         function getStoredLanguage() {
            const storedLang = localStorage.getItem(LANGUAGE_STORAGE_KEY);
            if (storedLang && translations[storedLang]) return storedLang;
            // Basic browser language detection fallback
            const browserLang = navigator.language || navigator.userLanguage;
            if (browserLang.startsWith('pt')) return 'pt';
            if (browserLang.startsWith('zh')) return 'zh';
            return 'en'; // Default to English
        }

         function getTranslation(key, lang, replacements = {}) {
            let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`; // Fallback chain: current lang -> english -> key name
            for (const placeholder in replacements) {
                 // Use a simpler regex for replacements like {num} or {passingScore}
                 const regex = new RegExp(`\\{${placeholder}\\}`, 'g');
                text = text.replace(regex, replacements[placeholder]);
            }
            return text;
        }

        function translatePage(lang) {
            if (!translations[lang]) lang = 'en'; // Fallback to English if lang not found
            document.documentElement.lang = lang;

            // Update static text and placeholders/aria-labels
            document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.getAttribute('data-translate');
                 const replacementsAttr = el.getAttribute('data-replacements');
                 let replacements = {};
                 if (replacementsAttr) {
                    try { replacements = JSON.parse(replacementsAttr); } catch(e) { console.error("Invalid JSON in data-replacements:", el); }
                 }
                 // Special handling for numeric replacements which might not be in quotes
                 if (key === 'q_num' && 'num' in replacements) replacements.num = Number(replacements.num);

                const translation = getTranslation(key, lang, replacements);
                if (el.tagName === 'TITLE') { document.title = translation; }
                // Use innerHTML for elements that might contain <code> or <br>
                else if (key.includes('_text') || key.includes('result_') || key === 'footer_text') {
                    el.innerHTML = translation; // Allow HTML tags in questions/results
                }
                 else { el.textContent = translation; }
            });
             document.querySelectorAll('[data-translate-placeholder]').forEach(el => {
                 const key = el.getAttribute('data-translate-placeholder');
                 el.setAttribute('placeholder', getTranslation(key, lang));
             });
             document.querySelectorAll('[data-translate-aria-label]').forEach(el => {
                 const key = el.getAttribute('data-translate-aria-label');
                 el.setAttribute('aria-label', getTranslation(key, lang));
             });

             // Retranslate result feedback if results are already shown
             if (resultArea.style.display !== 'none') {
                const scoreText = resultScoreEl.textContent.match(/(\d+)\s*\/\s*\d+/); // Extract score if already displayed
                if (scoreText) {
                    displayResults(parseInt(scoreText[1], 10)); // Re-display with new language
                }
             }
        }

         function setLanguage(lang) {
            if (!translations[lang]) lang = 'en'; // Fallback
            localStorage.setItem(LANGUAGE_STORAGE_KEY, lang);
            document.documentElement.lang = lang;
            languageSelectElement.value = lang; // Update dropdown
            translatePage(lang);
        }


        // --- Quiz Logic ---
        function handleSubmit(event) {
            event.preventDefault();
            let score = 0;

            // Disable inputs and button
            submitButton.disabled = true;
            const inputs = quizForm.querySelectorAll('input[type="radio"]');
            inputs.forEach(input => input.disabled = true);

            // Loop through each question block
            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                const questionBlock = quizForm.querySelector(`.question-block[data-question-id="${i}"]`);
                const selectedAnswer = quizForm.querySelector(`input[name="q${i}"]:checked`);
                const correctAnswerValue = correctAnswers[`q${i}`];
                const options = questionBlock.querySelectorAll(`input[name="q${i}"]`);

                // Reset visual feedback first
                questionBlock.classList.remove('correct', 'incorrect');
                 options.forEach(opt => {
                    const label = opt.nextElementSibling; // Get the label associated with the radio
                    if (label) label.classList.remove('correct', 'incorrect');
                 });


                if (selectedAnswer) {
                    const selectedValue = selectedAnswer.value;
                    const selectedLabel = selectedAnswer.nextElementSibling;

                    if (selectedValue === correctAnswerValue) {
                        score++;
                        questionBlock.classList.add('correct');
                         if(selectedLabel) selectedLabel.classList.add('correct');
                    } else {
                        questionBlock.classList.add('incorrect');
                         if(selectedLabel) selectedLabel.classList.add('incorrect');
                        // Also highlight the correct answer
                        const correctInput = questionBlock.querySelector(`input[value="${correctAnswerValue}"]`);
                        if (correctInput && correctInput.nextElementSibling) {
                             correctInput.nextElementSibling.classList.add('correct'); // Show the right one
                        }
                    }
                } else {
                     // No answer selected - mark block as incorrect and show correct answer
                     questionBlock.classList.add('incorrect');
                     const correctInput = questionBlock.querySelector(`input[value="${correctAnswerValue}"]`);
                     if (correctInput && correctInput.nextElementSibling) {
                          correctInput.nextElementSibling.classList.add('correct');
                     }
                }
            }

            displayResults(score);
            submitButton.style.display = 'none';
            retakeButton.style.display = 'inline-block'; // Show retake button
            resultArea.style.display = 'block'; // Show results
            resultArea.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function displayResults(score) {
             const lang = getStoredLanguage();
             const passed = score >= PASSING_SCORE;

            resultScoreEl.textContent = `${score} / ${TOTAL_QUESTIONS}`;
            resultArea.classList.remove('passed', 'failed'); // Reset classes

            if (passed) {
                resultArea.classList.add('passed');
                resultFeedbackEl.textContent = getTranslation('result_passed', lang);
                updateProgress(); // Update progress only if passed
            } else {
                resultArea.classList.add('failed');
                resultFeedbackEl.textContent = getTranslation('result_failed', lang, { passingScore: PASSING_SCORE });
            }
        }

        function updateProgress() {
            try {
                const storedStatus = localStorage.getItem(KNOWLEDGE_CHECK_STORAGE_KEY);
                let knowledgeCheckStatus = storedStatus ? JSON.parse(storedStatus) : {};
                 // Ensure it's an object
                 if (typeof knowledgeCheckStatus !== 'object' || knowledgeCheckStatus === null) {
                     knowledgeCheckStatus = {};
                 }
                knowledgeCheckStatus[MODULE_ID] = true; // Mark this module as complete
                localStorage.setItem(KNOWLEDGE_CHECK_STORAGE_KEY, JSON.stringify(knowledgeCheckStatus));
                // console.log(`Progress updated for Module ${MODULE_ID}`); // For debugging
            } catch (e) {
                console.error("Error updating progress in localStorage:", e);
                 // Optionally inform the user that progress couldn't be saved
                 alert("Could not save your progress. Please ensure localStorage is enabled and not full.");
            }
        }


        function resetQuiz() {
            quizForm.reset(); // Clears selected radio buttons
            resultArea.style.display = 'none'; // Hide results
            retakeButton.style.display = 'none'; // Hide retake button
            submitButton.style.display = 'inline-block'; // Show submit button
            submitButton.disabled = false; // Re-enable submit button

            // Reset visual feedback
            const questionBlocks = quizForm.querySelectorAll('.question-block');
            questionBlocks.forEach(block => {
                block.classList.remove('correct', 'incorrect');
                const labels = block.querySelectorAll('.options-list label');
                labels.forEach(label => label.classList.remove('correct', 'incorrect'));
            });

             // Re-enable inputs
             const inputs = quizForm.querySelectorAll('input[type="radio"]');
             inputs.forEach(input => input.disabled = false);

             // Scroll to top
             window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // --- Event Listeners ---
        quizForm.addEventListener('submit', handleSubmit);
        retakeButton.addEventListener('click', resetQuiz);
         languageSelectElement.addEventListener('change', (e) => {
             setLanguage(e.target.value);
         });


        // --- Initial Setup ---
        document.addEventListener('DOMContentLoaded', () => {
             const initialLang = getStoredLanguage();
             languageSelectElement.value = initialLang; // Set dropdown to stored language
             translatePage(initialLang); // Translate page on load
        });

    </script>

</body>
</html>

<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="kc_page_title_25">Knowledge Check: Module 25 - Complete Python</title>
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Base Styles & Variables (Copied from Dashboard) --- */
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-page: #f0f2f5;
            --background-card: #ffffff;
            --background-sidebar: #ffffff; /* Not used directly, but keep for consistency */
            --background-header: linear-gradient(135deg, #0d6efd, #0a58ca); /* Used for return button */
            --text-light: #f8f9fa;
            --text-dark: #343a40;
            --text-muted: #6c757d;
            --accent-color: #ffc107;
            --success-color: #198754;
            --error-color: #dc3545;
            --info-color: #0dcaf0;
            --video-color: #fd7e14; /* Not used directly */
            --check-color: #6f42c1; /* Used for buttons/emphasis */
            --certificate-color: #d63384; /* Used for lang switcher */
            --chat-panel-bg: #ffffff; /* Not used */
            --chat-box-bg: #f8f9fa; /* Not used */
            --progress-bg: #e9ecef;
            --progress-fill: var(--check-color);
            --border-color: #dee2e6;
            --border-radius: 8px;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            --card-shadow-hover: 0 6px 18px rgba(0, 0, 0, 0.1); /* Use for quiz container */
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
            /* Colors for lang switcher */
            --lang-select-border: var(--certificate-color);
            --lang-select-bg: rgba(255, 255, 255, 0.1);
            --lang-select-bg-hover: rgba(255, 255, 255, 0.15);
            --lang-option-bg: var(--background-card);
            --lang-option-text: var(--text-dark);
            --lang-arrow-color: var(--certificate-color);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.6;
            background-color: var(--background-page); color: var(--text-dark);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* --- Header for Return Button & Language Switcher --- */
        .kc-header {
            background: var(--background-header);
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .kc-return-button {
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            background-color: rgba(255, 255, 255, 0.15);
            color: var(--text-light);
            text-decoration: none;
            border-radius: var(--border-radius);
            font-weight: 500;
            transition: background-color var(--transition-speed);
            font-size: 0.9rem;
        }
        .kc-return-button i { margin-right: 8px; }
        .kc-return-button:hover { background-color: rgba(255, 255, 255, 0.25); }

         /* Language Switcher Styles (Simplified for Header) */
        .language-switcher { margin-left: auto; /* Pushes to the right */ }
         #languageSelect {
            /* Adjustments for header placement */
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            border: 1px solid var(--lang-select-border);
            border-radius: 5px;
            padding: 6px 30px 6px 12px; /* Slightly smaller */
            cursor: pointer;
            font-size: 0.9rem; /* Slightly smaller */
            font-weight: 500;
            appearance: none; -webkit-appearance: none; -moz-appearance: none;
            /* Inline SVG with encoded color - MUST be updated if --certificate-color changes */
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23${encodeURIComponent('d63384')}%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 8px auto; /* Slightly smaller */
            transition: border-color 0.3s ease, background-color 0.3s ease;
         }
         #languageSelect:hover { background-color: var(--lang-select-bg-hover); border-color: #f0f0f0; }
         #languageSelect:focus { outline: none; border-color: var(--accent-color); box-shadow: 0 0 0 2px rgba(255, 193, 7, 0.3); }
         #languageSelect option {
              background: var(--lang-option-bg);
              color: var(--lang-option-text);
              padding: 5px;
         }

        /* --- Main Content Area --- */
        .kc-main {
            max-width: 900px;
            margin: 2rem auto;
            padding: 2rem;
            background-color: var(--background-card);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
            flex-grow: 1; /* Takes remaining vertical space */
        }

        .kc-main h1 {
            font-family: var(--font-title);
            color: var(--primary-color);
            margin-bottom: 0.8rem;
            border-bottom: 2px solid var(--check-color);
            padding-bottom: 0.5rem;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
        }
        .kc-main h1 i {
            margin-right: 10px;
            color: var(--check-color);
            font-size: 1.5rem;
        }

        .kc-instructions {
            background-color: var(--background-page);
            padding: 1rem 1.5rem;
            margin-bottom: 2rem;
            border-radius: var(--border-radius);
            border: 1px dashed var(--border-color);
            font-size: 0.95rem;
            color: var(--text-muted);
        }
        .kc-instructions strong { color: var(--text-dark); }
        .kc-instructions i { color: var(--check-color); margin-right: 5px;}

        /* --- Quiz Form Styling --- */
        #quiz-container { margin-bottom: 2rem; }

        .quiz-question {
            margin-bottom: 2.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        .quiz-question:last-of-type {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .question-number {
            display: inline-block;
            background-color: var(--check-color);
            color: var(--text-light);
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: 700;
            font-size: 0.85rem;
            margin-right: 10px;
            min-width: 25px;
            text-align: center;
        }

        .question-text {
            font-weight: 500;
            margin-bottom: 1rem;
            font-size: 1.1rem;
            display: inline; /* Keep on same line as number */
        }
        .question-text code {
            font-size: 0.95em;
            background: #eee;
            padding: 2px 5px;
            border-radius: 3px;
            color: #c7254e;
            font-family: monospace;
        }

        .quiz-options { margin-top: 1rem; } /* Add space between question text and options */

        .quiz-options label {
            display: block;
            margin-bottom: 0.8rem;
            padding: 0.8rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: background-color var(--transition-speed), border-color var(--transition-speed);
            background-color: #fdfdfd;
        }
        .quiz-options label:hover { background-color: #f8f9fa; border-color: var(--secondary-color); }
        .quiz-options input[type="radio"] { margin-right: 10px; vertical-align: middle; accent-color: var(--check-color); }
        .quiz-options label span { vertical-align: middle; }
        .quiz-options label code { font-size: 0.9em; background: #eee; padding: 1px 4px; border-radius: 3px; color: #c7254e; font-family: monospace;}

        /* --- Buttons --- */
        .quiz-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .quiz-buttons button {
            padding: 0.8rem 2rem;
            font-size: 1rem;
            font-weight: 500;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: background-color var(--transition-speed), transform var(--transition-speed);
            min-width: 150px;
        }
        .quiz-buttons button:hover { transform: translateY(-2px); }
        .quiz-buttons button:disabled { background-color: var(--secondary-color); cursor: not-allowed; opacity: 0.7; transform: none; }

        #submit-quiz { background-color: var(--check-color); color: var(--text-light); }
        #submit-quiz:hover:not(:disabled) { background-color: #5a35a3; }

        #retry-button { background-color: var(--secondary-color); color: var(--text-light); display: none; /* Hidden initially */ }
        #retry-button:hover:not(:disabled) { background-color: #5a6268; }

        /* --- Results Area --- */
        #quiz-results {
            margin-top: 2rem;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            text-align: center;
            display: none; /* Hidden initially */
            border: 1px solid var(--border-color);
        }
        #quiz-results.pass { background-color: #d1e7dd; border-color: var(--success-color); }
        #quiz-results.fail { background-color: #f8d7da; border-color: var(--error-color); }

        #quiz-results h3 {
            font-family: var(--font-title);
            margin-bottom: 0.5rem;
        }
        #quiz-results.pass h3 { color: var(--success-color); }
        #quiz-results.fail h3 { color: var(--error-color); }

        #result-message { font-size: 1.1rem; font-weight: 500; margin-bottom: 0.3rem; }
        #result-score { font-size: 1rem; color: var(--text-muted); }

        /* --- Footer --- */
        footer {
            text-align: center; padding: 1.5rem; margin-top: auto; /* Pushes footer down */
            background-color: var(--background-card); border-top: 1px solid var(--border-color);
            color: var(--text-muted); font-size: 0.9rem;
        }

        /* --- Responsive Design (Simplified) --- */
        @media (max-width: 992px) {
            .kc-main { width: 95%; padding: 1.5rem; margin: 1.5rem auto; }
            .kc-main h1 { font-size: 1.6rem; }
        }
        @media (max-width: 768px) {
            html { font-size: 15px; }
            .kc-header { padding: 0.8rem 1rem; }
            .kc-return-button { font-size: 0.85rem; padding: 0.4rem 0.8rem; }
            #languageSelect { font-size: 0.85rem; padding: 5px 25px 5px 10px; background-size: 7px auto; }
            .kc-main h1 { font-size: 1.4rem; }
            .question-text { font-size: 1rem; }
            .quiz-options label { padding: 0.7rem 0.9rem; }
        }
         @media (max-width: 576px) {
             html { font-size: 14px; }
             .kc-main { padding: 1rem; }
             .kc-main h1 { font-size: 1.3rem; }
             .kc-instructions { padding: 0.8rem 1rem; font-size: 0.9rem; }
             .question-text { font-size: 0.95rem; }
             .quiz-options label { padding: 0.6rem 0.8rem; margin-bottom: 0.6rem; }
             .quiz-buttons button { padding: 0.7rem 1.5rem; font-size: 0.9rem; min-width: 120px;}
             #quiz-results { padding: 1rem; }
             #result-message { font-size: 1rem; }
             #result-score { font-size: 0.9rem; }
         }

    </style>
</head>
<body>

    <header class="kc-header">
        <a href="ctp-dashboard.html" class="kc-return-button">
            <i class="fas fa-arrow-left"></i> <span data-translate="kc_return_button">Return to Dashboard</span>
        </a>
         <div class="language-switcher">
            <select id="languageSelect" data-translate-aria-label="lang_select_aria" aria-label="Select Language">
                <option value="en" data-translate="lang_en">🇬🇧 English</option>
                <option value="pt" data-translate="lang_pt">🇧🇷 Português</option>
                <option value="zh" data-translate="lang_zh">🇨🇳 中文</option>
            </select>
        </div>
    </header>

    <main class="kc-main">
        <h1 data-translate="kc_title_25"><i class="fas fa-shield-alt"></i> Module 25: Knowledge Check - Exception Handling</h1>

        <p class="kc-instructions" data-translate="kc_instructions">
            <i class="fas fa-info-circle"></i> Select the best answer for each question. You need to answer at least <strong>6 out of 10</strong> questions correctly to pass. You can retry as many times as you need. Good luck!
        </p>

        <form id="quiz-form">
            <div id="quiz-container">
                <!-- Questions will be dynamically generated here by JS -->
                <p>Loading questions...</p>
            </div>

            <div class="quiz-buttons">
                <button type="submit" id="submit-quiz" data-translate="kc_submit_button">Submit Answers</button>
                <button type="button" id="retry-button" data-translate="kc_retry_button">Retry Quiz</button>
            </div>
        </form>

        <div id="quiz-results">
            <h3 id="result-heading"></h3>
            <p id="result-message"></p>
            <p id="result-score"></p>
        </div>

    </main>

    <footer>
        <p data-translate="footer_text">Part of the Road to Free Open AGI Project</p>
    </footer>

    <script>
        const MODULE_ID = 25;
        const PASSING_SCORE = 6;
        const TOTAL_QUESTIONS = 10;
        const KNOWLEDGE_CHECK_STORAGE_KEY = 'knowledgeCheckStatus_v1';
        const LANGUAGE_STORAGE_KEY = 'userLanguage';

        // --- Quiz Questions Data ---
        // Structure: { id: question_number, correctIndex: index_of_correct_option }
        // Translation keys for text and options will be generated based on id and index
        const quizQuestionsData = [
            { id: 0, correctIndex: 2 }, // try block purpose
            { id: 1, correctIndex: 1 }, // except block purpose
            { id: 2, correctIndex: 0 }, // finally block purpose
            { id: 3, correctIndex: 3 }, // Catching specific error
            { id: 4, correctIndex: 1 }, // Catching general error
            { id: 5, correctIndex: 2 }, // Code output (ValueError)
            { id: 6, correctIndex: 0 }, // Code output (ZeroDivisionError)
            { id: 7, correctIndex: 3 }, // What happens if no error occurs (try/else)
            { id: 8, correctIndex: 0 }, // When does finally execute?
            { id: 9, correctIndex: 1 }, // Syntax element for try/except
        ];

        // --- Translations Object ---
        const translations = {
             en: {
                 "kc_page_title_25": "Knowledge Check: Module 25 - Exception Handling",
                 "kc_return_button": "Return to Dashboard",
                 "kc_title_25": "Module 25: Knowledge Check - Exception Handling",
                 "kc_instructions": "<i class=\"fas fa-info-circle\"></i> Select the best answer for each question. You need to answer at least <strong>6 out of 10</strong> questions correctly to pass. You can retry as many times as you need. Good luck!",
                 "kc_submit_button": "Submit Answers",
                 "kc_retry_button": "Retry Quiz",
                 "kc_result_pass": "Congratulations! You Passed!",
                 "kc_result_fail": "Keep Trying! You Can Do It!",
                 "kc_result_score": "Your score: {score} out of {total}",
                 "footer_text": "Part of the Road to Free Open AGI Project",
                 "lang_select_aria": "Select Language", "lang_en": "🇬🇧 English", "lang_pt": "🇧🇷 Português", "lang_zh": "🇨🇳 中文",
                 // Questions M25
                 "kc_q25_0_text": "What is the primary purpose of the `try` block in Python exception handling?",
                 "kc_q25_0_opt0": "To define cleanup code that always runs.",
                 "kc_q25_0_opt1": "To specify the type of error to catch.",
                 "kc_q25_0_opt2": "To enclose code that might raise an exception.",
                 "kc_q25_0_opt3": "To execute code only if no exception occurred.",
                 "kc_q25_1_text": "What does the `except` block do?",
                 "kc_q25_1_opt0": "It contains the code that might cause an error.",
                 "kc_q25_1_opt1": "It contains the code to execute if a specific error (or any error, if unspecified) occurs in the `try` block.",
                 "kc_q25_1_opt2": "It always executes, regardless of errors.",
                 "kc_q25_1_opt3": "It executes only when the `try` block finishes without errors.",
                 "kc_q25_2_text": "What is the purpose of the `finally` block?",
                 "kc_q25_2_opt0": "To contain code that must run regardless of whether an exception occurred or not (e.g., closing a file).",
                 "kc_q25_2_opt1": "To catch very specific types of errors.",
                 "kc_q25_2_opt2": "To execute only if an error occurs.",
                 "kc_q25_2_opt3": "To execute only if no error occurs.",
                 "kc_q25_3_text": "How do you catch only a specific type of error, like a `ValueError`?",
                 "kc_q25_3_opt0": "Use `except all:`",
                 "kc_q25_3_opt1": "Use `except:` without specifying an error type.",
                 "kc_q25_3_opt2": "Use `try ValueError:`",
                 "kc_q25_3_opt3": "Use `except ValueError:`",
                 "kc_q25_4_text": "What happens if you use `except:` without specifying an error type?",
                 "kc_q25_4_opt0": "It causes a syntax error.",
                 "kc_q25_4_opt1": "It catches *all* types of exceptions (generally discouraged unless you know why).",
                 "kc_q25_4_opt2": "It catches only `SyntaxError`.",
                 "kc_q25_4_opt3": "It does nothing.",
                 "kc_q25_5_text": "What will the following code print? \n```python\ntry:\n    num = int('abc')\n    print(num)\nexcept ValueError:\n    print('Invalid number')\nexcept TypeError:\n    print('Type issue')\n```",
                 "kc_q25_5_opt0": "abc",
                 "kc_q25_5_opt1": "Type issue",
                 "kc_q25_5_opt2": "Invalid number",
                 "kc_q25_5_opt3": "It will crash with a ValueError.",
                 "kc_q25_6_text": "What will the following code print? \n```python\ntry:\n    result = 10 / 0\n    print(result)\nexcept ValueError:\n    print('Bad value')\nfinally:\n    print('Done')\n```",
                 "kc_q25_6_opt0": "Done (after crashing with ZeroDivisionError)", // Correct - finally runs even if exception isn't caught
                 "kc_q25_6_opt1": "Bad value\nDone",
                 "kc_q25_6_opt2": "10 / 0",
                 "kc_q25_6_opt3": "Done", // Incorrect - it *will* crash first
                 "kc_q25_7_text": "Consider the `else` block in a `try...except...else` structure. When does the code inside the `else` block execute?",
                 "kc_q25_7_opt0": "Always, after the `try` and `except` blocks.",
                 "kc_q25_7_opt1": "Only if an exception *is* caught by an `except` block.",
                 "kc_q25_7_opt2": "Only if the `try` block completes successfully *without* raising any exceptions.",
                 "kc_q25_7_opt3": "It never executes; `else` is not valid with `try`.",
                 "kc_q25_8_text": "When does the `finally` block execute?",
                 "kc_q25_8_opt0": "Always, after the `try`, `except`, and `else` blocks have finished, regardless of whether an exception occurred or was handled.",
                 "kc_q25_8_opt1": "Only when an exception occurs.",
                 "kc_q25_8_opt2": "Only when no exception occurs.",
                 "kc_q25_8_opt3": "Only if an `except` block successfully handles an error.",
                 "kc_q25_9_text": "Which punctuation mark is essential at the end of `try`, `except`, `else`, and `finally` lines in Python?",
                 "kc_q25_9_opt0": "Semicolon (;)",
                 "kc_q25_9_opt1": "Colon (:)",
                 "kc_q25_9_opt2": "Period (.)",
                 "kc_q25_9_opt3": "Comma (,)",
             },
             pt: {
                 "kc_page_title_25": "Verificação de Conhecimento: Módulo 25 - Tratamento de Exceções",
                 "kc_return_button": "Voltar ao Painel",
                 "kc_title_25": "Módulo 25: Verificação de Conhecimento - Tratamento de Exceções",
                 "kc_instructions": "<i class=\"fas fa-info-circle\"></i> Selecione a melhor resposta para cada pergunta. Você precisa responder corretamente a pelo menos <strong>6 de 10</strong> perguntas para passar. Você pode tentar novamente quantas vezes precisar. Boa sorte!",
                 "kc_submit_button": "Enviar Respostas",
                 "kc_retry_button": "Tentar Novamente",
                 "kc_result_pass": "Parabéns! Você Passou!",
                 "kc_result_fail": "Continue Tentando! Você Consegue!",
                 "kc_result_score": "Sua pontuação: {score} de {total}",
                 "footer_text": "Parte do Projeto Road to Free Open AGI",
                 "lang_select_aria": "Selecionar Idioma", "lang_en": "🇬🇧 English", "lang_pt": "🇧🇷 Português", "lang_zh": "🇨🇳 中文",
                 // Questions M25 - PT
                 "kc_q25_0_text": "Qual é o propósito principal do bloco `try` no tratamento de exceções em Python?",
                 "kc_q25_0_opt0": "Definir código de limpeza que sempre executa.",
                 "kc_q25_0_opt1": "Especificar o tipo de erro a ser capturado.",
                 "kc_q25_0_opt2": "Envolver código que pode gerar uma exceção.",
                 "kc_q25_0_opt3": "Executar código apenas se nenhuma exceção ocorreu.",
                 "kc_q25_1_text": "O que o bloco `except` faz?",
                 "kc_q25_1_opt0": "Contém o código que pode causar um erro.",
                 "kc_q25_1_opt1": "Contém o código a ser executado se um erro específico (ou qualquer erro, se não especificado) ocorrer no bloco `try`.",
                 "kc_q25_1_opt2": "Sempre executa, independentemente de erros.",
                 "kc_q25_1_opt3": "Executa apenas quando o bloco `try` termina sem erros.",
                 "kc_q25_2_text": "Qual é o propósito do bloco `finally`?",
                 "kc_q25_2_opt0": "Conter código que deve ser executado independentemente de uma exceção ter ocorrido ou não (por exemplo, fechar um arquivo).",
                 "kc_q25_2_opt1": "Capturar tipos muito específicos de erros.",
                 "kc_q25_2_opt2": "Executar apenas se ocorrer um erro.",
                 "kc_q25_2_opt3": "Executar apenas se não ocorrer erro.",
                 "kc_q25_3_text": "Como você captura apenas um tipo específico de erro, como um `ValueError`?",
                 "kc_q25_3_opt0": "Use `except all:`",
                 "kc_q25_3_opt1": "Use `except:` sem especificar um tipo de erro.",
                 "kc_q25_3_opt2": "Use `try ValueError:`",
                 "kc_q25_3_opt3": "Use `except ValueError:`",
                 "kc_q25_4_text": "O que acontece se você usar `except:` sem especificar um tipo de erro?",
                 "kc_q25_4_opt0": "Causa um erro de sintaxe.",
                 "kc_q25_4_opt1": "Captura *todos* os tipos de exceções (geralmente desencorajado, a menos que você saiba o porquê).",
                 "kc_q25_4_opt2": "Captura apenas `SyntaxError`.",
                 "kc_q25_4_opt3": "Não faz nada.",
                 "kc_q25_5_text": "O que o código a seguir imprimirá? \n```python\ntry:\n    num = int('abc')\n    print(num)\nexcept ValueError:\n    print('Número inválido')\nexcept TypeError:\n    print('Problema de tipo')\n```",
                 "kc_q25_5_opt0": "abc",
                 "kc_q25_5_opt1": "Problema de tipo",
                 "kc_q25_5_opt2": "Número inválido",
                 "kc_q25_5_opt3": "Ele vai travar com um ValueError.",
                 "kc_q25_6_text": "O que o código a seguir imprimirá? \n```python\ntry:\n    result = 10 / 0\n    print(result)\nexcept ValueError:\n    print('Valor ruim')\nfinally:\n    print('Feito')\n```",
                 "kc_q25_6_opt0": "Feito (após travar com ZeroDivisionError)", // Correto
                 "kc_q25_6_opt1": "Valor ruim\nFeito",
                 "kc_q25_6_opt2": "10 / 0",
                 "kc_q25_6_opt3": "Feito", // Incorreto
                 "kc_q25_7_text": "Considere o bloco `else` em uma estrutura `try...except...else`. Quando o código dentro do bloco `else` executa?",
                 "kc_q25_7_opt0": "Sempre, após os blocos `try` e `except`.",
                 "kc_q25_7_opt1": "Apenas se uma exceção *for* capturada por um bloco `except`.",
                 "kc_q25_7_opt2": "Apenas se o bloco `try` for concluído com sucesso *sem* gerar nenhuma exceção.",
                 "kc_q25_7_opt3": "Nunca executa; `else` não é válido com `try`.",
                 "kc_q25_8_text": "Quando o bloco `finally` executa?",
                 "kc_q25_8_opt0": "Sempre, após os blocos `try`, `except` e `else` terem terminado, independentemente de uma exceção ter ocorrido ou ter sido tratada.",
                 "kc_q25_8_opt1": "Apenas quando ocorre uma exceção.",
                 "kc_q25_8_opt2": "Apenas quando nenhuma exceção ocorre.",
                 "kc_q25_8_opt3": "Apenas se um bloco `except` tratar com sucesso um erro.",
                 "kc_q25_9_text": "Qual sinal de pontuação é essencial no final das linhas `try`, `except`, `else` e `finally` em Python?",
                 "kc_q25_9_opt0": "Ponto e vírgula (;)",
                 "kc_q25_9_opt1": "Dois pontos (:)",
                 "kc_q25_9_opt2": "Ponto (.)",
                 "kc_q25_9_opt3": "Vírgula (,)",
             },
             zh: {
                 "kc_page_title_25": "知识测验：模块 25 - 异常处理",
                 "kc_return_button": "返回仪表板",
                 "kc_title_25": "模块 25：知识测验 - 异常处理",
                 "kc_instructions": "<i class=\"fas fa-info-circle\"></i> 为每个问题选择最佳答案。您需要正确回答至少 <strong>10 个问题中的 6 个</strong>才能通过。您可以根据需要重试任意次数。祝您好运！",
                 "kc_submit_button": "提交答案",
                 "kc_retry_button": "重试测验",
                 "kc_result_pass": "恭喜！您已通过！",
                 "kc_result_fail": "继续努力！你可以做到的！",
                 "kc_result_score": "您的得分：{total} 分中的 {score} 分",
                 "footer_text": "通往自由开放AGI之路项目的一部分",
                 "lang_select_aria": "选择语言", "lang_en": "🇬🇧 English", "lang_pt": "🇧🇷 Português", "lang_zh": "🇨🇳 中文",
                  // Questions M25 - ZH
                 "kc_q25_0_text": "Python 异常处理中 `try` 块的主要目的是什么？",
                 "kc_q25_0_opt0": "定义总是运行的清理代码。",
                 "kc_q25_0_opt1": "指定要捕获的错误类型。",
                 "kc_q25_0_opt2": "包含可能引发异常的代码。",
                 "kc_q25_0_opt3": "仅在没有发生异常时执行代码。",
                 "kc_q25_1_text": "`except` 块的作用是什么？",
                 "kc_q25_1_opt0": "它包含可能导致错误的代码。",
                 "kc_q25_1_opt1": "如果 `try` 块中发生特定错误（如果未指定，则为任何错误），它包含要执行的代码。",
                 "kc_q25_1_opt2": "无论是否有错误，它总是执行。",
                 "kc_q25_1_opt3": "仅当 `try` 块无错误完成时才执行。",
                 "kc_q25_2_text": "`finally` 块的目的是什么？",
                 "kc_q25_2_opt0": "包含无论是否发生异常都必须运行的代码（例如，关闭文件）。",
                 "kc_q25_2_opt1": "捕获非常特定类型的错误。",
                 "kc_q25_2_opt2": "仅在发生错误时执行。",
                 "kc_q25_2_opt3": "仅在没有错误发生时执行。",
                 "kc_q25_3_text": "如何仅捕获特定类型的错误，例如 `ValueError`？",
                 "kc_q25_3_opt0": "使用 `except all:`",
                 "kc_q25_3_opt1": "使用不指定错误类型的 `except:`。",
                 "kc_q25_3_opt2": "使用 `try ValueError:`",
                 "kc_q25_3_opt3": "使用 `except ValueError:`",
                 "kc_q25_4_text": "如果您使用 `except:` 而不指定错误类型，会发生什么？",
                 "kc_q25_4_opt0": "导致语法错误。",
                 "kc_q25_4_opt1": "它会捕获*所有*类型的异常（通常不鼓励，除非您知道原因）。",
                 "kc_q25_4_opt2": "它只捕获 `SyntaxError`。",
                 "kc_q25_4_opt3": "它什么也不做。",
                 "kc_q25_5_text": "以下代码将打印什么？\n```python\ntry:\n    num = int('abc')\n    print(num)\nexcept ValueError:\n    print('无效数字')\nexcept TypeError:\n    print('类型问题')\n```",
                 "kc_q25_5_opt0": "abc",
                 "kc_q25_5_opt1": "类型问题",
                 "kc_q25_5_opt2": "无效数字",
                 "kc_q25_5_opt3": "它将因 ValueError 而崩溃。",
                 "kc_q25_6_text": "以下代码将打印什么？\n```python\ntry:\n    result = 10 / 0\n    print(result)\nexcept ValueError:\n    print('错误值')\nfinally:\n    print('完成')\n```",
                 "kc_q25_6_opt0": "完成 (在因 ZeroDivisionError 崩溃后)", // 正确
                 "kc_q25_6_opt1": "错误值\n完成",
                 "kc_q25_6_opt2": "10 / 0",
                 "kc_q25_6_opt3": "完成", // 不正确
                 "kc_q25_7_text": "考虑 `try...except...else` 结构中的 `else` 块。`else` 块内的代码何时执行？",
                 "kc_q25_7_opt0": "总是在 `try` 和 `except` 块之后。",
                 "kc_q25_7_opt1": "仅当异常*被* `except` 块捕获时。",
                 "kc_q25_7_opt2": "仅当 `try` 块成功完成*且未*引发任何异常时。",
                 "kc_q25_7_opt3": "它从不执行；`else` 对 `try` 无效。",
                 "kc_q25_8_text": "`finally` 块何时执行？",
                 "kc_q25_8_opt0": "总是在 `try`、`except` 和 `else` 块完成后执行，无论是否发生异常或是否已处理异常。",
                 "kc_q25_8_opt1": "仅在发生异常时。",
                 "kc_q25_8_opt2": "仅在没有异常发生时。",
                 "kc_q25_8_opt3": "仅当 `except` 块成功处理错误时。",
                 "kc_q25_9_text": "在 Python 中，`try`、`except`、`else` 和 `finally` 行的末尾必须使用哪个标点符号？",
                 "kc_q25_9_opt0": "分号 (;)",
                 "kc_q25_9_opt1": "冒号 (:)",
                 "kc_q25_9_opt2": "句点 (.)",
                 "kc_q25_9_opt3": "逗号 (,)",
             }
         };

        // --- Core Logic (Similar to Dashboard, adapted for Quiz) ---
        document.addEventListener('DOMContentLoaded', () => {
            const quizContainer = document.getElementById('quiz-container');
            const quizForm = document.getElementById('quiz-form');
            const submitButton = document.getElementById('submit-quiz');
            const resultsDiv = document.getElementById('quiz-results');
            const retryButton = document.getElementById('retry-button');
            const resultHeading = document.getElementById('result-heading');
            const resultMessage = document.getElementById('result-message');
            const resultScore = document.getElementById('result-score');
            const languageSelectElement = document.getElementById('languageSelect');

            let currentLang = getStoredLanguage();

            // --- Translation Functions ---
            function getStoredLanguage() { const storedLang = localStorage.getItem(LANGUAGE_STORAGE_KEY); return (storedLang && translations[storedLang]) ? storedLang : 'en'; }
            function getTranslation(key, lang, replacements = {}) { let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`; for (const placeholder in replacements) { const regex = new RegExp(`\\{${placeholder}\\}`, 'g'); text = text.replace(regex, replacements[placeholder]); } return text; }
            function translatePage(lang) { document.documentElement.lang = lang; document.querySelectorAll('[data-translate]').forEach(el => { const key = el.getAttribute('data-translate'); const translation = getTranslation(key, lang); if (el.tagName === 'TITLE') { document.title = translation; } else if (translation.includes('<') || translation.includes('>')) { el.innerHTML = translation; } else { el.textContent = translation; } }); document.querySelectorAll('[data-translate-aria-label]').forEach(el => { const key = el.getAttribute('data-translate-aria-label'); el.setAttribute('aria-label', getTranslation(key, lang)); }); }

            // --- Quiz Generation ---
            function generateQuizHTML(lang) {
                quizContainer.innerHTML = ''; // Clear previous questions
                quizQuestionsData.forEach((q, index) => {
                    const questionDiv = document.createElement('div');
                    questionDiv.classList.add('quiz-question');

                    const questionTextKey = `kc_q${MODULE_ID}_${q.id}_text`;
                    questionDiv.innerHTML = `
                        <span class="question-number">${index + 1}</span>
                        <p class="question-text">${getTranslation(questionTextKey, lang)}</p>
                        <div class="quiz-options">
                            ${[0, 1, 2, 3].map(optIndex => { // Assuming 4 options per question
                                const optionTextKey = `kc_q${MODULE_ID}_${q.id}_opt${optIndex}`;
                                const optionText = getTranslation(optionTextKey, lang);
                                return `
                                <label>
                                    <input type="radio" name="q${index}" value="${optIndex}" required>
                                    <span>${optionText}</span>
                                </label>`;
                            }).join('')}
                        </div>
                    `;
                    quizContainer.appendChild(questionDiv);
                });
                 // Ensure retry button is hidden and submit is enabled on generation
                 retryButton.style.display = 'none';
                 submitButton.disabled = false;
                 resultsDiv.style.display = 'none';
                 resultsDiv.className = ''; // Remove pass/fail classes
            }

             // --- LocalStorage Interaction ---
            function loadKnowledgeCheckStatus() { try { const storedStatus = localStorage.getItem(KNOWLEDGE_CHECK_STORAGE_KEY); const parsed = storedStatus ? JSON.parse(storedStatus) : {}; return typeof parsed === 'object' && parsed !== null ? parsed : {}; } catch (e) { console.error("Error reading KC status from localStorage:", e); return {}; } }
            function saveKnowledgeCheckStatus(statusObject) { try { localStorage.setItem(KNOWLEDGE_CHECK_STORAGE_KEY, JSON.stringify(statusObject)); } catch (e) { console.error("Error saving KC status to localStorage:", e); } }
            function saveProgress(passed) { if (!passed) return; // Only save if passed const currentStatus = loadKnowledgeCheckStatus(); currentStatus[MODULE_ID] = true; saveKnowledgeCheckStatus(currentStatus); console.log(`Module ${MODULE_ID} marked as passed.`); }

            // --- Handle Quiz Submission ---
            function handleSubmit(event) {
                event.preventDefault();
                let score = 0;
                const formData = new FormData(quizForm);
                quizQuestionsData.forEach((q, index) => {
                    const selectedAnswer = formData.get(`q${index}`); // Gets the value (optIndex)
                    if (selectedAnswer !== null && parseInt(selectedAnswer, 10) === q.correctIndex) {
                        score++;
                    }
                });

                const passed = score >= PASSING_SCORE;
                saveProgress(passed);
                displayResults(score, passed, currentLang);
            }

            // --- Display Results ---
            function displayResults(score, passed, lang) {
                resultHeading.textContent = getTranslation(passed ? 'kc_result_pass' : 'kc_result_fail', lang);
                resultScore.textContent = getTranslation('kc_result_score', lang, { score: score, total: TOTAL_QUESTIONS });

                resultsDiv.className = passed ? 'pass' : 'fail'; // Add class for styling
                resultsDiv.style.display = 'block';
                submitButton.disabled = true;
                retryButton.style.display = 'inline-block';

                // Scroll to results smoothly
                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }

             // --- Handle Retry ---
             function handleRetry() {
                 resultsDiv.style.display = 'none';
                 resultsDiv.className = ''; // Clear pass/fail class
                 submitButton.disabled = false;
                 retryButton.style.display = 'none';
                 quizForm.reset(); // Clear selections
                 // Scroll back to top smoothly
                 quizContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
             }

            // --- Language Switcher Logic ---
             function handleLanguageChange(event) {
                currentLang = event.target.value;
                localStorage.setItem(LANGUAGE_STORAGE_KEY, currentLang);
                translatePage(currentLang);
                // Regenerate quiz only if it hasn't been submitted yet
                if (submitButton.disabled === false) {
                     generateQuizHTML(currentLang);
                } else {
                    // If already submitted, just update the result text
                    const scoreText = resultScore.textContent; // Get current score text before translation
                    const scoreMatch = scoreText.match(/(\d+)\s*.*\s*(\d+)/); // Extract numbers
                     if (scoreMatch) {
                        const score = parseInt(scoreMatch[1], 10);
                        const total = parseInt(scoreMatch[2], 10);
                        const passed = score >= PASSING_SCORE;
                         displayResults(score, passed, currentLang); // Re-display results with new lang
                     }
                }
             }

            // --- Initial Setup ---
            languageSelectElement.value = currentLang; // Set dropdown to stored/detected language
            translatePage(currentLang);
            generateQuizHTML(currentLang); // Generate initial quiz

            // --- Event Listeners ---
            quizForm.addEventListener('submit', handleSubmit);
            retryButton.addEventListener('click', handleRetry);
            languageSelectElement.addEventListener('change', handleLanguageChange);

        }); // End DOMContentLoaded
    </script>

</body>
</html>
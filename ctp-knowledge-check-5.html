<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="kc5_page_title">Knowledge Check: Comparisons & Booleans - Complete Python</title>
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Base Styles & Variables (Copied from dashboard) --- */
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-page: #f0f2f5;
            --background-card: #ffffff;
            --background-sidebar: #ffffff; /* Keeping for consistency, though no sidebar here */
            --background-header: linear-gradient(135deg, #0d6efd, #0a58ca);
            --text-light: #f8f9fa;
            --text-dark: #343a40;
            --text-muted: #6c757d;
            --accent-color: #ffc107;
            --success-color: #198754;
            --error-color: #dc3545;
            --info-color: #0dcaf0;
            --video-color: #fd7e14; /* Keeping var names */
            --check-color: #6f42c1;
            --certificate-color: #d63384;
            --chat-panel-bg: #ffffff; /* Keeping var names */
            --chat-box-bg: #f8f9fa; /* Keeping var names */
            --chat-bot-bg: #e9ecef; /* Keeping var names */
            --chat-bot-text: #343a40; /* Keeping var names */
            --chat-user-bg: #d1e7ff; /* Keeping var names */
            --chat-user-text: #0a58ca; /* Keeping var names */
            --chat-error-bg: #f8d7da; /* Keeping var names */
            --chat-error-text: #842029; /* Keeping var names */
            --chat-border-color: #dee2e6; /* Keeping var names */
            --progress-bg: #e9ecef;
            --progress-fill: var(--check-color);
            --border-color: #dee2e6;
            --border-radius: 8px;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            --card-shadow-hover: 0 6px 18px rgba(0, 0, 0, 0.1); /* Keeping var names */
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
            --sidebar-width: 260px; /* Keeping var names */
             /* Colors for lang switcher */
             --lang-select-border: var(--certificate-color);
             --lang-select-bg: rgba(255, 255, 255, 0.1);
             --lang-select-bg-hover: rgba(255, 255, 255, 0.15);
             --lang-option-bg: var(--background-card);
             --lang-option-text: var(--text-dark);
             --lang-arrow-color: var(--certificate-color);
             /* Quiz Specific */
             --quiz-question-bg: #f8f9fa;
             --quiz-correct-bg: #d1e7dd;
             --quiz-correct-border: #a3cfbb;
             --quiz-incorrect-bg: #f8d7da;
             --quiz-incorrect-border: #f1aeb5;
             --quiz-selected-bg: #cfe2ff;
             --quiz-selected-border: #a9c9fe;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.6;
            background-color: var(--background-page); color: var(--text-dark);
            display: flex; flex-direction: column; min-height: 100vh;
        }

        /* --- Header for Quiz Page --- */
        .quiz-header {
            background: var(--background-header);
            color: var(--text-light);
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .quiz-header-content {
             display: flex;
             align-items: center;
             gap: 1.5rem; /* Space between button and title */
             flex-grow: 1; /* Allow title to take space */
        }
        .return-button {
            background-color: rgba(255, 255, 255, 0.15);
            color: var(--text-light);
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: background-color var(--transition-speed) ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
        }
        .return-button i { line-height: 1; }
        .return-button:hover { background-color: rgba(255, 255, 255, 0.25); }
        .quiz-header h1 {
            font-family: var(--font-title);
            font-size: 1.6rem;
            margin: 0;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }
        .quiz-lang-switcher { /* Language switcher container in header */
            position: relative;
        }
         #languageSelect { /* Style the select dropdown */
            background: var(--lang-select-bg);
            color: var(--text-light);
            border: 1px solid var(--lang-select-border);
            border-radius: 5px;
            padding: 6px 30px 6px 10px; /* Adjust padding */
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            appearance: none; -webkit-appearance: none; -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23${encodeURIComponent(getComputedStyle(document.documentElement).getPropertyValue('--certificate-color').trim().substring(1))}%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 8px auto;
            transition: border-color 0.3s ease, background-color 0.3s ease;
         }
         #languageSelect:hover { background-color: var(--lang-select-bg-hover); }
         #languageSelect:focus { outline: none; border-color: var(--accent-color); }
         #languageSelect option {
              background: var(--lang-option-bg);
              color: var(--lang-option-text);
              padding: 5px;
         }

        /* --- Main Quiz Content Area --- */
        .quiz-main {
            max-width: 900px;
            width: 95%;
            margin: 2rem auto;
            background-color: var(--background-card);
            padding: 2rem 2.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            flex-grow: 1;
        }
        .quiz-instructions {
            background-color: #eef2f7; /* Light background for instructions */
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius);
            margin-bottom: 2rem;
            border: 1px solid #d6dde5;
            font-size: 0.95rem;
            color: var(--text-dark);
        }
        .quiz-instructions p { margin-bottom: 0.5rem; }
        .quiz-instructions p:last-child { margin-bottom: 0; }
        .quiz-instructions strong { color: var(--primary-color); }
        .quiz-instructions .pass-score { color: var(--success-color); font-weight: bold; }
        .quiz-instructions .retake-info { color: var(--secondary-color); }

        /* --- Question Styling --- */
        .question-block {
            background-color: var(--background-card);
            margin-bottom: 1.8rem;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            box-shadow: 0 2px 5px rgba(0,0,0,0.04);
            transition: border-color 0.3s ease;
        }
        .question-block.answered.correct { border-left: 5px solid var(--success-color); }
        .question-block.answered.incorrect { border-left: 5px solid var(--error-color); }

        .question-text {
            font-weight: 500;
            font-size: 1.1rem;
            margin-bottom: 1.2rem;
            color: var(--text-dark);
        }
        .question-text code {
            background-color: #e9ecef;
            padding: 0.1em 0.4em;
            border-radius: 3px;
            font-size: 0.9em;
            color: #c7254e; /* Similar to dashboard */
            font-family: monospace;
        }
        .options-list { list-style: none; padding: 0; margin: 0; }
        .option-item { margin-bottom: 0.8rem; }
        .option-item label {
            display: block; /* Makes the whole area clickable */
            background-color: var(--quiz-question-bg);
            padding: 0.8rem 1.2rem;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            position: relative;
            font-size: 0.95rem;
        }
        .option-item label:hover { background-color: #e2e6ea; border-color: #adb5bd; }
        .option-item input[type="radio"] { /* Hide the default radio button */
            opacity: 0;
            position: absolute;
            width: 0; height: 0;
        }
        /* Custom radio button appearance */
        .option-item label::before {
            content: '';
            display: inline-block;
            width: 18px; height: 18px;
            border: 2px solid var(--secondary-color);
            border-radius: 50%;
            margin-right: 10px;
            vertical-align: middle;
            transition: border-color 0.2s ease;
        }
         /* Checked state appearance */
        .option-item input[type="radio"]:checked + span::before {
            border-color: var(--primary-color);
            background-color: var(--primary-color); /* Optional: fill */
            box-shadow: inset 0 0 0 3px var(--quiz-question-bg); /* Creates the inner circle effect */
        }
         /* Focus state */
        .option-item input[type="radio"]:focus + span { outline: 2px solid var(--primary-color); outline-offset: 2px; }

        /* --- Feedback Styling (Applied after submit) --- */
        .option-item.correct-answer label {
            background-color: var(--quiz-correct-bg);
            border-color: var(--quiz-correct-border);
            color: #0f5132;
            font-weight: 500;
        }
        .option-item.incorrect-answer label { /* User selected this, but it was wrong */
            background-color: var(--quiz-incorrect-bg);
            border-color: var(--quiz-incorrect-border);
            color: #842029;
            font-weight: 500;
        }
        .option-item.correct-answer label::after,
        .option-item.incorrect-answer label::after {
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            right: 15px; top: 50%;
            transform: translateY(-50%);
            font-size: 1.1rem;
        }
        .option-item.correct-answer label::after { content: '\f00c'; color: var(--success-color); }
        .option-item.incorrect-answer label::after { content: '\f00d'; color: var(--error-color); }

        /* --- Submit Button --- */
        .submit-button-container { text-align: center; margin-top: 2.5rem; }
        #submit-quiz {
            background-color: var(--check-color);
            color: var(--text-light);
            border: none;
            padding: 0.8rem 2rem;
            font-size: 1.1rem;
            font-weight: 500;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: background-color var(--transition-speed) ease, transform 0.1s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        #submit-quiz:hover { background-color: #5a359a; }
        #submit-quiz:active { transform: scale(0.98); }
        #submit-quiz:disabled { background-color: var(--secondary-color); cursor: not-allowed; opacity: 0.7; }

        /* --- Results Area --- */
        #results-area {
            margin-top: 2rem;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            text-align: center;
            font-size: 1.1rem;
            display: none; /* Hidden initially */
            border-width: 2px;
            border-style: solid;
        }
        #results-area.pass-message {
            background-color: var(--quiz-correct-bg);
            border-color: var(--quiz-correct-border);
            color: #0f5132;
        }
        #results-area.fail-message {
            background-color: var(--quiz-incorrect-bg);
            border-color: var(--quiz-incorrect-border);
            color: #842029;
        }
        #results-area p { margin-bottom: 0.5rem; }
        #results-area strong { font-weight: 700; }
        #results-area .score { font-size: 1.3em; display: block; margin-bottom: 0.5rem; }
        #results-area .progress-saved { font-size: 0.9em; color: var(--secondary-color); margin-top: 0.8rem; }

        /* --- Footer --- */
        footer { text-align: center; padding: 1.5rem; margin-top: auto; background-color: var(--background-card); border-top: 1px solid var(--border-color); color: var(--text-muted); font-size: 0.9rem; }

        /* --- Responsive Design Adjustments --- */
        @media (max-width: 768px) {
            html { font-size: 15px; }
            .quiz-header h1 { font-size: 1.4rem; }
            .quiz-main { padding: 1.5rem; width: 98%; margin: 1.5rem auto; }
            .question-text { font-size: 1rem; }
            .option-item label { padding: 0.7rem 1rem; font-size: 0.9rem;}
             .quiz-header-content { gap: 0.8rem; } /* Reduce gap on smaller screens */
             .return-button { padding: 0.4rem 0.8rem; font-size: 0.8rem; }
             #languageSelect { padding: 5px 25px 5px 8px; font-size: 0.8rem; }
        }
        @media (max-width: 576px) {
            html { font-size: 14px; }
            .quiz-header { flex-direction: column; gap: 0.8rem; padding: 0.8rem 1rem; }
            .quiz-header-content { width: 100%; justify-content: space-between;} /* Space between button and title */
            .quiz-lang-switcher { align-self: flex-end; /* Move lang switcher below */ margin-top: 5px; }
            .quiz-header h1 { font-size: 1.3rem; text-align: left; } /* Align title left */
            .quiz-main { padding: 1rem 1.2rem; margin: 1rem auto; }
            .question-block { padding: 1rem; }
            .option-item label::before { width: 16px; height: 16px; margin-right: 8px;}
            #submit-quiz { font-size: 1rem; padding: 0.7rem 1.5rem; }
             #results-area { padding: 1rem; font-size: 1rem; }
        }

    </style>
</head>
<body>

    <header class="quiz-header">
        <div class="quiz-header-content">
            <a href="ctp-dashboard.html" class="return-button">
                <i class="fas fa-arrow-left"></i> <span data-translate="return_to_dashboard">Return to Dashboard</span>
            </a>
            <h1 data-translate="kc5_header_title">Module 5 Check: Comparisons</h1>
        </div>
         <div class="quiz-lang-switcher">
             <select id="languageSelect" data-translate-aria-label="lang_select_aria" aria-label="Select Language">
                 <option value="en" data-translate="lang_en">🇬🇧 English</option>
                 <option value="pt" data-translate="lang_pt">🇧🇷 Português</option>
                 <option value="zh" data-translate="lang_zh">🇨🇳 中文</option>
             </select>
         </div>
    </header>

    <main class="quiz-main">

        <div class="quiz-instructions">
            <p data-translate="quiz_instructions_p1">Test your understanding of Module 5: Comparisons & Booleans.</p>
            <p data-translate="quiz_instructions_p2">You need to answer <span class="pass-score">6 out of 10</span> questions correctly to pass.</p>
            <p data-translate="quiz_instructions_p3" class="retake-info">You can retake this check as many times as you need. Passing will update your certificate progress.</p>
        </div>

        <form id="knowledge-check-form">
            <div id="question-area">
                <!-- Questions will be loaded here by JavaScript -->
            </div>

            <div class="submit-button-container">
                <button type="submit" id="submit-quiz" data-translate="submit_button">Submit Answers</button>
            </div>
        </form>

        <div id="results-area">
            <!-- Results will be displayed here -->
        </div>

    </main>

    <footer>
        <p data-translate="footer_text">Part of the Road to Free Open AGI Project</p>
    </footer>

    <script>
        // --- Constants ---
        const KNOWLEDGE_CHECK_STORAGE_KEY = 'knowledgeCheckStatus_v1';
        const LANGUAGE_STORAGE_KEY = 'userLanguage';
        const MODULE_ID = 5; // *** This is specific to this file ***
        const TOTAL_QUESTIONS = 10;
        const PASS_SCORE = 6;

        // --- Translations Object (Including new keys for this page) ---
        const translations = {
             en: { /* ... English keys from dashboard ... */
                 "kc5_page_title": "Knowledge Check: Comparisons & Booleans - Complete Python",
                 "kc5_header_title": "Module 5 Check: Comparisons",
                 "return_to_dashboard": "Return to Dashboard",
                 "quiz_instructions_p1": "Test your understanding of Module 5: Comparisons & Booleans.",
                 "quiz_instructions_p2": "You need to answer <span class=\"pass-score\">6 out of 10</span> questions correctly to pass.",
                 "quiz_instructions_p3": "You can retake this check as many times as you need. Passing will update your certificate progress.",
                 "submit_button": "Submit Answers",
                 "results_pass_header": "Congratulations, you passed!",
                 "results_fail_header": "Keep trying!",
                 "results_score_label": "Your score:",
                 "results_progress_saved": "Your progress for this module has been saved.",
                 "results_try_again": "Review the material and try again!",
                 "lang_select_aria": "Select Language",
                 "lang_en": "🇬🇧 English",
                 "lang_pt": "🇧🇷 Português",
                 "lang_zh": "🇨🇳 中文",
                 "footer_text": "Part of the Road to Free Open AGI Project",

                 // --- Module 5 Questions ---
                 "kc5_q1_question": "Which operator checks if two values are NOT equal?",
                 "kc5_q1_opt_a": "==",
                 "kc5_q1_opt_b": "!=",
                 "kc5_q1_opt_c": "<>",
                 "kc5_q1_opt_d": "not ==",

                 "kc5_q2_question": "What is the result of the expression `10 > 5`?",
                 "kc5_q2_opt_a": "True",
                 "kc5_q2_opt_b": "False",
                 "kc5_q2_opt_c": "10",
                 "kc5_q2_opt_d": "5",

                 "kc5_q3_question": "Which of the following expressions evaluates to `False`?",
                 "kc5_q3_opt_a": "5 <= 5",
                 "kc5_q3_opt_b": "'apple' == 'apple'",
                 "kc5_q3_opt_c": "100 < 99",
                 "kc5_q3_opt_d": "0 != 1",

                 "kc5_q4_question": "What data type does a comparison operation like `<` or `==` return?",
                 "kc5_q4_opt_a": "Integer (int)",
                 "kc5_q4_opt_b": "String (str)",
                 "kc5_q4_opt_c": "Boolean (bool)",
                 "kc5_q4_opt_d": "Float (float)",

                 "kc5_q5_question": "Consider `x = 15`. What is the value of `x >= 20`?",
                 "kc5_q5_opt_a": "True",
                 "kc5_q5_opt_b": "False",
                 "kc5_q5_opt_c": "15",
                 "kc5_q5_opt_d": "Error",

                 "kc5_q6_question": "What does the expression `'hello' == 'Hello'` evaluate to?",
                 "kc5_q6_opt_a": "True",
                 "kc5_q6_opt_b": "False",
                 "kc5_q6_opt_c": "'hello'",
                 "kc5_q6_opt_d": "It depends on the Python version",

                 "kc5_q7_question": "Which operator checks if a value is less than OR equal to another?",
                 "kc5_q7_opt_a": "<",
                 "kc5_q7_opt_b": "<=",
                 "kc5_q7_opt_c": "=<",
                 "kc5_q7_opt_d": "<==",

                 "kc5_q8_question": "If `a = True` and `b = False`, what is `a == b`?",
                 "kc5_q8_opt_a": "True",
                 "kc5_q8_opt_b": "False",
                 "kc5_q8_opt_c": "Error",
                 "kc5_q8_opt_d": "None",

                 "kc5_q9_question": "What is the result of `5 == 5.0`?",
                 "kc5_q9_opt_a": "True",
                 "kc5_q9_opt_b": "False",
                 "kc5_q9_opt_c": "Causes a TypeError",
                 "kc5_q9_opt_d": "Sometimes True, sometimes False",

                 "kc5_q10_question": "The values `True` and `False` belong to which Python data type?",
                 "kc5_q10_opt_a": "str",
                 "kc5_q10_opt_b": "int",
                 "kc5_q10_opt_c": "bool",
                 "kc5_q10_opt_d": "list",
                 // Add dashboard keys here if needed, or assume they are inherited/not needed on this page
             },
             pt: { /* ... Portuguese keys from dashboard ... */
                 "kc5_page_title": "Verificação: Comparações e Booleanos - Python Completo",
                 "kc5_header_title": "Verificação Módulo 5: Comparações",
                 "return_to_dashboard": "Voltar ao Painel",
                 "quiz_instructions_p1": "Teste seu entendimento do Módulo 5: Comparações e Booleanos.",
                 "quiz_instructions_p2": "Você precisa acertar <span class=\"pass-score\">6 de 10</span> questões para passar.",
                 "quiz_instructions_p3": "Você pode refazer esta verificação quantas vezes precisar. Passar atualizará o progresso do seu certificado.",
                 "submit_button": "Enviar Respostas",
                 "results_pass_header": "Parabéns, você passou!",
                 "results_fail_header": "Continue tentando!",
                 "results_score_label": "Sua pontuação:",
                 "results_progress_saved": "Seu progresso para este módulo foi salvo.",
                 "results_try_again": "Revise o material e tente novamente!",
                 "lang_select_aria": "Selecionar Idioma",
                 "lang_en": "🇬🇧 English",
                 "lang_pt": "🇧🇷 Português",
                 "lang_zh": "🇨🇳 中文",
                 "footer_text": "Parte do Projeto Road to Free Open AGI",

                 // --- Module 5 Questions (PT) ---
                 "kc5_q1_question": "Qual operador verifica se dois valores NÃO são iguais?",
                 "kc5_q1_opt_a": "==",
                 "kc5_q1_opt_b": "!=",
                 "kc5_q1_opt_c": "<>",
                 "kc5_q1_opt_d": "not ==",

                 "kc5_q2_question": "Qual é o resultado da expressão `10 > 5`?",
                 "kc5_q2_opt_a": "True",
                 "kc5_q2_opt_b": "False",
                 "kc5_q2_opt_c": "10",
                 "kc5_q2_opt_d": "5",

                 "kc5_q3_question": "Qual das seguintes expressões avalia para `False`?",
                 "kc5_q3_opt_a": "5 <= 5",
                 "kc5_q3_opt_b": "'apple' == 'apple'",
                 "kc5_q3_opt_c": "100 < 99",
                 "kc5_q3_opt_d": "0 != 1",

                 "kc5_q4_question": "Qual tipo de dado uma operação de comparação como `<` ou `==` retorna?",
                 "kc5_q4_opt_a": "Inteiro (int)",
                 "kc5_q4_opt_b": "String (str)",
                 "kc5_q4_opt_c": "Booleano (bool)",
                 "kc5_q4_opt_d": "Ponto flutuante (float)",

                 "kc5_q5_question": "Considere `x = 15`. Qual é o valor de `x >= 20`?",
                 "kc5_q5_opt_a": "True",
                 "kc5_q5_opt_b": "False",
                 "kc5_q5_opt_c": "15",
                 "kc5_q5_opt_d": "Erro",

                 "kc5_q6_question": "O que a expressão `'hello' == 'Hello'` avalia?",
                 "kc5_q6_opt_a": "True",
                 "kc5_q6_opt_b": "False",
                 "kc5_q6_opt_c": "'hello'",
                 "kc5_q6_opt_d": "Depende da versão do Python",

                 "kc5_q7_question": "Qual operador verifica se um valor é menor OU igual a outro?",
                 "kc5_q7_opt_a": "<",
                 "kc5_q7_opt_b": "<=",
                 "kc5_q7_opt_c": "=<",
                 "kc5_q7_opt_d": "<==",

                 "kc5_q8_question": "Se `a = True` e `b = False`, quanto é `a == b`?",
                 "kc5_q8_opt_a": "True",
                 "kc5_q8_opt_b": "False",
                 "kc5_q8_opt_c": "Erro",
                 "kc5_q8_opt_d": "None",

                 "kc5_q9_question": "Qual é o resultado de `5 == 5.0`?",
                 "kc5_q9_opt_a": "True",
                 "kc5_q9_opt_b": "False",
                 "kc5_q9_opt_c": "Causa um TypeError",
                 "kc5_q9_opt_d": "Às vezes True, às vezes False",

                 "kc5_q10_question": "Os valores `True` e `False` pertencem a qual tipo de dado Python?",
                 "kc5_q10_opt_a": "str",
                 "kc5_q10_opt_b": "int",
                 "kc5_q10_opt_c": "bool",
                 "kc5_q10_opt_d": "list",
             },
             zh: { /* ... Chinese keys from dashboard ... */
                 "kc5_page_title": "知识测验：比较与布尔值 - Python 完全指南",
                 "kc5_header_title": "模块 5 测验：比较",
                 "return_to_dashboard": "返回仪表板",
                 "quiz_instructions_p1": "测试您对模块 5：比较与布尔值的理解。",
                 "quiz_instructions_p2": "您需要正确回答 <span class=\"pass-score\">10 个问题中的 6 个</span>才能通过。",
                 "quiz_instructions_p3": "您可以根据需要重考此测验任意次数。通过测验将更新您的证书进度。",
                 "submit_button": "提交答案",
                 "results_pass_header": "恭喜，您通过了！",
                 "results_fail_header": "继续努力！",
                 "results_score_label": "您的得分：",
                 "results_progress_saved": "您此模块的进度已保存。",
                 "results_try_again": "复习材料后重试！",
                 "lang_select_aria": "选择语言",
                 "lang_en": "🇬🇧 English",
                 "lang_pt": "🇧🇷 Português",
                 "lang_zh": "🇨🇳 中文",
                 "footer_text": "通往自由开放AGI之路项目的一部分",

                  // --- Module 5 Questions (ZH) ---
                 "kc5_q1_question": "哪个运算符检查两个值是否不相等？",
                 "kc5_q1_opt_a": "==",
                 "kc5_q1_opt_b": "!=",
                 "kc5_q1_opt_c": "<>",
                 "kc5_q1_opt_d": "not ==",

                 "kc5_q2_question": "表达式 `10 > 5` 的结果是什么？",
                 "kc5_q2_opt_a": "True",
                 "kc5_q2_opt_b": "False",
                 "kc5_q2_opt_c": "10",
                 "kc5_q2_opt_d": "5",

                 "kc5_q3_question": "以下哪个表达式的计算结果为 `False`？",
                 "kc5_q3_opt_a": "5 <= 5",
                 "kc5_q3_opt_b": "'apple' == 'apple'",
                 "kc5_q3_opt_c": "100 < 99",
                 "kc5_q3_opt_d": "0 != 1",

                 "kc5_q4_question": "像 `<` 或 `==` 这样的比较运算返回什么数据类型？",
                 "kc5_q4_opt_a": "整数 (int)",
                 "kc5_q4_opt_b": "字符串 (str)",
                 "kc5_q4_opt_c": "布尔值 (bool)",
                 "kc5_q4_opt_d": "浮点数 (float)",

                 "kc5_q5_question": "假设 `x = 15`。`x >= 20` 的值是什么？",
                 "kc5_q5_opt_a": "True",
                 "kc5_q5_opt_b": "False",
                 "kc5_q5_opt_c": "15",
                 "kc5_q5_opt_d": "错误",

                 "kc5_q6_question": "表达式 `'hello' == 'Hello'` 的计算结果是什么？",
                 "kc5_q6_opt_a": "True",
                 "kc5_q6_opt_b": "False",
                 "kc5_q6_opt_c": "'hello'",
                 "kc5_q6_opt_d": "取决于 Python 版本",

                 "kc5_q7_question": "哪个运算符检查一个值是否小于或等于另一个值？",
                 "kc5_q7_opt_a": "<",
                 "kc5_q7_opt_b": "<=",
                 "kc5_q7_opt_c": "=<",
                 "kc5_q7_opt_d": "<==",

                 "kc5_q8_question": "如果 `a = True` 且 `b = False`，`a == b` 是什么？",
                 "kc5_q8_opt_a": "True",
                 "kc5_q8_opt_b": "False",
                 "kc5_q8_opt_c": "错误",
                 "kc5_q8_opt_d": "None",

                 "kc5_q9_question": "`5 == 5.0` 的结果是什么？",
                 "kc5_q9_opt_a": "True",
                 "kc5_q9_opt_b": "False",
                 "kc5_q9_opt_c": "导致 TypeError",
                 "kc5_q9_opt_d": "有时是 True，有时是 False",

                 "kc5_q10_question": "值 `True` 和 `False` 属于 Python 的哪种数据类型？",
                 "kc5_q10_opt_a": "str",
                 "kc5_q10_opt_b": "int",
                 "kc5_q10_opt_c": "bool",
                 "kc5_q10_opt_d": "list",
             }
         };

        // --- Quiz Data ---
        const quizData = {
            [MODULE_ID]: [
                { questionKey: "kc5_q1_question", optionsKeys: ["kc5_q1_opt_a", "kc5_q1_opt_b", "kc5_q1_opt_c", "kc5_q1_opt_d"], correctAnswerIndex: 1 },
                { questionKey: "kc5_q2_question", optionsKeys: ["kc5_q2_opt_a", "kc5_q2_opt_b", "kc5_q2_opt_c", "kc5_q2_opt_d"], correctAnswerIndex: 0 },
                { questionKey: "kc5_q3_question", optionsKeys: ["kc5_q3_opt_a", "kc5_q3_opt_b", "kc5_q3_opt_c", "kc5_q3_opt_d"], correctAnswerIndex: 2 },
                { questionKey: "kc5_q4_question", optionsKeys: ["kc5_q4_opt_a", "kc5_q4_opt_b", "kc5_q4_opt_c", "kc5_q4_opt_d"], correctAnswerIndex: 2 },
                { questionKey: "kc5_q5_question", optionsKeys: ["kc5_q5_opt_a", "kc5_q5_opt_b", "kc5_q5_opt_c", "kc5_q5_opt_d"], correctAnswerIndex: 1 },
                { questionKey: "kc5_q6_question", optionsKeys: ["kc5_q6_opt_a", "kc5_q6_opt_b", "kc5_q6_opt_c", "kc5_q6_opt_d"], correctAnswerIndex: 1 },
                { questionKey: "kc5_q7_question", optionsKeys: ["kc5_q7_opt_a", "kc5_q7_opt_b", "kc5_q7_opt_c", "kc5_q7_opt_d"], correctAnswerIndex: 1 },
                { questionKey: "kc5_q8_question", optionsKeys: ["kc5_q8_opt_a", "kc5_q8_opt_b", "kc5_q8_opt_c", "kc5_q8_opt_d"], correctAnswerIndex: 1 },
                { questionKey: "kc5_q9_question", optionsKeys: ["kc5_q9_opt_a", "kc5_q9_opt_b", "kc5_q9_opt_c", "kc5_q9_opt_d"], correctAnswerIndex: 0 },
                { questionKey: "kc5_q10_question", optionsKeys: ["kc5_q10_opt_a", "kc5_q10_opt_b", "kc5_q10_opt_c", "kc5_q10_opt_d"], correctAnswerIndex: 2 }
            ]
        };


        // --- Core Functions ---
        function loadKnowledgeCheckStatus() { try { const storedStatus = localStorage.getItem(KNOWLEDGE_CHECK_STORAGE_KEY); const parsed = storedStatus ? JSON.parse(storedStatus) : {}; return typeof parsed === 'object' && parsed !== null ? parsed : {}; } catch (e) { console.error("Error reading KC status from localStorage:", e); return {}; } }
        function saveKnowledgeCheckStatus(statusObject) { try { localStorage.setItem(KNOWLEDGE_CHECK_STORAGE_KEY, JSON.stringify(statusObject)); } catch (e) { console.error("Error saving KC status to localStorage:", e); } }
        function getStoredLanguage() { const storedLang = localStorage.getItem(LANGUAGE_STORAGE_KEY); return (storedLang && translations[storedLang]) ? storedLang : 'en'; }
        function getTranslation(key, lang, replacements = {}) { let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`; for (const placeholder in replacements) { const regex = new RegExp(`\\{${placeholder}\\}`, 'g'); text = text.replace(regex, replacements[placeholder]); } return text; }

        function translatePage(lang) {
            if (!translations[lang]) lang = 'en';
            document.documentElement.lang = lang;
            document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.getAttribute('data-translate');
                const translation = getTranslation(key, lang);
                if (el.tagName === 'TITLE') { document.title = translation; }
                else if (translation.includes('<') && translation.includes('>')) { el.innerHTML = translation; } // Allow HTML in translations
                else { el.textContent = translation; }
            });
             document.querySelectorAll('[data-translate-placeholder]').forEach(el => { const key = el.getAttribute('data-translate-placeholder'); el.setAttribute('placeholder', getTranslation(key, lang)); });
             document.querySelectorAll('[data-translate-aria-label]').forEach(el => { const key = el.getAttribute('data-translate-aria-label'); el.setAttribute('aria-label', getTranslation(key, lang)); });
        }

        function setLanguage(lang) {
            if (!translations[lang]) lang = 'en'; // Fallback
            localStorage.setItem(LANGUAGE_STORAGE_KEY, lang);
            document.documentElement.lang = lang;
             // Update language selector value
             const langSelect = document.getElementById('languageSelect');
             if (langSelect) langSelect.value = lang;
            translatePage(lang); // Re-translate the whole page
            // Note: If quiz is already submitted, results message needs re-translation too if visible
             const resultsArea = document.getElementById('results-area');
             if (resultsArea.style.display !== 'none' && resultsArea.dataset.score) {
                 const score = parseInt(resultsArea.dataset.score, 10);
                 const passed = score >= PASS_SCORE;
                 displayResults(score, passed); // Re-display results with new language
             }
        }

        function renderQuiz() {
            const questions = quizData[MODULE_ID];
            const questionArea = document.getElementById('question-area');
            const lang = getStoredLanguage();
            questionArea.innerHTML = ''; // Clear previous questions

            questions.forEach((q, index) => {
                const questionBlock = document.createElement('div');
                questionBlock.classList.add('question-block');
                questionBlock.id = `question-${index}`;

                const questionText = document.createElement('p');
                questionText.classList.add('question-text');
                questionText.setAttribute('data-translate', q.questionKey);
                // Add question number
                 const questionNumberSpan = document.createElement('span');
                 questionNumberSpan.textContent = `${index + 1}. `;
                 questionText.insertBefore(questionNumberSpan, questionText.firstChild);

                questionBlock.appendChild(questionText);

                const optionsList = document.createElement('ul');
                optionsList.classList.add('options-list');

                q.optionsKeys.forEach((optionKey, optionIndex) => {
                    const optionItem = document.createElement('li');
                    optionItem.classList.add('option-item');

                    const inputId = `q${index}_option${optionIndex}`;
                    const radioInput = document.createElement('input');
                    radioInput.type = 'radio';
                    radioInput.name = `question_${index}`;
                    radioInput.value = optionIndex;
                    radioInput.id = inputId;

                    const label = document.createElement('label');
                    label.htmlFor = inputId;

                     // Use a span inside the label for better control with ::before pseudo-element
                     const labelTextSpan = document.createElement('span');
                     labelTextSpan.setAttribute('data-translate', optionKey);

                    label.appendChild(radioInput);
                    label.appendChild(labelTextSpan);
                    optionItem.appendChild(label);
                    optionsList.appendChild(optionItem);
                });

                questionBlock.appendChild(optionsList);
                questionArea.appendChild(questionBlock);
            });

            translatePage(lang); // Translate after rendering
        }

         function displayResults(score, passed) {
             const resultsArea = document.getElementById('results-area');
             const lang = getStoredLanguage();
             resultsArea.innerHTML = ''; // Clear previous results
             resultsArea.style.display = 'block';
             resultsArea.dataset.score = score; // Store score for re-translation

             const headerKey = passed ? "results_pass_header" : "results_fail_header";
             const resultHeader = document.createElement('p');
             resultHeader.innerHTML = `<strong>${getTranslation(headerKey, lang)}</strong>`;

             const scoreText = document.createElement('p');
             scoreText.classList.add('score');
             scoreText.textContent = `${getTranslation("results_score_label", lang)} ${score} / ${TOTAL_QUESTIONS}`;

             resultsArea.appendChild(resultHeader);
             resultsArea.appendChild(scoreText);

             resultsArea.className = passed ? 'pass-message' : 'fail-message'; // Base class for styling

             if (passed) {
                 const savedText = document.createElement('p');
                 savedText.classList.add('progress-saved');
                 savedText.textContent = getTranslation("results_progress_saved", lang);
                 resultsArea.appendChild(savedText);
             } else {
                 const tryAgainText = document.createElement('p');
                 tryAgainText.textContent = getTranslation("results_try_again", lang);
                 resultsArea.appendChild(tryAgainText);
             }

             // Scroll to results
             resultsArea.scrollIntoView({ behavior: 'smooth', block: 'center' });
         }

         function handleSubmit(event) {
             event.preventDefault();
             const questions = quizData[MODULE_ID];
             let score = 0;
             let allAnswered = true;

             // Clear previous feedback
             document.querySelectorAll('.question-block').forEach(qb => qb.classList.remove('answered', 'correct', 'incorrect'));
             document.querySelectorAll('.option-item').forEach(oi => oi.classList.remove('correct-answer', 'incorrect-answer'));

             questions.forEach((q, index) => {
                 const questionBlock = document.getElementById(`question-${index}`);
                 const selectedOptionInput = document.querySelector(`input[name="question_${index}"]:checked`);

                 if (selectedOptionInput) {
                     const selectedAnswerIndex = parseInt(selectedOptionInput.value, 10);
                     const correctAnswerIndex = q.correctAnswerIndex;
                     const options = questionBlock.querySelectorAll('.option-item');

                     questionBlock.classList.add('answered');

                     if (selectedAnswerIndex === correctAnswerIndex) {
                         score++;
                         options[selectedAnswerIndex].classList.add('correct-answer');
                         questionBlock.classList.add('correct');
                     } else {
                         options[selectedAnswerIndex].classList.add('incorrect-answer');
                         options[correctAnswerIndex].classList.add('correct-answer'); // Show the correct one too
                         questionBlock.classList.add('incorrect');
                     }
                 } else {
                     allAnswered = false; // Mark if any question is unanswered
                 }
             });

              if (!allAnswered) {
                  // Optionally, add a message prompting the user to answer all questions
                  // For now, we'll just calculate based on answered questions, but feedback could be added
                  console.warn("Not all questions answered.");
              }

             const passed = score >= PASS_SCORE;

             if (passed) {
                 const knowledgeCheckStatus = loadKnowledgeCheckStatus();
                 knowledgeCheckStatus[MODULE_ID] = true;
                 saveKnowledgeCheckStatus(knowledgeCheckStatus);
             }

              displayResults(score, passed);

             // Disable submit button after submission? Or allow re-submitting to check changes?
             // Let's allow resubmission for immediate feedback on changes.
             // const submitButton = document.getElementById('submit-quiz');
             // submitButton.disabled = true;
         }


        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            const initialLang = getStoredLanguage();

            // Set initial language selector value
            const languageSelectElement = document.getElementById('languageSelect');
            if (languageSelectElement) {
                languageSelectElement.value = initialLang;
                languageSelectElement.addEventListener('change', (e) => {
                    setLanguage(e.target.value);
                });
            }

            renderQuiz(); // Render based on initial language

            const form = document.getElementById('knowledge-check-form');
            form.addEventListener('submit', handleSubmit);
        });

    </script>

</body>
</html>

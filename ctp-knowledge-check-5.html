<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="page_title">Knowledge Check: Module 5</title>
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Base Styles & Variables (Copied from Dashboard, slightly adapted) --- */
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-page: #f0f2f5;
            --background-card: #ffffff;
            --text-light: #f8f9fa;
            --text-dark: #343a40;
            --text-muted: #6c757d;
            --success-color: #198754;
            --error-color: #dc3545;
            --info-color: #0dcaf0;
            --check-color: #6f42c1; /* Used for progress/pass */
            --border-color: #dee2e6;
            --border-radius: 8px;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
             /* Colors for lang switcher */
             --lang-select-border: var(--check-color);
             --lang-select-bg: var(--background-card);
             --lang-option-bg: var(--background-card);
             --lang-option-text: var(--text-dark);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.6;
            background-color: var(--background-page); color: var(--text-dark);
            padding-bottom: 4rem; /* Ensure space for content */
        }

        /* --- Knowledge Check Header --- */
        .kc-header {
            background: linear-gradient(135deg, #0d6efd, #0a58ca);
            color: var(--text-light);
            padding: 1.5rem 1.5rem;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .kc-header h1 {
            font-family: var(--font-title);
            font-size: 1.8rem;
            margin: 0;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
        }
         .kc-header .header-controls {
             display: flex;
             align-items: center;
             gap: 1rem;
         }
        .return-button {
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            background-color: rgba(255, 255, 255, 0.15);
            color: var(--text-light);
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 5px;
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: background-color var(--transition-speed);
        }
        .return-button i { margin-right: 6px; }
        .return-button:hover { background-color: rgba(255, 255, 255, 0.25); }

        /* Language Switcher Styles */
         .language-switcher select {
            background: var(--lang-select-bg);
            color: var(--text-dark);
            border: 1px solid var(--lang-select-border);
            border-radius: 5px;
            padding: 8px 30px 8px 12px; /* Adjusted padding */
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            appearance: none; -webkit-appearance: none; -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23${encodeURIComponent(getComputedStyle(document.documentElement).getPropertyValue('--check-color').trim().substring(1))}%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 8px auto;
            transition: border-color 0.3s ease;
            min-width: 120px; /* Ensure enough width */
         }
         .language-switcher select:hover { border-color: var(--primary-color); }
         .language-switcher select:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25); }
         .language-switcher option {
              background: var(--lang-option-bg);
              color: var(--lang-option-text);
              padding: 5px;
         }

        /* --- Main Quiz Container --- */
        .kc-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background-color: var(--background-card);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
        }

        /* --- Intro & Status Messages --- */
        .quiz-intro, #results-area, #already-passed-message {
            margin-bottom: 1.5rem;
            padding: 1rem 1.5rem;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            background-color: #f8f9fa; /* Light background for emphasis */
        }
        .quiz-intro p, #results-area p, #already-passed-message p {
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }
        .quiz-intro strong, #results-area strong, #already-passed-message strong {
            font-weight: 500;
            color: var(--text-dark);
        }
        #already-passed-message {
            background-color: #e2f0e8; /* Light green */
            border-color: var(--success-color);
            color: #146c43;
        }
        #already-passed-message strong { color: var(--success-color); }

        /* --- Question Styling --- */
        .question-block {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background-color: #fff;
            counter-increment: question-counter; /* For numbering */
        }
        .question-block:last-of-type { margin-bottom: 1.5rem; }

        .question-text {
            font-weight: 500;
            margin-bottom: 1rem;
            color: var(--text-dark);
            font-size: 1.05rem;
            display: flex; /* Use flex for numbering */
            align-items: baseline;
        }
         /* Add question number automatically */
        .question-text::before {
            content: counter(question-counter) ". ";
            font-weight: 700;
            color: var(--primary-color);
            margin-right: 8px;
            min-width: 20px; /* Ensure space */
        }
        .question-text code {
             font-size: 0.95em;
             background: #e9ecef;
             padding: 2px 5px;
             border-radius: 4px;
             color: #c7254e;
             font-family: monospace;
        }

        .options { display: flex; flex-direction: column; gap: 0.8rem; }
        .options label {
            display: block;
            padding: 0.8rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            cursor: pointer;
            transition: background-color var(--transition-speed), border-color var(--transition-speed);
            font-size: 0.95rem;
        }
        .options label:hover { background-color: #f8f9fa; }
        .options input[type="radio"] { margin-right: 10px; vertical-align: middle; }
        .options .option-text code { /* Style code within options */
             font-size: 0.9em;
             background: #e9ecef;
             padding: 1px 4px;
             border-radius: 3px;
             color: #c7254e;
             font-family: monospace;
        }

        /* --- Submit & Retry Buttons --- */
        #submit-button, #retry-button {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-light);
            background-color: var(--primary-color);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color var(--transition-speed);
            text-align: center;
        }
        #submit-button:hover, #retry-button:hover { background-color: #0b5ed7; }
        #submit-button:disabled { background-color: var(--secondary-color); cursor: not-allowed; }
        #retry-button { background-color: var(--secondary-color); margin-top: 1rem;}
        #retry-button:hover { background-color: #5a6268;}

        /* --- Results Area Styling --- */
        #results-area { display: none; } /* Hidden by default */
        #results-area.pass {
            background-color: #d1e7dd; /* Lighter green for pass */
            border-color: var(--success-color);
        }
        #results-area.fail {
            background-color: #f8d7da; /* Lighter red for fail */
            border-color: var(--error-color);
        }
        #results-area .result-title {
            font-family: var(--font-title);
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
        }
        #results-area.pass .result-title { color: var(--success-color); }
        #results-area.fail .result-title { color: var(--error-color); }

        /* --- Footer --- */
        footer {
            text-align: center;
            padding: 1.5rem;
            margin-top: 3rem;
            background-color: var(--background-card);
            border-top: 1px solid var(--border-color);
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* --- Responsive --- */
        @media (max-width: 768px) {
            html { font-size: 15px; }
            .kc-header { flex-direction: column; gap: 1rem; text-align: center; }
            .kc-header h1 { font-size: 1.6rem; }
            .kc-container { padding: 1.5rem; }
            .question-block { padding: 1rem; }
        }
        @media (max-width: 576px) {
            html { font-size: 14px; }
            .kc-header { padding: 1rem; }
            .kc-header h1 { font-size: 1.4rem; }
            .kc-header .header-controls { flex-direction: column; gap: 0.8rem; width: 100%; }
            .return-button { width: 100%; justify-content: center; }
            .language-switcher select { width: 100%; }
            .kc-container { padding: 1rem; }
            .quiz-intro, #results-area, #already-passed-message { padding: 0.8rem 1rem; }
            .options label { padding: 0.6rem 0.8rem; }
            #submit-button, #retry-button { width: 100%; }
        }

    </style>
</head>
<body>

    <header class="kc-header">
        <h1><i class="fas fa-check-double" style="color: var(--check-color);"></i> <span data-translate="header_title">Module 5 Check</span></h1>
        <div class="header-controls">
             <a href="ctp-dashboard.html" class="return-button">
                 <i class="fas fa-arrow-left"></i> <span data-translate="return_button">Return to Dashboard</span>
             </a>
            <div class="language-switcher">
                <select id="languageSelect" data-translate-aria-label="lang_select_aria" aria-label="Select Language">
                    <option value="en" data-translate="lang_en">ð¬ð§ English</option>
                    <option value="pt" data-translate="lang_pt">ð§ð· PortuguÃªs</option>
                    <option value="zh" data-translate="lang_zh">ð¨ð³ ä¸­æ</option>
                </select>
            </div>
        </div>
    </header>

    <main class="kc-container">

        <div class="quiz-intro">
            <p><strong data-translate="intro_title">Knowledge Check: Comparisons & Booleans</strong></p>
            <p data-translate="intro_instructions">Answer the following 10 questions. You need to answer at least <strong>6</strong> questions correctly to pass this check.</p>
            <p data-translate="intro_attempts">You can attempt this check as many times as you need.</p>
        </div>

        <div id="already-passed-message" style="display: none;">
            <p><i class="fas fa-check-circle" style="color: var(--success-color);"></i> <strong data-translate="passed_already_title">Already Passed!</strong></p>
            <p data-translate="passed_already_text">You have already successfully completed this knowledge check. Your progress has been saved.</p>
        </div>

        <form id="quiz-form">
            <!-- Questions will be dynamically generated here by JavaScript -->
        </form>

        <button type="submit" id="submit-button" form="quiz-form" data-translate="submit_button">Submit Answers</button>

        <div id="results-area">
             <h2 class="result-title" data-translate="results_title_placeholder">Results</h2>
             <p id="result-score-text" data-translate="results_score_placeholder">Your score: 0 / 10</p>
             <p id="result-message-text" data-translate="results_message_placeholder">Result message goes here.</p>
             <button type="button" id="retry-button" style="display: none;" data-translate="retry_button">Retry Quiz</button>
        </div>

    </main>

    <footer>
        <p data-translate="footer_text">Module 5 Knowledge Check - Road to Free Open AGI</p>
    </footer>

    <script>
        const MODULE_ID = 5; // Crucial: This identifies the module for progress tracking
        const TOTAL_QUESTIONS = 10;
        const PASS_SCORE = 6;
        const KNOWLEDGE_CHECK_STORAGE_KEY = 'knowledgeCheckStatus_v1';
        const LANGUAGE_STORAGE_KEY = 'userLanguage';

        // --- Quiz Questions Data ---
        // Structure: { question_key: "translation_key_for_question", options_key_prefix: "translation_key_prefix_for_options", correct_option_index: 0 }
        // Options will be looked up as `${options_key_prefix}_A`, `${options_key_prefix}_B`, etc.
        const quizData = [
            { question_key: "q5_1_text", options_key_prefix: "q5_1_option", correct_option_index: 1 }, // 5 == 5 -> True
            { question_key: "q5_2_text", options_key_prefix: "q5_2_option", correct_option_index: 0 }, // 10 != 5 -> True
            { question_key: "q5_3_text", options_key_prefix: "q5_3_option", correct_option_index: 0 }, // 7 > 3 -> True
            { question_key: "q5_4_text", options_key_prefix: "q5_4_option", correct_option_index: 1 }, // 4 <= 4 -> True
            { question_key: "q5_5_text", options_key_prefix: "q5_5_option", correct_option_index: 2 }, // 2 >= 8 -> False
            { question_key: "q5_6_text", options_key_prefix: "q5_6_option", correct_option_index: 0 }, // type of True -> bool
            { question_key: "q5_7_text", options_key_prefix: "q5_7_option", correct_option_index: 1 }, // 5 == '5' -> False
            { question_key: "q5_8_text", options_key_prefix: "q5_8_option", correct_option_index: 0 }, // 'apple' < 'banana' -> True
            { question_key: "q5_9_text", options_key_prefix: "q5_9_option", correct_option_index: 1 }, // result of x = 10 > 5 -> True
            { question_key: "q5_10_text", options_key_prefix: "q5_10_option", correct_option_index: 2 }, // not (3 < 1) -> True
        ];

        // --- Translations Object ---
        const translations = {
             en: {
                 "page_title": "Knowledge Check: Module 5 - Comparisons & Booleans",
                 "header_title": "Module 5 Check: Comparisons & Booleans",
                 "return_button": "Return to Dashboard",
                 "lang_select_aria": "Select Language",
                 "lang_en": "ð¬ð§ English", "lang_pt": "ð§ð· PortuguÃªs", "lang_zh": "ð¨ð³ ä¸­æ",
                 "intro_title": "Knowledge Check: Comparisons & Booleans",
                 "intro_instructions": "Answer the following 10 questions. You need to answer at least <strong>6</strong> questions correctly to pass this check.",
                 "intro_attempts": "You can attempt this check as many times as you need.",
                 "passed_already_title": "Already Passed!",
                 "passed_already_text": "You have already successfully completed this knowledge check. Your progress has been saved.",
                 "submit_button": "Submit Answers",
                 "retry_button": "Retry Quiz",
                 "results_title_placeholder": "Results",
                 "results_score_placeholder": "Your score: {score} / {total}",
                 "results_message_pass": "<strong>Congratulations!</strong> You passed the knowledge check for this module.",
                 "results_message_fail": "<strong>Not Quite Yet!</strong> You need 6 correct answers to pass. Feel free to review the material and try again.",
                 "footer_text": "Module 5 Knowledge Check - Road to Free Open AGI",
                 // Questions & Options (Module 5)
                 "q5_1_text": "What is the result of the expression <code>5 == 5</code>?",
                 "q5_1_option_A": "<code>False</code>", "q5_1_option_B": "<code>True</code>", "q5_1_option_C": "<code>5</code>", "q5_1_option_D": "Error",
                 "q5_2_text": "What is the result of the expression <code>10 != 5</code>?",
                 "q5_2_option_A": "<code>True</code>", "q5_2_option_B": "<code>False</code>", "q5_2_option_C": "<code>10</code>", "q5_2_option_D": "<code>5</code>",
                 "q5_3_text": "What is the result of the expression <code>7 > 3</code>?",
                 "q5_3_option_A": "<code>True</code>", "q5_3_option_B": "<code>False</code>", "q5_3_option_C": "<code>7</code>", "q5_3_option_D": "<code>None</code>",
                 "q5_4_text": "What is the result of the expression <code>4 <= 4</code>?",
                 "q5_4_option_A": "<code>False</code>", "q5_4_option_B": "<code>True</code>", "q5_4_option_C": "<code>4</code>", "q5_4_option_D": "An error occurs",
                 "q5_5_text": "What is the result of the expression <code>2 >= 8</code>?",
                 "q5_5_option_A": "<code>2</code>", "q5_5_option_B": "<code>True</code>", "q5_5_option_C": "<code>False</code>", "q5_5_option_D": "<code>8</code>",
                 "q5_6_text": "What is the data type of the value <code>True</code> in Python?",
                 "q5_6_option_A": "<code>bool</code>", "q5_6_option_B": "<code>str</code>", "q5_6_option_C": "<code>int</code>", "q5_6_option_D": "<code>NoneType</code>",
                 "q5_7_text": "What is the result of the expression <code>5 == '5'</code>?",
                 "q5_7_option_A": "<code>True</code>", "q5_7_option_B": "<code>False</code>", "q5_7_option_C": "<code>5</code>", "q5_7_option_D": "TypeError",
                 "q5_8_text": "What is the result of the expression <code>'apple' < 'banana'</code>?",
                 "q5_8_option_A": "<code>True</code>", "q5_8_option_B": "<code>False</code>", "q5_8_option_C": "Alphabetical Error", "q5_8_option_D": "<code>None</code>",
                 "q5_9_text": "Consider the code: <code>x = 10 > 5</code>. What is the value stored in the variable <code>x</code>?",
                 "q5_9_option_A": "<code>10</code>", "q5_9_option_B": "<code>True</code>", "q5_9_option_C": "<code>False</code>", "q5_9_option_D": "<code>5</code>",
                 "q5_10_text": "What is the result of the expression <code>not (3 < 1)</code>?",
                 "q5_10_option_A": "<code>False</code>", "q5_10_option_B": "<code>not True</code>", "q5_10_option_C": "<code>True</code>", "q5_10_option_D": "Error",
             },
             pt: {
                 "page_title": "VerificaÃ§Ã£o de Conhecimento: MÃ³dulo 5 - ComparaÃ§Ãµes e Booleanos",
                 "header_title": "VerificaÃ§Ã£o MÃ³dulo 5: ComparaÃ§Ãµes e Booleanos",
                 "return_button": "Voltar ao Painel",
                 "lang_select_aria": "Selecionar Idioma",
                 "lang_en": "ð¬ð§ English", "lang_pt": "ð§ð· PortuguÃªs", "lang_zh": "ð¨ð³ ä¸­æ",
                 "intro_title": "VerificaÃ§Ã£o de Conhecimento: ComparaÃ§Ãµes e Booleanos",
                 "intro_instructions": "Responda Ã s 10 perguntas seguintes. VocÃª precisa acertar pelo menos <strong>6</strong> perguntas para passar nesta verificaÃ§Ã£o.",
                 "intro_attempts": "VocÃª pode tentar esta verificaÃ§Ã£o quantas vezes precisar.",
                 "passed_already_title": "JÃ¡ Aprovado!",
                 "passed_already_text": "VocÃª jÃ¡ completou esta verificaÃ§Ã£o de conhecimento com sucesso. Seu progresso foi salvo.",
                 "submit_button": "Enviar Respostas",
                 "retry_button": "Tentar Novamente",
                 "results_title_placeholder": "Resultados",
                 "results_score_placeholder": "Sua pontuaÃ§Ã£o: {score} / {total}",
                 "results_message_pass": "<strong>ParabÃ©ns!</strong> VocÃª passou na verificaÃ§Ã£o de conhecimento para este mÃ³dulo.",
                 "results_message_fail": "<strong>Ainda nÃ£o!</strong> VocÃª precisa de 6 respostas corretas para passar. Sinta-se Ã  vontade para revisar o material e tentar novamente.",
                 "footer_text": "VerificaÃ§Ã£o MÃ³dulo 5 - Road to Free Open AGI",
                 // Questions & Options (Module 5 PT)
                 "q5_1_text": "Qual Ã© o resultado da expressÃ£o <code>5 == 5</code>?",
                 "q5_1_option_A": "<code>False</code>", "q5_1_option_B": "<code>True</code>", "q5_1_option_C": "<code>5</code>", "q5_1_option_D": "Erro",
                 "q5_2_text": "Qual Ã© o resultado da expressÃ£o <code>10 != 5</code>?",
                 "q5_2_option_A": "<code>True</code>", "q5_2_option_B": "<code>False</code>", "q5_2_option_C": "<code>10</code>", "q5_2_option_D": "<code>5</code>",
                 "q5_3_text": "Qual Ã© o resultado da expressÃ£o <code>7 > 3</code>?",
                 "q5_3_option_A": "<code>True</code>", "q5_3_option_B": "<code>False</code>", "q5_3_option_C": "<code>7</code>", "q5_3_option_D": "<code>None</code>",
                 "q5_4_text": "Qual Ã© o resultado da expressÃ£o <code>4 <= 4</code>?",
                 "q5_4_option_A": "<code>False</code>", "q5_4_option_B": "<code>True</code>", "q5_4_option_C": "<code>4</code>", "q5_4_option_D": "Ocorre um erro",
                 "q5_5_text": "Qual Ã© o resultado da expressÃ£o <code>2 >= 8</code>?",
                 "q5_5_option_A": "<code>2</code>", "q5_5_option_B": "<code>True</code>", "q5_5_option_C": "<code>False</code>", "q5_5_option_D": "<code>8</code>",
                 "q5_6_text": "Qual Ã© o tipo de dado do valor <code>True</code> em Python?",
                 "q5_6_option_A": "<code>bool</code>", "q5_6_option_B": "<code>str</code>", "q5_6_option_C": "<code>int</code>", "q5_6_option_D": "<code>NoneType</code>",
                 "q5_7_text": "Qual Ã© o resultado da expressÃ£o <code>5 == '5'</code>?",
                 "q5_7_option_A": "<code>True</code>", "q5_7_option_B": "<code>False</code>", "q5_7_option_C": "<code>5</code>", "q5_7_option_D": "TypeError",
                 "q5_8_text": "Qual Ã© o resultado da expressÃ£o <code>'apple' < 'banana'</code>?",
                 "q5_8_option_A": "<code>True</code>", "q5_8_option_B": "<code>False</code>", "q5_8_option_C": "Erro AlfabÃ©tico", "q5_8_option_D": "<code>None</code>",
                 "q5_9_text": "Considere o cÃ³digo: <code>x = 10 > 5</code>. Qual valor Ã© armazenado na variÃ¡vel <code>x</code>?",
                 "q5_9_option_A": "<code>10</code>", "q5_9_option_B": "<code>True</code>", "q5_9_option_C": "<code>False</code>", "q5_9_option_D": "<code>5</code>",
                 "q5_10_text": "Qual Ã© o resultado da expressÃ£o <code>not (3 < 1)</code>?",
                 "q5_10_option_A": "<code>False</code>", "q5_10_option_B": "<code>not True</code>", "q5_10_option_C": "<code>True</code>", "q5_10_option_D": "Erro",
            },
            zh: {
                 "page_title": "ç¥è¯æµéªï¼æ¨¡å 5 - æ¯è¾ä¸å¸å°å¼",
                 "header_title": "æ¨¡å 5 æµéªï¼æ¯è¾ä¸å¸å°å¼",
                 "return_button": "è¿åä»ªè¡¨æ¿",
                 "lang_select_aria": "éæ©è¯­è¨",
                 "lang_en": "ð¬ð§ English", "lang_pt": "ð§ð· PortuguÃªs", "lang_zh": "ð¨ð³ ä¸­æ",
                 "intro_title": "ç¥è¯æµéªï¼æ¯è¾ä¸å¸å°å¼",
                 "intro_instructions": "åç­ä»¥ä¸ 10 ä¸ªé®é¢ãæ¨éè¦è³å°ç­å¯¹ <strong>6</strong> é¢æè½éè¿æ­¤æµéªã",
                 "intro_attempts": "æ¨å¯ä»¥æ ¹æ®éè¦å°è¯å¤æ¬¡ã",
                 "passed_already_title": "å·²éè¿ï¼",
                 "passed_already_text": "æ¨å·²æåå®ææ­¤ç¥è¯æµéªãæ¨çè¿åº¦å·²ä¿å­ã",
                 "submit_button": "æäº¤ç­æ¡",
                 "retry_button": "éæ°æµéª",
                 "results_title_placeholder": "ç»æ",
                 "results_score_placeholder": "æ¨çå¾åï¼{score} / {total}",
                 "results_message_pass": "<strong>æ­åï¼</strong> æ¨éè¿äºæ¬æ¨¡åçç¥è¯æµéªã",
                 "results_message_fail": "<strong>è¿å·®ä¸ç¹ï¼</strong> æ¨éè¦ç­å¯¹ 6 é¢æè½éè¿ãè¯·éæ¶å¤ä¹ ææå¹¶éè¯ã",
                 "footer_text": "æ¨¡å 5 ç¥è¯æµéª - éå¾èªç±å¼æ¾AGIä¹è·¯",
                 // Questions & Options (Module 5 ZH)
                 "q5_1_text": "è¡¨è¾¾å¼ <code>5 == 5</code> çç»ææ¯ä»ä¹ï¼",
                 "q5_1_option_A": "<code>False</code>", "q5_1_option_B": "<code>True</code>", "q5_1_option_C": "<code>5</code>", "q5_1_option_D": "éè¯¯",
                 "q5_2_text": "è¡¨è¾¾å¼ <code>10 != 5</code> çç»ææ¯ä»ä¹ï¼",
                 "q5_2_option_A": "<code>True</code>", "q5_2_option_B": "<code>False</code>", "q5_2_option_C": "<code>10</code>", "q5_2_option_D": "<code>5</code>",
                 "q5_3_text": "è¡¨è¾¾å¼ <code>7 > 3</code> çç»ææ¯ä»ä¹ï¼",
                 "q5_3_option_A": "<code>True</code>", "q5_3_option_B": "<code>False</code>", "q5_3_option_C": "<code>7</code>", "q5_3_option_D": "<code>None</code>",
                 "q5_4_text": "è¡¨è¾¾å¼ <code>4 <= 4</code> çç»ææ¯ä»ä¹ï¼",
                 "q5_4_option_A": "<code>False</code>", "q5_4_option_B": "<code>True</code>", "q5_4_option_C": "<code>4</code>", "q5_4_option_D": "åçéè¯¯",
                 "q5_5_text": "è¡¨è¾¾å¼ <code>2 >= 8</code> çç»ææ¯ä»ä¹ï¼",
                 "q5_5_option_A": "<code>2</code>", "q5_5_option_B": "<code>True</code>", "q5_5_option_C": "<code>False</code>", "q5_5_option_D": "<code>8</code>",
                 "q5_6_text": "å¨ Python ä¸­ï¼å¼ <code>True</code> çæ°æ®ç±»åæ¯ä»ä¹ï¼",
                 "q5_6_option_A": "<code>bool</code>", "q5_6_option_B": "<code>str</code>", "q5_6_option_C": "<code>int</code>", "q5_6_option_D": "<code>NoneType</code>",
                 "q5_7_text": "è¡¨è¾¾å¼ <code>5 == '5'</code> çç»ææ¯ä»ä¹ï¼",
                 "q5_7_option_A": "<code>True</code>", "q5_7_option_B": "<code>False</code>", "q5_7_option_C": "<code>5</code>", "q5_7_option_D": "ç±»åéè¯¯ (TypeError)",
                 "q5_8_text": "è¡¨è¾¾å¼ <code>'apple' < 'banana'</code> çç»ææ¯ä»ä¹ï¼",
                 "q5_8_option_A": "<code>True</code>", "q5_8_option_B": "<code>False</code>", "q5_8_option_C": "å­æ¯é¡ºåºéè¯¯", "q5_8_option_D": "<code>None</code>",
                 "q5_9_text": "èèä»£ç ï¼<code>x = 10 > 5</code>ãåé <code>x</code> ä¸­å­å¨çå¼æ¯ä»ä¹ï¼",
                 "q5_9_option_A": "<code>10</code>", "q5_9_option_B": "<code>True</code>", "q5_9_option_C": "<code>False</code>", "q5_9_option_D": "<code>5</code>",
                 "q5_10_text": "è¡¨è¾¾å¼ <code>not (3 < 1)</code> çç»ææ¯ä»ä¹ï¼",
                 "q5_10_option_A": "<code>False</code>", "q5_10_option_B": "<code>not True</code>", "q5_10_option_C": "<code>True</code>", "q5_10_option_D": "éè¯¯",
            }
        };

        // --- DOM Elements ---
        const quizForm = document.getElementById('quiz-form');
        const submitButton = document.getElementById('submit-button');
        const resultsArea = document.getElementById('results-area');
        const resultTitle = resultsArea.querySelector('.result-title');
        const resultScoreText = document.getElementById('result-score-text');
        const resultMessageText = document.getElementById('result-message-text');
        const retryButton = document.getElementById('retry-button');
        const alreadyPassedMessage = document.getElementById('already-passed-message');
        const languageSelect = document.getElementById('languageSelect');

        // --- State ---
        let currentLanguage = 'en';
        let knowledgeCheckStatus = {};

        // --- LocalStorage Functions ---
        function loadKnowledgeCheckStatus() {
            try {
                const storedStatus = localStorage.getItem(KNOWLEDGE_CHECK_STORAGE_KEY);
                const parsed = storedStatus ? JSON.parse(storedStatus) : {};
                // Basic validation: ensure it's an object
                knowledgeCheckStatus = (typeof parsed === 'object' && parsed !== null) ? parsed : {};
            } catch (e) {
                console.error("Error reading KC status from localStorage:", e);
                knowledgeCheckStatus = {};
            }
        }

        function saveKnowledgeCheckStatus() {
            try {
                localStorage.setItem(KNOWLEDGE_CHECK_STORAGE_KEY, JSON.stringify(knowledgeCheckStatus));
            } catch (e) {
                console.error("Error saving KC status to localStorage:", e);
            }
        }

        // --- Translation Functions ---
        function getStoredLanguage() {
            const storedLang = localStorage.getItem(LANGUAGE_STORAGE_KEY);
            if (storedLang && translations[storedLang]) return storedLang;
            // Basic browser language detection (optional fallback)
            const browserLang = navigator.language || navigator.userLanguage;
            if (browserLang.startsWith('pt')) return 'pt';
            if (browserLang.startsWith('zh')) return 'zh';
            return 'en'; // Default
        }

        function setLanguage(lang) {
            if (!translations[lang]) lang = 'en'; // Fallback
            currentLanguage = lang;
            localStorage.setItem(LANGUAGE_STORAGE_KEY, lang);
            document.documentElement.lang = lang;
            languageSelect.value = lang; // Update dropdown
            translatePage(lang);
            renderQuiz(lang); // Re-render quiz content with new language
        }

         function getTranslation(key, lang, replacements = {}) {
             let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`;
             // Handle replacements like {score} and {total}
             for (const placeholder in replacements) {
                 const regex = new RegExp(`\\{${placeholder}\\}`, 'g');
                 text = text.replace(regex, replacements[placeholder]);
             }
             return text;
         }

        function translatePage(lang) {
            document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.getAttribute('data-translate');
                const translation = getTranslation(key, lang);
                // Use innerHTML for elements that might contain <strong> etc.
                if (['intro_instructions', 'results_message_pass', 'results_message_fail', 'passed_already_title', 'passed_already_text'].includes(key)) {
                     el.innerHTML = translation;
                } else if (el.tagName === 'TITLE') {
                     document.title = translation;
                } else {
                     el.textContent = translation;
                }
            });
             document.querySelectorAll('[data-translate-aria-label]').forEach(el => {
                 const key = el.getAttribute('data-translate-aria-label');
                 el.setAttribute('aria-label', getTranslation(key, lang));
             });
             // Translate buttons specifically if needed (if not using data-translate)
             // submitButton.textContent = getTranslation('submit_button', lang);
             // retryButton.textContent = getTranslation('retry_button', lang);
        }

        // --- Quiz Logic ---
        function renderQuiz(lang) {
            quizForm.innerHTML = ''; // Clear previous questions
            quizForm.style.counterReset = 'question-counter'; // Reset numbering for CSS
            quizData.forEach((q, index) => {
                const questionBlock = document.createElement('div');
                questionBlock.className = 'question-block';
                questionBlock.dataset.questionId = index;

                const questionText = document.createElement('p');
                questionText.className = 'question-text';
                // Fetch and set question text using translation key, allow HTML (for <code>)
                questionText.innerHTML = getTranslation(q.question_key, lang);

                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'options';

                ['A', 'B', 'C', 'D'].forEach((optionLetter, optionIndex) => {
                    const optionKey = `${q.options_key_prefix}_${optionLetter}`;
                    const optionText = getTranslation(optionKey, lang);

                    // Only create option if translation exists
                    if (optionText !== `[${optionKey}]`) {
                        const label = document.createElement('label');
                        const input = document.createElement('input');
                        input.type = 'radio';
                        input.name = `q${index}`;
                        input.value = optionIndex; // Store the index (0, 1, 2, or 3)
                        input.required = true; // Make sure an option is selected

                        const span = document.createElement('span');
                        span.className = 'option-text';
                        span.innerHTML = ` ${optionText}`; // Add space, allow HTML

                        label.appendChild(input);
                        label.appendChild(span);
                        optionsDiv.appendChild(label);
                    }
                });

                questionBlock.appendChild(questionText);
                questionBlock.appendChild(optionsDiv);
                quizForm.appendChild(questionBlock);
            });
        }

        function checkAnswers() {
            let score = 0;
            const selectedAnswers = quizForm.querySelectorAll('input[type="radio"]:checked');

            if (selectedAnswers.length < TOTAL_QUESTIONS) {
                // Optional: Add validation feedback - alert or inline message
                alert('Please answer all questions before submitting.'); // Simple alert, improve as needed
                return;
            }


            selectedAnswers.forEach(input => {
                const questionIndex = parseInt(input.name.substring(1), 10); // Get index from name="qX"
                const selectedOptionIndex = parseInt(input.value, 10);
                if (quizData[questionIndex].correct_option_index === selectedOptionIndex) {
                    score++;
                }
            });

            showResults(score);
        }

        function showResults(score) {
            const passed = score >= PASS_SCORE;

            // Update progress in localStorage if passed
            if (passed) {
                knowledgeCheckStatus[MODULE_ID] = true; // Mark module 5 as complete
                saveKnowledgeCheckStatus();
            }

            // Display results
            resultsArea.style.display = 'block';
            quizForm.style.display = 'none'; // Hide questions
            submitButton.style.display = 'none'; // Hide submit button

            resultScoreText.textContent = getTranslation('results_score_placeholder', currentLanguage, { score: score, total: TOTAL_QUESTIONS });
            resultTitle.textContent = getTranslation('results_title_placeholder', currentLanguage); // Basic "Results" title

            if (passed) {
                resultsArea.className = 'pass'; // Add 'pass' class for styling
                 resultMessageText.innerHTML = getTranslation('results_message_pass', currentLanguage);
                retryButton.style.display = 'none'; // No need to retry if passed
            } else {
                resultsArea.className = 'fail'; // Add 'fail' class for styling
                 resultMessageText.innerHTML = getTranslation('results_message_fail', currentLanguage);
                retryButton.style.display = 'inline-block'; // Show retry button
            }

             // Scroll to results
             resultsArea.scrollIntoView({ behavior: 'smooth' });
        }

        function retryQuiz() {
            resultsArea.style.display = 'none';
            resultsArea.className = ''; // Reset pass/fail class
            retryButton.style.display = 'none';
            quizForm.style.display = 'block';
            submitButton.style.display = 'inline-block';
            quizForm.reset(); // Clear selected radio buttons
            // Scroll back to top (optional)
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function checkInitialStatus() {
            loadKnowledgeCheckStatus();
            if (knowledgeCheckStatus[MODULE_ID] === true) {
                alreadyPassedMessage.style.display = 'block';
                quizForm.style.display = 'none';
                submitButton.style.display = 'none';
                 document.querySelector('.quiz-intro').style.display = 'none'; // Hide instructions if already passed
            } else {
                alreadyPassedMessage.style.display = 'none';
                quizForm.style.display = 'block';
                submitButton.style.display = 'inline-block';
                document.querySelector('.quiz-intro').style.display = 'block';
            }
        }

        // --- Event Listeners ---
        quizForm.addEventListener('submit', (event) => {
            event.preventDefault(); // Prevent default form submission
            checkAnswers();
        });

        retryButton.addEventListener('click', retryQuiz);

        languageSelect.addEventListener('change', (e) => {
            setLanguage(e.target.value);
        });

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            const initialLang = getStoredLanguage();
            setLanguage(initialLang); // Set language, translate, and render quiz
            checkInitialStatus(); // Check if already passed and update UI accordingly
        });

    </script>

</body>
</html>

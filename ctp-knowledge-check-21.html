<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="page_title">Knowledge Check: Module 21</title>
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Base Styles & Variables (Same as ctp-dashboard.html) --- */
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-page: #f0f2f5;
            --background-card: #ffffff;
            --text-light: #f8f9fa;
            --text-dark: #343a40;
            --text-muted: #6c757d;
            --accent-color: #ffc107;
            --success-color: #198754;
            --error-color: #dc3545;
            --info-color: #0dcaf0;
            --check-color: #6f42c1; /* Used for KC */
            --border-color: #dee2e6;
            --border-radius: 8px;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
            /* Add other variables if needed from dashboard */
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.6;
            background-color: var(--background-page); color: var(--text-dark);
            padding-top: 80px; /* Space for fixed header */
        }

        /* --- Quiz Header --- */
        .quiz-header {
            position: fixed; /* Make header fixed */
            top: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(135deg, #0d6efd, #0a58ca); /* Same as dashboard header */
            color: var(--text-light);
            padding: 1rem 1.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 100;
            display: flex;
            align-items: center;
        }
        .return-link {
            color: var(--text-light);
            text-decoration: none;
            font-size: 1.1rem;
            margin-right: 1.5rem;
            padding: 0.3rem 0.6rem;
            border: 1px solid rgba(255,255,255,0.5);
            border-radius: 5px;
            transition: background-color var(--transition-speed), border-color var(--transition-speed);
        }
        .return-link:hover {
            background-color: rgba(255,255,255,0.1);
            border-color: var(--text-light);
        }
        .return-link i { margin-right: 5px; }
        .quiz-header h1 {
            font-family: var(--font-title);
            font-size: 1.6rem; /* Slightly smaller than dashboard title */
            margin: 0;
            flex-grow: 1; /* Take remaining space */
            text-align: center; /* Center title */
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
        }

        /* --- Quiz Container & Content --- */
        .quiz-container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 2rem;
            background-color: var(--background-card);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
        }
        .quiz-intro {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
            font-size: 1rem;
            color: var(--text-muted);
        }
        .quiz-intro strong { color: var(--text-dark); }
        .quiz-intro i { color: var(--check-color); }

        /* --- Question Styling --- */
        .question-block {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px dashed var(--border-color);
        }
        .question-block:last-of-type {
            margin-bottom: 0;
            border-bottom: none;
            padding-bottom: 0;
        }
        .question-block h4 {
            font-size: 1.15rem;
            font-weight: 500;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }
        .question-block h4 .q-number {
            display: inline-block;
            background-color: var(--primary-color);
            color: var(--text-light);
            border-radius: 50%;
            width: 28px;
            height: 28px;
            line-height: 28px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: bold;
            margin-right: 10px;
        }
        .question-block code {
             font-size: 0.95em; background: #e9ecef; padding: 2px 5px; border-radius: 4px; color: #c7254e; font-family: monospace;
        }

        /* --- Options Styling --- */
        .options { display: flex; flex-direction: column; gap: 0.75rem; }
        .options label {
            display: flex; /* Use flex for alignment */
            align-items: center; /* Align radio button and text */
            background-color: #f8f9fa;
            padding: 0.8rem 1rem;
            border-radius: 6px;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: background-color var(--transition-speed), border-color var(--transition-speed);
            position: relative; /* For feedback icons */
            overflow: hidden; /* Contain feedback ripple */
        }
        .options label:hover { background-color: #e9ecef; border-color: #adb5bd; }
        .options input[type="radio"] { margin-right: 10px; accent-color: var(--primary-color); width: 18px; height: 18px; flex-shrink: 0;}
        .options span { flex-grow: 1; line-height: 1.4;}

        /* Feedback Styles (Applied after submission) */
        .options label.correct {
            background-color: #d1e7dd; /* Light green */
            border-color: var(--success-color);
            color: var(--success-color);
            font-weight: 500;
        }
        .options label.incorrect {
            background-color: #f8d7da; /* Light red */
            border-color: var(--error-color);
            color: var(--error-color);
        }
        .options label.correct::after,
        .options label.incorrect::after {
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.1rem;
        }
        .options label.correct::after { content: '\f00c'; } /* check */
        .options label.incorrect::after { content: '\f00d'; } /* times */
        /* Hide radio buttons when showing feedback? Maybe not necessary */
        form[data-submitted="true"] .options input[type="radio"] {
            /* appearance: none; - Optional: hide radios after submit */
        }

        /* --- Submit & Retake Buttons --- */
        .submit-button, .retake-button {
            display: block;
            width: 100%;
            max-width: 250px;
            margin: 2.5rem auto 0 auto;
            padding: 0.8rem 1rem;
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--text-light);
            background-color: var(--check-color);
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color var(--transition-speed), transform var(--transition-speed);
            text-align: center;
        }
        .submit-button:hover, .retake-button:hover {
            background-color: #5a349b; /* Darker purple */
            transform: translateY(-2px);
        }
        .submit-button:disabled {
            background-color: var(--secondary-color);
            cursor: not-allowed;
            transform: none;
        }

        /* --- Results Area --- */
        #results-area {
            margin-top: 2.5rem;
            padding: 1.5rem 2rem;
            border-radius: var(--border-radius);
            text-align: center;
            border: 2px solid; /* Border color set by class */
        }
        #results-area.result-pass {
            background-color: #e6f9ee;
            border-color: var(--success-color);
            color: var(--success-color);
        }
        #results-area.result-fail {
            background-color: #feedf0;
            border-color: var(--error-color);
            color: var(--error-color);
        }
        #results-area h3 {
            font-family: var(--font-title);
            font-size: 1.6rem;
            margin-bottom: 0.5rem;
        }
        #results-area p {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 1.5rem;
        }
        #results-area p strong { font-weight: 700; }


        /* --- Footer --- */
        footer { text-align: center; padding: 1.5rem; margin-top: 3rem; background-color: var(--background-card); border-top: 1px solid var(--border-color); color: var(--text-muted); font-size: 0.9rem; }

        /* --- Responsive Adjustments --- */
        @media (max-width: 992px) {
            .quiz-container { margin: 1.5rem auto; padding: 1.5rem; }
            .quiz-header h1 { font-size: 1.4rem; }
            .return-link { font-size: 1rem; margin-right: 1rem; }
        }
        @media (max-width: 768px) {
            body { padding-top: 70px; }
            .quiz-header { padding: 0.8rem 1rem; }
            .quiz-header h1 { font-size: 1.3rem; text-align: left; padding-left: 10px; }
            .return-link { font-size: 0.9rem; padding: 0.2rem 0.5rem; }
            .quiz-container { margin: 1rem; padding: 1rem; }
            .quiz-intro { font-size: 0.95rem; }
            .question-block h4 { font-size: 1.05rem; }
            .options label { padding: 0.7rem 0.8rem; }
            .options input[type="radio"] { width: 16px; height: 16px; }
            .submit-button, .retake-button { font-size: 1rem; max-width: 200px; }
             #results-area { padding: 1rem 1.5rem; }
             #results-area h3 { font-size: 1.4rem; }
             #results-area p { font-size: 1rem; }
        }
         @media (max-width: 576px) {
             body { padding-top: 60px; }
             .quiz-header { flex-wrap: wrap; }
             .return-link { order: 1; margin-right: 0; margin-bottom: 5px; } /* Move return link below title maybe? Or keep left */
             .quiz-header h1 { order: 2; width: 100%; text-align: center; padding-left: 0; font-size: 1.2rem; margin-top: 5px;} /* Title below link */
             .question-block h4 .q-number { width: 24px; height: 24px; line-height: 24px; font-size: 0.8rem; margin-right: 8px;}
             .options label { font-size: 0.9rem; }
         }

    </style>
</head>
<body>

    <header class="quiz-header">
        <a href="ctp-dashboard.html" class="return-link" data-translate="return_button">
            <i class="fas fa-arrow-left"></i> Dashboard
        </a>
        <h1 data-translate="header_title">Module 21: Working with Dictionaries</h1>
    </header>

    <div class="quiz-container">
        <div class="quiz-intro">
            <p data-translate="quiz_intro">Test your knowledge! Answer <strong>10 questions</strong>. You need at least <strong>6 correct answers</strong> to pass (<i class="fas fa-check-double"></i>). You can retake the quiz as many times as needed. Good luck!</p>
        </div>

        <form id="quiz-form">

            <!-- Question 1 -->
            <div class="question-block">
                <h4 data-translate="q1_text"><span class="q-number">1</span>Which method is commonly used to iterate over only the keys of a dictionary called `my_dict`?</h4>
                <div class="options">
                    <label> <input type="radio" name="q1" value="a" required> <span data-translate="q1_opt_a"><code>for item in my_dict.items():</code></span> </label>
                    <label> <input type="radio" name="q1" value="b"> <span data-translate="q1_opt_b"><code>for key in my_dict:</code></span> </label>
                    <label> <input type="radio" name="q1" value="c"> <span data-translate="q1_opt_c"><code>for value in my_dict.values():</code></span> </label>
                    <label> <input type="radio" name="q1" value="d"> <span data-translate="q1_opt_d"><code>for index in range(len(my_dict)):</code></span> </label>
                </div>
            </div>

            <!-- Question 2 -->
            <div class="question-block">
                <h4 data-translate="q2_text"><span class="q-number">2</span>How can you get a list of all values from a dictionary `student_grades`?</h4>
                <div class="options">
                    <label> <input type="radio" name="q2" value="a" required> <span data-translate="q2_opt_a"><code>list(student_grades.keys())</code></span> </label>
                    <label> <input type="radio" name="q2" value="b"> <span data-translate="q2_opt_b"><code>student_grades.get_values()</code></span> </label>
                    <label> <input type="radio" name="q2" value="c"> <span data-translate="q2_opt_c"><code>list(student_grades.values())</code></span> </label>
                    <label> <input type="radio" name="q2" value="d"> <span data-translate="q2_opt_d"><code>student_grades[:]</code></span> </label>
                </div>
            </div>

            <!-- Question 3 -->
            <div class="question-block">
                <h4 data-translate="q3_text"><span class="q-number">3</span>What does the `items()` method return when called on a dictionary?</h4>
                <div class="options">
                    <label> <input type="radio" name="q3" value="a" required> <span data-translate="q3_opt_a">A list of keys.</span> </label>
                    <label> <input type="radio" name="q3" value="b"> <span data-translate="q3_opt_b">A list of values.</span> </label>
                    <label> <input type="radio" name="q3" value="c"> <span data-translate="q3_opt_c">A view object containing key-value tuple pairs.</span> </label>
                    <label> <input type="radio" name="q3" value="d"> <span data-translate="q3_opt_d">The dictionary itself.</span> </label>
                </div>
            </div>

            <!-- Question 4 -->
            <div class="question-block">
                <h4 data-translate="q4_text"><span class="q-number">4</span>How do you check if a key named `'city'` exists in a dictionary `user_profile`?</h4>
                <div class="options">
                    <label> <input type="radio" name="q4" value="a" required> <span data-translate="q4_opt_a"><code>'city' in user_profile</code></span> </label>
                    <label> <input type="radio" name="q4" value="b"> <span data-translate="q4_opt_b"><code>user_profile.has_key('city')</code> (Note: Outdated in Python 3)</span> </label>
                    <label> <input type="radio" name="q4" value="c"> <span data-translate="q4_opt_c"><code>user_profile.exists('city')</code></span> </label>
                    <label> <input type="radio" name="q4" value="d"> <span data-translate="q4_opt_d"><code>user_profile['city'] != None</code></span> </label>
                </div>
            </div>

            <!-- Question 5 -->
            <div class="question-block">
                 <h4 data-translate="q5_text"><span class="q-number">5</span>What is the primary purpose of the `del` keyword when used with a dictionary item like `del data['temp']`?</h4>
                <div class="options">
                    <label> <input type="radio" name="q5" value="a" required> <span data-translate="q5_opt_a">To retrieve the value associated with the key `'temp'`.</span> </label>
                    <label> <input type="radio" name="q5" value="b"> <span data-translate="q5_opt_b">To check if the key `'temp'` exists.</span> </label>
                    <label> <input type="radio" name="q5" value="c"> <span data-translate="q5_opt_c">To remove the key-value pair associated with the key `'temp'` from the dictionary.</span> </label>
                    <label> <input type="radio" name="q5" value="d"> <span data-translate="q5_opt_d">To set the value of `'temp'` to `None`.</span> </label>
                </div>
            </div>

            <!-- Question 6 -->
            <div class="question-block">
                 <h4 data-translate="q6_text"><span class="q-number">6</span>Consider `inventory = {'apples': 10, 'bananas': 5}`. What happens if you execute `removed_item = inventory.pop('oranges', 0)`?</h4>
                <div class="options">
                    <label> <input type="radio" name="q6" value="a" required> <span data-translate="q6_opt_a">It raises a `KeyError` because `'oranges'` is not in the dictionary.</span> </label>
                    <label> <input type="radio" name="q6" value="b"> <span data-translate="q6_opt_b">`removed_item` becomes `0`, and the dictionary remains unchanged.</span> </label>
                    <label> <input type="radio" name="q6" value="c"> <span data-translate="q6_opt_c">`removed_item` becomes `None`, and the dictionary remains unchanged.</span> </label>
                    <label> <input type="radio" name="q6" value="d"> <span data-translate="q6_opt_d">It adds `'oranges': 0` to the dictionary.</span> </label>
                </div>
            </div>

             <!-- Question 7 -->
            <div class="question-block">
                 <h4 data-translate="q7_text"><span class="q-number">7</span>Which method allows you to get a value for a key but returns a default value (e.g., `None` or a specified value) if the key is not found, without raising an error?</h4>
                <div class="options">
                    <label> <input type="radio" name="q7" value="a" required> <span data-translate="q7_opt_a"><code>my_dict[key]</code></span> </label>
                    <label> <input type="radio" name="q7" value="b"> <span data-translate="q7_opt_b"><code>my_dict.find(key, default)</code></span> </label>
                    <label> <input type="radio" name="q7" value="c"> <span data-translate="q7_opt_c"><code>my_dict.fetch(key, default)</code></span> </label>
                    <label> <input type="radio" name="q7" value="d"> <span data-translate="q7_opt_d"><code>my_dict.get(key, default)</code></span> </label>
                </div>
            </div>

             <!-- Question 8 -->
            <div class="question-block">
                 <h4 data-translate="q8_text"><span class="q-number">8</span>If you iterate through a dictionary using `for k, v in my_dict.items():`, what do `k` and `v` represent in each iteration?</h4>
                <div class="options">
                    <label> <input type="radio" name="q8" value="a" required> <span data-translate="q8_opt_a">`k` is the index, `v` is the key.</span> </label>
                    <label> <input type="radio" name="q8" value="b"> <span data-translate="q8_opt_b">`k` is the key, `v` is the value.</span> </label>
                    <label> <input type="radio" name="q8" value="c"> <span data-translate="q8_opt_c">`k` is the value, `v` is the key.</span> </label>
                    <label> <input type="radio" name="q8" value="d"> <span data-translate="q8_opt_d">`k` is the key, `v` is the index.</span> </label>
                </div>
            </div>

             <!-- Question 9 -->
            <div class="question-block">
                 <h4 data-translate="q9_text"><span class="q-number">9</span>What is the result of `len({'name': 'Alice', 'age': 30, 'city': 'New York'})`?</h4>
                <div class="options">
                    <label> <input type="radio" name="q9" value="a" required> <span data-translate="q9_opt_a"><code>2</code></span> </label>
                    <label> <input type="radio" name="q9" value="b"> <span data-translate="q9_opt_b"><code>3</code></span> </label>
                    <label> <input type="radio" name="q9" value="c"> <span data-translate="q9_opt_c"><code>6</code></span> </label>
                    <label> <input type="radio" name="q9" value="d"> <span data-translate="q9_opt_d">It raises a `TypeError`.</span> </label>
                </div>
            </div>

             <!-- Question 10 -->
            <div class="question-block">
                 <h4 data-translate="q10_text"><span class="q-number">10</span>Which of the following correctly creates an empty dictionary?</h4>
                <div class="options">
                    <label> <input type="radio" name="q10" value="a" required> <span data-translate="q10_opt_a"><code>my_dict = []</code></span> </label>
                    <label> <input type="radio" name="q10" value="b"> <span data-translate="q10_opt_b"><code>my_dict = ()</code></span> </label>
                    <label> <input type="radio" name="q10" value="c"> <span data-translate="q10_opt_c"><code>my_dict = {}</code> or <code>my_dict = dict()</code></span> </label>
                    <label> <input type="radio" name="q10" value="d"> <span data-translate="q10_opt_d"><code>my_dict = new Dictionary()</code></span> </label>
                </div>
            </div>

            <button type="submit" class="submit-button" data-translate="submit_button">Submit Answers</button>
        </form>

        <div id="results-area" style="display: none;">
            <h3 id="result-title"></h3>
            <p id="result-message"></p>
            <button class="retake-button" data-translate="retake_button">Retake Quiz</button>
        </div>

    </div><!-- /.quiz-container -->

    <footer>
        <p data-translate="footer_text">Part of the Road to Free Open AGI Project</p>
    </footer>

    <script>
        const MODULE_ID = 21; // <<<<<<<<< IMPORTANT: Set Module ID here
        const PASSING_SCORE = 6;
        const KNOWLEDGE_CHECK_STORAGE_KEY = 'knowledgeCheckStatus_v1';
        const LANGUAGE_STORAGE_KEY = 'userLanguage';

        // --- Quiz Data (Correct Answers) ---
        // Matches the 'value' of the correct radio button for each question
        const correctAnswers = {
            q1: 'b', q2: 'c', q3: 'c', q4: 'a', q5: 'c',
            q6: 'b', q7: 'd', q8: 'b', q9: 'b', q10: 'c'
        };

         // --- Translations Object ---
        const translations = {
             en: {
                 "page_title": "Knowledge Check: Module 21 - Working with Dictionaries",
                 "header_title": "Module 21: Working with Dictionaries",
                 "return_button": "Dashboard",
                 "quiz_intro": "Test your knowledge! Answer <strong>10 questions</strong>. You need at least <strong>6 correct answers</strong> to pass (<i class=\"fas fa-check-double\"></i>). You can retake the quiz as many times as needed. Good luck!",
                 "q1_text": "Which method is commonly used to iterate over only the keys of a dictionary called `my_dict`?",
                 "q1_opt_a": "`for item in my_dict.items():`", "q1_opt_b": "`for key in my_dict:`", "q1_opt_c": "`for value in my_dict.values():`", "q1_opt_d": "`for index in range(len(my_dict)):`",
                 "q2_text": "How can you get a list of all values from a dictionary `student_grades`?",
                 "q2_opt_a": "`list(student_grades.keys())`", "q2_opt_b": "`student_grades.get_values()`", "q2_opt_c": "`list(student_grades.values())`", "q2_opt_d": "`student_grades[:]`",
                 "q3_text": "What does the `items()` method return when called on a dictionary?",
                 "q3_opt_a": "A list of keys.", "q3_opt_b": "A list of values.", "q3_opt_c": "A view object containing key-value tuple pairs.", "q3_opt_d": "The dictionary itself.",
                 "q4_text": "How do you check if a key named `'city'` exists in a dictionary `user_profile`?",
                 "q4_opt_a": "`'city' in user_profile`", "q4_opt_b": "`user_profile.has_key('city')` (Note: Outdated in Python 3)", "q4_opt_c": "`user_profile.exists('city')`", "q4_opt_d": "`user_profile['city'] != None`",
                 "q5_text": "What is the primary purpose of the `del` keyword when used with a dictionary item like `del data['temp']`?",
                 "q5_opt_a": "To retrieve the value associated with the key `'temp'`.", "q5_opt_b": "To check if the key `'temp'` exists.", "q5_opt_c": "To remove the key-value pair associated with the key `'temp'` from the dictionary.", "q5_opt_d": "To set the value of `'temp'` to `None`.",
                 "q6_text": "Consider `inventory = {'apples': 10, 'bananas': 5}`. What happens if you execute `removed_item = inventory.pop('oranges', 0)`?",
                 "q6_opt_a": "It raises a `KeyError` because `'oranges'` is not in the dictionary.", "q6_opt_b": "`removed_item` becomes `0`, and the dictionary remains unchanged.", "q6_opt_c": "`removed_item` becomes `None`, and the dictionary remains unchanged.", "q6_opt_d": "It adds `'oranges': 0` to the dictionary.",
                 "q7_text": "Which method allows you to get a value for a key but returns a default value (e.g., `None` or a specified value) if the key is not found, without raising an error?",
                 "q7_opt_a": "`my_dict[key]`", "q7_opt_b": "`my_dict.find(key, default)`", "q7_opt_c": "`my_dict.fetch(key, default)`", "q7_opt_d": "`my_dict.get(key, default)`",
                 "q8_text": "If you iterate through a dictionary using `for k, v in my_dict.items():`, what do `k` and `v` represent in each iteration?",
                 "q8_opt_a": "`k` is the index, `v` is the key.", "q8_opt_b": "`k` is the key, `v` is the value.", "q8_opt_c": "`k` is the value, `v` is the key.", "q8_opt_d": "`k` is the key, `v` is the index.",
                 "q9_text": "What is the result of `len({'name': 'Alice', 'age': 30, 'city': 'New York'})`?",
                 "q9_opt_a": "`2`", "q9_opt_b": "`3`", "q9_opt_c": "`6`", "q9_opt_d": "It raises a `TypeError`.",
                 "q10_text": "Which of the following correctly creates an empty dictionary?",
                 "q10_opt_a": "`my_dict = []`", "q10_opt_b": "`my_dict = ()`", "q10_opt_c": "`my_dict = {}` or `my_dict = dict()`", "q10_opt_d": "`my_dict = new Dictionary()`",
                 "submit_button": "Submit Answers",
                 "results_score": "Your score: <strong>{score}/10</strong>",
                 "results_passed": "Congratulations! You passed! 🎉",
                 "results_failed": "Almost there! Keep trying! 💪",
                 "retake_button": "Retake Quiz",
                 "footer_text": "Part of the Road to Free Open AGI Project"
             },
             pt: {
                 "page_title": "Verificação de Conhecimento: Módulo 21 - Trabalhando com Dicionários",
                 "header_title": "Módulo 21: Trabalhando com Dicionários",
                 "return_button": "Painel",
                 "quiz_intro": "Teste seus conhecimentos! Responda <strong>10 perguntas</strong>. Você precisa de pelo menos <strong>6 respostas corretas</strong> para passar (<i class=\"fas fa-check-double\"></i>). Você pode refazer o teste quantas vezes precisar. Boa sorte!",
                 "q1_text": "Qual método é comumente usado para iterar apenas sobre as chaves de um dicionário chamado `my_dict`?",
                 "q1_opt_a": "`for item in my_dict.items():`", "q1_opt_b": "`for key in my_dict:`", "q1_opt_c": "`for value in my_dict.values():`", "q1_opt_d": "`for index in range(len(my_dict)):`",
                 "q2_text": "Como você pode obter uma lista de todos os valores de um dicionário `student_grades`?",
                 "q2_opt_a": "`list(student_grades.keys())`", "q2_opt_b": "`student_grades.get_values()`", "q2_opt_c": "`list(student_grades.values())`", "q2_opt_d": "`student_grades[:]`",
                 "q3_text": "O que o método `items()` retorna quando chamado em um dicionário?",
                 "q3_opt_a": "Uma lista de chaves.", "q3_opt_b": "Uma lista de valores.", "q3_opt_c": "Um objeto de visualização contendo pares de tuplas chave-valor.", "q3_opt_d": "O próprio dicionário.",
                 "q4_text": "Como você verifica se uma chave chamada `'city'` existe em um dicionário `user_profile`?",
                 "q4_opt_a": "`'city' in user_profile`", "q4_opt_b": "`user_profile.has_key('city')` (Obs: Obsoleto no Python 3)", "q4_opt_c": "`user_profile.exists('city')`", "q4_opt_d": "`user_profile['city'] != None`",
                 "q5_text": "Qual é o propósito principal da palavra-chave `del` quando usada com um item de dicionário como `del data['temp']`?",
                 "q5_opt_a": "Recuperar o valor associado à chave `'temp'`.", "q5_opt_b": "Verificar se a chave `'temp'` existe.", "q5_opt_c": "Remover o par chave-valor associado à chave `'temp'` do dicionário.", "q5_opt_d": "Definir o valor de `'temp'` como `None`.",
                 "q6_text": "Considere `inventory = {'apples': 10, 'bananas': 5}`. O que acontece se você executar `removed_item = inventory.pop('oranges', 0)`?",
                 "q6_opt_a": "Levanta um `KeyError` porque `'oranges'` não está no dicionário.", "q6_opt_b": "`removed_item` torna-se `0`, e o dicionário permanece inalterado.", "q6_opt_c": "`removed_item` torna-se `None`, e o dicionário permanece inalterado.", "q6_opt_d": "Adiciona `'oranges': 0` ao dicionário.",
                 "q7_text": "Qual método permite obter um valor para uma chave, mas retorna um valor padrão (ex: `None` ou um valor especificado) se a chave não for encontrada, sem levantar um erro?",
                 "q7_opt_a": "`my_dict[key]`", "q7_opt_b": "`my_dict.find(key, default)`", "q7_opt_c": "`my_dict.fetch(key, default)`", "q7_opt_d": "`my_dict.get(key, default)`",
                 "q8_text": "Se você iterar por um dicionário usando `for k, v in my_dict.items():`, o que `k` e `v` representam em cada iteração?",
                 "q8_opt_a": "`k` é o índice, `v` é a chave.", "q8_opt_b": "`k` é a chave, `v` é o valor.", "q8_opt_c": "`k` é o valor, `v` é a chave.", "q8_opt_d": "`k` é a chave, `v` é o índice.",
                 "q9_text": "Qual é o resultado de `len({'name': 'Alice', 'age': 30, 'city': 'New York'})`?",
                 "q9_opt_a": "`2`", "q9_opt_b": "`3`", "q9_opt_c": "`6`", "q9_opt_d": "Levanta um `TypeError`.",
                 "q10_text": "Qual das seguintes opções cria corretamente um dicionário vazio?",
                 "q10_opt_a": "`my_dict = []`", "q10_opt_b": "`my_dict = ()`", "q10_opt_c": "`my_dict = {}` ou `my_dict = dict()`", "q10_opt_d": "`my_dict = new Dictionary()`",
                 "submit_button": "Enviar Respostas",
                 "results_score": "Sua pontuação: <strong>{score}/10</strong>",
                 "results_passed": "Parabéns! Você passou! 🎉",
                 "results_failed": "Quase lá! Continue tentando! 💪",
                 "retake_button": "Refazer Teste",
                 "footer_text": "Parte do Projeto Road to Free Open AGI"
             },
             zh: {
                 "page_title": "知识测验：模块 21 - 使用字典",
                 "header_title": "模块 21: 使用字典",
                 "return_button": "仪表板",
                 "quiz_intro": "测试您的知识！回答 <strong>10 个问题</strong>。您需要至少答对 <strong>6 题</strong> 才能通过 (<i class=\"fas fa-check-double\"></i>)。您可以根据需要多次重考。祝您好运！",
                 "q1_text": "通常使用哪种方法仅迭代名为 `my_dict` 的字典的键？",
                 "q1_opt_a": "`for item in my_dict.items():`", "q1_opt_b": "`for key in my_dict:`", "q1_opt_c": "`for value in my_dict.values():`", "q1_opt_d": "`for index in range(len(my_dict)):`",
                 "q2_text": "如何从字典 `student_grades` 获取所有值的列表？",
                 "q2_opt_a": "`list(student_grades.keys())`", "q2_opt_b": "`student_grades.get_values()`", "q2_opt_c": "`list(student_grades.values())`", "q2_opt_d": "`student_grades[:]`",
                 "q3_text": "在字典上调用 `items()` 方法会返回什么？",
                 "q3_opt_a": "键的列表。", "q3_opt_b": "值的列表。", "q3_opt_c": "包含键值元组对的视图对象。", "q3_opt_d": "字典本身。",
                 "q4_text": "如何检查名为 `'city'` 的键是否存在于字典 `user_profile` 中？",
                 "q4_opt_a": "`'city' in user_profile`", "q4_opt_b": "`user_profile.has_key('city')` (注意：Python 3 中已过时)", "q4_opt_c": "`user_profile.exists('city')`", "q4_opt_d": "`user_profile['city'] != None`",
                 "q5_text": "当与字典项（如 `del data['temp']`）一起使用时，`del` 关键字的主要目的是什么？",
                 "q5_opt_a": "检索与键 `'temp'` 关联的值。", "q5_opt_b": "检查键 `'temp'` 是否存在。", "q5_opt_c": "从字典中删除与键 `'temp'` 关联的键值对。", "q5_opt_d": "将 `'temp'` 的值设置为 `None`。",
                 "q6_text": "考虑 `inventory = {'apples': 10, 'bananas': 5}`。如果执行 `removed_item = inventory.pop('oranges', 0)` 会发生什么？",
                 "q6_opt_a": "引发 `KeyError`，因为 `'oranges'` 不在字典中。", "q6_opt_b": "`removed_item` 变为 `0`，字典保持不变。", "q6_opt_c": "`removed_item` 变为 `None`，字典保持不变。", "q6_opt_d": "它将 `'oranges': 0` 添加到字典中。",
                 "q7_text": "哪种方法允许您获取键的值，但如果找不到键，则返回默认值（例如 `None` 或指定值），而不会引发错误？",
                 "q7_opt_a": "`my_dict[key]`", "q7_opt_b": "`my_dict.find(key, default)`", "q7_opt_c": "`my_dict.fetch(key, default)`", "q7_opt_d": "`my_dict.get(key, default)`",
                 "q8_text": "如果使用 `for k, v in my_dict.items():` 迭代字典，`k` 和 `v` 在每次迭代中代表什么？",
                 "q8_opt_a": "`k` 是索引，`v` 是键。", "q8_opt_b": "`k` 是键，`v` 是值。", "q8_opt_c": "`k` 是值，`v` 是键。", "q8_opt_d": "`k` 是键，`v` 是索引。",
                 "q9_text": "`len({'name': 'Alice', 'age': 30, 'city': 'New York'})` 的结果是什么？",
                 "q9_opt_a": "`2`", "q9_opt_b": "`3`", "q9_opt_c": "`6`", "q9_opt_d": "引发 `TypeError`。",
                 "q10_text": "以下哪项正确创建了一个空字典？",
                 "q10_opt_a": "`my_dict = []`", "q10_opt_b": "`my_dict = ()`", "q10_opt_c": "`my_dict = {}` 或 `my_dict = dict()`", "q10_opt_d": "`my_dict = new Dictionary()`",
                 "submit_button": "提交答案",
                 "results_score": "您的分数：<strong>{score}/10</strong>",
                 "results_passed": "恭喜！您通过了！🎉",
                 "results_failed": "就差一点！继续努力！💪",
                 "retake_button": "重新测验",
                 "footer_text": "通往自由开放AGI之路项目的一部分"
             }
         };

        // --- Utility Functions ---
        function getStoredLanguage() { const storedLang = localStorage.getItem(LANGUAGE_STORAGE_KEY); return storedLang && translations[storedLang] ? storedLang : 'en'; }
        function getTranslation(key, lang, replacements = {}) { let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`; for (const placeholder in replacements) { const regex = new RegExp(`\\{${placeholder}\\}`, 'g'); text = text.replace(regex, replacements[placeholder]); } return text; }
        function translatePage(lang) { if (!translations[lang]) lang = 'en'; document.documentElement.lang = lang; document.querySelectorAll('[data-translate]').forEach(el => { const key = el.getAttribute('data-translate'); const translation = getTranslation(key, lang); if (el.tagName === 'TITLE') { document.title = translation; } else if (translation.includes('<') && translation.includes('>')) { el.innerHTML = translation; } else { el.textContent = translation; } }); document.querySelectorAll('[data-translate-placeholder]').forEach(el => { const key = el.getAttribute('data-translate-placeholder'); el.setAttribute('placeholder', getTranslation(key, lang)); }); document.querySelectorAll('[data-translate-aria-label]').forEach(el => { const key = el.getAttribute('data-translate-aria-label'); el.setAttribute('aria-label', getTranslation(key, lang)); }); }
        function loadKnowledgeCheckStatus() { try { const storedStatus = localStorage.getItem(KNOWLEDGE_CHECK_STORAGE_KEY); const parsed = storedStatus ? JSON.parse(storedStatus) : {}; return typeof parsed === 'object' && parsed !== null ? parsed : {}; } catch (e) { console.error("Error reading KC status from localStorage:", e); return {}; } }
        function saveKnowledgeCheckStatus(moduleId, passed) { try { const currentStatus = loadKnowledgeCheckStatus(); currentStatus[moduleId] = passed; localStorage.setItem(KNOWLEDGE_CHECK_STORAGE_KEY, JSON.stringify(currentStatus)); } catch (e) { console.error("Error saving KC status to localStorage:", e); } }

        // --- Quiz Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const quizForm = document.getElementById('quiz-form');
            const resultsArea = document.getElementById('results-area');
            const resultTitle = document.getElementById('result-title');
            const resultMessage = document.getElementById('result-message');
            const retakeButton = resultsArea.querySelector('.retake-button');
            const submitButton = quizForm.querySelector('.submit-button');

            function handleSubmit(event) {
                event.preventDefault();
                submitButton.disabled = true;
                quizForm.dataset.submitted = 'true'; // Mark form as submitted

                let score = 0;
                const formData = new FormData(quizForm);
                const userAnswers = {};

                // Disable all inputs after submission
                quizForm.querySelectorAll('input[type="radio"]').forEach(input => {
                    input.disabled = true;
                });

                for (const [question, correctAnswer] of Object.entries(correctAnswers)) {
                    const userAnswer = formData.get(question);
                    userAnswers[question] = userAnswer; // Store user's answer
                    if (userAnswer === correctAnswer) {
                        score++;
                    }
                }

                const passed = score >= PASSING_SCORE;
                displayResults(score, passed);
                showFeedback(userAnswers);

                if (passed) {
                    saveKnowledgeCheckStatus(MODULE_ID, true);
                     // Optional: Trigger an event or update UI elsewhere if needed immediately
                    console.log(`Module ${MODULE_ID} passed and status saved.`);
                }
            }

            function displayResults(score, passed) {
                const lang = getStoredLanguage();
                resultsArea.style.display = 'block';
                resultsArea.className = passed ? 'result-pass' : 'result-fail'; // Add class for styling
                resultTitle.textContent = getTranslation(passed ? 'results_passed' : 'results_failed', lang);
                resultMessage.innerHTML = getTranslation('results_score', lang, { score: score });
                window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' }); // Scroll to show results
            }

            function showFeedback(userAnswers) {
                quizForm.querySelectorAll('.question-block').forEach((block, index) => {
                    const questionName = `q${index + 1}`;
                    const correctAnswerValue = correctAnswers[questionName];
                    const userAnswerValue = userAnswers[questionName];

                    block.querySelectorAll('.options label').forEach(label => {
                        const radio = label.querySelector('input[type="radio"]');
                        label.classList.remove('correct', 'incorrect'); // Clear previous feedback

                        if (radio.value === correctAnswerValue) {
                            label.classList.add('correct'); // Mark correct answer
                        } else if (radio.value === userAnswerValue && userAnswerValue !== correctAnswerValue) {
                            label.classList.add('incorrect'); // Mark incorrect user choice
                        }
                    });
                });
            }

            function resetQuiz() {
                quizForm.reset();
                resultsArea.style.display = 'none';
                resultsArea.className = ''; // Remove result classes
                submitButton.disabled = false;
                quizForm.dataset.submitted = 'false'; // Unmark form

                // Re-enable inputs and remove feedback classes
                quizForm.querySelectorAll('input[type="radio"]').forEach(input => {
                    input.disabled = false;
                });
                quizForm.querySelectorAll('.options label').forEach(label => {
                    label.classList.remove('correct', 'incorrect');
                });

                window.scrollTo({ top: quizForm.offsetTop - 100, behavior: 'smooth' }); // Scroll back up near the top
            }

            // --- Initial Setup ---
            const currentLang = getStoredLanguage();
            translatePage(currentLang);

            quizForm.addEventListener('submit', handleSubmit);
            retakeButton.addEventListener('click', resetQuiz);

            // --- Optional: Pre-fill if already passed? ---
            // const initialStatus = loadKnowledgeCheckStatus();
            // if (initialStatus[MODULE_ID] === true) {
            //     // Maybe show a "You've already passed" message instead of the form?
            //     // Or just let them retake. Current setup allows retake.
            //     console.log(`Module ${MODULE_ID} already marked as passed.`);
            // }
        });

    </script>

</body>
</html>
<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="page_title">Module 12: Loops - Fixed Times</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Reset & Base Styles --- */
        :root {
            --primary-color: #007bff; /* Blue */
            --secondary-color: #6c757d; /* Grey */
            --background-light: #f8f9fa;
            --background-dark: #343a40;
            --text-light: #f8f9fa;
            --text-dark: #212529;
            --accent-color: #ffc107; /* Yellow */
            --success-color: #28a745; /* Green */
            --error-color: #dc3545; /* Red */
            --loop-color: #fd7e14; /* Orange for loops */
            --ct-color: #6f42c1; /* Purple for CT */
            --border-radius: 8px;
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
            --nav-primary: #6e48aa;
            --nav-success: #4cc9f0;
            --nav-dark: #1a1a2e;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.7;
            background-color: var(--background-light); color: var(--text-dark);
            overflow-x: hidden; display: flex; flex-direction: column; min-height: 100vh;
        }
        main { flex-grow: 1; }

        /* --- Utility Classes --- */
        .container { max-width: 960px; margin: 0 auto; padding: 0 15px; }
        .text-center { text-align: center; }
        .highlight { color: var(--primary-color); font-weight: bold; }
        .loop-highlight { color: var(--loop-color); font-weight: bold; }
        .fade-in { opacity: 0; transform: translateY(20px); animation: fadeInAnimation 0.8s ease-out forwards; }
        .fade-in.delay-1 { animation-delay: 0.2s; }
        .fade-in.delay-2 { animation-delay: 0.4s; }
        .fade-in.delay-3 { animation-delay: 0.6s; }
        .fade-in.delay-4 { animation-delay: 0.8s; }
        .fade-in.delay-5 { animation-delay: 1.0s; }
        .button-group { margin-top: 2rem; display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem; }
        .action-button {
             display: inline-flex; align-items: center; justify-content: center; gap: 0.5em;
             padding: 0.8rem 1.5rem; font-size: 1rem; font-weight: bold; color: var(--text-light);
             background-color: var(--primary-color); border: none; border-radius: var(--border-radius); cursor: pointer;
             transition: background-color var(--transition-speed), transform var(--transition-speed), filter var(--transition-speed), box-shadow var(--transition-speed);
             margin-top: 1rem; box-shadow: 0 2px 5px rgba(0,0,0,0.1); text-decoration: none; line-height: 1.2;
        }
        .action-button:hover:not(:disabled) { background-color: #0056b3; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
        .action-button:disabled { background-color: var(--secondary-color); cursor: not-allowed; transform: none; box-shadow: none; opacity: 0.7; }
        .action-button.success { background-color: var(--success-color); }
        .action-button.success:hover:not(:disabled) { background-color: #218838; }
        .action-button.secondary { background-color: var(--secondary-color); }
        .action-button.secondary:hover:not(:disabled) { background-color: #5a6268; }
        .action-button:active:not(:disabled) { transform: translateY(1px) scale(0.98); filter: brightness(0.95); }

        /* --- Animations --- */
        @keyframes fadeInAnimation { to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 5px rgba(0, 123, 255, 0.3); }
            50% { transform: scale(1.03); box-shadow: 0 0 15px rgba(0, 123, 255, 0.6); }
            100% { transform: scale(1); box-shadow: 0 0 5px rgba(0, 123, 255, 0.3); }
        }
        @keyframes code-line-anim { from { width: 0; opacity: 0; } to { width: 100%; opacity: 1; } }
        @keyframes tada {
          from { transform: scale3d(1, 1, 1); } 10%, 20% { transform: scale3d(.9, .9, .9) rotate3d(0, 0, 1, -3deg); }
          30%, 50%, 70%, 90% { transform: scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, 3deg); } 40%, 60%, 80% { transform: scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, -3deg); }
          to { transform: scale3d(1, 1, 1); }
        }
        .tada-anim { animation: tada 1s ease; }
        @keyframes shake {
          10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); }
          30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        @keyframes iconAppearCorrect {
            0% { transform: scale(0.5) rotate(-15deg); opacity: 0; }
            60% { transform: scale(1.2) rotate(5deg); opacity: 1; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
        @keyframes outputLineAppear { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }

        /* --- Minimal Retractable Nav --- */
        .minimal-nav-button {
            position: fixed; top: 15px; right: 15px; z-index: 1001; background-color: rgba(52, 58, 64, 0.75);
            color: var(--text-light); border: none; border-radius: var(--border-radius); padding: 8px 12px;
            cursor: pointer; transition: background-color var(--transition-speed), opacity var(--transition-speed), transform var(--transition-speed);
            font-size: 1.1rem; opacity: 0.6; box-shadow: 0 2px 5px rgba(0,0,0,0.2); line-height: 1;
        }
        .minimal-nav-button:hover { background-color: rgba(52, 58, 64, 0.95); opacity: 1; transform: scale(1.05); }
        .minimal-nav {
            position: fixed; top: 60px; right: 15px; z-index: 1000; background-color: var(--background-dark);
            border-radius: var(--border-radius); box-shadow: 0 5px 15px rgba(0,0,0,0.3); padding: 0.8rem;
            opacity: 0; transform: translateY(-15px) scale(0.95); transform-origin: top right; pointer-events: none;
            transition: opacity var(--transition-speed) ease, transform var(--transition-speed) ease; min-width: 200px;
        }
        body.nav-active .minimal-nav { opacity: 1; transform: translateY(0) scale(1); pointer-events: auto; }
        .minimal-nav ul { list-style: none; margin: 0; padding: 0; }
        .minimal-nav ul li { margin-bottom: 5px; }
        .minimal-nav ul li:last-child { margin-bottom: 0; }
        .minimal-nav ul li a {
            display: flex; align-items: center; color: var(--text-light); text-decoration: none; padding: 0.6rem 1rem;
            border-radius: 4px; transition: background-color var(--transition-speed), color var(--transition-speed);
            white-space: nowrap; font-weight: 400; font-size: 0.95rem;
        }
        .minimal-nav ul li a i.fas { margin-right: 10px; width: 1.2em; text-align: center; opacity: 0.8; transition: opacity var(--transition-speed); }
        .minimal-nav ul li a:hover { background-color: var(--loop-color); color: var(--text-light); } /* Loop color hover */
        .minimal-nav ul li a:hover i.fas { opacity: 1; }
        .minimal-nav .language-switcher-item { padding: 0.5rem 1rem; border-top: 1px solid var(--secondary-color); margin-top: 8px; padding-top: 13px; }
        #languageSelect {
            width: 100%; background: rgba(255,255,255,0.1); color: white; border: 1px solid var(--nav-success);
            border-radius: 5px; padding: 6px 30px 6px 12px; cursor: pointer; font-size: 0.9rem; appearance: none;
            -webkit-appearance: none; -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%234CC9F0%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat; background-position: right 10px center; background-size: 10px auto;
            transition: background-color 0.3s ease;
        }
        #languageSelect:hover { background-color: rgba(255,255,255,0.15); }
        #languageSelect option { background: var(--nav-dark); color: var(--text-light); }

        /* --- Header (Adapted for Module 12) --- */
        .main-header {
            background: linear-gradient(135deg, var(--loop-color), #c66410); /* Orange gradient */
            color: var(--text-light); padding: 4rem 0 6rem; text-align: center;
            position: relative; overflow: hidden;
        }
        .main-header h1 {
            font-family: var(--font-title); font-size: 3rem; margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3); animation: fadeInAnimation 1s ease-out;
        }
        .main-header p {
            font-size: 1.2rem; font-weight: 300; opacity: 0.9;
            animation: fadeInAnimation 1s ease-out 0.3s forwards; opacity: 0; /* Start hidden */
        }
        /* Decorative shapes */
        .header-shape { position: absolute; border-radius: 50%; background-color: rgba(255, 255, 255, 0.1); animation: pulse 5s infinite ease-in-out alternate; }
        .shape1 { width: 150px; height: 150px; bottom: -50px; left: 10%; animation-duration: 6s; }
        .shape2 { width: 80px; height: 80px; top: 50px; right: 15%; animation-duration: 4s; }
        .shape3 { width: 50px; height: 50px; bottom: 20px; right: 30%; animation-duration: 7s; }

        /* --- Section Styling --- */
        section { padding: 4rem 0; border-bottom: 1px solid #eee; }
        main section:last-of-type { border-bottom: none; }
        section h2 {
            font-family: var(--font-title); font-size: 2.2rem; color: var(--loop-color); /* Loop color for titles */
            margin-bottom: 2rem; text-align: center; position: relative; padding-bottom: 10px;
        }
        section h2::after {
            content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
            width: 60px; height: 4px; background-color: var(--accent-color); border-radius: 2px;
        }

        /* --- Why Loops Section --- */
        #why-loops p { font-size: 1.1rem; max-width: 750px; margin: 0 auto 1rem; text-align: center; }

        /* --- Loop Analogy Section --- */
        #loop-analogy .analogy-container {
            display: flex; align-items: center; justify-content: space-around;
            background-color: #fff; padding: 2rem; border-radius: var(--border-radius);
            box-shadow: 0 5px 15px rgba(0,0,0,0.08); margin-top: 2rem; flex-wrap: wrap; gap: 1rem;
        }
        .analogy-part {
            text-align: center; max-width: 220px; opacity: 0; transform: scale(0.9);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        .analogy-part.visible { opacity: 1; transform: scale(1); }
        .analogy-icon {
            font-size: 3rem; margin-bottom: 1rem; color: var(--loop-color); /* Loop color */
            display: inline-block; transition: transform var(--transition-speed) ease;
        }
        .analogy-part:hover .analogy-icon { transform: scale(1.2) rotate(5deg); }
        .analogy-arrow {
            font-size: 2.5rem; color: var(--secondary-color); opacity: 0;
            transition: opacity 0.5s ease 0.3s; /* Delay arrow fade-in */
        }
        .analogy-arrow.visible { opacity: 0.7; }

        /* --- For Loop Syntax & Range Section --- */
        #for-loop-syntax .syntax-explanation { display: flex; gap: 2rem; align-items: flex-start; margin-top: 2rem; flex-wrap: wrap; }
        .syntax-block {
            flex-basis: 50%; background-color: var(--background-dark); color: #eee;
            padding: 1.5rem; border-radius: var(--border-radius); font-family: 'Courier New', Courier, monospace;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2); font-size: 1.1rem;
        }
        .syntax-block code { display: block; white-space: pre; } /* Ensure formatting */
        .syntax-text { flex-basis: 45%; font-size: 1.05rem; }
        .syntax-text p { margin-bottom: 1.2rem; }
        /* Code Highlighting */
        .code-keyword { color: #569cd6; font-weight: bold; } /* Make keywords bold */
        .code-variable { color: #9cdcfe; }
        .code-function { color: #dcdcaa; }
        .code-number { color: #b5cea8; }
        .code-comment { color: #6a9955; font-style: italic; }
        .code-operator { color: #d4d4d4; }
        .code-paren { color: #ffd700; } /* Gold for parentheses */
        .code-colon { color: #ffd700; } /* Gold for colon */
        .code-string { color: #ce9178; }
        /* Tooltip */
        .code-highlight {
            background-color: rgba(253, 126, 20, 0.15); /* Light orange highlight */
            color: #c66410; padding: 0.2em 0.4em; border-radius: 4px;
            font-family: 'Courier New', Courier, monospace; font-weight: bold;
            cursor: pointer; transition: background-color var(--transition-speed);
            display: inline-block; position: relative;
        }
        .code-highlight:hover { background-color: rgba(253, 126, 20, 0.3); }
        .tooltip {
            visibility: hidden; width: 180px; background-color: var(--background-dark);
            color: var(--text-light); text-align: center; border-radius: 6px; padding: 8px 5px;
            position: absolute; z-index: 1; bottom: 125%; left: 50%; margin-left: -90px; /* Adjust for width */
            opacity: 0; transition: opacity 0.3s; font-family: var(--font-body);
            font-size: 0.9rem; font-weight: normal; pointer-events: none;
        }
        .tooltip::after { /* Arrow */
            content: ""; position: absolute; top: 100%; left: 50%; margin-left: -5px;
            border-width: 5px; border-style: solid; border-color: var(--background-dark) transparent transparent transparent;
        }
        .code-highlight:hover .tooltip { visibility: visible; opacity: 1; }

        /* --- Loop Example Section --- */
        #loop-example .example-container { display: flex; gap: 2rem; align-items: flex-start; margin-top: 2rem; flex-wrap: wrap; }
        .loop-demo {
            flex-basis: 55%; background-color: var(--background-dark); color: #eee;
            padding: 1.5rem; border-radius: var(--border-radius); font-family: 'Courier New', Courier, monospace;
            position: relative; min-height: 200px; box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: flex; flex-direction: column; /* Stack code and output */
        }
        .loop-demo .code-input { margin-bottom: 1rem; }
        .loop-demo .code-input .line { margin-bottom: 0.3rem; }
        .loop-demo .output-area {
            border-top: 1px dashed var(--secondary-color); padding-top: 1rem; margin-top: 1rem;
            min-height: 80px; /* Space for output */
        }
        .loop-demo .code-line-output {
            display: block; /* Each output on new line */
            color: var(--accent-color); font-weight: bold; font-size: 1.1rem;
            margin-bottom: 0.3rem;
            opacity: 0; /* Hidden initially */
            animation: outputLineAppear 0.5s ease forwards;
        }
        .loop-text { flex-basis: 40%; font-size: 1.05rem; }
        .loop-text p { margin-bottom: 1rem; }
        #run-loop-btn {
            background-color: var(--success-color); color: white; margin-top: 0; /* Align with code */
            padding: 0.6rem 1.2rem; font-size: 0.9rem; align-self: flex-start; /* Position button */
        }
         #run-loop-btn:hover { background-color: #218838; }
         #run-loop-btn i { margin-right: 5px; }


        /* --- Computational Thinking Section --- */
        #computational-thinking { background-color: #eef7ff; } /* Light blue background */
        #computational-thinking h2 { color: var(--ct-color); } /* Purple CT title */
        .ct-concepts {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem; margin-top: 2rem;
        }
        .ct-card {
            background-color: #fff; padding: 1.8rem; border-radius: var(--border-radius);
            border-left: 5px solid var(--ct-color); /* Purple accent */
            box-shadow: 0 4px 10px rgba(0,0,0,0.07); text-align: left; /* Align text left */
            opacity: 0; transform: translateY(20px);
            animation: fadeInAnimation 0.6s ease-out forwards;
        }
        .ct-card:nth-child(1) { animation-delay: 0.2s; }
        .ct-card:nth-child(2) { animation-delay: 0.4s; }
        .ct-icon {
            font-size: 2.5rem; margin-bottom: 1rem; color: var(--ct-color);
            float: right; /* Position icon nicely */
            opacity: 0.7;
        }
        .ct-card h3 {
            font-family: var(--font-body); font-weight: 700; font-size: 1.3rem;
            margin-bottom: 0.8rem; color: var(--ct-color); /* Purple heading */
        }
        .ct-card p { font-size: 1rem; color: var(--text-dark); }

        /* --- Knowledge Check Section --- */
        #knowledge-check { background-color: #e9ecef; }
        .quiz-container {
            background-color: #fff; padding: 2rem; border-radius: var(--border-radius);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); max-width: 700px; margin: 2rem auto 0;
        }
        .quiz-question { font-size: 1.2rem; font-weight: bold; margin-bottom: 1.5rem; color: var(--text-dark); }
        .quiz-options button {
            display: block; width: 100%; padding: 1rem; margin-bottom: 1rem; text-align: left;
            font-size: 1rem; background-color: #f8f9fa; border: 1px solid #ced4da;
            border-radius: var(--border-radius); cursor: pointer;
            transition: background-color var(--transition-speed), border-color var(--transition-speed), transform var(--transition-speed);
        }
        .quiz-options button:not(:disabled):hover { background-color: #e2e6ea; border-color: #adb5bd; transform: translateX(5px); }
        .quiz-options button:disabled { cursor: default; opacity: 0.7; }
        .quiz-options button.correct { background-color: #d4edda; border-color: var(--success-color); color: #155724; font-weight: bold; }
        .quiz-options button.incorrect { background-color: #f8d7da; border-color: var(--error-color); color: #721c24; font-weight: bold; }
        .quiz-options button.incorrect.shake { animation: shake 0.5s ease; } /* Apply shake only when class added */
        .quiz-feedback {
            margin-top: 1.5rem; padding: 1rem; border-radius: var(--border-radius);
            font-weight: bold; text-align: center; opacity: 0; transition: opacity 0.5s ease;
            height: 0; overflow: hidden;
        }
        .quiz-feedback.visible { opacity: 1; height: auto; margin-bottom: 1rem; }
        .quiz-feedback.correct { background-color: #d4edda; color: #155724; }
        .quiz-feedback.incorrect { background-color: #f8d7da; color: #721c24; }
        #next-question-btn {
            display: inline-flex; align-items: center; justify-content: center; gap: 0.5em;
            margin: 1.5rem auto 0; padding: 0.8rem 1.5rem; font-size: 1rem;
            font-weight: bold; color: var(--text-light); background-color: var(--primary-color);
            border: none; border-radius: var(--border-radius); cursor: pointer;
            transition: background-color var(--transition-speed), transform var(--transition-speed), opacity 0.3s, visibility 0.3s;
            opacity: 0; visibility: hidden;
        }
        #next-question-btn:hover { background-color: #0056b3; transform: scale(1.05); }
        #next-question-btn.visible { opacity: 1; visibility: visible; }

        /* --- Completion Section Styling --- */
        .completion-section { padding: 4rem 0; text-align: center; background-color: var(--background-light); }
        .completion-section .icon {
            font-size: 4rem; color: var(--success-color); margin-bottom: 1rem; display: inline-block;
            opacity: 0; animation: iconAppearCorrect 1s ease-out 0.5s forwards;
        }
        .completion-section .icon .fas + .fas { margin-left: 0.75rem; }
        .completion-section h2 {
            font-family: var(--font-title); font-size: 2.2rem; color: var(--primary-color); /* Back to primary color */
            margin-bottom: 1rem;
        }
        .completion-section h2::after { display: none; } /* Remove underline */
        .completion-section p {
            font-size: 1.1rem; margin-top: 1rem; color: var(--secondary-color);
            max-width: 700px; margin-left: auto; margin-right: auto; line-height: 1.8;
        }
        .completion-section .button-group { margin-top: 2.5rem; }

        /* --- Footer - REMOVED --- */

        /* --- Responsive Design --- */
        @media (max-width: 768px) {
            html { font-size: 15px; }
            .main-header h1 { font-size: 2.5rem; }
            .main-header p { font-size: 1.1rem; }
            section h2 { font-size: 1.8rem; }
            .minimal-nav { min-width: 180px; }
            .minimal-nav ul li a { padding: 0.6rem 0.8rem; }
            #languageSelect { font-size: 0.85rem; padding: 5px 25px 5px 10px;}
            /* New sections responsive */
            .analogy-container { flex-direction: column; gap: 1.5rem; }
            .analogy-arrow { transform: rotate(90deg); margin: 1rem 0; }
            .syntax-explanation, .example-container { flex-direction: column; }
            .syntax-block, .syntax-text, .loop-demo, .loop-text { flex-basis: 100%; }
            .ct-concepts { grid-template-columns: 1fr; }
            /* Completion Section Adjustments */
             .completion-section h2 { font-size: 2rem; }
             .completion-section .button-group { flex-direction: column; align-items: center; gap: 0.8rem; }
             .completion-section .action-button { width: 80%; max-width: 350px; margin-top: 0; }
        }
        @media (max-width: 480px) {
            html { font-size: 14px; }
            .main-header h1 { font-size: 2rem; }
            .main-header p { font-size: 1rem; }
            section h2 { font-size: 1.6rem; }
            .quiz-options button { padding: 0.8rem; font-size: 0.95rem; }
            .tooltip { width: 140px; margin-left: -70px; font-size: 0.8rem;}
             /* Nav Adjustments */
             .minimal-nav-button { top: 10px; right: 10px; padding: 6px 10px; font-size: 1rem; }
             .minimal-nav { top: 48px; right: 10px; min-width: 160px; }
             .minimal-nav ul li a { padding: 0.5rem 0.7rem; font-size: 0.9rem;}
             .minimal-nav ul li a i.fas { margin-right: 8px; }
             #languageSelect { font-size: 0.8rem; padding: 4px 20px 4px 8px;}
             /* Completion Section Adjustments */
             .completion-section .icon { font-size: 3.5rem; }
             .completion-section h2 { font-size: 1.8rem; }
             .completion-section p { font-size: 1rem; }
             .completion-section .action-button { width: 90%; max-width: 300px; }
        }
    </style>
</head>
<body>

    <!-- ========= Minimal Nav Handle ========= -->
    <button id="minimal-nav-toggle" class="minimal-nav-button" aria-label="Toggle Navigation Menu">
        <i class="fas fa-bars"></i>
    </button>

    <!-- ========= Minimal Nav Panel (Adapted for Module 12) ========= -->
    <nav id="minimal-nav-panel" class="minimal-nav">
        <ul>
            <!-- Links to OTHER main pages (Updated for M12) -->
            <li><a href="ctp-practice-12.html"><i class="fas fa-pencil-alt fa-fw"></i> <span data-translate="nav_practice">Start Practice</span></a></li>
            <li><a href="ctp-advanced-12.html"><i class="fas fa-flask fa-fw"></i> <span data-translate="nav_advanced">Advanced Practice</span></a></li>
            <li><a href="ctp-dashboard.html"><i class="fas fa-list fa-fw"></i> <span data-translate="nav_menu">Course Menu</span></a></li>
             <hr style="border: none; border-top: 1px solid var(--secondary-color); margin: 8px 0;">
             <!-- Links to sections on THIS page -->
             <li><a href="#why-loops"><i class="fas fa-redo fa-fw"></i> <span data-translate="nav_why_loops">Why Loops?</span></a></li>
             <li><a href="#loop-analogy"><i class="fas fa-robot fa-fw"></i> <span data-translate="nav_analogy">Loop Analogy</span></a></li>
             <li><a href="#for-loop-syntax"><i class="fas fa-code fa-fw"></i> <span data-translate="nav_syntax">Syntax & Range</span></a></li>
             <li><a href="#loop-example"><i class="fas fa-play-circle fa-fw"></i> <span data-translate="nav_example">Example</span></a></li>
             <li><a href="#computational-thinking"><i class="fas fa-brain fa-fw"></i> <span data-translate="nav_ct">Comp. Thinking</span></a></li>
             <li><a href="#knowledge-check"><i class="fas fa-check-double fa-fw"></i> <span data-translate="nav_quiz">Knowledge Check</span></a></li>
            <!-- Language Switcher Item -->
            <li class="language-switcher-item">
                 <select id="languageSelect" aria-label="Select Language">
                     <option value="en" data-translate="lang_en">üá¨üáß English</option>
                     <option value="pt" data-translate="lang_pt">üáßüá∑ Portugu√™s</option>
                     <option value="zh" data-translate="lang_zh">üá®üá≥ ‰∏≠Êñá</option>
                 </select>
            </li>
        </ul>
    </nav>

    <!-- ========= Header (Adapted for Module 12) ========= -->
    <header class="main-header">
        <div class="header-shape shape1"></div>
        <div class="header-shape shape2"></div>
        <div class="header-shape shape3"></div>
        <div class="container">
            <h1 data-translate="header_title">Module 12: Repeating Actions (Loops)</h1>
            <p data-translate="header_subtitle">Learn how to make the computer perform tasks multiple times with `for` loops!</p>
        </div>
    </header>

    <main>
        <!-- ========= Why Loops Section ========= -->
        <section id="why-loops">
            <div class="container">
                <h2 class="fade-in" data-translate="why_loops_title">üîÅ Why Repeat Ourselves?</h2>
                <p class="fade-in delay-1" data-translate="why_loops_p1">
                    Imagine you need to greet 5 friends online. Writing <code>print("Hello!")</code> five times works, but what if it's 100 friends? That's tedious and error-prone!
                </p>
                <p class="fade-in delay-2" data-translate="why_loops_p2">
                    Programming gives us <span class="loop-highlight">loops</span> to handle repetitive tasks efficiently. We tell the computer <span class="highlight">what</span> to do and <span class="highlight">how many times</span> to do it.
                </p>
            </div>
        </section>

        <!-- ========= Loop Analogy Section ========= -->
        <section id="loop-analogy">
            <div class="container">
                <h2 class="fade-in" data-translate="analogy_title">‚öôÔ∏è The Robot Task Analogy</h2>
                <p class="text-center fade-in delay-1" data-translate="analogy_subtitle">Think of a `for` loop like instructing a robot:</p>

                <div class="analogy-container fade-in delay-2">
                     <!-- JS adds 'visible' class on scroll -->
                    <div class="analogy-part">
                        <span class="analogy-icon">ü§ñ</span>
                        <h3 data-translate="analogy_robot_title">The Robot (Computer)</h3>
                        <p data-translate="analogy_robot_text">Ready to follow instructions.</p>
                    </div>
                    <div class="analogy-arrow">‚û°Ô∏è</div>
                    <div class="analogy-part">
                        <span class="analogy-icon">üìù</span>
                        <h3 data-translate="analogy_instruction_title">The Instruction (`for` loop)</h3>
                        <p data-translate="analogy_instruction_text">"Repeat the 'Package Item' task <span class="loop-highlight">5</span> times."</p>
                    </div>
                     <div class="analogy-arrow">‚û°Ô∏è</div>
                    <div class="analogy-part">
                        <span class="analogy-icon">üì¶</span>
                        <h3 data-translate="analogy_action_title">The Action (Code inside loop)</h3>
                        <p data-translate="analogy_action_text">Robot packages 5 items, one after the other.</p>
                    </div>
                </div>
                 <p class="text-center fade-in delay-3" style="margin-top: 2rem;" data-translate="analogy_conclusion">The `for` loop automates the repetition for us!</p>
            </div>
        </section>

        <!-- ========= For Loop Syntax & Range Section ========= -->
        <section id="for-loop-syntax">
             <div class="container">
                 <h2 class="fade-in" data-translate="syntax_title">üêç The `for` loop with `range()`</h2>
                 <p class="text-center fade-in delay-1" data-translate="syntax_subtitle">This is how we tell Python to repeat something a specific number of times.</p>

                 <div class="syntax-explanation fade-in delay-2">
                     <div class="syntax-block">
                        <code><span class="code-keyword" data-translate-tooltip="tooltip_for">for</span> <span class="code-variable" data-translate-tooltip="tooltip_variable">i</span> <span class="code-keyword" data-translate-tooltip="tooltip_in">in</span> <span class="code-function" data-translate-tooltip="tooltip_range">range</span><span class="code-paren">(</span><span class="code-number" data-translate-tooltip="tooltip_number">5</span><span class="code-paren">)</span><span class="code-colon" data-translate-tooltip="tooltip_colon">:</span>
    <span class="code-comment" data-translate="syntax_comment"># Code to repeat goes here</span>
    <span class="code-function">print</span><span class="code-paren">(</span><span class="code-variable">i</span><span class="code-paren">)</span> <span class="code-comment"># Example: Print the current count</span></code>
                        <!-- Tooltip spans will be added/populated by JS if needed -->
                     </div>
                     <div class="syntax-text fade-in delay-3">
                         <p data-translate="syntax_text_p1">
                             <!-- Content set by JS translate function -->
                         </p>
                         <p data-translate="syntax_text_p2">
                             <!-- Content set by JS translate function -->
                         </p>
                          <p data-translate="syntax_text_p3">
                             <!-- Content set by JS translate function -->
                         </p>
                     </div>
                 </div>
             </div>
        </section>

         <!-- ========= Loop Example Section ========= -->
        <section id="loop-example">
             <div class="container">
                 <h2 class="fade-in" data-translate="example_title">üöÄ Let's See it in Action!</h2>
                 <p class="text-center fade-in delay-1" data-translate="example_subtitle">This code will demonstrate a simple loop.</p>

                 <div class="example-container fade-in delay-2">
                     <div class="loop-demo">
                         <div class="code-input">
                             <div class="line"><span class="code-keyword">for</span> <span class="code-variable">count</span> <span class="code-keyword">in</span> <span class="code-function" data-translate-tooltip="tooltip_example_range">range</span><span class="code-paren">(</span><span class="code-number">3</span><span class="code-paren">)</span><span class="code-colon">:</span></div>
                             <div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-function">print</span><span class="code-paren">(</span><span class="code-string">"Repeating..."</span><span class="code-paren">)</span></div>
                             <div class="line"><span class="code-function" data-translate-tooltip="tooltip_example_done">print</span><span class="code-paren">(</span><span class="code-string">"Done!"</span><span class="code-paren">)</span> <span class="code-comment"># Outside the loop</span></div>
                         </div>
                         <button id="run-loop-btn" class="action-button"><i class="fas fa-play"></i> <span data-translate="run_button">Run Code</span></button>
                         <div class="output-area">
                             <!-- Output will appear here via JS -->
                         </div>
                     </div>
                     <div class="loop-text fade-in delay-3">
                         <p data-translate="example_text_p1">
                             <!-- Content set by JS translate function -->
                         </p>
                         <p data-translate="example_text_p2">
                             <!-- Content set by JS translate function -->
                         </p>
                         <p data-translate="example_text_p3">
                             <!-- Content set by JS translate function -->
                         </p>
                     </div>
                 </div>
             </div>
        </section>

        <!-- ========= Computational Thinking Section ========= -->
        <section id="computational-thinking">
            <div class="container">
                <h2 class="fade-in" data-translate="ct_title">üß† Loops & Computational Thinking</h2>
                <p class="text-center fade-in delay-1" data-translate="ct_subtitle">Using loops strengthens these key skills:</p>
                <div class="ct-concepts">
                    <div class="ct-card fade-in delay-2">
                        <span class="ct-icon"><i class="fas fa-sync-alt"></i></span>
                        <h3 data-translate="ct_iteration_title">Iteration</h3>
                        <p data-translate="ct_iteration_text">This is the core idea of loops ‚Äì repeating a set of instructions multiple times. You define the process once and let the loop handle the repetition.</p>
                    </div>
                    <div class="ct-card fade-in delay-3">
                         <span class="ct-icon"><i class="fas fa-search"></i></span>
                        <h3 data-translate="ct_patterns_title">Pattern Recognition</h3>
                        <p data-translate="ct_patterns_text">Identifying tasks that need repeating is recognizing a pattern. Loops allow you to abstract that pattern into code, making it reusable and efficient.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========= Knowledge Check Section ========= -->
        <section id="knowledge-check">
            <div class="container">
                <h2 class="fade-in" data-translate="quiz_title">üß† Quick Check!</h2>
                <div class="quiz-container fade-in delay-1">
                    <div id="quiz-area">
                        <!-- Quiz questions will be loaded here by JavaScript -->
                    </div>
                    <div id="quiz-feedback" class="quiz-feedback">
                        <!-- Feedback (Correct/Incorrect) shown here -->
                    </div>
                    <button id="next-question-btn" data-translate="quiz_next_button">Next Question</button>
                </div>
            </div>
        </section>

        <!-- ========= Completion Section ========= -->
        <section class="completion-section">
            <div class="container">
                 <div class="icon">
                    <i class="fas fa-check-double"></i>
                    <i class="fas fa-redo"></i>
                    <i class="fas fa-star"></i>
                </div>
                <h2 class="fade-in delay-1" data-translate="completion_theory_title">Module 12 Theory Complete!</h2>
                <p class="fade-in delay-2" data-translate="completion_theory_desc">
                    Awesome! You've learned the basics of fixed repetition using `for` loops. Time to practice! <br>
                    Head to the <strong>Practice Zone</strong> or try the <strong>Advanced Practice</strong> to master loops.
                </p>
                <div class="button-group">
                    <!-- Links updated for Module 12 -->
                    <a href="ctp-dashboard.html" class="action-button secondary fade-in delay-3"><i class="fas fa-list"></i> <span data-translate="nav_menu">Course Menu</span></a>
                    <a href="ctp-practice-12.html" class="action-button success fade-in delay-4"><i class="fas fa-pencil-alt"></i> <span data-translate="nav_practice">Start Practice</span></a>
                    <a href="ctp-advanced-12.html" class="action-button secondary fade-in delay-5"><i class="fas fa-flask"></i> <span data-translate="nav_advanced">Advanced Practice</span></a>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer Removed -->

    <script>
    // --- Translations Object (Adapted for Module 12) ---
    const translations = {
        en: {
            "page_title": "Module 12: Loops - Fixed Times",
            // Nav
            "nav_practice": "Start Practice", "nav_advanced": "Advanced Practice", "nav_menu": "Course Menu",
            "nav_why_loops": "Why Loops?", "nav_analogy": "Loop Analogy", "nav_syntax": "Syntax & Range", "nav_example": "Example", "nav_ct": "Comp. Thinking", "nav_quiz": "Knowledge Check",
            "lang_en": "üá¨üáß English", "lang_pt": "üáßüá∑ Portugu√™s", "lang_zh": "üá®üá≥ ‰∏≠Êñá",
            // Header
            "header_title": "Module 12: Repeating Actions (Loops)", "header_subtitle": "Learn how to make the computer perform tasks multiple times with `for` loops!",
            // Why Loops
            "why_loops_title": "üîÅ Why Repeat Ourselves?",
            "why_loops_p1": "Imagine you need to greet 5 friends online. Writing `print(\"Hello!\")` five times works, but what if it's 100 friends? That's tedious and error-prone!",
            "why_loops_p2": "Programming gives us loops to handle repetitive tasks efficiently. We tell the computer what to do and how many times to do it.",
            // Analogy
            "analogy_title": "‚öôÔ∏è The Robot Task Analogy", "analogy_subtitle": "Think of a `for` loop like instructing a robot:",
            "analogy_robot_title": "The Robot (Computer)", "analogy_robot_text": "Ready to follow instructions.",
            "analogy_instruction_title": "The Instruction (`for` loop)", "analogy_instruction_text": "\"Repeat the 'Package Item' task 5 times.\"",
            "analogy_action_title": "The Action (Code inside loop)", "analogy_action_text": "Robot packages 5 items, one after the other.",
            "analogy_conclusion": "The `for` loop automates the repetition for us!",
            // Syntax & Range
            "syntax_title": "üêç The `for` loop with `range()`", "syntax_subtitle": "This is how we tell Python to repeat something a specific number of times.",
            "syntax_comment": "# Code to repeat goes here",
            "syntax_text_p1": "`for`: Keyword starting the loop.<br><span class=\"code-highlight\" data-translate-tooltip=\"tooltip_variable\">i</span>: A variable that holds the current count (can be any name). It changes each time the loop runs.<br><span class=\"code-highlight\" data-translate-tooltip=\"tooltip_in\">in</span>: Keyword connecting the variable to the sequence.",
            "syntax_text_p2": "<span class=\"code-highlight\" data-translate-tooltip=\"tooltip_range\">range(5)</span>: Creates a sequence of numbers. <span class=\"highlight\">Important:</span> `range(n)` generates numbers from <span class=\"loop-highlight\">0</span> up to (but <span class=\"highlight\">not including</span>) <span class=\"loop-highlight\">n</span>. So, `range(5)` gives: 0, 1, 2, 3, 4.",
            "syntax_text_p3": "<span class=\"code-highlight\" data-translate-tooltip=\"tooltip_colon\">:</span> The colon marks the end of the `for` statement.<br><strong>Indentation:</strong> The code <span class=\"highlight\">inside</span> the loop <span class=\"highlight\">must</span> be indented (usually 4 spaces). This tells Python what to repeat.",
            "tooltip_for": "Starts a 'for' loop, designed for repetition", "tooltip_variable": "Temporary variable holding the current item/count from the sequence (e.g., 0, then 1, then 2...)", "tooltip_in": "Connects the loop variable to the sequence generator",
            "tooltip_range": "Function that generates a sequence of numbers", "tooltip_number": "The 'stop' value. range(n) goes from 0 up to n-1", "tooltip_colon": "Required at the end of the 'for' line, signals the start of the indented block",
            // Example
            "example_title": "üöÄ Let's See it in Action!", "example_subtitle": "This code will demonstrate a simple loop.",
            "run_button": "Run Code",
            "example_text_p1": "Click \"Run Code\". Notice how <code>\"Repeating...\"</code> is printed multiple times?",
            "example_text_p2": "The loop uses <code class=\"code-highlight\" data-translate-tooltip=\"tooltip_example_range\">range(3)</code>, so the indented `print` statement runs 3 times.",
            "example_text_p3": "The final <code class=\"code-highlight\" data-translate-tooltip=\"tooltip_example_done\">print(\"Done!\")</code> is <span class=\"highlight\">not</span> indented, so it's outside the loop and only runs once after the loop completes.",
            "tooltip_example_range": "Generates numbers 0, 1, 2. The loop runs 3 times.", "tooltip_example_done": "This runs only once after the loop finishes because it's not indented.",
            "loop_output_line": "Repeating...", "loop_output_done": "Done!",
            // CT
            "ct_title": "üß† Loops & Computational Thinking", "ct_subtitle": "Using loops strengthens these key skills:",
            "ct_iteration_title": "Iteration", "ct_iteration_text": "This is the core idea of loops ‚Äì repeating a set of instructions multiple times. You define the process once and let the loop handle the repetition.",
            "ct_patterns_title": "Pattern Recognition", "ct_patterns_text": "Identifying tasks that need repeating is recognizing a pattern. Loops allow you to abstract that pattern into code, making it reusable and efficient.",
            // Quiz
            "quiz_title": "üß† Quick Check!", "quiz_next_button": "Next Question",
            "quiz_q1": "What is the main purpose of a `for` loop?",
            "quiz_q1_opt1": "To make decisions in code.", "quiz_q1_opt2": "To store data.", "quiz_q1_opt3": "To repeat a block of code multiple times.", "quiz_q1_opt4": "To define a function.",
            "quiz_q2": "How many times will the code inside this loop run: `for x in range(4):`?",
            "quiz_q2_opt1": "3 times", "quiz_q2_opt2": "4 times", "quiz_q2_opt3": "5 times", "quiz_q2_opt4": "0 times",
            "quiz_q3": "What sequence of numbers does `range(3)` produce for a loop?",
            "quiz_q3_opt1": "1, 2, 3", "quiz_q3_opt2": "0, 1, 2", "quiz_q3_opt3": "0, 1, 2, 3", "quiz_q3_opt4": "3, 2, 1",
            "quiz_q4": "What is essential for the code that should be repeated inside a `for` loop?",
            "quiz_q4_opt1": "It must be written in uppercase.", "quiz_q4_opt2": "It must end with a semicolon.", "quiz_q4_opt3": "It must be indented.", "quiz_q4_opt4": "It must use the `repeat` keyword.",
            "quiz_feedback_correct": "Correct! üéâ", "quiz_feedback_incorrect": "Not quite! The correct answer was: {correctAnswerText}",
            "quiz_final_score_title": "Module 12 Complete!", "quiz_final_score_summary": "You answered {score} out of {total} questions correctly.",
            "quiz_final_score_perfect": "Excellent looping! You've got the hang of `for`.", "quiz_final_score_good": "Good job! Practice makes perfect with loops.",
            // Completion
            "completion_theory_title": "Module 12 Theory Complete!",
            "completion_theory_desc": "Awesome! You've learned the basics of fixed repetition using `for` loops. Time to practice! <br> Head to the <strong>Practice Zone</strong> or try the <strong>Advanced Practice</strong> to master loops.",
        },
        pt: {
            "page_title": "M√≥dulo 12: La√ßos - Vezes Fixas",
            // Nav
            "nav_practice": "Iniciar Pr√°tica", "nav_advanced": "Pr√°tica Avan√ßada", "nav_menu": "Menu do Curso",
            "nav_why_loops": "Por que La√ßos?", "nav_analogy": "Analogia do La√ßo", "nav_syntax": "Sintaxe e Range", "nav_example": "Exemplo", "nav_ct": "Pensamento Comp.", "nav_quiz": "Teste R√°pido",
            "lang_en": "üá¨üáß English", "lang_pt": "üáßüá∑ Portugu√™s", "lang_zh": "üá®üá≥ ‰∏≠Êñá",
             // Header
            "header_title": "M√≥dulo 12: Repetindo A√ß√µes (La√ßos)", "header_subtitle": "Aprenda como fazer o computador realizar tarefas m√∫ltiplas vezes com la√ßos `for`!",
            // Why Loops
            "why_loops_title": "üîÅ Por que nos Repetir?",
            "why_loops_p1": "Imagine que voc√™ precisa cumprimentar 5 amigos online. Escrever `print(\"Ol√°!\")` cinco vezes funciona, mas e se forem 100 amigos? Isso √© tedioso e propenso a erros!",
            "why_loops_p2": "A programa√ß√£o nos d√° la√ßos (loops) para lidar com tarefas repetitivas de forma eficiente. Dizemos ao computador o que fazer e quantas vezes fazer.",
            // Analogy
            "analogy_title": "‚öôÔ∏è A Analogia da Tarefa do Rob√¥", "analogy_subtitle": "Pense em um la√ßo `for` como instruir um rob√¥:",
            "analogy_robot_title": "O Rob√¥ (Computador)", "analogy_robot_text": "Pronto para seguir instru√ß√µes.",
            "analogy_instruction_title": "A Instru√ß√£o (la√ßo `for`)", "analogy_instruction_text": "\"Repita a tarefa 'Empacotar Item' 5 vezes.\"",
            "analogy_action_title": "A A√ß√£o (C√≥digo dentro do la√ßo)", "analogy_action_text": "O rob√¥ empacota 5 itens, um ap√≥s o outro.",
            "analogy_conclusion": "O la√ßo `for` automatiza a repeti√ß√£o para n√≥s!",
            // Syntax & Range
            "syntax_title": "üêç O la√ßo `for` com `range()`", "syntax_subtitle": "√â assim que dizemos ao Python para repetir algo um n√∫mero espec√≠fico de vezes.",
            "syntax_comment": "# C√≥digo a repetir vai aqui",
            "syntax_text_p1": "`for`: Palavra-chave que inicia o la√ßo.<br><span class=\"code-highlight\" data-translate-tooltip=\"tooltip_variable\">i</span>: Uma vari√°vel que guarda a contagem atual (pode ser qualquer nome). Muda a cada vez que o la√ßo roda.<br><span class=\"code-highlight\" data-translate-tooltip=\"tooltip_in\">in</span>: Palavra-chave que conecta a vari√°vel √† sequ√™ncia.",
            "syntax_text_p2": "<span class=\"code-highlight\" data-translate-tooltip=\"tooltip_range\">range(5)</span>: Cria uma sequ√™ncia de n√∫meros. <span class=\"highlight\">Importante:</span> `range(n)` gera n√∫meros de <span class=\"loop-highlight\">0</span> at√© (mas <span class=\"highlight\">n√£o incluindo</span>) <span class=\"loop-highlight\">n</span>. Ent√£o, `range(5)` resulta em: 0, 1, 2, 3, 4.",
            "syntax_text_p3": "<span class=\"code-highlight\" data-translate-tooltip=\"tooltip_colon\">:</span> Os dois pontos marcam o fim da declara√ß√£o `for`.<br><strong>Indenta√ß√£o:</strong> O c√≥digo <span class=\"highlight\">dentro</span> do la√ßo <span class=\"highlight\">deve</span> ser indentado (geralmente 4 espa√ßos). Isso diz ao Python o que repetir.",
            "tooltip_for": "Inicia um la√ßo 'for', projetado para repeti√ß√£o", "tooltip_variable": "Vari√°vel tempor√°ria que cont√©m o item/contagem atual da sequ√™ncia (ex: 0, depois 1, depois 2...)", "tooltip_in": "Conecta a vari√°vel do la√ßo ao gerador de sequ√™ncia",
            "tooltip_range": "Fun√ß√£o que gera uma sequ√™ncia de n√∫meros", "tooltip_number": "O valor de 'parada'. range(n) vai de 0 at√© n-1", "tooltip_colon": "Obrigat√≥rio no final da linha 'for', sinaliza o in√≠cio do bloco indentado",
             // Example
            "example_title": "üöÄ Vamos Ver em A√ß√£o!", "example_subtitle": "Este c√≥digo demonstrar√° um la√ßo simples.",
            "run_button": "Executar C√≥digo",
            "example_text_p1": "Clique em \"Executar C√≥digo\". Note como <code>\"Repeating...\"</code> √© impresso v√°rias vezes?",
            "example_text_p2": "O la√ßo usa <code class=\"code-highlight\" data-translate-tooltip=\"tooltip_example_range\">range(3)</code>, ent√£o a instru√ß√£o `print` indentada executa 3 vezes.",
            "example_text_p3": "O <code class=\"code-highlight\" data-translate-tooltip=\"tooltip_example_done\">print(\"Done!\")</code> final <span class=\"highlight\">n√£o</span> est√° indentado, ent√£o est√° fora do la√ßo e s√≥ executa uma vez ap√≥s o t√©rmino do la√ßo.",
            "tooltip_example_range": "Gera os n√∫meros 0, 1, 2. O la√ßo executa 3 vezes.", "tooltip_example_done": "Isso executa apenas uma vez ap√≥s o fim do la√ßo porque n√£o est√° indentado.",
            "loop_output_line": "Repetindo...", "loop_output_done": "Feito!",
             // CT
            "ct_title": "üß† La√ßos e Pensamento Computacional", "ct_subtitle": "Usar la√ßos fortalece estas habilidades chave:",
            "ct_iteration_title": "Itera√ß√£o", "ct_iteration_text": "Esta √© a ideia central dos la√ßos ‚Äì repetir um conjunto de instru√ß√µes m√∫ltiplas vezes. Voc√™ define o processo uma vez e deixa o la√ßo cuidar da repeti√ß√£o.",
            "ct_patterns_title": "Reconhecimento de Padr√µes", "ct_patterns_text": "Identificar tarefas que precisam ser repetidas √© reconhecer um padr√£o. La√ßos permitem abstrair esse padr√£o em c√≥digo, tornando-o reutiliz√°vel e eficiente.",
            // Quiz
            "quiz_title": "üß† Teste R√°pido!", "quiz_next_button": "Pr√≥xima Pergunta",
            "quiz_q1": "Qual √© o prop√≥sito principal de um la√ßo `for`?",
            "quiz_q1_opt1": "Tomar decis√µes no c√≥digo.", "quiz_q1_opt2": "Armazenar dados.", "quiz_q1_opt3": "Repetir um bloco de c√≥digo m√∫ltiplas vezes.", "quiz_q1_opt4": "Definir uma fun√ß√£o.",
            "quiz_q2": "Quantas vezes o c√≥digo dentro deste la√ßo ser√° executado: `for x in range(4):`?",
            "quiz_q2_opt1": "3 vezes", "quiz_q2_opt2": "4 vezes", "quiz_q2_opt3": "5 vezes", "quiz_q2_opt4": "0 vezes",
            "quiz_q3": "Qual sequ√™ncia de n√∫meros `range(3)` produz para um la√ßo?",
            "quiz_q3_opt1": "1, 2, 3", "quiz_q3_opt2": "0, 1, 2", "quiz_q3_opt3": "0, 1, 2, 3", "quiz_q3_opt4": "3, 2, 1",
            "quiz_q4": "O que √© essencial para o c√≥digo que deve ser repetido dentro de um la√ßo `for`?",
            "quiz_q4_opt1": "Deve ser escrito em mai√∫sculas.", "quiz_q4_opt2": "Deve terminar com ponto e v√≠rgula.", "quiz_q4_opt3": "Deve ser indentado.", "quiz_q4_opt4": "Deve usar a palavra-chave `repeat`.",
            "quiz_feedback_correct": "Correto! üéâ", "quiz_feedback_incorrect": "Quase l√°! A resposta correta era: {correctAnswerText}",
            "quiz_final_score_title": "M√≥dulo 12 Completo!", "quiz_final_score_summary": "Voc√™ respondeu {score} de {total} perguntas corretamente.",
            "quiz_final_score_perfect": "Excelente! Voc√™ dominou o la√ßo `for`.", "quiz_final_score_good": "Bom trabalho! A pr√°tica leva √† perfei√ß√£o com la√ßos.",
             // Completion
            "completion_theory_title": "Teoria do M√≥dulo 12 Completa!",
            "completion_theory_desc": "Incr√≠vel! Voc√™ aprendeu o b√°sico da repeti√ß√£o fixa usando la√ßos `for`. Hora de praticar! <br> V√° para a <strong>Zona de Pr√°tica</strong> ou tente a <strong>Pr√°tica Avan√ßada</strong> para dominar os la√ßos.",
        },
        zh: {
            "page_title": "Ê®°Âùó 12ÔºöÂæ™ÁéØ - Âõ∫ÂÆöÊ¨°Êï∞",
            // Nav
            "nav_practice": "ÂºÄÂßãÁªÉ‰π†", "nav_advanced": "È´òÁ∫ßÁªÉ‰π†", "nav_menu": "ËØæÁ®ãËèúÂçï",
            "nav_why_loops": "‰∏∫‰ΩïÂæ™ÁéØÔºü", "nav_analogy": "Âæ™ÁéØÁ±ªÊØî", "nav_syntax": "ËØ≠Ê≥ï‰∏é Range", "nav_example": "Á§∫‰æã", "nav_ct": "ËÆ°ÁÆóÊÄùÁª¥", "nav_quiz": "Áü•ËØÜÊµãÈ™å",
            "lang_en": "üá¨üáß English", "lang_pt": "üáßüá∑ Portugu√™s", "lang_zh": "üá®üá≥ ‰∏≠Êñá",
             // Header
            "header_title": "Ê®°Âùó 12ÔºöÈáçÂ§çÊìç‰ΩúÔºàÂæ™ÁéØÔºâ", "header_subtitle": "Â≠¶‰π†Â¶Ç‰Ωï‰ΩøÁî® `for` Âæ™ÁéØËÆ©ËÆ°ÁÆóÊú∫Â§öÊ¨°ÊâßË°å‰ªªÂä°ÔºÅ",
            // Why Loops
            "why_loops_title": "üîÅ ‰∏∫‰ªÄ‰πàË¶ÅÈáçÂ§çËá™Â∑±Ôºü",
            "why_loops_p1": "ÊÉ≥Ë±°‰∏Ä‰∏ã‰Ω†ÈúÄË¶ÅÂú®Á∫øÈóÆÂÄô 5 ‰ΩçÊúãÂèã„ÄÇÂÜô‰∫îÊ¨° `print(\"‰Ω†Â•Ω!\")` ÂèØ‰ª•Ôºå‰ΩÜÂ¶ÇÊûúÊòØ 100 ‰∏™ÊúãÂèãÂë¢ÔºüÈÇ£‰ºöÂæàÁπÅÁêê‰∏îÂÆπÊòìÂá∫ÈîôÔºÅ",
            "why_loops_p2": "ÁºñÁ®ãÊèê‰æõ‰∫ÜÂæ™ÁéØÊù•È´òÊïàÂú∞Â§ÑÁêÜÈáçÂ§çÊÄß‰ªªÂä°„ÄÇÊàë‰ª¨ÂëäËØâËÆ°ÁÆóÊú∫Ë¶ÅÂÅö‰ªÄ‰πà‰ª•ÂèäÂÅöÂ§öÂ∞ëÊ¨°„ÄÇ",
            // Analogy
            "analogy_title": "‚öôÔ∏è Êú∫Âô®‰∫∫‰ªªÂä°Á±ªÊØî", "analogy_subtitle": "ÂèØ‰ª•Êää `for` Âæ™ÁéØÊÉ≥Ë±°ÊàêÁªôÊú∫Âô®‰∫∫‰∏ãÊåá‰ª§Ôºö",
            "analogy_robot_title": "Êú∫Âô®‰∫∫ÔºàËÆ°ÁÆóÊú∫Ôºâ", "analogy_robot_text": "ÂáÜÂ§áÂ•ΩÂê¨‰ªéÊåá‰ª§„ÄÇ",
            "analogy_instruction_title": "Êåá‰ª§ (`for` Âæ™ÁéØ)", "analogy_instruction_text": "‚ÄúÈáçÂ§ç‚ÄòÊâìÂåÖÁâ©ÂìÅ‚Äô‰ªªÂä° 5 Ê¨°„ÄÇ‚Äù",
            "analogy_action_title": "Âä®‰ΩúÔºàÂæ™ÁéØÂÜÖÁöÑ‰ª£Á†ÅÔºâ", "analogy_action_text": "Êú∫Âô®‰∫∫‰∏Ä‰∏™Êé•‰∏Ä‰∏™Âú∞ÊâìÂåÖ‰∫Ü 5 ‰∏™Áâ©ÂìÅ„ÄÇ",
            "analogy_conclusion": "`for` Âæ™ÁéØ‰∏∫Êàë‰ª¨Ëá™Âä®Âåñ‰∫ÜÈáçÂ§çËøáÁ®ãÔºÅ",
            // Syntax & Range
            "syntax_title": "üêç ‰ΩøÁî® `range()` ÁöÑ `for` Âæ™ÁéØ", "syntax_subtitle": "ËøôÂ∞±ÊòØÊàë‰ª¨ÂëäËØâ Python ÈáçÂ§çÊüê‰∫ãÁâπÂÆöÊ¨°Êï∞ÁöÑÊñπÂºè„ÄÇ",
            "syntax_comment": "# Ë¶ÅÈáçÂ§çÁöÑ‰ª£Á†ÅÊîæÂú®ËøôÈáå",
            "syntax_text_p1": "`for`: ÂºÄÂßãÂæ™ÁéØÁöÑÂÖ≥ÈîÆÂ≠ó„ÄÇ<br><span class=\"code-highlight\" data-translate-tooltip=\"tooltip_variable\">i</span>: ‰∏Ä‰∏™ÊåÅÊúâÂΩìÂâçËÆ°Êï∞ÁöÑÂèòÈáèÔºàÂèØ‰ª•ÊòØ‰ªª‰ΩïÂêçÁß∞Ôºâ„ÄÇÊØèÊ¨°Âæ™ÁéØËøêË°åÊó∂ÂÆÉÈÉΩ‰ºöÊîπÂèò„ÄÇ<br><span class=\"code-highlight\" data-translate-tooltip=\"tooltip_in\">in</span>: ËøûÊé•ÂèòÈáèÂíåÂ∫èÂàóÁöÑÂÖ≥ÈîÆÂ≠ó„ÄÇ",
            "syntax_text_p2": "<span class=\"code-highlight\" data-translate-tooltip=\"tooltip_range\">range(5)</span>: ÂàõÂª∫‰∏Ä‰∏™Êï∞Â≠óÂ∫èÂàó„ÄÇ<span class=\"highlight\">ÈáçË¶ÅÊèêÁ§∫Ôºö</span> `range(n)` ÁîüÊàê‰ªé <span class=\"loop-highlight\">0</span> ÂºÄÂßãÂà∞ <span class=\"loop-highlight\">n</span>Ôºà‰ΩÜ<span class=\"highlight\">‰∏çÂåÖÊã¨ n</span>ÔºâÁöÑÊï∞Â≠ó„ÄÇÊâÄ‰ª• `range(5)` ÂæóÂà∞Ôºö0, 1, 2, 3, 4„ÄÇ",
            "syntax_text_p3": "<span class=\"code-highlight\" data-translate-tooltip=\"tooltip_colon\">:</span> ÂÜíÂè∑Ê†áËÆ∞ `for` ËØ≠Âè•ÁöÑÁªìÊùü„ÄÇ<br><strong>Áº©Ëøõ:</strong> Âæ™ÁéØÂÜÖÈÉ®ÁöÑ‰ª£Á†Å<span class=\"highlight\">ÂøÖÈ°ª</span>Áº©ËøõÔºàÈÄöÂ∏∏ÊòØ 4 ‰∏™Á©∫Ê†ºÔºâ„ÄÇËøôÂëäËØâ Python Ë¶ÅÈáçÂ§ç‰ªÄ‰πà„ÄÇ",
            "tooltip_for": "ÂºÄÂßã‰∏Ä‰∏™ 'for' Âæ™ÁéØÔºå‰∏ì‰∏∫ÈáçÂ§çËÆæËÆ°", "tooltip_variable": "‰∏¥Êó∂ÂèòÈáèÔºåÊåÅÊúâÂ∫èÂàó‰∏≠ÁöÑÂΩìÂâçÈ°π/ËÆ°Êï∞Ôºà‰æãÂ¶ÇÔºåÂÖàÊòØ 0ÔºåÁÑ∂ÂêéÊòØ 1ÔºåÁÑ∂ÂêéÊòØ 2...Ôºâ", "tooltip_in": "Â∞ÜÂæ™ÁéØÂèòÈáèËøûÊé•Âà∞Â∫èÂàóÁîüÊàêÂô®",
            "tooltip_range": "ÁîüÊàêÊï∞Â≠óÂ∫èÂàóÁöÑÂáΩÊï∞", "tooltip_number": "‚ÄúÂÅúÊ≠¢‚ÄùÂÄº„ÄÇrange(n) ‰ªé 0 Âà∞ n-1", "tooltip_colon": "Âú® 'for' Ë°åÊú´Â∞æÂøÖÈ°ªÊúâÔºåÊ†áÂøóÁùÄÁº©ËøõÂùóÁöÑÂºÄÂßã",
             // Example
            "example_title": "üöÄ ËÆ©Êàë‰ª¨ÁúãÁúãÂÆûÈôÖÊïàÊûúÔºÅ", "example_subtitle": "ËøôÊÆµ‰ª£Á†ÅÂ∞ÜÊºîÁ§∫‰∏Ä‰∏™ÁÆÄÂçïÁöÑÂæ™ÁéØ„ÄÇ",
            "run_button": "ËøêË°å‰ª£Á†Å",
            "example_text_p1": "ÁÇπÂáª‚ÄúËøêË°å‰ª£Á†Å‚Äù„ÄÇÊ≥®ÊÑèÂà∞ <code>\"Repeating...\"</code> Ë¢´ÊâìÂç∞‰∫ÜÂ§öÊ¨°ÂêóÔºü",
            "example_text_p2": "Âæ™ÁéØ‰ΩøÁî®‰∫Ü <code class=\"code-highlight\" data-translate-tooltip=\"tooltip_example_range\">range(3)</code>ÔºåÊâÄ‰ª•Áº©ËøõÁöÑ `print` ËØ≠Âè•ËøêË°å‰∫Ü 3 Ê¨°„ÄÇ",
            "example_text_p3": "ÊúÄÂêéÁöÑ <code class=\"code-highlight\" data-translate-tooltip=\"tooltip_example_done\">print(\"Done!\")</code> <span class=\"highlight\">Ê≤°Êúâ</span>Áº©ËøõÔºåÊâÄ‰ª•ÂÆÉÂú®Âæ™ÁéØ‰πãÂ§ñÔºåÂπ∂‰∏îÂè™Âú®Âæ™ÁéØÂÆåÊàêÂêéËøêË°å‰∏ÄÊ¨°„ÄÇ",
            "tooltip_example_range": "ÁîüÊàêÊï∞Â≠ó 0, 1, 2„ÄÇÂæ™ÁéØËøêË°å 3 Ê¨°„ÄÇ", "tooltip_example_done": "ËøôÂè™Âú®Âæ™ÁéØÁªìÊùüÂêéËøêË°å‰∏ÄÊ¨°ÔºåÂõ†‰∏∫ÂÆÉÊ≤°ÊúâÁº©Ëøõ„ÄÇ",
            "loop_output_line": "Ê≠£Âú®ÈáçÂ§ç...", "loop_output_done": "ÂÆåÊàêÔºÅ",
             // CT
            "ct_title": "üß† Âæ™ÁéØ‰∏éËÆ°ÁÆóÊÄùÁª¥", "ct_subtitle": "‰ΩøÁî®Âæ™ÁéØÂèØ‰ª•Â¢ûÂº∫Ëøô‰∫õÂÖ≥ÈîÆÊäÄËÉΩÔºö",
            "ct_iteration_title": "Ëø≠‰ª£", "ct_iteration_text": "ËøôÊòØÂæ™ÁéØÁöÑÊ†∏ÂøÉÊÄùÊÉ≥‚Äî‚ÄîÂ§öÊ¨°ÈáçÂ§ç‰∏ÄÁªÑÊåá‰ª§„ÄÇ‰Ω†ÂÆö‰πâ‰∏ÄÊ¨°ËøáÁ®ãÔºåËÆ©Âæ™ÁéØÂ§ÑÁêÜÈáçÂ§ç„ÄÇ",
            "ct_patterns_title": "Ê®°ÂºèËØÜÂà´", "ct_patterns_text": "ËØÜÂà´ÈúÄË¶ÅÈáçÂ§çÁöÑ‰ªªÂä°Â∞±ÊòØÂú®ËØÜÂà´Ê®°Âºè„ÄÇÂæ™ÁéØÂÖÅËÆ∏‰Ω†Â∞ÜËØ•Ê®°ÂºèÊäΩË±°‰∏∫‰ª£Á†ÅÔºå‰ΩøÂÖ∂ÂèØÈáçÁî®‰∏îÈ´òÊïà„ÄÇ",
            // Quiz
            "quiz_title": "üß† Âø´ÈÄüÊµãÈ™åÔºÅ", "quiz_next_button": "‰∏ã‰∏ÄÈ¢ò",
            "quiz_q1": "`for` Âæ™ÁéØÁöÑ‰∏ªË¶ÅÁõÆÁöÑÊòØ‰ªÄ‰πàÔºü",
            "quiz_q1_opt1": "Âú®‰ª£Á†Å‰∏≠ÂÅöÂÜ≥Á≠ñ„ÄÇ", "quiz_q1_opt2": "Â≠òÂÇ®Êï∞ÊçÆ„ÄÇ", "quiz_q1_opt3": "Â§öÊ¨°ÈáçÂ§ç‰∏Ä‰∏™‰ª£Á†ÅÂùó„ÄÇ", "quiz_q1_opt4": "ÂÆö‰πâ‰∏Ä‰∏™ÂáΩÊï∞„ÄÇ",
            "quiz_q2": "Ëøô‰∏™Âæ™ÁéØÂÜÖÁöÑ‰ª£Á†Å‰ºöËøêË°åÂ§öÂ∞ëÊ¨°Ôºö`for x in range(4):`Ôºü",
            "quiz_q2_opt1": "3 Ê¨°", "quiz_q2_opt2": "4 Ê¨°", "quiz_q2_opt3": "5 Ê¨°", "quiz_q2_opt4": "0 Ê¨°",
            "quiz_q3": "`range(3)` ‰∏∫Âæ™ÁéØ‰∫ßÁîü‰ªÄ‰πàÊï∞Â≠óÂ∫èÂàóÔºü",
            "quiz_q3_opt1": "1, 2, 3", "quiz_q3_opt2": "0, 1, 2", "quiz_q3_opt3": "0, 1, 2, 3", "quiz_q3_opt4": "3, 2, 1",
            "quiz_q4": "ÂØπ‰∫é `for` Âæ™ÁéØÂÜÖÈúÄË¶ÅÈáçÂ§çÁöÑ‰ª£Á†ÅÔºå‰ªÄ‰πàÊòØÂøÖ‰∏çÂèØÂ∞ëÁöÑÔºü",
            "quiz_q4_opt1": "ÂøÖÈ°ªÁî®Â§ßÂÜôÂ≠óÊØç‰π¶ÂÜô„ÄÇ", "quiz_q4_opt2": "ÂøÖÈ°ª‰ª•ÂàÜÂè∑ÁªìÂ∞æ„ÄÇ", "quiz_q4_opt3": "ÂøÖÈ°ªÁº©Ëøõ„ÄÇ", "quiz_q4_opt4": "ÂøÖÈ°ª‰ΩøÁî® `repeat` ÂÖ≥ÈîÆÂ≠ó„ÄÇ",
            "quiz_feedback_correct": "Ê≠£Á°ÆÔºÅüéâ", "quiz_feedback_incorrect": "‰∏çÂ§™ÂØπÔºÅÊ≠£Á°ÆÁ≠îÊ°àÊòØÔºö{correctAnswerText}",
            "quiz_final_score_title": "Ê®°Âùó 12 ÂÆåÊàêÔºÅ", "quiz_final_score_summary": "‰Ω†Á≠îÂØπ‰∫Ü {score} / {total} È¢ò„ÄÇ",
            "quiz_final_score_perfect": "Âæ™ÁéØÊéåÊè°ÂæóÂæàÂ•ΩÔºÅ‰Ω†Â∑≤ÁªèÁêÜËß£‰∫Ü `for`„ÄÇ", "quiz_final_score_good": "ÂÅöÂæó‰∏çÈîôÔºÅÁÜüËÉΩÁîüÂ∑ßÔºåÂ§öÁªÉÁªÉÂæ™ÁéØÂêß„ÄÇ",
            // Completion
            "completion_theory_title": "Ê®°Âùó 12 ÁêÜËÆ∫ÂÆåÊàêÔºÅ",
            "completion_theory_desc": "Â§™Ê£í‰∫ÜÔºÅ‰Ω†Â∑≤ÁªèÂ≠¶‰π†‰∫Ü‰ΩøÁî® `for` Âæ™ÁéØËøõË°åÂõ∫ÂÆöÈáçÂ§çÁöÑÂü∫Á°ÄÁü•ËØÜ„ÄÇÊòØÊó∂ÂÄôÁªÉ‰π†‰∫ÜÔºÅ <br> ÂâçÂæÄ<strong>ÁªÉ‰π†Âå∫</strong>ÊàñÂ∞ùËØï<strong>È´òÁ∫ßÁªÉ‰π†</strong>Êù•ÊéåÊè°Âæ™ÁéØ„ÄÇ",
        }
    };

    document.addEventListener('DOMContentLoaded', () => {

        // --- Language Management Functions ---
        function getStoredLanguage() {
            const storedLang = localStorage.getItem('userLanguage');
            if (storedLang && translations[storedLang]) return storedLang;
            const browserLang = navigator.language || navigator.userLanguage;
            if (browserLang.startsWith('pt')) return 'pt';
            if (browserLang.startsWith('zh')) return 'zh';
            return 'en';
        }

        function setLanguage(lang) {
            if (!translations[lang]) lang = 'en';
            localStorage.setItem('userLanguage', lang);
            document.documentElement.lang = lang;
            translatePage(lang);
            const langSelect = document.getElementById('languageSelect');
            if (langSelect) langSelect.value = lang;
             if(quizArea && currentQuestionIndex < quizData.length) {
                 if (!quizArea.querySelector('[data-translate="quiz_final_score_title"]')) {
                    loadQuestion();
                 }
             }
        }

        function getTranslation(key, lang, replacements = {}) {
            let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`;
            for (const placeholder in replacements) {
                const regex = new RegExp(`\\{${placeholder}\\}`, 'g');
                text = text.replace(regex, replacements[placeholder]);
            }
            return text;
        }

        function translatePage(lang) {
             if (!translations[lang]) lang = 'en';

             document.querySelectorAll('[data-translate]').forEach(el => {
                 const key = el.getAttribute('data-translate');
                 const translation = getTranslation(key, lang);
                 if (el.tagName === 'TITLE') { document.title = translation; }
                 else if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA' || el.tagName === 'SELECT') { /* Skip certain form elements */ }
                 else if (el.tagName === 'OPTION') { el.textContent = translation; }
                 else if (el.classList.contains('code-comment') && key === 'syntax_comment') { // Handle specific code comments
                     const commentContent = translation.substring(translation.indexOf('#') + 1).trim();
                     el.textContent = '# ' + commentContent;
                 }
                 else {
                      // Use innerHTML only if the translation likely contains HTML (like the syntax explanations)
                     if ((key.startsWith('syntax_text_') || key === 'completion_theory_desc') && translation.includes('<')) {
                         el.innerHTML = translation;
                         // Re-attach tooltips for dynamic content if necessary
                         el.querySelectorAll('.code-highlight[data-translate-tooltip]').forEach(highlight => {
                             const tooltipKey = highlight.getAttribute('data-translate-tooltip');
                             if(tooltipKey) {
                                 let tooltip = highlight.querySelector('.tooltip');
                                 if (!tooltip) {
                                     tooltip = document.createElement('span');
                                     tooltip.className = 'tooltip';
                                     highlight.appendChild(tooltip);
                                 }
                                 tooltip.textContent = getTranslation(tooltipKey, lang);
                             }
                         });
                     }
                      else if (translation.includes('<') && translation.includes('>')) { // General HTML check
                         el.innerHTML = translation;
                     }
                     else { el.textContent = translation; }
                 }
             });

             document.querySelectorAll('[data-translate-placeholder]').forEach(el => {
                 const key = el.getAttribute('data-translate-placeholder');
                 el.setAttribute('placeholder', getTranslation(key, lang));
             });

              // Translate tooltips attached directly to code elements
              document.querySelectorAll('.code-keyword[data-translate-tooltip], .code-variable[data-translate-tooltip], .code-in[data-translate-tooltip], .code-function[data-translate-tooltip], .code-number[data-translate-tooltip], .code-colon[data-translate-tooltip]').forEach(el => {
                 const tooltipKey = el.getAttribute('data-translate-tooltip');
                 if(tooltipKey) {
                     let tooltip = el.querySelector('.tooltip');
                     if (!tooltip) {
                         tooltip = document.createElement('span');
                         tooltip.className = 'tooltip';
                         el.appendChild(tooltip);
                     }
                    tooltip.textContent = getTranslation(tooltipKey, lang);
                 }
             });

             // Translate tooltips within .code-highlight spans (needed for example section)
              document.querySelectorAll('.code-highlight[data-translate-tooltip]').forEach(highlight => {
                 const tooltipKey = highlight.getAttribute('data-translate-tooltip');
                 if (tooltipKey) {
                    let tooltip = highlight.querySelector('.tooltip');
                     if (!tooltip) {
                         tooltip = document.createElement('span');
                         tooltip.className = 'tooltip';
                         highlight.appendChild(tooltip);
                     }
                     tooltip.textContent = getTranslation(tooltipKey, lang);
                 }
             });
        }

        // --- Initialize Language ---
        const initialLang = getStoredLanguage();

        // --- Minimal Nav Logic ---
        const navToggleButton = document.getElementById('minimal-nav-toggle');
        const navPanel = document.getElementById('minimal-nav-panel');
        const body = document.body;

        if (navToggleButton && navPanel) {
            navToggleButton.addEventListener('click', (event) => { event.stopPropagation(); body.classList.toggle('nav-active'); navToggleButton.setAttribute('aria-expanded', body.classList.contains('nav-active')); });
            document.addEventListener('click', (event) => { if (body.classList.contains('nav-active') && !navPanel.contains(event.target) && event.target !== navToggleButton && !navToggleButton.contains(event.target)) { body.classList.remove('nav-active'); navToggleButton.setAttribute('aria-expanded', 'false'); } });
            navPanel.querySelectorAll('a').forEach(link => { link.addEventListener('click', () => { body.classList.remove('nav-active'); navToggleButton.setAttribute('aria-expanded', 'false'); }); });
            document.addEventListener('keydown', (event) => { if (event.key === 'Escape' && body.classList.contains('nav-active')) { body.classList.remove('nav-active'); navToggleButton.setAttribute('aria-expanded', 'false'); } });
            navToggleButton.setAttribute('aria-expanded', 'false');
        }

        // --- Language Switcher Setup ---
        const langSelect = document.getElementById('languageSelect');
        if (langSelect) { langSelect.addEventListener('change', (e) => { setLanguage(e.target.value); }); }

        // --- Intersection Observer for Animations ---
        const observerOptions = { root: null, rootMargin: '0px', threshold: 0.1 };
        const observerCallback = (entries, observer) => { entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('visible'); } }); };
        const observer = new IntersectionObserver(observerCallback, observerOptions);
        document.querySelectorAll('.analogy-part, .analogy-arrow, .ct-card').forEach(el => { observer.observe(el); });

        // --- Loop Example Simulation ---
        const runLoopButton = document.getElementById('run-loop-btn');
        const outputArea = document.querySelector('#loop-example .output-area');

        if (runLoopButton && outputArea) {
            runLoopButton.addEventListener('click', () => {
                outputArea.innerHTML = ''; // Clear previous output
                runLoopButton.disabled = true; // Prevent multiple clicks
                const currentLang = getStoredLanguage();
                const outputLineText = getTranslation("loop_output_line", currentLang);
                const outputDoneText = getTranslation("loop_output_done", currentLang);
                const iterations = 3; // From range(3) in the example
                let delay = 0;

                for (let i = 0; i < iterations; i++) {
                    setTimeout(() => {
                        const line = document.createElement('span');
                        line.className = 'code-line-output';
                        line.textContent = `> ${outputLineText}`;
                        outputArea.appendChild(line);
                    }, delay);
                    delay += 400; // Delay between lines
                }

                // Add the "Done!" line after the loop finishes
                setTimeout(() => {
                    const doneLine = document.createElement('span');
                    doneLine.className = 'code-line-output';
                    doneLine.textContent = `> ${outputDoneText}`;
                    doneLine.style.color = 'var(--success-color)'; // Maybe different color for done
                    outputArea.appendChild(doneLine);
                    runLoopButton.disabled = false; // Re-enable button
                }, delay + 100); // Add after last iteration
            });
        }


        // --- Knowledge Check / Quiz (Adapted for Module 12) ---
        const quizData = [
            { questionKey: "quiz_q1", optionKeys: ["quiz_q1_opt1", "quiz_q1_opt2", "quiz_q1_opt3", "quiz_q1_opt4"], correctAnswer: 2 },
            { questionKey: "quiz_q2", optionKeys: ["quiz_q2_opt1", "quiz_q2_opt2", "quiz_q2_opt3", "quiz_q2_opt4"], correctAnswer: 1 }, // range(4) -> 0, 1, 2, 3 (4 times)
            { questionKey: "quiz_q3", optionKeys: ["quiz_q3_opt1", "quiz_q3_opt2", "quiz_q3_opt3", "quiz_q3_opt4"], correctAnswer: 1 }, // range(3) -> 0, 1, 2
            { questionKey: "quiz_q4", optionKeys: ["quiz_q4_opt1", "quiz_q4_opt2", "quiz_q4_opt3", "quiz_q4_opt4"], correctAnswer: 2 }  // Indentation is key
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        const quizArea = document.getElementById('quiz-area');
        const feedbackArea = document.getElementById('quiz-feedback');
        const nextButton = document.getElementById('next-question-btn');

        function loadQuestion() {
            const currentLang = getStoredLanguage();
             if (!quizArea || currentQuestionIndex >= quizData.length) {
                 if (quizArea && !quizArea.querySelector('[data-translate="quiz_final_score_title"]')) { showFinalScore(); }
                 return;
             }
             const currentQuiz = quizData[currentQuestionIndex];
             const questionText = getTranslation(currentQuiz.questionKey, currentLang);
             quizArea.innerHTML = `
                 <div class="quiz-question">${currentQuestionIndex + 1}. ${questionText.replace(/`(.*?)`/g, '<code>$1</code>')}</div>
                 <div class="quiz-options">
                     ${currentQuiz.optionKeys.map((optionKey, index) => `<button class="quiz-option-btn" data-index="${index}">${getTranslation(optionKey, currentLang).replace(/`(.*?)`/g, '<code>$1</code>')}</button>`).join('')}
                 </div>`;
             feedbackArea.classList.remove('visible', 'correct', 'incorrect'); feedbackArea.textContent = '';
             nextButton.classList.remove('visible'); nextButton.disabled = true;
             document.querySelectorAll('.quiz-option-btn').forEach(button => button.addEventListener('click', handleAnswer));
        }

        function handleAnswer(event) {
             const currentLang = getStoredLanguage();
             const selectedButton = event.target;
             const selectedIndex = parseInt(selectedButton.dataset.index);
             const correctIndex = quizData[currentQuestionIndex].correctAnswer;
             const correctOptionKey = quizData[currentQuestionIndex].optionKeys[correctIndex];
             const correctAnswerText = getTranslation(correctOptionKey, currentLang).replace(/`(.*?)`/g, '<code>$1</code>');

             document.querySelectorAll('.quiz-option-btn').forEach(btn => { btn.disabled = true; btn.classList.remove('shake'); });
             feedbackArea.classList.add('visible');

             if (selectedIndex === correctIndex) {
                 selectedButton.classList.add('correct');
                 feedbackArea.innerHTML = getTranslation('quiz_feedback_correct', currentLang);
                 feedbackArea.classList.add('correct'); feedbackArea.classList.remove('incorrect');
                 score++;
                 selectedButton.classList.add('tada-anim');
             } else {
                 selectedButton.classList.add('incorrect');
                 feedbackArea.innerHTML = getTranslation('quiz_feedback_incorrect', currentLang, { correctAnswerText: `<strong>${correctAnswerText}</strong>` });
                 feedbackArea.classList.add('incorrect'); feedbackArea.classList.remove('correct');
                 const correctButton = document.querySelector(`.quiz-option-btn[data-index="${correctIndex}"]`);
                 if(correctButton) correctButton.classList.add('correct');
                 selectedButton.classList.add('shake');
             }
              selectedButton.addEventListener('animationend', () => { selectedButton.classList.remove('tada-anim', 'shake'); }, { once: true });
             nextButton.classList.add('visible'); nextButton.disabled = false;
        }

        function showFinalScore() {
             const currentLang = getStoredLanguage();
             const totalQuestions = quizData.length;
             let resultMessageKey = score === totalQuestions ? 'quiz_final_score_perfect' : 'quiz_final_score_good'; // M12 Specific keys
             quizArea.innerHTML = `
                 <div class="quiz-question text-center" data-translate="quiz_final_score_title" style="font-size: 1.5rem;">${getTranslation('quiz_final_score_title', currentLang)}</div>
                 <p class="text-center" style="font-size: 1.2rem; margin-bottom: 1rem;">${getTranslation('quiz_final_score_summary', currentLang, { score: score, total: totalQuestions })}</p>
                 <p class="text-center" style="color: ${score === totalQuestions ? 'var(--success-color)' : 'var(--primary-color)'}; font-weight: bold;">${getTranslation(resultMessageKey, currentLang)}</p>
             `;
             feedbackArea.classList.remove('visible');
             nextButton.style.display = 'none';
             quizArea.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        nextButton.addEventListener('click', () => {
             currentQuestionIndex++;
             loadQuestion();
         });

        // --- Initial Language Application and Load ---
        setLanguage(initialLang); // Apply language FIRST
        if (quizArea) { loadQuestion(); } // Initial quiz load

        // Trigger fade-in animations for elements initially in view
         document.querySelectorAll('.fade-in').forEach(el => {
             const rect = el.getBoundingClientRect();
             if(rect.top < window.innerHeight && rect.bottom >= 0) { /* Element is initially visible */ }
         });

    }); // End DOMContentLoaded
    </script>

</body>
</html>
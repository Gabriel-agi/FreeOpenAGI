<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="page_title">Knowledge Check - Module 2</title>
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Base Styles & Variables (Copied from ctp-dashboard.html) --- */
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-page: #f0f2f5;
            --background-card: #ffffff;
            --background-sidebar: #ffffff;
            --background-header: linear-gradient(135deg, #0d6efd, #0a58ca);
            --text-light: #f8f9fa;
            --text-dark: #343a40;
            --text-muted: #6c757d;
            --accent-color: #ffc107;
            --success-color: #198754;
            --error-color: #dc3545;
            --info-color: #0dcaf0;
            --video-color: #fd7e14;
            --check-color: #6f42c1;
            --certificate-color: #d63384;
            --chat-panel-bg: #ffffff;
            --chat-box-bg: #f8f9fa;
            --chat-bot-bg: #e9ecef;
            --chat-bot-text: #343a40;
            --chat-user-bg: #d1e7ff;
            --chat-user-text: #0a58ca;
            --chat-error-bg: #f8d7da;
            --chat-error-text: #842029;
            --chat-border-color: #dee2e6;
            --progress-bg: #e9ecef;
            --progress-fill: var(--check-color);
            --border-color: #dee2e6;
            --border-radius: 8px;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            --card-shadow-hover: 0 6px 18px rgba(0, 0, 0, 0.1);
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
            --sidebar-width: 260px;
             /* Colors for lang switcher */
             --lang-select-border: var(--certificate-color);
             --lang-select-bg: rgba(255, 255, 255, 0.1);
             --lang-select-bg-hover: rgba(255, 255, 255, 0.15);
             --lang-option-bg: var(--background-card);
             --lang-option-text: var(--text-dark);
             --lang-arrow-color: var(--certificate-color);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.6;
            background-color: var(--background-page); color: var(--text-dark);
            padding-top: 60px; /* Add padding to prevent content overlap with fixed header */
        }

        /* --- Simple Header for Return Button --- */
        .kc-header {
            position: fixed; /* Fixed position */
            top: 0;
            left: 0;
            width: 100%;
            background: var(--background-header);
            padding: 0.75rem 1.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 100; /* Ensure it's above other content */
            display: flex;
            align-items: center;
        }
        .return-button {
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            background-color: rgba(255, 255, 255, 0.15);
            color: var(--text-light);
            text-decoration: none;
            border-radius: var(--border-radius);
            font-weight: 500;
            font-size: 0.9rem;
            transition: background-color var(--transition-speed);
        }
        .return-button i {
            margin-right: 8px;
        }
        .return-button:hover {
            background-color: rgba(255, 255, 255, 0.25);
        }

        /* --- Knowledge Check Specific Styles --- */
        .kc-container {
            max-width: 800px;
            margin: 2rem auto; /* Adjusted margin for header */
            padding: 2rem;
            background-color: var(--background-card);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
        }

        .kc-container h1 {
            font-family: var(--font-title);
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            border-bottom: 2px solid var(--check-color);
            padding-bottom: 0.5rem;
            font-size: 1.8rem;
        }
        .kc-container .kc-instructions {
            font-size: 0.95rem;
            color: var(--text-muted);
            margin-bottom: 2rem;
            background-color: var(--background-page);
            padding: 0.8rem 1rem;
            border-radius: 5px;
            border-left: 4px solid var(--info-color);
        }
        .kc-instructions strong {
            color: var(--text-dark);
        }

        .kc-question {
            margin-bottom: 1.8rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px dashed var(--border-color);
        }
        .kc-question:last-of-type {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        .kc-question-text {
            font-weight: 500;
            margin-bottom: 1rem;
            font-size: 1.1rem;
            color: var(--text-dark);
        }
        .kc-question-text code {
             background-color: #e9ecef; padding: 0.1em 0.4em; border-radius: 3px; font-size: 0.9em; color: #c7254e; font-family: monospace;
        }

        .kc-options {
            display: flex;
            flex-direction: column;
            gap: 0.8rem; /* Spacing between options */
        }

        .kc-option {
            display: flex; /* Use flexbox for alignment */
            align-items: center; /* Center items vertically */
            background-color: #f8f9fa;
            padding: 0.8rem 1rem;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: background-color var(--transition-speed), border-color var(--transition-speed);
        }
        .kc-option:hover {
            background-color: #e9ecef;
            border-color: var(--secondary-color);
        }
        .kc-option input[type="radio"] {
           margin-right: 10px;
           flex-shrink: 0; /* Prevent radio button from shrinking */
           appearance: none; /* Custom styling */
           width: 18px; height: 18px;
           border: 2px solid var(--secondary-color);
           border-radius: 50%;
           position: relative;
           cursor: pointer;
           transition: border-color 0.2s ease;
        }
        .kc-option input[type="radio"]:checked {
            border-color: var(--check-color);
        }

         .kc-option input[type="radio"]:checked::before {
             content: '';
             display: block;
             width: 10px; height: 10px;
             background-color: var(--check-color);
             border-radius: 50%;
             position: absolute;
             top: 50%; left: 50%;
             transform: translate(-50%, -50%);
         }

        .kc-option label {
            flex-grow: 1; /* Label takes remaining space */
            cursor: pointer; /* Make label clickable */
            font-size: 0.95rem;
            color: var(--text-dark);
        }
        .kc-option label code {
            background-color: #ddeeff; padding: 0.1em 0.4em; border-radius: 3px; font-size: 0.9em; color: #0a58ca; font-family: monospace;
        }

        #submit-quiz {
            display: block;
            width: 100%;
            padding: 0.8rem 1.5rem;
            font-size: 1.1rem;
            font-weight: 700;
            font-family: var(--font-body);
            color: var(--text-light);
            background-color: var(--check-color);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: background-color var(--transition-speed);
            margin-top: 2rem;
        }
        #submit-quiz:hover {
            background-color: #5a35a2;
        }
        #submit-quiz:disabled {
            background-color: var(--secondary-color);
            cursor: not-allowed;
        }

        #quiz-results {
            margin-top: 2rem;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            text-align: center;
        }
        #quiz-results.pass {
            background-color: #d1e7dd; /* Light green */
            border: 1px solid var(--success-color);
            color: #0f5132; /* Dark green */
        }
        #quiz-results.fail {
            background-color: #f8d7da; /* Light red */
            border: 1px solid var(--error-color);
            color: #842029; /* Dark red */
        }
        #quiz-results p {
            margin-bottom: 1rem;
            font-size: 1.1rem;
            font-weight: 500;
        }
        #quiz-results strong {
            font-size: 1.3rem;
        }
        #try-again-button {
             display: inline-block;
             padding: 0.6rem 1.2rem;
             font-size: 1rem;
             font-weight: 500;
             color: var(--text-light);
             background-color: var(--secondary-color);
             border: none;
             border-radius: var(--border-radius);
             cursor: pointer;
             transition: background-color var(--transition-speed);
             margin-top: 1rem;
        }
         #try-again-button:hover {
             background-color: #5a6268;
         }

        .progress-saved-msg {
             font-size: 0.9rem;
             color: var(--success-color);
             margin-top: 0.5rem;
             font-style: italic;
         }

        /* --- Footer --- (Optional, but good for consistency) */
        footer { text-align: center; padding: 1.5rem; margin-top: 3rem; background-color: var(--background-card); border-top: 1px solid var(--border-color); color: var(--text-muted); font-size: 0.9rem; }

        /* --- Responsive Design --- */
        @media (max-width: 768px) {
            html { font-size: 15px; }
            body { padding-top: 50px; }
            .kc-header { padding: 0.6rem 1rem; }
            .return-button { font-size: 0.85rem; padding: 0.4rem 0.8rem; }
            .kc-container { margin: 1.5rem auto; padding: 1.5rem; }
            .kc-container h1 { font-size: 1.6rem; }
            .kc-question-text { font-size: 1rem; }
        }
        @media (max-width: 576px) {
            html { font-size: 14px; }
            body { padding-top: 45px; }
            .kc-header { padding: 0.5rem 0.8rem; }
             .return-button i { margin-right: 5px; }
            .kc-container { margin: 1rem 0.5rem; padding: 1rem; }
            .kc-container h1 { font-size: 1.4rem; }
            .kc-instructions { font-size: 0.9rem; padding: 0.6rem 0.8rem; }
            .kc-option { padding: 0.6rem 0.8rem; }
             .kc-option label { font-size: 0.9rem; }
             #submit-quiz { font-size: 1rem; padding: 0.7rem; }
             #quiz-results { padding: 1rem; }
             #quiz-results p { font-size: 1rem; }
             #quiz-results strong { font-size: 1.15rem; }
             #try-again-button { font-size: 0.9rem; padding: 0.5rem 1rem; }
        }

    </style>
</head>
<body>

    <header class="kc-header">
        <a href="ctp-dashboard.html" class="return-button">
            <i class="fas fa-arrow-left"></i> <span data-translate="return_to_dashboard">Return to Dashboard</span>
        </a>
        <!-- Maybe add Language selector here if needed, copying from dashboard -->
         <div class="language-switcher" style="margin-left: auto;"> <!-- Position to the right -->
            <select id="languageSelect" data-translate-aria-label="lang_select_aria" aria-label="Select Language">
                <option value="en" data-translate="lang_en">🇬🇧 English</option>
                <option value="pt" data-translate="lang_pt">🇧🇷 Português</option>
                <option value="zh" data-translate="lang_zh">🇨🇳 中文</option>
            </select>
        </div>
    </header>

    <div class="kc-container">
        <h1 data-translate="kc_title">Module 2: Working with Numbers - Knowledge Check</h1>
        <p class="kc-instructions" data-translate="kc_instructions">
            Answer the 10 questions below. You need to answer at least <strong>6 questions correctly</strong> to pass this knowledge check. You can attempt this check as many times as you need. Passing will mark this module as complete on your dashboard.
        </p>

        <form id="quiz-form">

            <!-- Question 1 -->
            <div class="kc-question">
                <p class="kc-question-text" data-translate="q1_text">1. What is the result of the expression <code>5 + 3 * 2</code> in Python?</p>
                <div class="kc-options">
                    <div class="kc-option">
                        <input type="radio" id="q1_a" name="q1" value="a" required>
                        <label for="q1_a" data-translate="q1_opt_a"><code>16</code></label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q1_b" name="q1" value="b">
                        <label for="q1_b" data-translate="q1_opt_b"><code>11</code></label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q1_c" name="q1" value="c">
                        <label for="q1_c" data-translate="q1_opt_c"><code>13</code></label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q1_d" name="q1" value="d">
                        <label for="q1_d" data-translate="q1_opt_d"><code>8</code></label>
                    </div>
                </div>
            </div>

            <!-- Question 2 -->
            <div class="kc-question">
                <p class="kc-question-text" data-translate="q2_text">2. Which operator performs floor division (discards the remainder)?</p>
                 <div class="kc-options">
                     <div class="kc-option">
                         <input type="radio" id="q2_a" name="q2" value="a" required>
                         <label for="q2_a" data-translate="q2_opt_a"><code>/</code></label>
                     </div>
                     <div class="kc-option">
                         <input type="radio" id="q2_b" name="q2" value="b">
                         <label for="q2_b" data-translate="q2_opt_b"><code>%</code></label>
                     </div>
                     <div class="kc-option">
                         <input type="radio" id="q2_c" name="q2" value="c">
                         <label for="q2_c" data-translate="q2_opt_c"><code>//</code></label>
                     </div>
                     <div class="kc-option">
                         <input type="radio" id="q2_d" name="q2" value="d">
                         <label for="q2_d" data-translate="q2_opt_d"><code>**</code></label>
                     </div>
                 </div>
            </div>

            <!-- Question 3 -->
             <div class="kc-question">
                 <p class="kc-question-text" data-translate="q3_text">3. What does the expression <code>10 % 3</code> evaluate to?</p>
                  <div class="kc-options">
                      <div class="kc-option">
                          <input type="radio" id="q3_a" name="q3" value="a" required>
                          <label for="q3_a" data-translate="q3_opt_a"><code>3</code></label>
                      </div>
                      <div class="kc-option">
                          <input type="radio" id="q3_b" name="q3" value="b">
                          <label for="q3_b" data-translate="q3_opt_b"><code>1</code></label>
                      </div>
                      <div class="kc-option">
                          <input type="radio" id="q3_c" name="q3" value="c">
                          <label for="q3_c" data-translate="q3_opt_c"><code>0</code></label>
                      </div>
                      <div class="kc-option">
                          <input type="radio" id="q3_d" name="q3" value="d">
                          <label for="q3_d" data-translate="q3_opt_d"><code>3.33...</code></label>
                      </div>
                  </div>
             </div>

            <!-- Question 4 -->
             <div class="kc-question">
                 <p class="kc-question-text" data-translate="q4_text">4. Which expression calculates 2 raised to the power of 5?</p>
                  <div class="kc-options">
                      <div class="kc-option">
                          <input type="radio" id="q4_a" name="q4" value="a" required>
                          <label for="q4_a" data-translate="q4_opt_a"><code>2 ^ 5</code></label>
                      </div>
                      <div class="kc-option">
                          <input type="radio" id="q4_b" name="q4" value="b">
                          <label for="q4_b" data-translate="q4_opt_b"><code>2 * 5</code></label>
                      </div>
                      <div class="kc-option">
                          <input type="radio" id="q4_c" name="q4" value="c">
                          <label for="q4_c" data-translate="q4_opt_c"><code>2 // 5</code></label>
                      </div>
                      <div class="kc-option">
                          <input type="radio" id="q4_d" name="q4" value="d">
                          <label for="q4_d" data-translate="q4_opt_d"><code>2 ** 5</code></label>
                      </div>
                  </div>
             </div>

            <!-- Question 5 -->
             <div class="kc-question">
                 <p class="kc-question-text" data-translate="q5_text">5. What is the result of <code>15 / 4</code>?</p>
                  <div class="kc-options">
                      <div class="kc-option">
                          <input type="radio" id="q5_a" name="q5" value="a" required>
                          <label for="q5_a" data-translate="q5_opt_a"><code>3</code></label>
                      </div>
                      <div class="kc-option">
                          <input type="radio" id="q5_b" name="q5" value="b">
                          <label for="q5_b" data-translate="q5_opt_b"><code>3.0</code></label>
                      </div>
                      <div class="kc-option">
                          <input type="radio" id="q5_c" name="q5" value="c">
                          <label for="q5_c" data-translate="q5_opt_c"><code>3.75</code></label>
                      </div>
                      <div class="kc-option">
                          <input type="radio" id="q5_d" name="q5" value="d">
                          <label for="q5_d" data-translate="q5_opt_d"><code>4</code></label>
                      </div>
                  </div>
             </div>

            <!-- Question 6 -->
             <div class="kc-question">
                 <p class="kc-question-text" data-translate="q6_text">6. What is the result of <code>15 // 4</code>?</p>
                 <div class="kc-options">
                     <div class="kc-option">
                         <input type="radio" id="q6_a" name="q6" value="a" required>
                         <label for="q6_a" data-translate="q6_opt_a"><code>3</code></label>
                     </div>
                     <div class="kc-option">
                         <input type="radio" id="q6_b" name="q6" value="b">
                         <label for="q6_b" data-translate="q6_opt_b"><code>3.0</code></label>
                     </div>
                     <div class="kc-option">
                         <input type="radio" id="q6_c" name="q6" value="c">
                         <label for="q6_c" data-translate="q6_opt_c"><code>3.75</code></label>
                     </div>
                     <div class="kc-option">
                         <input type="radio" id="q6_d" name="q6" value="d">
                         <label for="q6_d" data-translate="q6_opt_d"><code>4</code></label>
                     </div>
                 </div>
            </div>

            <!-- Question 7 -->
            <div class="kc-question">
                <p class="kc-question-text" data-translate="q7_text">7. According to operator precedence, which operation is performed first in <code>10 - 4 * 2</code>?</p>
                 <div class="kc-options">
                     <div class="kc-option">
                         <input type="radio" id="q7_a" name="q7" value="a" required>
                         <label for="q7_a" data-translate="q7_opt_a"><code>10 - 4</code> (Subtraction)</label>
                     </div>
                     <div class="kc-option">
                         <input type="radio" id="q7_b" name="q7" value="b">
                         <label for="q7_b" data-translate="q7_opt_b"><code>4 * 2</code> (Multiplication)</label>
                     </div>
                     <div class="kc-option">
                         <input type="radio" id="q7_c" name="q7" value="c">
                         <label for="q7_c" data-translate="q7_opt_c">Operations are performed left-to-right</label>
                     </div>
                      <div class="kc-option">
                         <input type="radio" id="q7_d" name="q7" value="d">
                         <label for="q7_d" data-translate="q7_opt_d">It causes an error</label>
                     </div>
                 </div>
            </div>

            <!-- Question 8 -->
            <div class="kc-question">
                 <p class="kc-question-text" data-translate="q8_text">8. What is the value of <code>result</code> after this code runs: <code>result = (2 + 3) * 4</code>?</p>
                 <div class="kc-options">
                     <div class="kc-option">
                         <input type="radio" id="q8_a" name="q8" value="a" required>
                         <label for="q8_a" data-translate="q8_opt_a"><code>14</code></label>
                     </div>
                     <div class="kc-option">
                         <input type="radio" id="q8_b" name="q8" value="b">
                         <label for="q8_b" data-translate="q8_opt_b"><code>20</code></label>
                     </div>
                     <div class="kc-option">
                         <input type="radio" id="q8_c" name="q8" value="c">
                         <label for="q8_c" data-translate="q8_opt_c"><code>11</code></label>
                     </div>
                     <div class="kc-option">
                         <input type="radio" id="q8_d" name="q8" value="d">
                         <label for="q8_d" data-translate="q8_opt_d"><code>9</code></label>
                     </div>
                 </div>
            </div>

            <!-- Question 9 -->
             <div class="kc-question">
                 <p class="kc-question-text" data-translate="q9_text">9. What is the result of <code>5 + 10 / 2</code>?</p>
                 <div class="kc-options">
                     <div class="kc-option">
                         <input type="radio" id="q9_a" name="q9" value="a" required>
                         <label for="q9_a" data-translate="q9_opt_a"><code>7.5</code></label>
                     </div>
                     <div class="kc-option">
                         <input type="radio" id="q9_b" name="q9" value="b">
                         <label for="q9_b" data-translate="q9_opt_b"><code>10.0</code></label>
                     </div>
                     <div class="kc-option">
                         <input type="radio" id="q9_c" name="q9" value="c">
                         <label for="q9_c" data-translate="q9_opt_c"><code>10</code></label>
                     </div>
                     <div class="kc-option">
                         <input type="radio" id="q9_d" name="q9" value="d">
                         <label for="q9_d" data-translate="q9_opt_d"><code>7</code></label>
                     </div>
                 </div>
            </div>

            <!-- Question 10 -->
             <div class="kc-question">
                 <p class="kc-question-text" data-translate="q10_text">10. Which has the highest precedence among the standard arithmetic operators below?</p>
                 <div class="kc-options">
                      <div class="kc-option">
                          <input type="radio" id="q10_a" name="q10" value="a" required>
                          <label for="q10_a" data-translate="q10_opt_a"><code>+</code> (Addition)</label>
                      </div>
                      <div class="kc-option">
                          <input type="radio" id="q10_b" name="q10" value="b">
                          <label for="q10_b" data-translate="q10_opt_b"><code>*</code> (Multiplication)</label>
                      </div>
                      <div class="kc-option">
                          <input type="radio" id="q10_c" name="q10" value="c">
                          <label for="q10_c" data-translate="q10_opt_c"><code>**</code> (Exponentiation)</label>
                      </div>
                       <div class="kc-option">
                          <input type="radio" id="q10_d" name="q10" value="d">
                          <label for="q10_d" data-translate="q10_opt_d"><code>/</code> (Division)</label>
                      </div>
                  </div>
             </div>

            <button type="submit" id="submit-quiz" data-translate="submit_button">Submit Answers</button>

        </form>

        <div id="quiz-results" style="display: none;">
            <!-- Results will be displayed here by JavaScript -->
        </div>

    </div>

    <footer data-translate="footer_text">Part of the Road to Free Open AGI Project</footer>

    <script>
        // --- Constants ---
        const MODULE_ID = 2; // ID for this module
        const PASSING_SCORE = 6;
        const TOTAL_QUESTIONS = 10;
        const KNOWLEDGE_CHECK_STORAGE_KEY = 'knowledgeCheckStatus_v1';
        const LANGUAGE_STORAGE_KEY = 'userLanguage';

        // --- Translations Object ---
        const translations = {
             en: {
                 "page_title": `Knowledge Check - Module ${MODULE_ID}`,
                 "kc_title": `Module ${MODULE_ID}: Working with Numbers - Knowledge Check`,
                 "kc_instructions": `Answer the ${TOTAL_QUESTIONS} questions below. You need to answer at least <strong>${PASSING_SCORE} questions correctly</strong> to pass this knowledge check. You can attempt this check as many times as you need. Passing will mark this module as complete on your dashboard.`,
                 "return_to_dashboard": "Return to Dashboard",
                 "submit_button": "Submit Answers",
                 "result_score": "Your score: <strong>{score}/{total}</strong>",
                 "result_passed": "Congratulations! You passed! 🎉 Progress saved.",
                 "result_failed": "Not quite! You need at least {passingScore} correct answers to pass.",
                 "try_again_button": "Try Again",
                 "progress_saved_msg": "Progress saved to dashboard!",
                 "lang_select_aria": "Select Language", "lang_en": "🇬🇧 English", "lang_pt": "🇧🇷 Português", "lang_zh": "🇨🇳 中文",
                 "footer_text": "Part of the Road to Free Open AGI Project",
                 // Questions Module 2
                 "q1_text": "1. What is the result of the expression <code>5 + 3 * 2</code> in Python?", "q1_opt_a": "<code>16</code>", "q1_opt_b": "<code>11</code>", "q1_opt_c": "<code>13</code>", "q1_opt_d": "<code>8</code>",
                 "q2_text": "2. Which operator performs floor division (discards the remainder)?", "q2_opt_a": "<code>/</code>", "q2_opt_b": "<code>%</code>", "q2_opt_c": "<code>//</code>", "q2_opt_d": "<code>**</code>",
                 "q3_text": "3. What does the expression <code>10 % 3</code> evaluate to?", "q3_opt_a": "<code>3</code>", "q3_opt_b": "<code>1</code>", "q3_opt_c": "<code>0</code>", "q3_opt_d": "<code>3.33...</code>",
                 "q4_text": "4. Which expression calculates 2 raised to the power of 5?", "q4_opt_a": "<code>2 ^ 5</code>", "q4_opt_b": "<code>2 * 5</code>", "q4_opt_c": "<code>2 // 5</code>", "q4_opt_d": "<code>2 ** 5</code>",
                 "q5_text": "5. What is the result of <code>15 / 4</code>?", "q5_opt_a": "<code>3</code>", "q5_opt_b": "<code>3.0</code>", "q5_opt_c": "<code>3.75</code>", "q5_opt_d": "<code>4</code>",
                 "q6_text": "6. What is the result of <code>15 // 4</code>?", "q6_opt_a": "<code>3</code>", "q6_opt_b": "<code>3.0</code>", "q6_opt_c": "<code>3.75</code>", "q6_opt_d": "<code>4</code>",
                 "q7_text": "7. According to operator precedence, which operation is performed first in <code>10 - 4 * 2</code>?", "q7_opt_a": "<code>10 - 4</code> (Subtraction)", "q7_opt_b": "<code>4 * 2</code> (Multiplication)", "q7_opt_c": "Operations are performed left-to-right", "q7_opt_d": "It causes an error",
                 "q8_text": "8. What is the value of <code>result</code> after this code runs: <code>result = (2 + 3) * 4</code>?", "q8_opt_a": "<code>14</code>", "q8_opt_b": "<code>20</code>", "q8_opt_c": "<code>11</code>", "q8_opt_d": "<code>9</code>",
                 "q9_text": "9. What is the result of <code>5 + 10 / 2</code>?", "q9_opt_a": "<code>7.5</code>", "q9_opt_b": "<code>10.0</code>", "q9_opt_c": "<code>10</code>", "q9_opt_d": "<code>7</code>",
                 "q10_text": "10. Which has the highest precedence among the standard arithmetic operators below?", "q10_opt_a": "<code>+</code> (Addition)", "q10_opt_b": "<code>*</code> (Multiplication)", "q10_opt_c": "<code>**</code> (Exponentiation)", "q10_opt_d": "<code>/</code> (Division)",
             },
             pt: {
                 "page_title": `Verificação de Conhecimento - Módulo ${MODULE_ID}`,
                 "kc_title": `Módulo ${MODULE_ID}: Trabalhando com Números - Verificação de Conhecimento`,
                 "kc_instructions": `Responda às ${TOTAL_QUESTIONS} perguntas abaixo. Você precisa acertar pelo menos <strong>${PASSING_SCORE} perguntas</strong> para passar nesta verificação. Você pode tentar quantas vezes precisar. Passar marcará este módulo como completo no seu painel.`,
                 "return_to_dashboard": "Voltar ao Painel",
                 "submit_button": "Enviar Respostas",
                 "result_score": "Sua pontuação: <strong>{score}/{total}</strong>",
                 "result_passed": "Parabéns! Você passou! 🎉 Progresso salvo.",
                 "result_failed": "Quase lá! Você precisa de pelo menos {passingScore} respostas corretas para passar.",
                 "try_again_button": "Tentar Novamente",
                 "progress_saved_msg": "Progresso salvo no painel!",
                 "lang_select_aria": "Selecionar Idioma", "lang_en": "🇬🇧 English", "lang_pt": "🇧🇷 Português", "lang_zh": "🇨🇳 中文",
                 "footer_text": "Parte do Projeto Road to Free Open AGI",
                  // Questions Module 2 - PT
                 "q1_text": "1. Qual é o resultado da expressão <code>5 + 3 * 2</code> em Python?", "q1_opt_a": "<code>16</code>", "q1_opt_b": "<code>11</code>", "q1_opt_c": "<code>13</code>", "q1_opt_d": "<code>8</code>",
                 "q2_text": "2. Qual operador realiza a divisão inteira (descarta o resto)?", "q2_opt_a": "<code>/</code>", "q2_opt_b": "<code>%</code>", "q2_opt_c": "<code>//</code>", "q2_opt_d": "<code>**</code>",
                 "q3_text": "3. Qual o resultado da expressão <code>10 % 3</code>?", "q3_opt_a": "<code>3</code>", "q3_opt_b": "<code>1</code>", "q3_opt_c": "<code>0</code>", "q3_opt_d": "<code>3.33...</code>",
                 "q4_text": "4. Qual expressão calcula 2 elevado à potência de 5?", "q4_opt_a": "<code>2 ^ 5</code>", "q4_opt_b": "<code>2 * 5</code>", "q4_opt_c": "<code>2 // 5</code>", "q4_opt_d": "<code>2 ** 5</code>",
                 "q5_text": "5. Qual é o resultado de <code>15 / 4</code>?", "q5_opt_a": "<code>3</code>", "q5_opt_b": "<code>3.0</code>", "q5_opt_c": "<code>3.75</code>", "q5_opt_d": "<code>4</code>",
                 "q6_text": "6. Qual é o resultado de <code>15 // 4</code>?", "q6_opt_a": "<code>3</code>", "q6_opt_b": "<code>3.0</code>", "q6_opt_c": "<code>3.75</code>", "q6_opt_d": "<code>4</code>",
                 "q7_text": "7. De acordo com a precedência de operadores, qual operação é realizada primeiro em <code>10 - 4 * 2</code>?", "q7_opt_a": "<code>10 - 4</code> (Subtração)", "q7_opt_b": "<code>4 * 2</code> (Multiplicação)", "q7_opt_c": "Operações são realizadas da esquerda para a direita", "q7_opt_d": "Causa um erro",
                 "q8_text": "8. Qual o valor de <code>result</code> após este código rodar: <code>result = (2 + 3) * 4</code>?", "q8_opt_a": "<code>14</code>", "q8_opt_b": "<code>20</code>", "q8_opt_c": "<code>11</code>", "q8_opt_d": "<code>9</code>",
                 "q9_text": "9. Qual é o resultado de <code>5 + 10 / 2</code>?", "q9_opt_a": "<code>7.5</code>", "q9_opt_b": "<code>10.0</code>", "q9_opt_c": "<code>10</code>", "q9_opt_d": "<code>7</code>",
                 "q10_text": "10. Qual tem a maior precedência entre os operadores aritméticos padrão abaixo?", "q10_opt_a": "<code>+</code> (Adição)", "q10_opt_b": "<code>*</code> (Multiplicação)", "q10_opt_c": "<code>**</code> (Exponenciação)", "q10_opt_d": "<code>/</code> (Divisão)",
             },
             zh: {
                 "page_title": `知识测验 - 模块 ${MODULE_ID}`,
                 "kc_title": `模块 ${MODULE_ID}: 处理数字 - 知识测验`,
                 "kc_instructions": `回答以下 ${TOTAL_QUESTIONS} 个问题。您至少需要答对 <strong>${PASSING_SCORE} 个问题</strong> 才能通过本次测验。您可以根据需要尝试多次。通过测验后，此模块将在您的仪表板上标记为已完成。`,
                 "return_to_dashboard": "返回仪表板",
                 "submit_button": "提交答案",
                 "result_score": "您的得分：<strong>{score}/{total}</strong>",
                 "result_passed": "恭喜！您已通过！🎉 进度已保存。",
                 "result_failed": "还差一点！您至少需要答对 {passingScore} 题才能通过。",
                 "try_again_button": "再试一次",
                 "progress_saved_msg": "进度已保存到仪表板！",
                 "lang_select_aria": "选择语言", "lang_en": "🇬🇧 English", "lang_pt": "🇧🇷 Português", "lang_zh": "🇨🇳 中文",
                 "footer_text": "通往自由开放AGI之路项目的一部分",
                 // Questions Module 2 - ZH
                 "q1_text": "1. Python 中表达式 <code>5 + 3 * 2</code> 的结果是什么？", "q1_opt_a": "<code>16</code>", "q1_opt_b": "<code>11</code>", "q1_opt_c": "<code>13</code>", "q1_opt_d": "<code>8</code>",
                 "q2_text": "2. 哪个运算符执行整除（丢弃余数）？", "q2_opt_a": "<code>/</code>", "q2_opt_b": "<code>%</code>", "q2_opt_c": "<code>//</code>", "q2_opt_d": "<code>**</code>",
                 "q3_text": "3. 表达式 <code>10 % 3</code> 的计算结果是什么？", "q3_opt_a": "<code>3</code>", "q3_opt_b": "<code>1</code>", "q3_opt_c": "<code>0</code>", "q3_opt_d": "<code>3.33...</code>",
                 "q4_text": "4. 哪个表达式计算 2 的 5 次方？", "q4_opt_a": "<code>2 ^ 5</code>", "q4_opt_b": "<code>2 * 5</code>", "q4_opt_c": "<code>2 // 5</code>", "q4_opt_d": "<code>2 ** 5</code>",
                 "q5_text": "5. <code>15 / 4</code> 的结果是什么？", "q5_opt_a": "<code>3</code>", "q5_opt_b": "<code>3.0</code>", "q5_opt_c": "<code>3.75</code>", "q5_opt_d": "<code>4</code>",
                 "q6_text": "6. <code>15 // 4</code> 的结果是什么？", "q6_opt_a": "<code>3</code>", "q6_opt_b": "<code>3.0</code>", "q6_opt_c": "<code>3.75</code>", "q6_opt_d": "<code>4</code>",
                 "q7_text": "7. 根据运算符优先级，<code>10 - 4 * 2</code> 中首先执行哪个运算？", "q7_opt_a": "<code>10 - 4</code> (减法)", "q7_opt_b": "<code>4 * 2</code> (乘法)", "q7_opt_c": "运算从左到右执行", "q7_opt_d": "会导致错误",
                 "q8_text": "8. 这段代码运行后 <code>result</code> 的值是多少：<code>result = (2 + 3) * 4</code>？", "q8_opt_a": "<code>14</code>", "q8_opt_b": "<code>20</code>", "q8_opt_c": "<code>11</code>", "q8_opt_d": "<code>9</code>",
                 "q9_text": "9. <code>5 + 10 / 2</code> 的结果是什么？", "q9_opt_a": "<code>7.5</code>", "q9_opt_b": "<code>10.0</code>", "q9_opt_c": "<code>10</code>", "q9_opt_d": "<code>7</code>",
                 "q10_text": "10. 在以下标准算术运算符中，哪个优先级最高？", "q10_opt_a": "<code>+</code> (加法)", "q10_opt_b": "<code>*</code> (乘法)", "q10_opt_c": "<code>**</code> (幂运算)", "q10_opt_d": "<code>/</code> (除法)",
             }
         };

        // --- Correct Answers ---
        const correctAnswers = {
            q1: 'b', // 5 + (3 * 2) = 5 + 6 = 11
            q2: 'c', // Floor division is //
            q3: 'b', // 10 divided by 3 is 3 with remainder 1
            q4: 'd', // Exponentiation is **
            q5: 'c', // Standard division results in float
            q6: 'a', // Floor division results in int
            q7: 'b', // Multiplication has higher precedence than subtraction
            q8: 'b', // Parentheses first: (5) * 4 = 20
            q9: 'b', // Division first: 5 + (10 / 2) = 5 + 5.0 = 10.0
            q10: 'c' // Exponentiation has the highest precedence
        };

        // --- Shared Helper Functions (Minimal necessary set) ---
        function loadKnowledgeCheckStatus() { try { const storedStatus = localStorage.getItem(KNOWLEDGE_CHECK_STORAGE_KEY); const parsed = storedStatus ? JSON.parse(storedStatus) : {}; return typeof parsed === 'object' && parsed !== null ? parsed : {}; } catch (e) { console.error("Error reading KC status from localStorage:", e); return {}; } }
        function saveKnowledgeCheckStatus(statusObject) { try { localStorage.setItem(KNOWLEDGE_CHECK_STORAGE_KEY, JSON.stringify(statusObject)); } catch (e) { console.error("Error saving KC status to localStorage:", e); } }
        function getStoredLanguage() { const storedLang = localStorage.getItem(LANGUAGE_STORAGE_KEY); if (storedLang && translations[storedLang]) return storedLang; const browserLang = navigator.language || navigator.userLanguage; if (browserLang.startsWith('pt')) return 'pt'; if (browserLang.startsWith('zh')) return 'zh'; return 'en'; }
        function getTranslation(key, lang, replacements = {}) { let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`; for (const placeholder in replacements) { const regex = new RegExp(`\\{${placeholder}\\}`, 'g'); text = text.replace(regex, replacements[placeholder]); } return text; }
        function translatePage(lang) { if (!translations[lang]) lang = 'en'; document.documentElement.lang = lang; document.querySelectorAll('[data-translate]').forEach(el => { const key = el.getAttribute('data-translate'); const translation = getTranslation(key, lang); if (el.tagName === 'TITLE') { document.title = translation; } else if (translation.includes('<') && translation.includes('>')) { el.innerHTML = translation; } else { el.textContent = translation; } }); document.querySelectorAll('[data-translate-placeholder]').forEach(el => { const key = el.getAttribute('data-translate-placeholder'); el.setAttribute('placeholder', getTranslation(key, lang)); }); document.querySelectorAll('[data-translate-aria-label]').forEach(el => { const key = el.getAttribute('data-translate-aria-label'); el.setAttribute('aria-label', getTranslation(key, lang)); }); }

        // --- Quiz Specific Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const quizForm = document.getElementById('quiz-form');
            const resultsDiv = document.getElementById('quiz-results');
            const submitButton = document.getElementById('submit-quiz');
            const languageSelect = document.getElementById('languageSelect');

             // --- Language Initialization ---
             const currentLang = getStoredLanguage();
             if (languageSelect) languageSelect.value = currentLang;
             translatePage(currentLang);

             // --- Language Selector Event ---
             if (languageSelect) {
                 languageSelect.addEventListener('change', (e) => {
                     const newLang = e.target.value;
                     localStorage.setItem(LANGUAGE_STORAGE_KEY, newLang);
                     translatePage(newLang);
                     // Re-translate results if they are visible
                     if (resultsDiv.style.display !== 'none') {
                         const score = parseInt(resultsDiv.dataset.score || '0');
                         displayResults(score); // Re-display with new language
                     }
                 });
             }


            quizForm.addEventListener('submit', (event) => {
                event.preventDefault();
                submitButton.disabled = true; // Prevent double submission

                let score = 0;
                const formData = new FormData(quizForm);

                for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                    const questionKey = `q${i}`;
                    const selectedAnswer = formData.get(questionKey);
                    if (selectedAnswer === correctAnswers[questionKey]) {
                        score++;
                    }
                }

                displayResults(score);
                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
            });

            function displayResults(score) {
                const lang = getStoredLanguage(); // Get current language for messages
                resultsDiv.innerHTML = ''; // Clear previous results

                const scoreText = getTranslation('result_score', lang, { score: score, total: TOTAL_QUESTIONS });
                const scorePara = document.createElement('p');
                scorePara.innerHTML = scoreText; // Use innerHTML because translation includes <strong>
                resultsDiv.appendChild(scorePara);

                resultsDiv.dataset.score = score; // Store score for re-translation

                if (score >= PASSING_SCORE) {
                    resultsDiv.className = 'pass'; // Add pass class for styling
                    const passMessage = document.createElement('p');
                    passMessage.textContent = getTranslation('result_passed', lang);
                    resultsDiv.appendChild(passMessage);

                    // Save progress to localStorage
                    let currentStatus = loadKnowledgeCheckStatus();
                    currentStatus[MODULE_ID] = true;
                    saveKnowledgeCheckStatus(currentStatus);

                    // Optional: Display a small confirmation message
                    // const savedMsg = document.createElement('p');
                    // savedMsg.textContent = getTranslation('progress_saved_msg', lang);
                    // savedMsg.className = 'progress-saved-msg';
                    // resultsDiv.appendChild(savedMsg);

                } else {
                    resultsDiv.className = 'fail'; // Add fail class
                    const failMessage = document.createElement('p');
                    failMessage.textContent = getTranslation('result_failed', lang, { passingScore: PASSING_SCORE });
                    resultsDiv.appendChild(failMessage);
                }

                // Add "Try Again" button
                const tryAgainButton = document.createElement('button');
                tryAgainButton.id = 'try-again-button';
                tryAgainButton.textContent = getTranslation('try_again_button', lang);
                tryAgainButton.type = 'button'; // Important: prevent form submission
                tryAgainButton.addEventListener('click', resetQuiz);
                resultsDiv.appendChild(tryAgainButton);

                resultsDiv.style.display = 'block';
            }

            function resetQuiz() {
                quizForm.reset(); // Clear selected radio buttons
                resultsDiv.style.display = 'none'; // Hide results area
                resultsDiv.innerHTML = ''; // Clear content
                resultsDiv.className = ''; // Remove pass/fail classes
                delete resultsDiv.dataset.score; // Remove stored score
                submitButton.disabled = false; // Re-enable submit button
                // Scroll back to the top of the quiz container
                document.querySelector('.kc-container h1').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

        });

    </script>

</body>
</html>
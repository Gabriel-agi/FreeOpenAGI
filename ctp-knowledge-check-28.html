<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="page_title_kc28">Knowledge Check: Module 28 - Sorting Algorithms</title>
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Base Styles & Variables (Copied from ctp-dashboard.html) --- */
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-page: #f0f2f5;
            --background-card: #ffffff;
            --background-sidebar: #ffffff;
            --background-header: linear-gradient(135deg, #0d6efd, #0a58ca);
            --text-light: #f8f9fa;
            --text-dark: #343a40;
            --text-muted: #6c757d;
            --accent-color: #ffc107;
            --success-color: #198754;
            --error-color: #dc3545;
            --info-color: #0dcaf0;
            --video-color: #fd7e14;
            --check-color: #6f42c1; /* Used for KC icon */
            --certificate-color: #d63384;
            --chat-panel-bg: #ffffff;
            --chat-box-bg: #f8f9fa;
            --chat-bot-bg: #e9ecef;
            --chat-bot-text: #343a40;
            --chat-user-bg: #d1e7ff;
            --chat-user-text: #0a58ca;
            --chat-error-bg: #f8d7da;
            --chat-error-text: #842029;
            --chat-border-color: #dee2e6;
            --progress-bg: #e9ecef;
            --progress-fill: var(--check-color);
            --border-color: #dee2e6;
            --border-radius: 8px;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            --card-shadow-hover: 0 6px 18px rgba(0, 0, 0, 0.1);
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
             /* Colors for lang switcher */
             --lang-select-border: var(--certificate-color);
             --lang-select-bg: rgba(255, 255, 255, 0.1);
             --lang-select-bg-hover: rgba(255, 255, 255, 0.15);
             --lang-option-bg: var(--background-card);
             --lang-option-text: var(--text-dark);
             --lang-arrow-color: var(--certificate-color);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.6;
            background-color: var(--background-page); color: var(--text-dark);
            overflow-x: hidden; padding-top: 80px; /* Add padding for fixed header */
        }

        /* --- Simplified Header for KC Page --- */
        .kc-header {
            background: var(--background-header);
            color: var(--text-light);
            padding: 1rem 1.5rem;
            position: fixed; /* Keep header fixed at the top */
            top: 0;
            left: 0;
            width: 100%;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .kc-header .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between; /* Adjust for button and title */
            align-items: center;
            width: 100%; /* Ensure it takes full width within max-width */
        }

        .kc-header h1 {
            font-family: var(--font-title);
            font-size: 1.6rem; /* Slightly smaller */
            margin: 0;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
            text-align: center; /* Center title if needed */
            flex-grow: 1; /* Allow title to take space */
        }
        .kc-header .back-button {
             color: var(--text-light);
             background-color: rgba(255, 255, 255, 0.15);
             border: 1px solid rgba(255, 255, 255, 0.5);
             padding: 0.5rem 1rem;
             border-radius: var(--border-radius);
             text-decoration: none;
             font-size: 0.9rem;
             font-weight: 500;
             transition: background-color var(--transition-speed) ease;
             display: inline-flex;
             align-items: center;
        }
        .kc-header .back-button i { margin-right: 6px; }
        .kc-header .back-button:hover { background-color: rgba(255, 255, 255, 0.25); }

        /* Language Switcher Styles (Keep same as dashboard) */
         .language-switcher { /* Positioned within header now */
             margin-left: 1rem; /* Space from title/back button */
             position: relative; /* Needed for custom arrow */
         }
         #languageSelect {
            min-width: 110px;
            background: var(--lang-select-bg); /* Use specific header bg */
            color: var(--text-light); /* Light text on dark header */
            border: 1px solid var(--lang-select-border);
            border-radius: 5px;
            padding: 6px 30px 6px 10px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            appearance: none; -webkit-appearance: none; -moz-appearance: none;
             /* Custom arrow using the variable color */
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23${encodeURIComponent(getComputedStyle(document.documentElement).getPropertyValue('--certificate-color').trim().substring(1))}%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 8px auto;
            transition: border-color 0.3s ease, background-color 0.3s ease;
         }
         #languageSelect:hover {
             border-color: var(--text-light);
             background-color: var(--lang-select-bg-hover);
         }
         #languageSelect:focus {
             outline: none;
             border-color: var(--accent-color);
             box-shadow: 0 0 0 2px rgba(255, 193, 7, 0.3); /* Accent focus */
         }
         #languageSelect option { /* Dropdown options styling */
              background: var(--lang-option-bg);
              color: var(--lang-option-text);
              padding: 5px;
         }

        /* --- Main Content Area for KC --- */
        .kc-container {
            max-width: 900px; /* Comfortable width for quiz */
            margin: 2rem auto; /* Space below header */
            padding: 2rem;
            background-color: var(--background-card);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
        }

        .kc-instructions {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        .kc-instructions h2 {
            font-family: var(--font-title);
            font-size: 1.8rem;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
        }
         .kc-instructions h2 i {
             margin-right: 10px;
             color: var(--check-color); /* Use check color for icon */
         }
        .kc-instructions p {
            color: var(--text-muted);
            font-size: 0.95rem;
        }
        .kc-instructions strong { color: var(--text-dark); }

        /* --- Quiz Styling --- */
        #quiz-form { } /* Container */

        .question-block {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background-color: #f8f9fa; /* Slightly different bg for questions */
            border-radius: var(--border-radius);
            border: 1px solid #e9ecef;
        }
        .question-block .question-text {
            font-weight: 500;
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: var(--text-dark);
        }
        .options-block { list-style: none; padding: 0; margin: 0; }
        .options-block li { margin-bottom: 0.8rem; }
        .options-block label {
            display: block; /* Make label clickable area larger */
            padding: 0.6rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            cursor: pointer;
            transition: background-color var(--transition-speed), border-color var(--transition-speed);
            background-color: var(--background-card);
        }
         .options-block label:hover {
             background-color: #eef;
             border-color: var(--primary-color);
         }
        .options-block input[type="radio"] {
            margin-right: 10px;
            vertical-align: middle; /* Align radio button better */
            accent-color: var(--primary-color); /* Modern browser feature */
        }
        .options-block input[type="radio"]:checked + span {
             font-weight: 500; /* Highlight selected option text */
        }
         /* Styling for disabled state after submission */
        .options-block input[type="radio"]:disabled + span {
            color: var(--text-muted);
            cursor: not-allowed;
        }
        .options-block input[type="radio"]:disabled:checked + span {
            font-weight: normal; /* Reset font weight */
        }
        .options-block label.disabled {
             background-color: #e9ecef;
             border-color: #dee2e6;
             cursor: not-allowed;
             opacity: 0.7;
        }
         .options-block label.disabled:hover {
             background-color: #e9ecef; /* Prevent hover effect */
             border-color: #dee2e6;
         }

        /* Submit Button */
        #submit-button {
            display: block; /* Center button */
            margin: 2rem auto 0 auto;
            padding: 0.8rem 2rem;
            font-size: 1.1rem;
            font-weight: 500;
            font-family: var(--font-body);
            color: var(--text-light);
            background-color: var(--check-color); /* Use check color */
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: background-color var(--transition-speed), transform var(--transition-speed);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        #submit-button:hover {
            background-color: #5a359a; /* Darker shade of check color */
            transform: translateY(-2px);
        }
        #submit-button:disabled {
             background-color: var(--secondary-color);
             cursor: not-allowed;
             transform: none;
             opacity: 0.7;
        }

        /* --- Results Area --- */
        #results-area {
            margin-top: 2.5rem;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            text-align: center;
            display: none; /* Initially hidden */
            border: 1px solid; /* Border color set by JS */
        }
        #results-area.passed {
             background-color: #d1e7dd; /* Light success */
             border-color: var(--success-color);
             color: #0f5132; /* Dark success */
        }
        #results-area.failed {
             background-color: #f8d7da; /* Light error */
             border-color: var(--error-color);
             color: #842029; /* Dark error */
        }
        #results-area h3 {
            font-family: var(--font-title);
            margin-bottom: 0.5rem;
            font-size: 1.5rem;
        }
        #results-area p { margin-bottom: 1rem; font-size: 1.1rem; }
        #retry-button {
            padding: 0.6rem 1.5rem;
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-light);
            background-color: var(--secondary-color);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: background-color var(--transition-speed);
            margin-top: 1rem;
             display: none; /* Initially hidden */
        }
        #retry-button:hover { background-color: #5a6268; }

        /* --- Footer --- */
        footer { text-align: center; padding: 1.5rem; margin-top: 3rem; background-color: var(--background-card); border-top: 1px solid var(--border-color); color: var(--text-muted); font-size: 0.9rem; }

        /* --- Responsive Design (Simplified for KC Page) --- */
        @media (max-width: 768px) {
             html { font-size: 15px; }
             body { padding-top: 70px; } /* Adjust for smaller header */
             .kc-header h1 { font-size: 1.4rem; }
             .kc-header .back-button { padding: 0.4rem 0.8rem; font-size: 0.85rem; }
             #languageSelect { padding: 5px 25px 5px 8px; font-size: 0.85rem; min-width: 100px; }
             .kc-container { padding: 1.5rem; margin: 1.5rem auto; }
             .kc-instructions h2 { font-size: 1.6rem; }
             .question-block { padding: 1rem; }
             .question-block .question-text { font-size: 1rem; }
             .options-block label { padding: 0.5rem 0.8rem; }
        }
        @media (max-width: 576px) {
             html { font-size: 14px; }
             body { padding-top: 60px; } /* Adjust further */
             .kc-header { padding: 0.8rem 1rem; flex-wrap: wrap; justify-content: center; } /* Allow wrap */
             .kc-header .back-button { order: 1; margin-bottom: 5px; /* Move to top left effectively */ }
             .kc-header h1 { order: 3; width: 100%; text-align: center; font-size: 1.3rem; margin-top: 5px; } /* Center title below */
             .language-switcher { order: 2; margin-left: 0; /* No margin needed */}
             .kc-container { padding: 1rem; margin: 1rem auto; }
             .kc-instructions h2 { font-size: 1.4rem; }
             .kc-instructions p { font-size: 0.9rem; }
             #submit-button { font-size: 1rem; padding: 0.7rem 1.5rem; }
             #results-area p { font-size: 1rem; }
             #retry-button { font-size: 0.9rem; padding: 0.5rem 1.2rem; }
        }

    </style>
</head>
<body>

    <header class="kc-header">
        <div class="header-content">
            <!-- Back Button -->
            <a href="ctp-dashboard.html" class="back-button">
                <i class="fas fa-arrow-left"></i> <span data-translate="kc_back_button">Back to Dashboard</span>
            </a>

            <!-- Title -->
            <h1 data-translate="kc_header_title_28">KC 28: Sorting</h1>

            <!-- Language Switcher -->
            <div class="language-switcher">
                <select id="languageSelect" data-translate-aria-label="lang_select_aria" aria-label="Select Language">
                    <option value="en" data-translate="lang_en">üá¨üáß English</option>
                    <option value="pt" data-translate="lang_pt">üáßüá∑ Portugu√™s</option>
                    <option value="zh" data-translate="lang_zh">üá®üá≥ ‰∏≠Êñá</option>
                </select>
            </div>
        </div>
    </header>

    <main class="kc-container">
        <section class="kc-instructions">
            <h2 data-translate="kc_instruction_title"><i class="fas fa-tasks"></i> Knowledge Check</h2>
            <p data-translate="kc_instruction_text">Test your understanding of Module 28 (Sorting Algorithms). Answer all 10 questions. You need at least <strong data-translate="kc_instruction_passing_score">6 correct answers</strong> to pass. You can retry as many times as you need.</p>
        </section>

        <form id="quiz-form">

            <!-- Question 1 -->
            <div class="question-block">
                <p class="question-text" data-translate="kc28_q1_text">1. What is the primary goal of a sorting algorithm?</p>
                <ul class="options-block">
                    <li><label><input type="radio" name="q1" value="a"><span data-translate="kc28_q1_opta"> To find the largest element in a list.</span></label></li>
                    <li><label><input type="radio" name="q1" value="b"><span data-translate="kc28_q1_optb"> To arrange elements in a specific order (e.g., ascending or descending).</span></label></li>
                    <li><label><input type="radio" name="q1" value="c"><span data-translate="kc28_q1_optc"> To remove duplicate elements from a list.</span></label></li>
                    <li><label><input type="radio" name="q1" value="d"><span data-translate="kc28_q1_optd"> To count how many elements are in a list.</span></label></li>
                </ul>
            </div>

            <!-- Question 2 -->
            <div class="question-block">
                <p class="question-text" data-translate="kc28_q2_text">2. Which Computational Thinking concept is most directly related to designing the steps of a sorting algorithm like Bubble Sort or Selection Sort?</p>
                <ul class="options-block">
                    <li><label><input type="radio" name="q2" value="a"><span data-translate="kc28_q2_opta"> Abstraction (Hiding complex details).</span></label></li>
                    <li><label><input type="radio" name="q2" value="b"><span data-translate="kc28_q2_optb"> Decomposition (Breaking down a problem).</span></label></li>
                    <li><label><input type="radio" name="q2" value="c"><span data-translate="kc28_q2_optc"> Pattern Recognition (Finding similarities).</span></label></li>
                    <li><label><input type="radio" name="q2" value="d"><span data-translate="kc28_q2_optd"> Algorithm Design (Creating step-by-step instructions).</span></label></li>
                </ul>
            </div>

            <!-- Question 3 -->
            <div class="question-block">
                <p class="question-text" data-translate="kc28_q3_text">3. What is the core operation performed repeatedly in Bubble Sort?</p>
                <ul class="options-block">
                    <li><label><input type="radio" name="q3" value="a"><span data-translate="kc28_q3_opta"> Finding the smallest element in the unsorted portion.</span></label></li>
                    <li><label><input type="radio" name="q3" value="b"><span data-translate="kc28_q3_optb"> Comparing adjacent elements and swapping them if they are in the wrong order.</span></label></li>
                    <li><label><input type="radio" name="q3" value="c"><span data-translate="kc28_q3_optc"> Dividing the list into smaller sub-lists.</span></label></li>
                    <li><label><input type="radio" name="q3" value="d"><span data-translate="kc28_q3_optd"> Inserting an element into its correct position in a sorted portion.</span></label></li>
                </ul>
            </div>

             <!-- Question 4 -->
             <div class="question-block">
                <p class="question-text" data-translate="kc28_q4_text">4. Consider the list <code>[5, 1, 4, 2]</code>. After the *first pass* of Bubble Sort (comparing and swapping adjacent elements from left to right), what will the list look like?</p>
                <ul class="options-block">
                    <li><label><input type="radio" name="q4" value="a"><span data-translate="kc28_q4_opta"> <code>[1, 5, 4, 2]</code></span></label></li>
                    <li><label><input type="radio" name="q4" value="b"><span data-translate="kc28_q4_optb"> <code>[1, 4, 2, 5]</code></span></label></li>
                    <li><label><input type="radio" name="q4" value="c"><span data-translate="kc28_q4_optc"> <code>[5, 1, 2, 4]</code></span></label></li>
                     <li><label><input type="radio" name="q4" value="d"><span data-translate="kc28_q4_optd"> <code>[1, 5, 2, 4]</code></span></label></li>
                </ul>
            </div>

             <!-- Question 5 -->
            <div class="question-block">
                <p class="question-text" data-translate="kc28_q5_text">5. What is the core operation performed in each pass of Selection Sort?</p>
                <ul class="options-block">
                    <li><label><input type="radio" name="q5" value="a"><span data-translate="kc28_q5_opta"> Swapping every adjacent pair that is out of order.</span></label></li>
                    <li><label><input type="radio" name="q5" value="b"><span data-translate="kc28_q5_optb"> Finding the minimum (or maximum) element in the unsorted portion and swapping it to the beginning of the unsorted portion.</span></label></li>
                    <li><label><input type="radio" name="q5" value="c"><span data-translate="kc28_q5_optc"> Merging two sorted halves of the list.</span></label></li>
                     <li><label><input type="radio" name="q5" value="d"><span data-translate="kc28_q5_optd"> Picking an element and comparing it to all others.</span></label></li>
                </ul>
            </div>

            <!-- Question 6 -->
            <div class="question-block">
                <p class="question-text" data-translate="kc28_q6_text">6. Consider the list <code>[5, 1, 4, 2]</code>. After the *first pass* of Selection Sort (finding the minimum and swapping it with the first element), what will the list look like?</p>
                <ul class="options-block">
                     <li><label><input type="radio" name="q6" value="a"><span data-translate="kc28_q6_opta"> <code>[1, 5, 4, 2]</code></span></label></li>
                    <li><label><input type="radio" name="q6" value="b"><span data-translate="kc28_q6_optb"> <code>[5, 1, 2, 4]</code></span></label></li>
                    <li><label><input type="radio" name="q6" value="c"><span data-translate="kc28_q6_optc"> <code>[1, 4, 5, 2]</code></span></label></li>
                    <li><label><input type="radio" name="q6" value="d"><span data-translate="kc28_q6_optd"> <code>[1, 2, 4, 5]</code></span></label></li>
                </ul>
            </div>

            <!-- Question 7 -->
            <div class="question-block">
                 <p class="question-text" data-translate="kc28_q7_text">7. How many swaps does Selection Sort perform in the worst case for a list of N elements?</p>
                 <ul class="options-block">
                    <li><label><input type="radio" name="q7" value="a"><span data-translate="kc28_q7_opta"> Exactly N swaps.</span></label></li>
                    <li><label><input type="radio" name="q7" value="b"><span data-translate="kc28_q7_optb"> At most N-1 swaps.</span></label></li>
                    <li><label><input type="radio" name="q7" value="c"><span data-translate="kc28_q7_optc"> It depends on the initial order, could be many more than N swaps (like Bubble Sort).</span></label></li>
                    <li><label><input type="radio" name="q7" value="d"><span data-translate="kc28_q7_optd"> Zero swaps if the list is already sorted.</span></label></li>
                </ul>
            </div>

            <!-- Question 8 -->
            <div class="question-block">
                <p class="question-text" data-translate="kc28_q8_text">8. Which simple sorting algorithm might finish early if the list becomes sorted during one of its passes?</p>
                 <ul class="options-block">
                    <li><label><input type="radio" name="q8" value="a"><span data-translate="kc28_q8_opta"> Selection Sort</span></label></li>
                    <li><label><input type="radio" name="q8" value="b"><span data-translate="kc28_q8_optb"> Bubble Sort (if implemented with an optimization flag)</span></label></li>
                    <li><label><input type="radio" name="q8" value="c"><span data-translate="kc28_q8_optc"> Both Bubble Sort and Selection Sort</span></label></li>
                    <li><label><input type="radio" name="q8" value="d"><span data-translate="kc28_q8_optd"> Neither, they always complete all passes.</span></label></li>
                </ul>
            </div>

            <!-- Question 9 -->
            <div class="question-block">
                 <p class="question-text" data-translate="kc28_q9_text">9. In general, for large, randomly ordered lists, are Bubble Sort and Selection Sort considered highly efficient compared to more advanced algorithms?</p>
                <ul class="options-block">
                     <li><label><input type="radio" name="q9" value="a"><span data-translate="kc28_q9_opta"> Yes, they are the fastest simple sorts.</span></label></li>
                    <li><label><input type="radio" name="q9" value="b"><span data-translate="kc28_q9_optb"> No, they are generally slower than algorithms like Merge Sort or Quick Sort for large lists.</span></label></li>
                    <li><label><input type="radio" name="q9" value="c"><span data-translate="kc28_q9_optc"> They are efficient only if the list is almost sorted already.</span></label></li>
                     <li><label><input type="radio" name="q9" value="d"><span data-translate="kc28_q9_optd"> Their efficiency is comparable to advanced algorithms.</span></label></li>
                 </ul>
            </div>

            <!-- Question 10 -->
            <div class="question-block">
                <p class="question-text" data-translate="kc28_q10_text">10. Why is understanding simple sorting algorithms like Bubble Sort and Selection Sort useful, even if more efficient ones exist?</p>
                <ul class="options-block">
                    <li><label><input type="radio" name="q10" value="a"><span data-translate="kc28_q10_opta"> They are the only algorithms used in modern software.</span></label></li>
                    <li><label><input type="radio" name="q10" value="b"><span data-translate="kc28_q10_optb"> They help build foundational understanding of algorithmic concepts like comparison, swapping, and iteration.</span></label></li>
                    <li><label><input type="radio" name="q10" value="c"><span data-translate="kc28_q10_optc"> They are required for advanced AI development.</span></label></li>
                    <li><label><input type="radio" name="q10" value="d"><span data-translate="kc28_q10_optd"> They are primarily used for sorting text data.</span></label></li>
                </ul>
            </div>

            <button type="submit" id="submit-button" data-translate="kc_submit_button">Submit Answers</button>

        </form>

        <div id="results-area">
            <h3 id="results-title"></h3>
            <p id="results-text"></p>
            <button id="retry-button" data-translate="kc_retry_button">Retry Quiz</button>
        </div>

    </main>

    <footer>
        <p data-translate="footer_text">Part of the Road to Free Open AGI Project</p>
    </footer>

    <script>
        const MODULE_ID = 28; // Define the current module ID
        const KNOWLEDGE_CHECK_STORAGE_KEY = 'knowledgeCheckStatus_v1';
        const LANGUAGE_STORAGE_KEY = 'userLanguage';
        const PASSING_SCORE = 6;
        const TOTAL_QUESTIONS = 10;

        // --- Correct Answers ---
        const correctAnswers = {
            q1: 'b', q2: 'd', q3: 'b', q4: 'b', q5: 'b',
            q6: 'a', q7: 'b', q8: 'b', q9: 'b', q10: 'b'
        };

        // --- Translations Object (Add KC-specific keys) ---
        const translations = {
             en: { /* English */
                "page_title_kc28": "Knowledge Check: Module 28 - Sorting Algorithms",
                "kc_back_button": "Back to Dashboard",
                "kc_header_title_28": "KC 28: Sorting",
                "kc_instruction_title": "Knowledge Check",
                "kc_instruction_text": "Test your understanding of Module 28 (Sorting Algorithms). Answer all 10 questions. You need at least <strong>{passingScore} correct answers</strong> to pass. You can retry as many times as you need.",
                "kc_instruction_passing_score": "6",
                "kc_submit_button": "Submit Answers",
                "kc_retry_button": "Retry Quiz",
                "kc_results_passed_title": "Passed!",
                "kc_results_failed_title": "Try Again",
                "kc_results_passed_text": "Congratulations! You answered {score} out of {total} questions correctly. Your progress for this module is updated.",
                "kc_results_failed_text": "You answered {score} out of {total} questions correctly. You need {passingScore} to pass. Keep trying!",
                /* Questions & Options */
                "kc28_q1_text": "1. What is the primary goal of a sorting algorithm?",
                "kc28_q1_opta": " To find the largest element in a list.",
                "kc28_q1_optb": " To arrange elements in a specific order (e.g., ascending or descending).",
                "kc28_q1_optc": " To remove duplicate elements from a list.",
                "kc28_q1_optd": " To count how many elements are in a list.",
                "kc28_q2_text": "2. Which Computational Thinking concept is most directly related to designing the steps of a sorting algorithm like Bubble Sort or Selection Sort?",
                "kc28_q2_opta": " Abstraction (Hiding complex details).",
                "kc28_q2_optb": " Decomposition (Breaking down a problem).",
                "kc28_q2_optc": " Pattern Recognition (Finding similarities).",
                "kc28_q2_optd": " Algorithm Design (Creating step-by-step instructions).",
                "kc28_q3_text": "3. What is the core operation performed repeatedly in Bubble Sort?",
                "kc28_q3_opta": " Finding the smallest element in the unsorted portion.",
                "kc28_q3_optb": " Comparing adjacent elements and swapping them if they are in the wrong order.",
                "kc28_q3_optc": " Dividing the list into smaller sub-lists.",
                "kc28_q3_optd": " Inserting an element into its correct position in a sorted portion.",
                "kc28_q4_text": "4. Consider the list `[5, 1, 4, 2]`. After the *first pass* of Bubble Sort (comparing and swapping adjacent elements from left to right), what will the list look like?",
                "kc28_q4_opta": " `[1, 5, 4, 2]`",
                "kc28_q4_optb": " `[1, 4, 2, 5]`", // Correct: 5>1 swap -> [1,5,4,2]; 5>4 swap -> [1,4,5,2]; 5>2 swap -> [1,4,2,5]
                "kc28_q4_optc": " `[5, 1, 2, 4]`",
                "kc28_q4_optd": " `[1, 5, 2, 4]`",
                "kc28_q5_text": "5. What is the core operation performed in each pass of Selection Sort?",
                "kc28_q5_opta": " Swapping every adjacent pair that is out of order.",
                "kc28_q5_optb": " Finding the minimum (or maximum) element in the unsorted portion and swapping it to the beginning of the unsorted portion.",
                "kc28_q5_optc": " Merging two sorted halves of the list.",
                "kc28_q5_optd": " Picking an element and comparing it to all others.",
                "kc28_q6_text": "6. Consider the list `[5, 1, 4, 2]`. After the *first pass* of Selection Sort (finding the minimum and swapping it with the first element), what will the list look like?",
                "kc28_q6_opta": " `[1, 5, 4, 2]`", // Correct: Min is 1 at index 1. Swap with index 0 (value 5).
                "kc28_q6_optb": " `[5, 1, 2, 4]`",
                "kc28_q6_optc": " `[1, 4, 5, 2]`",
                "kc28_q6_optd": " `[1, 2, 4, 5]`",
                "kc28_q7_text": "7. How many swaps does Selection Sort perform in the worst case for a list of N elements?",
                "kc28_q7_opta": " Exactly N swaps.",
                "kc28_q7_optb": " At most N-1 swaps.", // Correct: One swap per pass (except possibly the last).
                "kc28_q7_optc": " It depends on the initial order, could be many more than N swaps (like Bubble Sort).",
                "kc28_q7_optd": " Zero swaps if the list is already sorted.",
                "kc28_q8_text": "8. Which simple sorting algorithm might finish early if the list becomes sorted during one of its passes?",
                "kc28_q8_opta": " Selection Sort",
                "kc28_q8_optb": " Bubble Sort (if implemented with an optimization flag)", // Correct
                "kc28_q8_optc": " Both Bubble Sort and Selection Sort",
                "kc28_q8_optd": " Neither, they always complete all passes.",
                "kc28_q9_text": "9. In general, for large, randomly ordered lists, are Bubble Sort and Selection Sort considered highly efficient compared to more advanced algorithms?",
                "kc28_q9_opta": " Yes, they are the fastest simple sorts.",
                "kc28_q9_optb": " No, they are generally slower than algorithms like Merge Sort or Quick Sort for large lists.", // Correct
                "kc28_q9_optc": " They are efficient only if the list is almost sorted already.",
                "kc28_q9_optd": " Their efficiency is comparable to advanced algorithms.",
                "kc28_q10_text": "10. Why is understanding simple sorting algorithms like Bubble Sort and Selection Sort useful, even if more efficient ones exist?",
                "kc28_q10_opta": " They are the only algorithms used in modern software.",
                "kc28_q10_optb": " They help build foundational understanding of algorithmic concepts like comparison, swapping, and iteration.", // Correct
                "kc28_q10_optc": " They are required for advanced AI development.",
                "kc28_q10_optd": " They are primarily used for sorting text data.",
                /* Shared keys needed for JS */
                "lang_select_aria": "Select Language", "lang_en": "üá¨üáß English", "lang_pt": "üáßüá∑ Portugu√™s", "lang_zh": "üá®üá≥ ‰∏≠Êñá", "footer_text": "Part of the Road to Free Open AGI Project"
             },
             pt: { /* Portuguese */
                "page_title_kc28": "Verifica√ß√£o de Conhecimento: M√≥dulo 28 - Algoritmos de Ordena√ß√£o",
                "kc_back_button": "Voltar ao Painel",
                "kc_header_title_28": "VC 28: Ordena√ß√£o",
                "kc_instruction_title": "Verifica√ß√£o de Conhecimento",
                "kc_instruction_text": "Teste seu entendimento do M√≥dulo 28 (Algoritmos de Ordena√ß√£o). Responda a todas as 10 perguntas. Voc√™ precisa de pelo menos <strong data-translate=\"kc_instruction_passing_score\">{passingScore} respostas corretas</strong> para passar. Voc√™ pode tentar novamente quantas vezes precisar.",
                "kc_instruction_passing_score": "6",
                "kc_submit_button": "Enviar Respostas",
                "kc_retry_button": "Tentar Novamente",
                "kc_results_passed_title": "Aprovado!",
                "kc_results_failed_title": "Tente Novamente",
                "kc_results_passed_text": "Parab√©ns! Voc√™ acertou {score} de {total} perguntas. Seu progresso para este m√≥dulo foi atualizado.",
                "kc_results_failed_text": "Voc√™ acertou {score} de {total} perguntas. Voc√™ precisa de {passingScore} para passar. Continue tentando!",
                 /* Questions & Options */
                "kc28_q1_text": "1. Qual √© o objetivo principal de um algoritmo de ordena√ß√£o?",
                "kc28_q1_opta": " Encontrar o maior elemento em uma lista.",
                "kc28_q1_optb": " Organizar os elementos em uma ordem espec√≠fica (ex: crescente ou decrescente).",
                "kc28_q1_optc": " Remover elementos duplicados de uma lista.",
                "kc28_q1_optd": " Contar quantos elementos existem em uma lista.",
                "kc28_q2_text": "2. Qual conceito do Pensamento Computacional est√° mais diretamente relacionado ao projeto dos passos de um algoritmo de ordena√ß√£o como Bubble Sort ou Selection Sort?",
                "kc28_q2_opta": " Abstra√ß√£o (Ocultar detalhes complexos).",
                "kc28_q2_optb": " Decomposi√ß√£o (Dividir um problema).",
                "kc28_q2_optc": " Reconhecimento de Padr√µes (Encontrar semelhan√ßas).",
                "kc28_q2_optd": " Design de Algoritmos (Criar instru√ß√µes passo a passo).",
                "kc28_q3_text": "3. Qual √© a opera√ß√£o principal realizada repetidamente no Bubble Sort?",
                "kc28_q3_opta": " Encontrar o menor elemento na por√ß√£o n√£o ordenada.",
                "kc28_q3_optb": " Comparar elementos adjacentes e troc√°-los se estiverem na ordem errada.",
                "kc28_q3_optc": " Dividir a lista em sub-listas menores.",
                "kc28_q3_optd": " Inserir um elemento em sua posi√ß√£o correta em uma por√ß√£o ordenada.",
                "kc28_q4_text": "4. Considere a lista `[5, 1, 4, 2]`. Ap√≥s a *primeira passagem* do Bubble Sort (comparando e trocando elementos adjacentes da esquerda para a direita), como ficar√° a lista?",
                "kc28_q4_opta": " `[1, 5, 4, 2]`",
                "kc28_q4_optb": " `[1, 4, 2, 5]`", // Correto
                "kc28_q4_optc": " `[5, 1, 2, 4]`",
                "kc28_q4_optd": " `[1, 5, 2, 4]`",
                "kc28_q5_text": "5. Qual √© a opera√ß√£o principal realizada em cada passagem do Selection Sort?",
                "kc28_q5_opta": " Trocar cada par adjacente que est√° fora de ordem.",
                "kc28_q5_optb": " Encontrar o elemento m√≠nimo (ou m√°ximo) na por√ß√£o n√£o ordenada e troc√°-lo para o in√≠cio da por√ß√£o n√£o ordenada.",
                "kc28_q5_optc": " Mesclar duas metades ordenadas da lista.",
                "kc28_q5_optd": " Escolher um elemento e compar√°-lo com todos os outros.",
                "kc28_q6_text": "6. Considere a lista `[5, 1, 4, 2]`. Ap√≥s a *primeira passagem* do Selection Sort (encontrando o m√≠nimo e trocando-o com o primeiro elemento), como ficar√° a lista?",
                "kc28_q6_opta": " `[1, 5, 4, 2]`", // Correto
                "kc28_q6_optb": " `[5, 1, 2, 4]`",
                "kc28_q6_optc": " `[1, 4, 5, 2]`",
                "kc28_q6_optd": " `[1, 2, 4, 5]`",
                "kc28_q7_text": "7. Quantas trocas o Selection Sort realiza no pior caso para uma lista de N elementos?",
                "kc28_q7_opta": " Exatamente N trocas.",
                "kc28_q7_optb": " No m√°ximo N-1 trocas.", // Correto
                "kc28_q7_optc": " Depende da ordem inicial, podem ser muito mais que N trocas (como o Bubble Sort).",
                "kc28_q7_optd": " Zero trocas se a lista j√° estiver ordenada.",
                "kc28_q8_text": "8. Qual algoritmo de ordena√ß√£o simples pode terminar mais cedo se a lista ficar ordenada durante uma de suas passagens?",
                "kc28_q8_opta": " Selection Sort",
                "kc28_q8_optb": " Bubble Sort (se implementado com uma flag de otimiza√ß√£o)", // Correto
                "kc28_q8_optc": " Ambos Bubble Sort e Selection Sort",
                "kc28_q8_optd": " Nenhum, eles sempre completam todas as passagens.",
                "kc28_q9_text": "9. Em geral, para listas grandes e ordenadas aleatoriamente, o Bubble Sort e o Selection Sort s√£o considerados altamente eficientes em compara√ß√£o com algoritmos mais avan√ßados?",
                "kc28_q9_opta": " Sim, s√£o as ordena√ß√µes simples mais r√°pidas.",
                "kc28_q9_optb": " N√£o, geralmente s√£o mais lentos que algoritmos como Merge Sort ou Quick Sort para listas grandes.", // Correto
                "kc28_q9_optc": " S√£o eficientes apenas se a lista j√° estiver quase ordenada.",
                "kc28_q9_optd": " Sua efici√™ncia √© compar√°vel a algoritmos avan√ßados.",
                "kc28_q10_text": "10. Por que √© √∫til entender algoritmos de ordena√ß√£o simples como Bubble Sort e Selection Sort, mesmo que existam outros mais eficientes?",
                "kc28_q10_opta": " S√£o os √∫nicos algoritmos usados em software moderno.",
                "kc28_q10_optb": " Ajudam a construir uma compreens√£o fundamental de conceitos algor√≠tmicos como compara√ß√£o, troca e itera√ß√£o.", // Correto
                "kc28_q10_optc": " S√£o necess√°rios para o desenvolvimento avan√ßado de IA.",
                "kc28_q10_optd": " S√£o usados principalmente para ordenar dados de texto.",
                /* Shared keys needed for JS */
                "lang_select_aria": "Selecionar Idioma", "lang_en": "üá¨üáß English", "lang_pt": "üáßüá∑ Portugu√™s", "lang_zh": "üá®üá≥ ‰∏≠Êñá", "footer_text": "Parte do Projeto Road to Free Open AGI"
            },
             zh: { /* Chinese */
                 "page_title_kc28": "Áü•ËØÜÊµãÈ™åÔºöÊ®°Âùó 28 - ÊéíÂ∫èÁÆóÊ≥ï",
                "kc_back_button": "ËøîÂõû‰ª™Ë°®Êùø",
                "kc_header_title_28": "Áü•Êµã 28ÔºöÊéíÂ∫è",
                "kc_instruction_title": "Áü•ËØÜÊµãÈ™å",
                "kc_instruction_text": "ÊµãËØïÊÇ®ÂØπÊ®°Âùó 28ÔºàÊéíÂ∫èÁÆóÊ≥ïÔºâÁöÑÁêÜËß£„ÄÇÂõûÁ≠îÊâÄÊúâ 10 ‰∏™ÈóÆÈ¢ò„ÄÇÊÇ®Ëá≥Â∞ëÈúÄË¶ÅÁ≠îÂØπ <strong data-translate=\"kc_instruction_passing_score\">{passingScore} È¢ò</strong> ÊâçËÉΩÈÄöËøá„ÄÇÊÇ®ÂèØ‰ª•Ê†πÊçÆÈúÄË¶ÅÈáçËØï‰ªªÊÑèÊ¨°Êï∞„ÄÇ",
                "kc_instruction_passing_score": "6",
                "kc_submit_button": "Êèê‰∫§Á≠îÊ°à",
                "kc_retry_button": "ÈáçÊñ∞ÊµãÈ™å",
                "kc_results_passed_title": "ÈÄöËøáÔºÅ",
                "kc_results_failed_title": "ÂÜçËØï‰∏ÄÊ¨°",
                "kc_results_passed_text": "ÊÅ≠ÂñúÔºÅÊÇ®Âú® {total} È¢ò‰∏≠Á≠îÂØπ‰∫Ü {score} È¢ò„ÄÇÊÇ®Âú®Ê≠§Ê®°ÂùóÁöÑËøõÂ∫¶Â∑≤Êõ¥Êñ∞„ÄÇ",
                "kc_results_failed_text": "ÊÇ®Âú® {total} È¢ò‰∏≠Á≠îÂØπ‰∫Ü {score} È¢ò„ÄÇÊÇ®ÈúÄË¶ÅÁ≠îÂØπ {passingScore} È¢òÊâçËÉΩÈÄöËøá„ÄÇÁªßÁª≠Âä™ÂäõÔºÅ",
                 /* Questions & Options */
                "kc28_q1_text": "1. ÊéíÂ∫èÁÆóÊ≥ïÁöÑ‰∏ªË¶ÅÁõÆÊ†áÊòØ‰ªÄ‰πàÔºü",
                "kc28_q1_opta": " ÊâæÂà∞ÂàóË°®‰∏≠ÁöÑÊúÄÂ§ßÂÖÉÁ¥†„ÄÇ",
                "kc28_q1_optb": " ÊåâÁâπÂÆöÈ°∫Â∫èÔºà‰æãÂ¶ÇÔºåÂçáÂ∫èÊàñÈôçÂ∫èÔºâÊéíÂàóÂÖÉÁ¥†„ÄÇ",
                "kc28_q1_optc": " ‰ªéÂàóË°®‰∏≠Âà†Èô§ÈáçÂ§çÂÖÉÁ¥†„ÄÇ",
                "kc28_q1_optd": " ËÆ°ÁÆóÂàóË°®‰∏≠ÊúâÂ§öÂ∞ë‰∏™ÂÖÉÁ¥†„ÄÇ",
                "kc28_q2_text": "2. Âì™‰∏™ËÆ°ÁÆóÊÄùÁª¥Ê¶ÇÂøµ‰∏éËÆæËÆ°ÂÉèÂÜíÊ≥°ÊéíÂ∫èÊàñÈÄâÊã©ÊéíÂ∫èËøôÊ†∑ÁöÑÊéíÂ∫èÁÆóÊ≥ïÊ≠•È™§ÊúÄÁõ¥Êé•Áõ∏ÂÖ≥Ôºü",
                "kc28_q2_opta": " ÊäΩË±°ÔºàÈöêËóèÂ§çÊùÇÁªÜËäÇÔºâ„ÄÇ",
                "kc28_q2_optb": " ÂàÜËß£ÔºàÂàÜËß£ÈóÆÈ¢òÔºâ„ÄÇ",
                "kc28_q2_optc": " Ê®°ÂºèËØÜÂà´ÔºàÂèëÁé∞Áõ∏‰ººÊÄßÔºâ„ÄÇ",
                "kc28_q2_optd": " ÁÆóÊ≥ïËÆæËÆ°ÔºàÂàõÂª∫ÂàÜÊ≠•ËØ¥ÊòéÔºâ„ÄÇ",
                "kc28_q3_text": "3. ÂÜíÊ≥°ÊéíÂ∫è‰∏≠ÂèçÂ§çÊâßË°åÁöÑÊ†∏ÂøÉÊìç‰ΩúÊòØ‰ªÄ‰πàÔºü",
                "kc28_q3_opta": " Âú®Êú™ÊéíÂ∫èÈÉ®ÂàÜÊâæÂà∞ÊúÄÂ∞èÁöÑÂÖÉÁ¥†„ÄÇ",
                "kc28_q3_optb": " ÊØîËæÉÁõ∏ÈÇªÂÖÉÁ¥†ÔºåÂ¶ÇÊûúÈ°∫Â∫èÈîôËØØÂàô‰∫§Êç¢ÂÆÉ‰ª¨„ÄÇ",
                "kc28_q3_optc": " Â∞ÜÂàóË°®ÂàÜÊàêÊõ¥Â∞èÁöÑÂ≠êÂàóË°®„ÄÇ",
                "kc28_q3_optd": " Â∞ÜÂÖÉÁ¥†ÊèíÂÖ•Âà∞Â∑≤ÊéíÂ∫èÈÉ®ÂàÜÁöÑÊ≠£Á°Æ‰ΩçÁΩÆ„ÄÇ",
                "kc28_q4_text": "4. ËÄÉËôëÂàóË°® `[5, 1, 4, 2]`„ÄÇÂú®ÂÜíÊ≥°ÊéíÂ∫èÁöÑ*Á¨¨‰∏ÄËΩÆ*Ôºà‰ªéÂ∑¶Âà∞Âè≥ÊØîËæÉÂíå‰∫§Êç¢Áõ∏ÈÇªÂÖÉÁ¥†Ôºâ‰πãÂêéÔºåÂàóË°®‰ºöÊòØ‰ªÄ‰πàÊ†∑Â≠êÔºü",
                "kc28_q4_opta": " `[1, 5, 4, 2]`",
                "kc28_q4_optb": " `[1, 4, 2, 5]`", // Ê≠£Á°Æ
                "kc28_q4_optc": " `[5, 1, 2, 4]`",
                "kc28_q4_optd": " `[1, 5, 2, 4]`",
                "kc28_q5_text": "5. ÈÄâÊã©ÊéíÂ∫èÁöÑÊØè‰∏ÄËΩÆÊâßË°åÁöÑÊ†∏ÂøÉÊìç‰ΩúÊòØ‰ªÄ‰πàÔºü",
                "kc28_q5_opta": " ‰∫§Êç¢ÊØè‰∏ÄÂØπÈ°∫Â∫èÈîôËØØÁöÑÁõ∏ÈÇªÂÖÉÁ¥†„ÄÇ",
                "kc28_q5_optb": " Âú®Êú™ÊéíÂ∫èÈÉ®ÂàÜÊâæÂà∞ÊúÄÂ∞èÔºàÊàñÊúÄÂ§ßÔºâÁöÑÂÖÉÁ¥†ÔºåÂπ∂Â∞ÜÂÖ∂‰∫§Êç¢Âà∞Êú™ÊéíÂ∫èÈÉ®ÂàÜÁöÑÂºÄÂ§¥„ÄÇ",
                "kc28_q5_optc": " ÂêàÂπ∂ÂàóË°®ÁöÑ‰∏§‰∏™Â∑≤ÊéíÂ∫èÈÉ®ÂàÜ„ÄÇ",
                "kc28_q5_optd": " ÈÄâÊã©‰∏Ä‰∏™ÂÖÉÁ¥†Âπ∂Â∞ÜÂÖ∂‰∏éÊâÄÊúâÂÖ∂‰ªñÂÖÉÁ¥†ËøõË°åÊØîËæÉ„ÄÇ",
                "kc28_q6_text": "6. ËÄÉËôëÂàóË°® `[5, 1, 4, 2]`„ÄÇÂú®ÈÄâÊã©ÊéíÂ∫èÁöÑ*Á¨¨‰∏ÄËΩÆ*ÔºàÊâæÂà∞ÊúÄÂ∞èÂÄºÂπ∂Â∞ÜÂÖ∂‰∏éÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†‰∫§Êç¢Ôºâ‰πãÂêéÔºåÂàóË°®‰ºöÊòØ‰ªÄ‰πàÊ†∑Â≠êÔºü",
                "kc28_q6_opta": " `[1, 5, 4, 2]`", // Ê≠£Á°Æ
                "kc28_q6_optb": " `[5, 1, 2, 4]`",
                "kc28_q6_optc": " `[1, 4, 5, 2]`",
                "kc28_q6_optd": " `[1, 2, 4, 5]`",
                "kc28_q7_text": "7. ÂØπ‰∫éÂåÖÂê´ N ‰∏™ÂÖÉÁ¥†ÁöÑÂàóË°®ÔºåÈÄâÊã©ÊéíÂ∫èÂú®ÊúÄÂùèÊÉÖÂÜµ‰∏ãÊâßË°åÂ§öÂ∞ëÊ¨°‰∫§Êç¢Ôºü",
                "kc28_q7_opta": " Ê≠£Â•Ω N Ê¨°‰∫§Êç¢„ÄÇ",
                "kc28_q7_optb": " ÊúÄÂ§ö N-1 Ê¨°‰∫§Êç¢„ÄÇ", // Ê≠£Á°Æ
                "kc28_q7_optc": " ÂèñÂÜ≥‰∫éÂàùÂßãÈ°∫Â∫èÔºåÂèØËÉΩÊØî N Ê¨°‰∫§Êç¢Â§öÂæóÂ§öÔºàÂÉèÂÜíÊ≥°ÊéíÂ∫èÔºâ„ÄÇ",
                "kc28_q7_optd": " Â¶ÇÊûúÂàóË°®Â∑≤ÁªèÊéíÂ∫èÔºåÂàô‰∏∫Èõ∂Ê¨°‰∫§Êç¢„ÄÇ",
                "kc28_q8_text": "8. Âì™ÁßçÁÆÄÂçïÁöÑÊéíÂ∫èÁÆóÊ≥ïÂèØËÉΩÂú®ÂàóË°®Âú®ÂÖ∂ÊüêËΩÆÊéíÂ∫èËøáÁ®ã‰∏≠ÂèòÂæóÊúâÂ∫èÊó∂ÊèêÂâçÂÆåÊàêÔºü",
                "kc28_q8_opta": " ÈÄâÊã©ÊéíÂ∫è",
                "kc28_q8_optb": " ÂÜíÊ≥°ÊéíÂ∫èÔºàÂ¶ÇÊûú‰ΩøÁî®‰ºòÂåñÊ†áÂøóÂÆûÁé∞Ôºâ", // Ê≠£Á°Æ
                "kc28_q8_optc": " ÂÜíÊ≥°ÊéíÂ∫èÂíåÈÄâÊã©ÊéíÂ∫èÈÉΩÂèØ‰ª•",
                "kc28_q8_optd": " ÈÉΩ‰∏çËÉΩÔºåÂÆÉ‰ª¨ÊÄªÊòØÂÆåÊàêÊâÄÊúâËΩÆÊ¨°„ÄÇ",
                "kc28_q9_text": "9. ‰∏ÄËà¨Êù•ËØ¥ÔºåÂØπ‰∫éÂ§ßÂûã„ÄÅÈöèÊú∫ÊéíÂ∫èÁöÑÂàóË°®Ôºå‰∏éÊõ¥È´òÁ∫ßÁöÑÁÆóÊ≥ïÁõ∏ÊØîÔºåÂÜíÊ≥°ÊéíÂ∫èÂíåÈÄâÊã©ÊéíÂ∫èÊòØÂê¶Ë¢´ËÆ§‰∏∫ÊòØÈ´òÊïàÁöÑÔºü",
                "kc28_q9_opta": " ÊòØÁöÑÔºåÂÆÉ‰ª¨ÊòØÊúÄÂø´ÁöÑÁÆÄÂçïÊéíÂ∫è„ÄÇ",
                "kc28_q9_optb": " ‰∏çÔºåÂØπ‰∫éÂ§ßÂûãÂàóË°®ÔºåÂÆÉ‰ª¨ÈÄöÂ∏∏ÊØîÂΩíÂπ∂ÊéíÂ∫èÊàñÂø´ÈÄüÊéíÂ∫èÁ≠âÁÆóÊ≥ïÊÖ¢„ÄÇ", // Ê≠£Á°Æ
                "kc28_q9_optc": " Âè™ÊúâÂΩìÂàóË°®Âá†‰πéÂ∑≤ÁªèÊéíÂ∫èÊó∂ÔºåÂÆÉ‰ª¨ÊâçÈ´òÊïà„ÄÇ",
                "kc28_q9_optd": " ÂÆÉ‰ª¨ÁöÑÊïàÁéá‰∏éÈ´òÁ∫ßÁÆóÊ≥ïÁõ∏ÂΩì„ÄÇ",
                "kc28_q10_text": "10. Âç≥‰ΩøÂ≠òÂú®Êõ¥È´òÊïàÁöÑÊéíÂ∫èÁÆóÊ≥ïÔºå‰∏∫‰ªÄ‰πàÁêÜËß£ÂÉèÂÜíÊ≥°ÊéíÂ∫èÂíåÈÄâÊã©ÊéíÂ∫èËøôÊ†∑ÁöÑÁÆÄÂçïÊéíÂ∫èÁÆóÊ≥ï‰ªçÁÑ∂ÊúâÁî®Ôºü",
                "kc28_q10_opta": " ÂÆÉ‰ª¨ÊòØÁé∞‰ª£ËΩØ‰ª∂‰∏≠ÂîØ‰∏Ä‰ΩøÁî®ÁöÑÁÆóÊ≥ï„ÄÇ",
                "kc28_q10_optb": " ÂÆÉ‰ª¨ÊúâÂä©‰∫éÂª∫Á´ãÂØπÊØîËæÉ„ÄÅ‰∫§Êç¢ÂíåËø≠‰ª£Á≠âÁÆóÊ≥ïÊ¶ÇÂøµÁöÑÂü∫Á°ÄÁêÜËß£„ÄÇ", // Ê≠£Á°Æ
                "kc28_q10_optc": " ÂÆÉ‰ª¨ÊòØÈ´òÁ∫ß‰∫∫Â∑•Êô∫ËÉΩÂºÄÂèëÊâÄÂøÖÈúÄÁöÑ„ÄÇ",
                "kc28_q10_optd": " ÂÆÉ‰ª¨‰∏ªË¶ÅÁî®‰∫éÂØπÊñáÊú¨Êï∞ÊçÆËøõË°åÊéíÂ∫è„ÄÇ",
                 /* Shared keys needed for JS */
                "lang_select_aria": "ÈÄâÊã©ËØ≠Ë®Ä", "lang_en": "üá¨üáß English", "lang_pt": "üáßüá∑ Portugu√™s", "lang_zh": "üá®üá≥ ‰∏≠Êñá", "footer_text": "ÈÄöÂæÄËá™Áî±ÂºÄÊîæAGI‰πãË∑ØÈ°πÁõÆÁöÑ‰∏ÄÈÉ®ÂàÜ"
            }
         };

        // --- Helper Functions (Translation & LocalStorage - Copied/Adapted from Dashboard) ---
         function getStoredLanguage() { const storedLang = localStorage.getItem(LANGUAGE_STORAGE_KEY); return (storedLang && translations[storedLang]) ? storedLang : 'en'; }

         function getTranslation(key, lang, replacements = {}) {
             let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`;
             text = text.replace(/\{score\}/g, replacements.score ?? '?')
                       .replace(/\{total\}/g, replacements.total ?? TOTAL_QUESTIONS)
                       .replace(/\{passingScore\}/g, replacements.passingScore ?? PASSING_SCORE);
             return text;
         }

         function translatePage(lang) {
             if (!translations[lang]) lang = 'en';
             document.documentElement.lang = lang;
             document.querySelectorAll('[data-translate]').forEach(el => {
                 const key = el.getAttribute('data-translate');
                 const replacements = { // Add replacements if needed for specific keys
                     passingScore: PASSING_SCORE,
                     total: TOTAL_QUESTIONS
                 };
                 const translation = getTranslation(key, lang, replacements);
                 if (el.tagName === 'TITLE') { document.title = translation; }
                 else if (translation.includes('<') && translation.includes('>')) { el.innerHTML = translation; }
                  else { el.textContent = translation; }
             });
             document.querySelectorAll('[data-translate-placeholder]').forEach(el => { const key = el.getAttribute('data-translate-placeholder'); el.setAttribute('placeholder', getTranslation(key, lang)); });
             document.querySelectorAll('[data-translate-aria-label]').forEach(el => { const key = el.getAttribute('data-translate-aria-label'); el.setAttribute('aria-label', getTranslation(key, lang)); });
         }

         function loadKnowledgeCheckStatus() { try { const storedStatus = localStorage.getItem(KNOWLEDGE_CHECK_STORAGE_KEY); const parsed = storedStatus ? JSON.parse(storedStatus) : {}; return typeof parsed === 'object' && parsed !== null ? parsed : {}; } catch (e) { console.error("Error reading KC status from localStorage:", e); return {}; } }

         function saveKnowledgeCheckStatus(moduleId, passed) {
             const statusObject = loadKnowledgeCheckStatus();
             // Only update if the user passed *this time* OR if it was already passed
             // This prevents overwriting a 'true' with subsequent failed attempts.
             if (passed || statusObject[moduleId] === true) {
                  statusObject[moduleId] = true; // Mark as passed
                  try {
                    localStorage.setItem(KNOWLEDGE_CHECK_STORAGE_KEY, JSON.stringify(statusObject));
                  } catch (e) {
                     console.error("Error saving KC status to localStorage:", e);
                     alert("Could not save your progress. LocalStorage might be full or disabled.");
                  }
             }
             // No need to save 'false' as progress only tracks completion.
         }


        // --- Quiz Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const quizForm = document.getElementById('quiz-form');
            const resultsArea = document.getElementById('results-area');
            const resultsTitle = document.getElementById('results-title');
            const resultsText = document.getElementById('results-text');
            const submitButton = document.getElementById('submit-button');
            const retryButton = document.getElementById('retry-button');
            const languageSelect = document.getElementById('languageSelect');
            const radioButtons = quizForm.querySelectorAll('input[type="radio"]');
            const labels = quizForm.querySelectorAll('label');

            function handleSubmit(event) {
                event.preventDefault();
                let score = 0;
                const currentLang = getStoredLanguage();

                // Disable inputs
                radioButtons.forEach(radio => radio.disabled = true);
                labels.forEach(label => label.classList.add('disabled')); // Add visual disabled state
                submitButton.disabled = true;

                // Calculate score
                for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                    const questionName = `q${i}`;
                    const selectedOption = quizForm.querySelector(`input[name="${questionName}"]:checked`);
                    if (selectedOption && selectedOption.value === correctAnswers[questionName]) {
                        score++;
                    }
                     // Optional: Add visual feedback for correct/incorrect answers here if desired
                }

                const passed = score >= PASSING_SCORE;

                // Save status if passed
                saveKnowledgeCheckStatus(MODULE_ID, passed);

                // Display results
                resultsArea.classList.remove('passed', 'failed'); // Clear previous classes
                if (passed) {
                    resultsTitle.textContent = getTranslation('kc_results_passed_title', currentLang);
                    resultsText.textContent = getTranslation('kc_results_passed_text', currentLang, { score: score, total: TOTAL_QUESTIONS });
                    resultsArea.classList.add('passed');
                } else {
                    resultsTitle.textContent = getTranslation('kc_results_failed_title', currentLang);
                    resultsText.textContent = getTranslation('kc_results_failed_text', currentLang, { score: score, total: TOTAL_QUESTIONS, passingScore: PASSING_SCORE });
                     resultsArea.classList.add('failed');
                }
                resultsArea.style.display = 'block';
                retryButton.style.display = 'inline-block'; // Show retry button

                // Scroll to results
                resultsArea.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }

            function handleRetry() {
                resultsArea.style.display = 'none';
                retryButton.style.display = 'none';
                quizForm.reset(); // Clear selections

                // Re-enable inputs
                radioButtons.forEach(radio => radio.disabled = false);
                 labels.forEach(label => label.classList.remove('disabled'));
                 submitButton.disabled = false;

                // Scroll to top of quiz
                quizForm.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            // --- Event Listeners ---
            quizForm.addEventListener('submit', handleSubmit);
            retryButton.addEventListener('click', handleRetry);

            // Language switcher logic
             languageSelect.addEventListener('change', (e) => {
                const selectedLang = e.target.value;
                localStorage.setItem(LANGUAGE_STORAGE_KEY, selectedLang);
                translatePage(selectedLang);
                // Re-translate results if they are visible
                if(resultsArea.style.display === 'block') {
                    const scoreText = resultsText.textContent; // Try to get score from existing text
                    let score = scoreText.match(/(\d+)\s+out/)?.[1] || scoreText.match(/acertou\s+(\d+)\s+de/)?.[1] || scoreText.match(/Á≠îÂØπ‰∫Ü\s+(\d+)\s+È¢ò/)?.[1] || 0; // Extract score
                    score = parseInt(score, 10);
                    const passed = score >= PASSING_SCORE;
                     if (passed) {
                         resultsTitle.textContent = getTranslation('kc_results_passed_title', selectedLang);
                         resultsText.textContent = getTranslation('kc_results_passed_text', selectedLang, { score: score, total: TOTAL_QUESTIONS });
                     } else {
                         resultsTitle.textContent = getTranslation('kc_results_failed_title', selectedLang);
                         resultsText.textContent = getTranslation('kc_results_failed_text', selectedLang, { score: score, total: TOTAL_QUESTIONS, passingScore: PASSING_SCORE });
                     }
                 }
             });

             // --- Initial Setup ---
            const initialLang = getStoredLanguage();
            languageSelect.value = initialLang;
            translatePage(initialLang);

        }); // End DOMContentLoaded
    </script>

</body>
</html>
<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="page_title">Knowledge Check: Module 20 - Complete Python</title>
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Base Styles & Variables (Copied from dashboard) --- */
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-page: #f0f2f5;
            --background-card: #ffffff;
            --background-header: linear-gradient(135deg, #0d6efd, #0a58ca);
            --text-light: #f8f9fa;
            --text-dark: #343a40;
            --text-muted: #6c757d;
            --accent-color: #ffc107;
            --success-color: #198754;
            --error-color: #dc3545;
            --info-color: #0dcaf0;
            --check-color: #6f42c1; /* Color for knowledge checks */
            --border-color: #dee2e6;
            --border-radius: 8px;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
            /* Colors for lang switcher (keep consistent) */
            --lang-select-border: var(--certificate-color, var(--check-color)); /* Use check color as fallback */
            --lang-select-bg: rgba(255, 255, 255, 0.1);
            --lang-select-bg-hover: rgba(255, 255, 255, 0.15);
            --lang-option-bg: var(--background-card);
            --lang-option-text: var(--text-dark);
            --lang-arrow-color: var(--certificate-color, var(--check-color));
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.6;
            background-color: var(--background-page); color: var(--text-dark);
            padding-top: 80px; /* Account for fixed header */
        }

        /* --- Knowledge Check Header --- */
        .kc-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 1.5rem;
            background: var(--background-header);
            color: var(--text-light);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 100;
        }
        .back-button {
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            background-color: rgba(255, 255, 255, 0.15);
            color: var(--text-light);
            border: none;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: background-color var(--transition-speed);
        }
        .back-button i { margin-right: 6px; }
        .back-button:hover { background-color: rgba(255, 255, 255, 0.25); text-decoration: none; color: var(--text-light); }

        .header-controls { display: flex; align-items: center; gap: 1rem; }
        .language-switcher select {
            background: var(--lang-select-bg);
            color: var(--text-light);
            border: 1px solid var(--lang-select-border);
            border-radius: 5px;
            padding: 6px 30px 6px 12px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            appearance: none; -webkit-appearance: none; -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23${encodeURIComponent(getComputedStyle(document.documentElement).getPropertyValue('--text-light').trim().substring(1))}%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 8px auto;
            transition: border-color 0.3s ease, background-color 0.3s ease;
            min-width: 130px; /* Ensure enough width */
        }
        .language-switcher select:hover { background-color: var(--lang-select-bg-hover); }
        .language-switcher select:focus { outline: none; border-color: var(--accent-color); }
        .language-switcher select option {
             background: var(--lang-option-bg);
             color: var(--lang-option-text);
        }

        /* --- Quiz Container & Styling --- */
        .quiz-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
            background-color: var(--background-card);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
        }
        .quiz-title {
            font-family: var(--font-title);
            font-size: 1.8rem;
            color: var(--check-color);
            margin-bottom: 0.5rem;
            text-align: center;
            border-bottom: 2px solid var(--check-color);
            padding-bottom: 0.5rem;
        }
        .quiz-title .module-number {
             color: var(--text-muted);
             font-weight: 400;
             font-size: 1.2rem;
             margin-right: 8px;
             display: inline-block;
             background-color: var(--background-page);
             padding: 2px 8px;
             border-radius: 4px;
        }
        .quiz-instructions {
            font-size: 0.95rem;
            color: var(--text-muted);
            margin-bottom: 2rem;
            text-align: center;
            line-height: 1.4;
        }
        .quiz-instructions strong { color: var(--text-dark); }
        .quiz-instructions i { color: var(--check-color); margin: 0 2px;}

        /* --- Questions Styling --- */
        .quiz-questions { margin-bottom: 2rem; }
        .question-block {
            margin-bottom: 1.8rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px dashed var(--border-color);
        }
        .question-block:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0;}
        .question-block p {
            font-weight: 500;
            margin-bottom: 1rem;
            font-size: 1.05rem;
        }
        .question-block p code {
            background-color: #e9ecef; padding: 0.15em 0.5em; border-radius: 4px; font-size: 0.9em; color: #c7254e;
        }
        .answer-options { display: flex; flex-direction: column; gap: 0.6rem; }
        .answer-option {
            display: block;
            padding: 0.6rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            cursor: pointer;
            transition: background-color var(--transition-speed), border-color var(--transition-speed);
        }
        .answer-option:hover { background-color: #f8f9fa; }
        .answer-option input[type="radio"] { margin-right: 0.7rem; vertical-align: middle; }
        .answer-option label { cursor: pointer; vertical-align: middle; width: calc(100% - 25px); /* Allow label text to wrap */ display: inline-block;}
        .answer-option label code { font-size: 0.9em; background-color: #eee; padding: 1px 4px; border-radius: 3px; }

        /* --- Feedback Styling (After Submission) --- */
        .answer-option.correct {
            background-color: #d1e7dd; /* Light green */
            border-color: var(--success-color);
            font-weight: 500;
        }
        .answer-option.incorrect {
            background-color: #f8d7da; /* Light red */
            border-color: var(--error-color);
        }
        .answer-option.correct::before {
            content: '\f00c'; /* Check mark */
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: var(--success-color);
            margin-right: 8px;
            font-size: 0.9em;
        }
        .answer-option.incorrect::before {
            content: '\f00d'; /* X mark */
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: var(--error-color);
            margin-right: 8px;
            font-size: 0.9em;
        }
        /* Hide radio buttons after submission */
        .quiz-submitted .answer-option input[type="radio"] {
            display: none;
        }
         .quiz-submitted .answer-option label {
            margin-left: 5px; /* Adjust label position slightly when radio is hidden */
         }

        /* --- Buttons & Results --- */
        .quiz-controls { text-align: center; margin-top: 2.5rem; }
        .submit-button, .retry-button {
            padding: 0.8rem 2rem;
            font-size: 1rem;
            font-weight: 500;
            border-radius: var(--border-radius);
            border: none;
            cursor: pointer;
            transition: background-color var(--transition-speed), transform var(--transition-speed);
        }
        .submit-button { background-color: var(--check-color); color: var(--text-light); }
        .submit-button:hover { background-color: #5a35a1; transform: scale(1.02); }
        .retry-button { background-color: var(--secondary-color); color: var(--text-light); margin-left: 1rem;}
        .retry-button:hover { background-color: #5a6268; transform: scale(1.02); }

        .quiz-results {
            margin-top: 2rem;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            text-align: center;
            display: none; /* Hidden initially */
        }
        .quiz-results.pass { background-color: #e6f7f0; border: 1px solid var(--success-color); }
        .quiz-results.fail { background-color: #fdeeee; border: 1px solid var(--error-color); }
        .result-message { font-size: 1.2rem; font-weight: 700; margin-bottom: 0.5rem; }
        .result-message.pass { color: var(--success-color); }
        .result-message.fail { color: var(--error-color); }
        .result-score { font-size: 1rem; color: var(--text-dark); }
        .result-score strong { font-size: 1.1rem; }

        /* --- Footer --- */
        footer { text-align: center; padding: 1.5rem; margin-top: 3rem; background-color: var(--background-card); border-top: 1px solid var(--border-color); color: var(--text-muted); font-size: 0.9rem; }

        /* --- Responsive Design Adjustments --- */
        @media (max-width: 768px) {
            body { padding-top: 70px; }
            .kc-header { padding: 0.6rem 1rem; }
            .quiz-container { margin: 1rem; padding: 1.5rem; }
            .quiz-title { font-size: 1.5rem; }
            .quiz-instructions { font-size: 0.9rem; }
            .question-block p { font-size: 1rem; }
            .answer-option { padding: 0.5rem 0.8rem; }
            .submit-button, .retry-button { padding: 0.7rem 1.5rem; font-size: 0.95rem; }
            .language-switcher select { min-width: 110px; padding: 5px 25px 5px 10px; font-size: 0.85rem;}
            .back-button { padding: 0.4rem 0.8rem; font-size: 0.85rem; }
        }
         @media (max-width: 480px) {
             body { padding-top: 100px; /* More space if header wraps */ }
             .kc-header { flex-direction: column; align-items: flex-start; gap: 0.5rem;}
             .header-controls { width: 100%; justify-content: space-between; } /* Space out button and lang */
             .quiz-title { font-size: 1.3rem; }
             .question-block p { line-height: 1.4; }
             .quiz-controls { display: flex; flex-direction: column; gap: 0.8rem; }
             .retry-button { margin-left: 0; }
         }
    </style>
</head>
<body>

    <header class="kc-header">
        <a href="ctp-dashboard.html" class="back-button">
            <i class="fas fa-arrow-left"></i> <span data-translate="back_to_dashboard">Back to Dashboard</span>
        </a>
        <div class="header-controls">
            <div class="language-switcher">
                <select id="languageSelect" data-translate-aria-label="lang_select_aria" aria-label="Select Language">
                    <option value="en" data-translate="lang_en">🇬🇧 English</option>
                    <option value="pt" data-translate="lang_pt">🇧🇷 Português</option>
                    <option value="zh" data-translate="lang_zh">🇨🇳 中文</option>
                </select>
            </div>
        </div>
    </header>

    <main class="quiz-container">
        <h1 class="quiz-title">
            <span class="module-number">20</span> <span data-translate="quiz_page_title">Knowledge Check: Dictionaries Intro</span>
        </h1>
        <p class="quiz-instructions" data-translate="quiz_instructions">
            Answer the questions below to test your understanding. You need <strong>6 out of 10</strong> correct answers to pass <i class="fas fa-check"></i>. You can retry as many times as you need <i class="fas fa-redo"></i>.
        </p>

        <form id="kc-form">
            <div class="quiz-questions">

                <!-- Question 1 -->
                <div class="question-block">
                    <p data-translate="q1_text">1. How do you create an empty dictionary in Python?</p>
                    <div class="answer-options">
                        <div class="answer-option">
                            <input type="radio" id="q1a" name="q1" value="a" required>
                            <label for="q1a" data-translate="q1_a"><code>empty_dict = []</code></label>
                        </div>
                        <div class="answer-option">
                            <input type="radio" id="q1b" name="q1" value="b">
                            <label for="q1b" data-translate="q1_b"><code>empty_dict = {}</code></label>
                        </div>
                        <div class="answer-option">
                            <input type="radio" id="q1c" name="q1" value="c">
                            <label for="q1c" data-translate="q1_c"><code>empty_dict = ()</code></label>
                        </div>
                        <div class="answer-option">
                            <input type="radio" id="q1d" name="q1" value="d">
                            <label for="q1d" data-translate="q1_d"><code>empty_dict = dict[]</code></label>
                        </div>
                    </div>
                </div>

                <!-- Question 2 -->
                <div class="question-block">
                    <p data-translate="q2_text">2. Given the dictionary <code>student = {'name': 'Alex', 'age': 20}</code>, how do you access the value associated with the key <code>'name'</code>?</p>
                    <div class="answer-options">
                        <div class="answer-option">
                            <input type="radio" id="q2a" name="q2" value="a" required>
                            <label for="q2a" data-translate="q2_a"><code>student('name')</code></label>
                        </div>
                        <div class="answer-option">
                            <input type="radio" id="q2b" name="q2" value="b">
                            <label for="q2b" data-translate="q2_b"><code>student['name']</code></label>
                        </div>
                        <div class="answer-option">
                            <input type="radio" id="q2c" name="q2" value="c">
                            <label for="q2c" data-translate="q2_c"><code>student.get('name')</code> (Select the primary way taught in this intro)</label>
                        </div>
                        <div class="answer-option">
                            <input type="radio" id="q2d" name="q2" value="d">
                            <label for="q2d" data-translate="q2_d"><code>student{name}</code></label>
                        </div>
                    </div>
                </div>

                <!-- Question 3 -->
                <div class="question-block">
                    <p data-translate="q3_text">3. What happens if you try to access a key that does *not* exist in a dictionary using square brackets, like <code>my_dict['unknown_key']</code>?</p>
                    <div class="answer-options">
                        <div class="answer-option">
                            <input type="radio" id="q3a" name="q3" value="a" required>
                            <label for="q3a" data-translate="q3_a">It returns <code>None</code>.</label>
                        </div>
                        <div class="answer-option">
                            <input type="radio" id="q3b" name="q3" value="b">
                            <label for="q3b" data-translate="q3_b">It automatically adds the key with a default value.</label>
                        </div>
                        <div class="answer-option">
                            <input type="radio" id="q3c" name="q3" value="c">
                            <label for="q3c" data-translate="q3_c">It raises a <code>KeyError</code>.</label>
                        </div>
                        <div class="answer-option">
                            <input type="radio" id="q3d" name="q3" value="d">
                            <label for="q3d" data-translate="q3_d">It returns an empty string <code>""</code>.</label>
                        </div>
                    </div>
                </div>

                <!-- Question 4 -->
                 <div class="question-block">
                    <p data-translate="q4_text">4. How can you add a new key-value pair (<code>'city': 'London'</code>) to an existing dictionary called <code>user_info</code>?</p>
                    <div class="answer-options">
                        <div class="answer-option">
                            <input type="radio" id="q4a" name="q4" value="a" required>
                            <label for="q4a" data-translate="q4_a"><code>user_info.append({'city': 'London'})</code></label>
                        </div>
                         <div class="answer-option">
                             <input type="radio" id="q4b" name="q4" value="b">
                             <label for="q4b" data-translate="q4_b"><code>user_info['city'] = 'London'</code></label>
                         </div>
                        <div class="answer-option">
                             <input type="radio" id="q4c" name="q4" value="c">
                             <label for="q4c" data-translate="q4_c"><code>user_info.add('city', 'London')</code></label>
                         </div>
                         <div class="answer-option">
                             <input type="radio" id="q4d" name="q4" value="d">
                             <label for="q4d" data-translate="q4_d"><code>user_info + {'city': 'London'}</code></label>
                         </div>
                    </div>
                </div>

                <!-- Question 5 -->
                <div class="question-block">
                    <p data-translate="q5_text">5. What is the primary purpose of a dictionary in Python?</p>
                    <div class="answer-options">
                        <div class="answer-option">
                            <input type="radio" id="q5a" name="q5" value="a" required>
                            <label for="q5a" data-translate="q5_a">To store an ordered sequence of items.</label>
                        </div>
                        <div class="answer-option">
                             <input type="radio" id="q5b" name="q5" value="b">
                             <label for="q5b" data-translate="q5_b">To store items that cannot be changed (immutable).</label>
                         </div>
                         <div class="answer-option">
                             <input type="radio" id="q5c" name="q5" value="c">
                             <label for="q5c" data-translate="q5_c">To store key-value pairs, allowing fast lookups by key.</label>
                         </div>
                        <div class="answer-option">
                             <input type="radio" id="q5d" name="q5" value="d">
                             <label for="q5d" data-translate="q5_d">To perform mathematical calculations.</label>
                         </div>
                    </div>
                </div>

                <!-- Question 6 -->
                <div class="question-block">
                     <p data-translate="q6_text">6. Consider <code>prefs = {'color': 'blue', 'size': 'M'}</code>. What happens if you execute <code>prefs['color'] = 'red'</code>?</p>
                    <div class="answer-options">
                         <div class="answer-option">
                             <input type="radio" id="q6a" name="q6" value="a" required>
                             <label for="q6a" data-translate="q6_a">It adds a new key <code>'color'</code> with the value <code>'red'</code>.</label>
                         </div>
                         <div class="answer-option">
                             <input type="radio" id="q6b" name="q6" value="b">
                             <label for="q6b" data-translate="q6_b">It causes an error because the key <code>'color'</code> already exists.</label>
                         </div>
                         <div class="answer-option">
                            <input type="radio" id="q6c" name="q6" value="c">
                             <label for="q6c" data-translate="q6_c">It updates the value associated with the key <code>'color'</code> to <code>'red'</code>.</label>
                         </div>
                         <div class="answer-option">
                             <input type="radio" id="q6d" name="q6" value="d">
                            <label for="q6d" data-translate="q6_d">It creates a completely new dictionary.</label>
                        </div>
                    </div>
                </div>

                <!-- Question 7 -->
                <div class="question-block">
                    <p data-translate="q7_text">7. Which data type is commonly used for dictionary *keys*?</p>
                    <div class="answer-options">
                         <div class="answer-option">
                            <input type="radio" id="q7a" name="q7" value="a" required>
                            <label for="q7a" data-translate="q7_a">Lists</label>
                        </div>
                        <div class="answer-option">
                            <input type="radio" id="q7b" name="q7" value="b">
                            <label for="q7b" data-translate="q7_b">Strings and Numbers (Immutable types)</label>
                        </div>
                         <div class="answer-option">
                            <input type="radio" id="q7c" name="q7" value="c">
                            <label for="q7c" data-translate="q7_c">Other Dictionaries</label>
                         </div>
                         <div class="answer-option">
                             <input type="radio" id="q7d" name="q7" value="d">
                            <label for="q7d" data-translate="q7_d">Any data type can be a key.</label>
                        </div>
                    </div>
                </div>

                <!-- Question 8 -->
                <div class="question-block">
                     <p data-translate="q8_text">8. What are the components of a key-value pair in a dictionary?</p>
                     <div class="answer-options">
                        <div class="answer-option">
                            <input type="radio" id="q8a" name="q8" value="a" required>
                            <label for="q8a" data-translate="q8_a">An index and an element</label>
                        </div>
                        <div class="answer-option">
                             <input type="radio" id="q8b" name="q8" value="b">
                             <label for="q8b" data-translate="q8_b">A key and a value, separated by a colon (<code>:</code>)</label>
                         </div>
                         <div class="answer-option">
                            <input type="radio" id="q8c" name="q8" value="c">
                            <label for="q8c" data-translate="q8_c">Two values separated by a comma (<code>,</code>)</label>
                         </div>
                         <div class="answer-option">
                             <input type="radio" id="q8d" name="q8" value="d">
                             <label for="q8d" data-translate="q8_d">A function name and its result</label>
                         </div>
                     </div>
                </div>

                <!-- Question 9 -->
                 <div class="question-block">
                     <p data-translate="q9_text">9. Is the order of items guaranteed in dictionaries created in older Python versions (before 3.7)?</p>
                     <div class="answer-options">
                         <div class="answer-option">
                            <input type="radio" id="q9a" name="q9" value="a" required>
                             <label for="q9a" data-translate="q9_a">Yes, they are always ordered by key.</label>
                         </div>
                         <div class="answer-option">
                             <input type="radio" id="q9b" name="q9" value="b">
                             <label for="q9b" data-translate="q9_b">Yes, they are always ordered by insertion time.</label>
                         </div>
                         <div class="answer-option">
                            <input type="radio" id="q9c" name="q9" value="c">
                             <label for="q9c" data-translate="q9_c">No, the order was arbitrary and could change.</label>
                         </div>
                        <div class="answer-option">
                             <input type="radio" id="q9d" name="q9" value="d">
                             <label for="q9d" data-translate="q9_d">Yes, they are always ordered alphabetically by value.</label>
                         </div>
                    </div>
                 </div>

                 <!-- Question 10 -->
                 <div class="question-block">
                    <p data-translate="q10_text">10. Can a dictionary store values of different data types (e.g., strings, numbers, lists) together?</p>
                     <div class="answer-options">
                        <div class="answer-option">
                             <input type="radio" id="q10a" name="q10" value="a" required>
                             <label for="q10a" data-translate="q10_a">Yes, dictionary values can be of any type.</label>
                         </div>
                         <div class="answer-option">
                             <input type="radio" id="q10b" name="q10" value="b">
                             <label for="q10b" data-translate="q10_b">No, all values in a dictionary must be of the same type.</label>
                         </div>
                        <div class="answer-option">
                             <input type="radio" id="q10c" name="q10" value="c">
                             <label for="q10c" data-translate="q10_c">Only strings and numbers are allowed as values.</label>
                         </div>
                         <div class="answer-option">
                            <input type="radio" id="q10d" name="q10" value="d">
                             <label for="q10d" data-translate="q10_d">Only immutable types (like numbers, strings, tuples) are allowed as values.</label>
                         </div>
                     </div>
                 </div>

            </div><!-- /.quiz-questions -->

            <div class="quiz-controls">
                <button type="submit" class="submit-button" id="submit-button" data-translate="submit_button">Submit Answers</button>
                <button type="button" class="retry-button" id="retry-button" style="display: none;" data-translate="retry_button">Retry Quiz</button>
            </div>

        </form>

        <div class="quiz-results" id="quiz-results">
            <p class="result-message" id="result-message"></p>
            <p class="result-score" id="result-score"></p>
        </div>

    </main>

    <footer>
        <p data-translate="footer_text">Part of the Road to Free Open AGI Project</p>
    </footer>

    <script>
        // --- Constants ---
        const MODULE_ID = 20;
        const KNOWLEDGE_CHECK_STORAGE_KEY = 'knowledgeCheckStatus_v1';
        const PASSING_SCORE = 6;
        const TOTAL_QUESTIONS = 10;
        const correctAnswers = ['b', 'b', 'c', 'b', 'c', 'c', 'b', 'b', 'c', 'a']; // Correct answers for Q1-Q10

        // --- Translations Object ---
        const translations = {
            en: {
                "page_title": `Knowledge Check: Module ${MODULE_ID} - Complete Python`,
                "quiz_page_title": "Knowledge Check: Dictionaries Intro",
                "back_to_dashboard": "Back to Dashboard",
                "lang_select_aria": "Select Language",
                "lang_en": "🇬🇧 English",
                "lang_pt": "🇧🇷 Português",
                "lang_zh": "🇨🇳 中文",
                "quiz_instructions": "Answer the questions below to test your understanding. You need <strong>{passingScore} out of {totalQuestions}</strong> correct answers to pass <i class=\"fas fa-check\"></i>. You can retry as many times as you need <i class=\"fas fa-redo\"></i>.",
                "q1_text": "1. How do you create an empty dictionary in Python?",
                "q1_a": "<code>empty_dict = []</code>",
                "q1_b": "<code>empty_dict = {}</code>",
                "q1_c": "<code>empty_dict = ()</code>",
                "q1_d": "<code>empty_dict = dict[]</code>",
                "q2_text": "2. Given the dictionary <code>student = {'name': 'Alex', 'age': 20}</code>, how do you access the value associated with the key <code>'name'</code>?",
                "q2_a": "<code>student('name')</code>",
                "q2_b": "<code>student['name']</code>",
                "q2_c": "<code>student.get('name')</code> (Select the primary way taught in this intro)",
                "q2_d": "<code>student{name}</code>",
                "q3_text": "3. What happens if you try to access a key that does *not* exist in a dictionary using square brackets, like <code>my_dict['unknown_key']</code>?",
                "q3_a": "It returns <code>None</code>.",
                "q3_b": "It automatically adds the key with a default value.",
                "q3_c": "It raises a <code>KeyError</code>.",
                "q3_d": "It returns an empty string <code>\"\"</code>.",
                "q4_text": "4. How can you add a new key-value pair (<code>'city': 'London'</code>) to an existing dictionary called <code>user_info</code>?",
                "q4_a": "<code>user_info.append({'city': 'London'})</code>",
                "q4_b": "<code>user_info['city'] = 'London'</code>",
                "q4_c": "<code>user_info.add('city', 'London')</code>",
                "q4_d": "<code>user_info + {'city': 'London'}</code>",
                "q5_text": "5. What is the primary purpose of a dictionary in Python?",
                "q5_a": "To store an ordered sequence of items.",
                "q5_b": "To store items that cannot be changed (immutable).",
                "q5_c": "To store key-value pairs, allowing fast lookups by key.",
                "q5_d": "To perform mathematical calculations.",
                "q6_text": "6. Consider <code>prefs = {'color': 'blue', 'size': 'M'}</code>. What happens if you execute <code>prefs['color'] = 'red'</code>?",
                "q6_a": "It adds a new key <code>'color'</code> with the value <code>'red'</code>.",
                "q6_b": "It causes an error because the key <code>'color'</code> already exists.",
                "q6_c": "It updates the value associated with the key <code>'color'</code> to <code>'red'</code>.",
                "q6_d": "It creates a completely new dictionary.",
                "q7_text": "7. Which data type is commonly used for dictionary *keys*?",
                "q7_a": "Lists",
                "q7_b": "Strings and Numbers (Immutable types)",
                "q7_c": "Other Dictionaries",
                "q7_d": "Any data type can be a key.",
                "q8_text": "8. What are the components of a key-value pair in a dictionary?",
                "q8_a": "An index and an element",
                "q8_b": "A key and a value, separated by a colon (<code>:</code>)",
                "q8_c": "Two values separated by a comma (<code>,</code>)",
                "q8_d": "A function name and its result",
                "q9_text": "9. Is the order of items guaranteed in dictionaries created in older Python versions (before 3.7)?",
                "q9_a": "Yes, they are always ordered by key.",
                "q9_b": "Yes, they are always ordered by insertion time.",
                "q9_c": "No, the order was arbitrary and could change.",
                "q9_d": "Yes, they are always ordered alphabetically by value.",
                "q10_text": "10. Can a dictionary store values of different data types (e.g., strings, numbers, lists) together?",
                "q10_a": "Yes, dictionary values can be of any type.",
                "q10_b": "No, all values in a dictionary must be of the same type.",
                "q10_c": "Only strings and numbers are allowed as values.",
                "q10_d": "Only immutable types (like numbers, strings, tuples) are allowed as values.",
                "submit_button": "Submit Answers",
                "retry_button": "Retry Quiz",
                "result_pass_message": "Congratulations, you passed!",
                "result_fail_message": "Keep trying! You can do it.",
                "result_score_details": "Your score: <strong>{score}</strong> out of {totalQuestions}",
                "footer_text": "Part of the Road to Free Open AGI Project"
            },
            pt: {
                "page_title": `Verificação de Conhecimento: Módulo ${MODULE_ID} - Python Completo`,
                "quiz_page_title": "Verificação de Conhecimento: Introdução a Dicionários",
                "back_to_dashboard": "Voltar ao Painel",
                "lang_select_aria": "Selecionar Idioma",
                "lang_en": "🇬🇧 English",
                "lang_pt": "🇧🇷 Português",
                "lang_zh": "🇨🇳 中文",
                "quiz_instructions": "Responda às perguntas abaixo para testar seu entendimento. Você precisa de <strong>{passingScore} de {totalQuestions}</strong> respostas corretas para passar <i class=\"fas fa-check\"></i>. Você pode tentar novamente quantas vezes precisar <i class=\"fas fa-redo\"></i>.",
                "q1_text": "1. Como você cria um dicionário vazio em Python?",
                "q1_a": "<code>dicionario_vazio = []</code>",
                "q1_b": "<code>dicionario_vazio = {}</code>",
                "q1_c": "<code>dicionario_vazio = ()</code>",
                "q1_d": "<code>dicionario_vazio = dict[]</code>",
                "q2_text": "2. Dado o dicionário <code>estudante = {'nome': 'Alex', 'idade': 20}</code>, como você acessa o valor associado à chave <code>'nome'</code>?",
                "q2_a": "<code>estudante('nome')</code>",
                "q2_b": "<code>estudante['nome']</code>",
                "q2_c": "<code>estudante.get('nome')</code> (Selecione a forma principal ensinada nesta introdução)",
                "q2_d": "<code>estudante{nome}</code>",
                "q3_text": "3. O que acontece se você tentar acessar uma chave que *não* existe em um dicionário usando colchetes, como <code>meu_dict['chave_desconhecida']</code>?",
                "q3_a": "Retorna <code>None</code>.",
                "q3_b": "Adiciona automaticamente a chave com um valor padrão.",
                "q3_c": "Levanta um <code>KeyError</code>.",
                "q3_d": "Retorna uma string vazia <code>\"\"</code>.",
                "q4_text": "4. Como você pode adicionar um novo par chave-valor (<code>'cidade': 'Londres'</code>) a um dicionário existente chamado <code>info_usuario</code>?",
                "q4_a": "<code>info_usuario.append({'cidade': 'Londres'})</code>",
                "q4_b": "<code>info_usuario['cidade'] = 'Londres'</code>",
                "q4_c": "<code>info_usuario.add('cidade', 'Londres')</code>",
                "q4_d": "<code>info_usuario + {'cidade': 'Londres'}</code>",
                "q5_text": "5. Qual é o propósito principal de um dicionário em Python?",
                "q5_a": "Armazenar uma sequência ordenada de itens.",
                "q5_b": "Armazenar itens que não podem ser alterados (imutáveis).",
                "q5_c": "Armazenar pares chave-valor, permitindo buscas rápidas pela chave.",
                "q5_d": "Realizar cálculos matemáticos.",
                "q6_text": "6. Considere <code>prefs = {'cor': 'azul', 'tamanho': 'M'}</code>. O que acontece se você executar <code>prefs['cor'] = 'vermelho'</code>?",
                "q6_a": "Adiciona uma nova chave <code>'cor'</code> com o valor <code>'vermelho'</code>.",
                "q6_b": "Causa um erro porque a chave <code>'cor'</code> já existe.",
                "q6_c": "Atualiza o valor associado à chave <code>'cor'</code> para <code>'vermelho'</code>.",
                "q6_d": "Cria um dicionário completamente novo.",
                "q7_text": "7. Qual tipo de dado é comumente usado para *chaves* de dicionário?",
                "q7_a": "Listas",
                "q7_b": "Strings e Números (Tipos imutáveis)",
                "q7_c": "Outros Dicionários",
                "q7_d": "Qualquer tipo de dado pode ser uma chave.",
                "q8_text": "8. Quais são os componentes de um par chave-valor em um dicionário?",
                "q8_a": "Um índice e um elemento",
                "q8_b": "Uma chave e um valor, separados por dois pontos (<code>:</code>)",
                "q8_c": "Dois valores separados por uma vírgula (<code>,</code>)",
                "q8_d": "O nome de uma função e seu resultado",
                "q9_text": "9. A ordem dos itens é garantida em dicionários criados em versões mais antigas do Python (antes da 3.7)?",
                "q9_a": "Sim, eles são sempre ordenados pela chave.",
                "q9_b": "Sim, eles são sempre ordenados pelo tempo de inserção.",
                "q9_c": "Não, a ordem era arbitrária e podia mudar.",
                "q9_d": "Sim, eles são sempre ordenados alfabeticamente pelo valor.",
                "q10_text": "10. Um dicionário pode armazenar valores de diferentes tipos de dados (ex: strings, números, listas) juntos?",
                "q10_a": "Sim, os valores do dicionário podem ser de qualquer tipo.",
                "q10_b": "Não, todos os valores em um dicionário devem ser do mesmo tipo.",
                "q10_c": "Apenas strings e números são permitidos como valores.",
                "q10_d": "Apenas tipos imutáveis (como números, strings, tuplas) são permitidos como valores.",
                "submit_button": "Enviar Respostas",
                "retry_button": "Tentar Novamente",
                "result_pass_message": "Parabéns, você passou!",
                "result_fail_message": "Continue tentando! Você consegue.",
                "result_score_details": "Sua pontuação: <strong>{score}</strong> de {totalQuestions}",
                "footer_text": "Parte do Projeto Road to Free Open AGI"
            },
            zh: {
                "page_title": `知识测验: 模块 ${MODULE_ID} - Python 完全指南`,
                "quiz_page_title": "知识测验: 字典简介",
                "back_to_dashboard": "返回仪表板",
                "lang_select_aria": "选择语言",
                "lang_en": "🇬🇧 English",
                "lang_pt": "🇧🇷 Português",
                "lang_zh": "🇨🇳 中文",
                "quiz_instructions": "回答以下问题以测试您的理解程度。您需要答对 <strong>{totalQuestions} 题中的 {passingScore} 题</strong> 才能通过 <i class=\"fas fa-check\"></i>。您可以根据需要重试任意次数 <i class=\"fas fa-redo\"></i>。",
                "q1_text": "1. 在 Python 中如何创建一个空字典？",
                "q1_a": "<code>empty_dict = []</code>",
                "q1_b": "<code>empty_dict = {}</code>",
                "q1_c": "<code>empty_dict = ()</code>",
                "q1_d": "<code>empty_dict = dict[]</code>",
                "q2_text": "2. 给定字典 <code>student = {'name': 'Alex', 'age': 20}</code>，如何访问与键 <code>'name'</code> 关联的值？",
                "q2_a": "<code>student('name')</code>",
                "q2_b": "<code>student['name']</code>",
                "q2_c": "<code>student.get('name')</code> (选择本简介中教授的主要方式)",
                "q2_d": "<code>student{name}</code>",
                "q3_text": "3. 如果尝试使用方括号访问字典中*不存在*的键，例如 <code>my_dict['unknown_key']</code>，会发生什么？",
                "q3_a": "返回 <code>None</code>。",
                "q3_b": "它会自动添加该键并赋予默认值。",
                "q3_c": "引发 <code>KeyError</code>。",
                "q3_d": "返回空字符串 <code>\"\"</code>。",
                "q4_text": "4. 如何将一个新的键值对 (<code>'city': 'London'</code>) 添加到名为 <code>user_info</code> 的现有字典中？",
                "q4_a": "<code>user_info.append({'city': 'London'})</code>",
                "q4_b": "<code>user_info['city'] = 'London'</code>",
                "q4_c": "<code>user_info.add('city', 'London')</code>",
                "q4_d": "<code>user_info + {'city': 'London'}</code>",
                "q5_text": "5. Python 字典的主要用途是什么？",
                "q5_a": "存储有序的项目序列。",
                "q5_b": "存储不能更改的项目（不可变）。",
                "q5_c": "存储键值对，允许通过键快速查找。",
                "q5_d": "执行数学计算。",
                "q6_text": "6. 考虑 <code>prefs = {'color': 'blue', 'size': 'M'}</code>。如果执行 <code>prefs['color'] = 'red'</code> 会发生什么？",
                "q6_a": "它添加一个新键 <code>'color'</code>，其值为 <code>'red'</code>。",
                "q6_b": "它会导致错误，因为键 <code>'color'</code> 已经存在。",
                "q6_c": "它将与键 <code>'color'</code> 关联的值更新为 <code>'red'</code>。",
                "q6_d": "它创建一个全新的字典。",
                "q7_text": "7. 哪种数据类型通常用于字典的*键*？",
                "q7_a": "列表",
                "q7_b": "字符串和数字（不可变类型）",
                "q7_c": "其他字典",
                "q7_d": "任何数据类型都可以作为键。",
                "q8_text": "8. 字典中键值对的组成部分是什么？",
                "q8_a": "一个索引和一个元素",
                "q8_b": "一个键和一个值，用冒号 (<code>:</code>) 分隔",
                "q8_c": "两个用逗号 (<code>,</code>) 分隔的值",
                "q8_d": "一个函数名及其结果",
                "q9_text": "9. 在旧版 Python（3.7 之前）创建的字典中，项目的顺序是否得到保证？",
                "q9_a": "是的，它们总是按键排序。",
                "q9_b": "是的，它们总是按插入时间排序。",
                "q9_c": "不，顺序是任意的，并且可能会改变。",
                "q9_d": "是的，它们总是按值的字母顺序排序。",
                "q10_text": "10. 字典是否可以同时存储不同数据类型的值（例如，字符串、数字、列表）？",
                "q10_a": "是的，字典值可以是任何类型。",
                "q10_b": "不，字典中的所有值必须是同一类型。",
                "q10_c": "只允许字符串和数字作为值。",
                "q10_d": "只允许不可变类型（如数字、字符串、元组）作为值。",
                "submit_button": "提交答案",
                "retry_button": "重试测验",
                "result_pass_message": "恭喜，您通过了！",
                "result_fail_message": "继续努力！你可以做到的。",
                "result_score_details": "你的分数：<strong>{score}</strong> / {totalQuestions}",
                "footer_text": "通往自由开放AGI之路项目的一部分"
            }
        };

        // --- LocalStorage Helper ---
        function loadKnowledgeCheckStatus() {
             try {
                 const storedStatus = localStorage.getItem(KNOWLEDGE_CHECK_STORAGE_KEY);
                 const parsed = storedStatus ? JSON.parse(storedStatus) : {};
                 // Basic validation: ensure it's an object
                 return typeof parsed === 'object' && parsed !== null ? parsed : {};
             } catch (e) {
                 console.error("Error reading KC status from localStorage:", e);
                 return {}; // Return empty object on error
             }
         }

        function saveKnowledgeCheckStatus(moduleId, passed) {
             if (!passed) return; // Only save successful attempts

             const currentStatus = loadKnowledgeCheckStatus();
             // Only update if not already marked as passed, or if saving a pass
             if (currentStatus[moduleId] !== true) {
                 currentStatus[moduleId] = true;
                 try {
                     localStorage.setItem(KNOWLEDGE_CHECK_STORAGE_KEY, JSON.stringify(currentStatus));
                     console.log(`KC status updated for module ${moduleId}: Passed`);
                 } catch (e) {
                     console.error("Error saving KC status to localStorage:", e);
                 }
             }
         }


        // --- Translation Functions ---
        const LANGUAGE_STORAGE_KEY = 'userLanguage';

        function getStoredLanguage() {
            const storedLang = localStorage.getItem(LANGUAGE_STORAGE_KEY);
            if (storedLang && translations[storedLang]) return storedLang;
            const browserLang = navigator.language || navigator.userLanguage;
            if (browserLang.startsWith('pt')) return 'pt';
            if (browserLang.startsWith('zh')) return 'zh';
            return 'en'; // Default to English
        }

         function getTranslation(key, lang, replacements = {}) {
            let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`; // Fallback chain
             // Replace placeholders like {placeholder}
             for (const placeholder in replacements) {
                 // Use a regex for global replacement
                const regex = new RegExp(`\\{${placeholder}\\}`, 'g');
                 text = text.replace(regex, replacements[placeholder]);
             }
            return text;
        }


         function translatePage(lang) {
            if (!translations[lang]) lang = 'en'; // Ensure lang exists

             document.querySelectorAll('[data-translate]').forEach(el => {
                 const key = el.getAttribute('data-translate');
                 let translation = '';
                 // Special handling for instructions with replacements
                 if (key === 'quiz_instructions') {
                     translation = getTranslation(key, lang, { passingScore: PASSING_SCORE, totalQuestions: TOTAL_QUESTIONS });
                 } else if (key === 'result_score_details') {
                     // Get score dynamically if results are shown
                     const scoreEl = document.getElementById('result-score');
                     const currentScore = scoreEl ? (scoreEl.dataset.score || 0) : 0; // Get score from data attribute if set
                     translation = getTranslation(key, lang, { score: currentScore, totalQuestions: TOTAL_QUESTIONS });
                 }
                 else {
                     translation = getTranslation(key, lang);
                 }

                 if (el.tagName === 'TITLE') {
                    document.title = translation;
                 } else if (translation.includes('<') && translation.includes('>')) {
                     // If translation contains HTML tags, use innerHTML
                     el.innerHTML = translation;
                 } else {
                     // Otherwise, use textContent for safety
                     el.textContent = translation;
                 }
             });

             // Translate ARIA labels
            document.querySelectorAll('[data-translate-aria-label]').forEach(el => {
                 const key = el.getAttribute('data-translate-aria-label');
                 el.setAttribute('aria-label', getTranslation(key, lang));
            });
         }


        function setLanguage(lang) {
             if (!translations[lang]) lang = 'en'; // Fallback
             localStorage.setItem(LANGUAGE_STORAGE_KEY, lang);
             document.documentElement.lang = lang; // Set lang attribute on <html>

             // Update language selector value
            const langSelect = document.getElementById('languageSelect');
            if (langSelect) langSelect.value = lang;

             // Re-translate the page
             updateQuizUI();
         }


        // --- Quiz Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('kc-form');
            const submitButton = document.getElementById('submit-button');
            const retryButton = document.getElementById('retry-button');
            const resultsDiv = document.getElementById('quiz-results');
            const resultMessageEl = document.getElementById('result-message');
            const resultScoreEl = document.getElementById('result-score');
            const languageSelectElement = document.getElementById('languageSelect');
            const questionBlocks = form.querySelectorAll('.question-block');

            function handleSubmit(event) {
                event.preventDefault();
                let score = 0;

                // Disable form elements during processing
                submitButton.disabled = true;
                questionBlocks.forEach(block => {
                    block.querySelectorAll('input[type="radio"]').forEach(input => input.disabled = true);
                });


                // Calculate score and provide feedback
                for (let i = 0; i < TOTAL_QUESTIONS; i++) {
                    const questionIndex = i + 1;
                    const selectedAnswer = form.querySelector(`input[name="q${questionIndex}"]:checked`);
                    const options = form.querySelectorAll(`input[name="q${questionIndex}"]`);
                    const correctAnswerValue = correctAnswers[i];

                    options.forEach(option => {
                        const parentDiv = option.closest('.answer-option');
                        parentDiv.classList.remove('correct', 'incorrect'); // Clear previous feedback

                        if (option.value === correctAnswerValue) {
                            parentDiv.classList.add('correct'); // Mark correct option
                        }

                        if (selectedAnswer && selectedAnswer === option && option.value !== correctAnswerValue) {
                             parentDiv.classList.add('incorrect'); // Mark selected incorrect option
                        }
                    });

                    if (selectedAnswer && selectedAnswer.value === correctAnswerValue) {
                        score++;
                    }
                }

                const passed = score >= PASSING_SCORE;

                // Save status if passed
                saveKnowledgeCheckStatus(MODULE_ID, passed);

                // Display results
                resultsDiv.style.display = 'block';
                resultsDiv.className = `quiz-results ${passed ? 'pass' : 'fail'}`; // Add pass/fail class

                // Store score for translation update
                resultScoreEl.dataset.score = score;

                // Trigger UI update to translate result messages with the correct score
                updateQuizUI();

                // Show/hide buttons
                submitButton.style.display = 'none';
                retryButton.style.display = 'inline-block';

                // Add class to hide radio buttons via CSS
                form.classList.add('quiz-submitted');

                 // Scroll to results
                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });

            }

            function handleRetry() {
                 // Reset form elements
                form.reset();
                submitButton.disabled = false;
                 form.classList.remove('quiz-submitted'); // Show radios again

                questionBlocks.forEach(block => {
                    block.querySelectorAll('input[type="radio"]').forEach(input => input.disabled = false);
                    block.querySelectorAll('.answer-option').forEach(div => {
                        div.classList.remove('correct', 'incorrect'); // Clear visual feedback
                    });
                });

                // Hide results, show submit button
                resultsDiv.style.display = 'none';
                submitButton.style.display = 'inline-block';
                retryButton.style.display = 'none';

                // Scroll to top of quiz
                form.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

             // Update UI including translation
            function updateQuizUI() {
                 const lang = getStoredLanguage();
                 translatePage(lang); // Translate static and dynamic elements

                 // Update dynamic result texts specifically after score calculation
                 const score = resultScoreEl.dataset.score; // Retrieve stored score
                 if (score !== undefined) { // Check if score is available (i.e., after submission)
                     const passed = parseInt(score, 10) >= PASSING_SCORE;
                     resultMessageEl.textContent = getTranslation(passed ? 'result_pass_message' : 'result_fail_message', lang);
                     resultScoreEl.innerHTML = getTranslation('result_score_details', lang, { score: score, totalQuestions: TOTAL_QUESTIONS });
                     resultsDiv.className = `quiz-results ${passed ? 'pass' : 'fail'}`;
                 } else {
                      // Ensure results section is reset if UI is updated before submission
                      resultMessageEl.textContent = '';
                      resultScoreEl.textContent = '';
                      resultsDiv.style.display = 'none';
                 }
            }


            // --- Initial Setup ---
            // Set initial language selector value and attach listener
             if (languageSelectElement) {
                 languageSelectElement.value = getStoredLanguage(); // Set initial value
                 languageSelectElement.addEventListener('change', (e) => {
                     setLanguage(e.target.value);
                 });
             }

            // Attach form submit listener
            form.addEventListener('submit', handleSubmit);

            // Attach retry button listener
            retryButton.addEventListener('click', handleRetry);

            // Perform initial translation
            updateQuizUI();
        });

    </script>

</body>
</html>
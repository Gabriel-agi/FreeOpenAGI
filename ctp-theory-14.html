<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="page_title">Module 14: Loops - Conditionals (while)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Reset & Base Styles --- */
        :root {
            --primary-color: #007bff; /* Blue */
            --secondary-color: #6c757d; /* Grey */
            --background-light: #f8f9fa;
            --background-dark: #343a40;
            --text-light: #f8f9fa;
            --text-dark: #212529;
            --accent-color: #ffc107; /* Yellow */
            --success-color: #28a745; /* Green */
            --error-color: #dc3545; /* Red */
            --info-color: #17a2b8; /* Teal */
            --loop-color: #fd7e14; /* Orange - for loop specific elements */
            --border-radius: 8px;
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
             /* Nav Colors */
            --nav-primary: #6e48aa; /* Purple */
            --nav-success: #4cc9f0; /* Light Blue */
            --nav-dark: #1a1a2e; /* Dark Blue/Purple */
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.7;
            background-color: var(--background-light); color: var(--text-dark);
            overflow-x: hidden; display: flex; flex-direction: column; min-height: 100vh;
        }
        main { flex-grow: 1; } /* Ensures main content pushes footer (if present) down */

        /* --- Utility Classes --- */
        .container { max-width: 960px; margin: 0 auto; padding: 0 15px; }
        .text-center { text-align: center; }
        .highlight { color: var(--primary-color); font-weight: bold; }
        .loop-highlight { color: var(--loop-color); font-weight: bold; }
        .fade-in { opacity: 0; transform: translateY(20px); animation: fadeInAnimation 0.8s ease-out forwards; }
        .fade-in.delay-1 { animation-delay: 0.2s; } .fade-in.delay-2 { animation-delay: 0.4s; }
        .fade-in.delay-3 { animation-delay: 0.6s; } .fade-in.delay-4 { animation-delay: 0.8s; }
        .fade-in.delay-5 { animation-delay: 1.0s; }
        .button-group { margin-top: 2rem; display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem; }
        .action-button {
             display: inline-flex; align-items: center; justify-content: center; gap: 0.5em;
             padding: 0.8rem 1.5rem; font-size: 1rem; font-weight: bold;
             color: var(--text-light); background-color: var(--primary-color); border: none;
             border-radius: var(--border-radius); cursor: pointer;
             transition: background-color var(--transition-speed), transform var(--transition-speed), filter var(--transition-speed), box-shadow var(--transition-speed);
             margin-top: 1rem; box-shadow: 0 2px 5px rgba(0,0,0,0.1); text-decoration: none; line-height: 1.2;
        }
        .action-button i.fas { /* Aligned by flex */ }
        .action-button:hover:not(:disabled) { background-color: #0056b3; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
        .action-button:disabled { background-color: var(--secondary-color); cursor: not-allowed; transform: none; box-shadow: none; opacity: 0.7; }
        .action-button.success { background-color: var(--success-color); }
        .action-button.success:hover:not(:disabled) { background-color: #218838; }
        .action-button.secondary { background-color: var(--secondary-color); }
        .action-button.secondary:hover:not(:disabled) { background-color: #5a6268; }
        .action-button:active:not(:disabled) { transform: translateY(1px) scale(0.98); filter: brightness(0.95); }

        /* --- Animations --- */
        @keyframes fadeInAnimation { to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0% { transform: scale(1); box-shadow: 0 0 5px rgba(0, 123, 255, 0.3); } 50% { transform: scale(1.03); box-shadow: 0 0 15px rgba(0, 123, 255, 0.6); } 100% { transform: scale(1); box-shadow: 0 0 5px rgba(0, 123, 255, 0.3); } }
        @keyframes code-line-anim { from { width: 0; opacity: 0; } to { width: 100%; opacity: 1; } }
        @keyframes tada { from { transform: scale3d(1, 1, 1); } 10%, 20% { transform: scale3d(.9, .9, .9) rotate3d(0, 0, 1, -3deg); } 30%, 50%, 70%, 90% { transform: scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, 3deg); } 40%, 60%, 80% { transform: scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, -3deg); } to { transform: scale3d(1, 1, 1); } }
        .tada-anim { animation: tada 1s ease; }
        @keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); } }
        @keyframes iconAppearCorrect { 0% { transform: scale(0.5) rotate(-15deg); opacity: 0; } 60% { transform: scale(1.2) rotate(5deg); opacity: 1; } 100% { transform: scale(1) rotate(0deg); opacity: 1; } }
        @keyframes spinRepeat { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes blinkCursor { 50% { opacity: 0; } }

        /* --- Minimal Retractable Nav --- */
        .minimal-nav-button { position: fixed; top: 15px; right: 15px; z-index: 1001; background-color: rgba(52, 58, 64, 0.75); color: var(--text-light); border: none; border-radius: var(--border-radius); padding: 8px 12px; cursor: pointer; transition: background-color var(--transition-speed), opacity var(--transition-speed), transform var(--transition-speed); font-size: 1.1rem; opacity: 0.6; box-shadow: 0 2px 5px rgba(0,0,0,0.2); line-height: 1; }
        .minimal-nav-button:hover { background-color: rgba(52, 58, 64, 0.95); opacity: 1; transform: scale(1.05); }
        .minimal-nav { position: fixed; top: 60px; right: 15px; z-index: 1000; background-color: var(--background-dark); border-radius: var(--border-radius); box-shadow: 0 5px 15px rgba(0,0,0,0.3); padding: 0.8rem; opacity: 0; transform: translateY(-15px) scale(0.95); transform-origin: top right; pointer-events: none; transition: opacity var(--transition-speed) ease, transform var(--transition-speed) ease; min-width: 200px; }
        body.nav-active .minimal-nav { opacity: 1; transform: translateY(0) scale(1); pointer-events: auto; }
        .minimal-nav ul { list-style: none; margin: 0; padding: 0; }
        .minimal-nav ul li { margin-bottom: 5px; } .minimal-nav ul li:last-child { margin-bottom: 0; }
        .minimal-nav ul li a { display: flex; align-items: center; color: var(--text-light); text-decoration: none; padding: 0.6rem 1rem; border-radius: 4px; transition: background-color var(--transition-speed), color var(--transition-speed); white-space: nowrap; font-weight: 400; font-size: 0.95rem; }
        .minimal-nav ul li a i.fas { margin-right: 10px; width: 1.2em; text-align: center; opacity: 0.8; transition: opacity var(--transition-speed); }
        .minimal-nav ul li a:hover { background-color: var(--primary-color); color: var(--text-light); } .minimal-nav ul li a:hover i.fas { opacity: 1; }
        .minimal-nav .language-switcher-item { padding: 0.5rem 1rem; border-top: 1px solid var(--secondary-color); margin-top: 8px; padding-top: 13px; }
        #languageSelect { width: 100%; background: rgba(255,255,255,0.1); color: white; border: 1px solid var(--nav-success); border-radius: 5px; padding: 6px 30px 6px 12px; cursor: pointer; font-size: 0.9rem; appearance: none; -webkit-appearance: none; -moz-appearance: none; background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%234CC9F0%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'); background-repeat: no-repeat; background-position: right 10px center; background-size: 10px auto; transition: background-color 0.3s ease; }
        #languageSelect:hover { background-color: rgba(255,255,255,0.15); }
        #languageSelect option { background: var(--nav-dark); color: var(--text-light); }

        /* --- Header --- */
        .main-header {
            background: linear-gradient(135deg, var(--loop-color), var(--primary-color)); /* Adjusted gradient */
            color: var(--text-light); padding: 4rem 0 6rem; text-align: center; position: relative; overflow: hidden;
        }
        .main-header h1 { font-family: var(--font-title); font-size: 3rem; margin-bottom: 0.5rem; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3); animation: fadeInAnimation 1s ease-out; }
        .main-header p { font-size: 1.2rem; font-weight: 300; opacity: 0.9; animation: fadeInAnimation 1s ease-out 0.3s forwards; opacity: 0; }
        .header-shape { position: absolute; border-radius: 50%; background-color: rgba(255, 255, 255, 0.1); animation: pulse 5s infinite ease-in-out alternate; }
        .shape1 { width: 150px; height: 150px; bottom: -50px; left: 10%; animation-duration: 6s; }
        .shape2 { width: 80px; height: 80px; top: 50px; right: 15%; animation-duration: 4s; }
        .shape3 { width: 50px; height: 50px; bottom: 20px; right: 30%; animation-duration: 7s; }

        /* --- Section Styling --- */
        section { padding: 4rem 0; border-bottom: 1px solid #eee; }
        main section:last-of-type { border-bottom: none; }
        section h2 { font-family: var(--font-title); font-size: 2.2rem; color: var(--primary-color); margin-bottom: 2rem; text-align: center; position: relative; padding-bottom: 10px; }
        section h2::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 60px; height: 4px; background-color: var(--accent-color); border-radius: 2px; }

        /* --- Introduction Section --- */
        #introduction .concept-visual {
            display: flex; justify-content: center; align-items: center; gap: 1.5rem;
            margin: 2rem auto; padding: 1.5rem; background-color: #fff; border-radius: var(--border-radius);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08); max-width: 500px;
        }
        #introduction .concept-icon { font-size: 3rem; color: var(--loop-color); animation: spinRepeat 10s linear infinite; }
        #introduction .concept-text { font-size: 1.1rem; color: var(--secondary-color); }

        /* --- While Syntax Section --- */
        #while-syntax .syntax-explanation { display: flex; gap: 2rem; align-items: flex-start; margin-top: 2rem; flex-wrap: wrap; }
        .code-demo {
            flex-basis: 55%; background-color: var(--background-dark); color: #eee;
            padding: 1.5rem 2rem 2rem; border-radius: var(--border-radius); font-family: 'Courier New', Courier, monospace;
            position: relative; min-height: 220px; /* Increased height */
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
         .code-demo .code-line { display: block; margin-bottom: 0.5em; white-space: pre; }
         .code-demo .code-comment { color: #6a9955; font-style: italic; }
         .code-demo .code-output-area {
            color: var(--accent-color); font-weight: bold; font-size: 1.1rem;
            border-top: 1px dashed var(--secondary-color); padding-top: 1rem; margin-top: 1.5rem;
            min-height: 80px; /* Space for output lines */
            opacity: 0; transition: opacity 0.5s ease;
         }
         .code-demo .code-output-area.visible { opacity: 1; }
         .code-demo .output-line { display: block; margin-bottom: 0.3em; opacity: 0; animation: fadeInAnimation 0.5s forwards; }
         /* Simulate cursor for effect */
         .code-demo .code-output-area::after {
             content: '_'; display: inline-block;
             animation: blinkCursor 1s infinite step-end;
             margin-left: 2px; font-weight: bold;
             visibility: hidden; /* Initially hidden */
         }
         .code-demo .code-output-area.typing::after { visibility: visible; }
         .code-demo .code-output-area.done::after { visibility: hidden; }


        .syntax-text { flex-basis: 40%; font-size: 1.05rem; }
        .syntax-text p { margin-bottom: 1rem; }
        .code-highlight {
            background-color: rgba(0, 123, 255, 0.1); color: #0056b3; padding: 0.2em 0.4em;
            border-radius: 4px; font-family: 'Courier New', Courier, monospace; font-weight: bold;
            cursor: pointer; transition: background-color var(--transition-speed);
            display: inline-block; position: relative;
        }
        .code-highlight.loop { background-color: rgba(253, 126, 20, 0.1); color: #c7620a; }
        .code-highlight:hover { background-color: rgba(0, 123, 255, 0.2); }
        .code-highlight.loop:hover { background-color: rgba(253, 126, 20, 0.2); }
        /* Tooltip */
        .tooltip { visibility: hidden; width: 180px; background-color: var(--background-dark); color: var(--text-light); text-align: center; border-radius: 6px; padding: 8px 5px; position: absolute; z-index: 1; bottom: 125%; left: 50%; margin-left: -90px; opacity: 0; transition: opacity 0.3s; font-family: var(--font-body); font-size: 0.9rem; font-weight: normal; pointer-events: none; }
        .tooltip::after { content: ""; position: absolute; top: 100%; left: 50%; margin-left: -5px; border-width: 5px; border-style: solid; border-color: var(--background-dark) transparent transparent transparent; }
        .code-highlight:hover .tooltip { visibility: visible; opacity: 1; }
        /* Code syntax colors */
        .code-keyword { color: #569cd6; } /* Blue */
        .code-control { color: #c586c0; } /* Purple (for while, if etc.) */
        .code-variable { color: #9cdcfe; } /* Light blue */
        .code-string { color: #ce9178; } /* Brown/Orange */
        .code-function { color: #dcdcaa; } /* Yellow */
        .code-number { color: #b5cea8; } /* Green */
        .code-operator { color: #d4d4d4; } /* White/Grey */
        .code-boolean { color: #569cd6; font-weight: bold; } /* Blue bold */

        /* --- Loop Condition Section --- */
        #loop-condition .condition-box {
            background: linear-gradient(145deg, rgba(255,255,255,0.8), rgba(240,240,240,0.8));
            border-left: 5px solid var(--info-color);
            padding: 1.5rem 2rem; margin: 2rem auto; border-radius: var(--border-radius);
            box-shadow: 0 3px 10px rgba(0,0,0,0.07); max-width: 700px;
            display: flex; align-items: center; gap: 1.5rem;
        }
        #loop-condition .condition-icon { font-size: 2.5rem; color: var(--info-color); flex-shrink: 0; }
        #loop-condition .condition-text p { margin-bottom: 0.5rem; font-size: 1.05rem; line-height: 1.6; }
        #loop-condition .condition-text strong { color: var(--info-color); }
        #loop-condition .caution { color: var(--error-color); font-weight: bold; }


        /* --- Knowledge Check Section --- */
        #knowledge-check { background-color: #e9ecef; }
        .quiz-container { background-color: #fff; padding: 2rem; border-radius: var(--border-radius); box-shadow: 0 5px 15px rgba(0,0,0,0.1); max-width: 700px; margin: 2rem auto 0; }
        .quiz-question { font-size: 1.2rem; font-weight: bold; margin-bottom: 1.5rem; color: var(--text-dark); }
        .quiz-options button { display: block; width: 100%; padding: 1rem; margin-bottom: 1rem; text-align: left; font-size: 1rem; background-color: #f8f9fa; border: 1px solid #ced4da; border-radius: var(--border-radius); cursor: pointer; transition: background-color var(--transition-speed), border-color var(--transition-speed), transform var(--transition-speed); }
        .quiz-options button:not(:disabled):hover { background-color: #e2e6ea; border-color: #adb5bd; transform: translateX(5px); }
        .quiz-options button:disabled { cursor: default; opacity: 0.7; }
        .quiz-options button.correct { background-color: #d4edda; border-color: var(--success-color); color: #155724; font-weight: bold; }
        .quiz-options button.incorrect { background-color: #f8d7da; border-color: var(--error-color); color: #721c24; font-weight: bold; }
        .quiz-options button.incorrect.shake { animation: shake 0.5s ease; }
        .quiz-feedback { margin-top: 1.5rem; padding: 1rem; border-radius: var(--border-radius); font-weight: bold; text-align: center; opacity: 0; transition: opacity 0.5s ease; height: 0; overflow: hidden; }
        .quiz-feedback.visible { opacity: 1; height: auto; margin-bottom: 1rem; }
        .quiz-feedback.correct { background-color: #d4edda; color: #155724; }
        .quiz-feedback.incorrect { background-color: #f8d7da; color: #721c24; }
        #next-question-btn { display: inline-flex; align-items: center; justify-content: center; gap: 0.5em; margin: 1.5rem auto 0; padding: 0.8rem 1.5rem; font-size: 1rem; font-weight: bold; color: var(--text-light); background-color: var(--primary-color); border: none; border-radius: var(--border-radius); cursor: pointer; transition: background-color var(--transition-speed), transform var(--transition-speed), opacity 0.3s, visibility 0.3s; opacity: 0; visibility: hidden; }
        #next-question-btn:hover { background-color: #0056b3; transform: scale(1.05); }
        #next-question-btn.visible { opacity: 1; visibility: visible; }

        /* --- Completion Section Styling --- */
        .completion-section { padding: 4rem 0; text-align: center; background-color: var(--background-light); }
        .completion-section .icon { font-size: 4rem; color: var(--success-color); margin-bottom: 1rem; display: inline-block; opacity: 0; animation: iconAppearCorrect 1s ease-out 0.5s forwards; }
        .completion-section .icon .fas + .fas { margin-left: 0.75rem; }
        .completion-section h2 { font-family: var(--font-title); font-size: 2.2rem; color: var(--primary-color); margin-bottom: 1rem; }
        .completion-section h2::after { display: none; }
        .completion-section p { font-size: 1.1rem; margin-top: 1rem; color: var(--secondary-color); max-width: 700px; margin-left: auto; margin-right: auto; line-height: 1.8; }
        .completion-section .button-group { margin-top: 2.5rem; }

        /* --- Footer REMOVED --- */

        /* --- Responsive Design --- */
        @media (max-width: 768px) {
            html { font-size: 15px; }
            .main-header h1 { font-size: 2.5rem; } .main-header p { font-size: 1.1rem; }
            section h2 { font-size: 1.8rem; }
            #while-syntax .syntax-explanation { flex-direction: column; }
            .code-demo, .syntax-text { flex-basis: 100%; }
             .code-demo { min-height: 200px; }
            #loop-condition .condition-box { flex-direction: column; text-align: center; }
            /* Nav Adjustments */
            .minimal-nav { min-width: 180px; } .minimal-nav ul li a { padding: 0.6rem 0.8rem; }
            #languageSelect { font-size: 0.85rem; padding: 5px 25px 5px 10px;}
             /* Completion Section Adjustments */
             .completion-section h2 { font-size: 2rem; }
             .completion-section .button-group { flex-direction: column; align-items: center; gap: 0.8rem; }
             .completion-section .action-button { width: 80%; max-width: 350px; margin-top: 0; }
        }
        @media (max-width: 480px) {
            html { font-size: 14px; }
            .main-header h1 { font-size: 2rem; } .main-header p { font-size: 1rem; }
            section h2 { font-size: 1.6rem; }
             .code-demo { padding: 1rem 1.5rem 1.5rem; min-height: 180px; font-size: 0.9em; }
             .code-demo .code-output-area { font-size: 1rem; min-height: 60px; }
            .quiz-options button { padding: 0.8rem; font-size: 0.95rem; }
            .tooltip { width: 140px; margin-left: -70px; font-size: 0.8rem;}
             /* Nav Adjustments */
             .minimal-nav-button { top: 10px; right: 10px; padding: 6px 10px; font-size: 1rem; }
             .minimal-nav { top: 48px; right: 10px; min-width: 160px; }
             .minimal-nav ul li a { padding: 0.5rem 0.7rem; font-size: 0.9rem;} .minimal-nav ul li a i.fas { margin-right: 8px; }
             #languageSelect { font-size: 0.8rem; padding: 4px 20px 4px 8px;}
             /* Completion Section Adjustments */
             .completion-section .icon { font-size: 3.5rem; } .completion-section h2 { font-size: 1.8rem; }
             .completion-section p { font-size: 1rem; }
             .completion-section .action-button { width: 90%; max-width: 300px; }
        }

    </style>
</head>
<body>

    <!-- ========= Minimal Nav Handle ========= -->
    <button id="minimal-nav-toggle" class="minimal-nav-button" aria-label="Toggle Navigation Menu" aria-expanded="false">
        <i class="fas fa-bars"></i>
    </button>

    <!-- ========= Minimal Nav Panel (with Language Switcher) ========= -->
    <nav id="minimal-nav-panel" class="minimal-nav">
        <ul>
            <!-- Links to OTHER main pages -->
            <li><a href="ctp-practice-14.html"><i class="fas fa-pencil-alt fa-fw"></i> <span data-translate="nav_practice">Practice</span></a></li>
            <li><a href="ctp-advanced-14.html"><i class="fas fa-flask fa-fw"></i> <span data-translate="nav_advanced">Advanced Practice</span></a></li>
            <li><a href="ctp-dashboard.html"><i class="fas fa-list fa-fw"></i> <span data-translate="nav_menu">Course Menu</span></a></li>
             <hr style="border: none; border-top: 1px solid var(--secondary-color); margin: 8px 0;">
             <!-- Links to sections on THIS page -->
             <li><a href="#introduction"><i class="fas fa-info-circle fa-fw"></i> <span data-translate="nav_intro">Introduction</span></a></li>
             <li><a href="#while-syntax"><i class="fas fa-code fa-fw"></i> <span data-translate="nav_syntax">Syntax & Example</span></a></li>
             <li><a href="#loop-condition"><i class="fas fa-check-circle fa-fw"></i> <span data-translate="nav_condition">The Condition</span></a></li>
             <li><a href="#knowledge-check"><i class="fas fa-check-double fa-fw"></i> <span data-translate="nav_quiz">Knowledge Check</span></a></li>
             <li><a href="#completion"><i class="fas fa-flag-checkered fa-fw"></i> <span data-translate="nav_completion">Completion</span></a></li>
            <!-- Language Switcher Item -->
            <li class="language-switcher-item">
                 <select id="languageSelect" aria-label="Select Language">
                     <option value="en" data-translate="lang_en">🇬🇧 English</option>
                     <option value="pt" data-translate="lang_pt">🇧🇷 Português</option>
                     <option value="zh" data-translate="lang_zh">🇨🇳 中文</option>
                 </select>
            </li>
        </ul>
    </nav>

    <header class="main-header">
        <!-- Decorative shapes -->
        <div class="header-shape shape1" style="background-color: rgba(255, 255, 255, 0.08);"></div>
        <div class="header-shape shape2" style="background-color: rgba(255, 255, 255, 0.12);"></div>
        <div class="header-shape shape3" style="background-color: rgba(255, 255, 255, 0.05);"></div>

        <div class="container">
            <h1 data-translate="header_title">Module 14: Repeating Actions with `while`</h1>
            <p data-translate="header_subtitle">Learn how to make Python repeat tasks as long as a condition is true.</p>
        </div>
    </header>

    <main>
        <!-- ========= Introduction Section ========= -->
        <section id="introduction">
            <div class="container">
                <h2 class="fade-in" data-translate="intro_title">🔁 Repeating Actions Conditionally</h2>
                <p class="text-center fade-in delay-1" data-translate="intro_p1">
                    Sometimes, you need the computer to do something <span class="loop-highlight">over and over</span>, but only <span class="highlight">while</span> a certain situation is true.
                </p>
                 <div class="concept-visual fade-in delay-2">
                    <span class="concept-icon"><i class="fas fa-sync-alt"></i></span>
                    <div class="concept-text">
                        <p data-translate="intro_analogy">Imagine checking your phone for a message <span class="loop-highlight">repeatedly</span>, <span class="highlight">until</span> you finally receive it.</p>
                    </div>
                </div>
                <p class="text-center fade-in delay-3" data-translate="intro_p2">
                    Python's <code class="loop-highlight">while</code> loop is perfect for this conditional repetition.
                </p>
            </div>
        </section>

        <!-- ========= While Syntax Section ========= -->
        <section id="while-syntax">
             <div class="container">
                 <h2 class="fade-in" data-translate="syntax_title">⚙️ The `while` Loop Structure</h2>
                 <p class="text-center fade-in delay-1" data-translate="syntax_subtitle">It checks a condition, then runs the indented code if it's true.</p>

                 <div class="syntax-explanation fade-in delay-2">
                     <div class="code-demo">
                        <span class="code-line"><span class="code-variable">count</span> <span class="code-operator">=</span> <span class="code-number">0</span> <span class="code-comment" data-translate="code_comment_1"># Start a counter</span></span>
                        <span class="code-line"><span class="code-control">while</span> <span class="code-variable">count</span> <span class="code-operator">&lt;</span> <span class="code-number">3</span><span class="code-operator">:</span> <span class="code-comment" data-translate="code_comment_2"># Loop while count is less than 3</span></span>
                        <span class="code-line">    <span class="code-function">print</span>(<span class="code-string">f"Count is: {<span class="code-variable">count</span>}"</span>) <span class="code-comment" data-translate="code_comment_3"># Action inside the loop</span></span>
                        <span class="code-line">    <span class="code-variable">count</span> <span class="code-operator">=</span> <span class="code-variable">count</span> <span class="code-operator">+</span> <span class="code-number">1</span> <span class="code-comment" data-translate="code_comment_4"># IMPORTANT: Update the counter!</span></span>
                        <span class="code-line"><span class="code-function">print</span>(<span class="code-string">"Loop finished!"</span>) <span class="code-comment" data-translate="code_comment_5"># This runs after the loop</span></span>

                        <div class="code-output-area">
                            <!-- Output appears here -->
                        </div>
                     </div>
                     <div class="syntax-text fade-in delay-3">
                         <p data-translate="syntax_text_p1">
                             The <span class="code-highlight loop" data-translate-tooltip="tooltip_while">while<span class="tooltip">The keyword that starts the conditional loop.</span></span> statement is followed by a <span class="code-highlight" data-translate-tooltip="tooltip_condition">condition<span class="tooltip">An expression that evaluates to True or False (e.g., count < 3).</span></span> and a colon <code class="loop-highlight">:</code>.
                         </p>
                         <p data-translate="syntax_text_p2">
                             The code to be repeated must be <span class="code-highlight" data-translate-tooltip="tooltip_indentation">indented<span class="tooltip">Usually 4 spaces. This tells Python what's inside the loop.</span></span> underneath the `while` line.
                         </p>
                         <p data-translate="syntax_text_p3">
                             The loop <span class="loop-highlight">continues</span> as long as the condition is <span class="code-highlight code-boolean" data-translate-tooltip="tooltip_true">True<span class="tooltip">The loop keeps running.</span></span>. It <span class="highlight">stops</span> when the condition becomes <span class="code-highlight code-boolean" data-translate-tooltip="tooltip_false">False<span class="tooltip">The loop terminates, and Python moves to the next line after the loop.</span></span>.
                         </p>
                         <p data-translate="syntax_text_p4">
                              It's crucial that something <span class="highlight">inside</span> the loop eventually makes the condition <span class="code-highlight code-boolean">False</span>! (Like <code class="code-variable">count = count + 1</code>).
                         </p>
                     </div>
                 </div>
             </div>
        </section>

        <!-- ========= Loop Condition Section ========= -->
        <section id="loop-condition">
            <div class="container">
                 <h2 class="fade-in" data-translate="condition_title">🚦 The Condition is Key</h2>
                 <p class="text-center fade-in delay-1" data-translate="condition_subtitle">The loop's fate depends entirely on the condition.</p>

                <div class="condition-box fade-in delay-2">
                    <span class="condition-icon"><i class="fas fa-lightbulb"></i></span>
                    <div class="condition-text">
                        <p data-translate="condition_p1">
                            Before each potential repetition (iteration), Python <span class="highlight">re-evaluates</span> the `while` condition.
                        </p>
                        <p data-translate="condition_p2">
                            If <code class="code-boolean">True</code>: Run the indented code block again.
                        </p>
                        <p data-translate="condition_p3">
                            If <code class="code-boolean">False</code>: Skip the block and continue after the loop.
                        </p>
                         <p data-translate="condition_p4">
                           <strong data-translate="condition_warning_intro">Watch out!</strong> If the condition <span class="caution">never</span> becomes <code class="code-boolean">False</code>, you create an <span class="caution" data-translate="condition_infinite">infinite loop</span> (your program gets stuck!).
                         </p>
                    </div>
                </div>
            </div>
        </section>


        <!-- ========= Knowledge Check Section ========= -->
        <section id="knowledge-check">
            <div class="container">
                <h2 class="fade-in" data-translate="quiz_title">🧠 Quick Check!</h2>
                <div class="quiz-container fade-in delay-1">
                    <div id="quiz-area">
                        <!-- Quiz questions will be loaded here by JavaScript -->
                    </div>
                    <div id="quiz-feedback" class="quiz-feedback">
                        <!-- Feedback (Correct/Incorrect) shown here -->
                    </div>
                    <button id="next-question-btn" data-translate="quiz_next_button">Next Question <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
        </section>

        <!-- ========= Completion Section ========= -->
        <section id="completion" class="completion-section">
            <div class="container">
                 <div class="icon"> <!-- Animation applied via CSS -->
                    <i class="fas fa-sync-alt"></i>
                    <i class="fas fa-check-double"></i>
                    <i class="fas fa-brain"></i>
                </div>
                <h2 class="fade-in delay-1" data-translate="completion_theory_title">Module 14 Theory Complete!</h2>
                <p class="fade-in delay-2" data-translate="completion_theory_desc">
                    Excellent! You've learned how the `while` loop repeats actions based on a condition. <br>
                    Time to practice this powerful looping structure in the <strong>Practice Zone</strong> or tackle the <strong>Advanced Practice</strong>.
                </p>
                <div class="button-group">
                    <!-- Button Order: Menu (Left, Grey), Practice (Center, Green), Advanced (Right, Grey) -->
                    <a href="ctp-dashboard.html" class="action-button secondary fade-in delay-3"><i class="fas fa-list"></i> <span data-translate="nav_menu">Course Menu</span></a>
                    <a href="ctp-practice-14.html" class="action-button success fade-in delay-4"><i class="fas fa-pencil-alt"></i> <span data-translate="nav_practice">Start Practice</span></a>
                    <a href="ctp-advanced-14.html" class="action-button secondary fade-in delay-5"><i class="fas fa-flask"></i> <span data-translate="nav_advanced">Advanced Practice</span></a>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer Section Removed -->

    <script>
    // --- Translations Object ---
    const translations = {
        en: {
            "page_title": "Module 14: Loops - Conditionals (while)",
            "nav_practice": "Start Practice", "nav_advanced": "Advanced Practice", "nav_menu": "Course Menu",
            "nav_intro": "Introduction", "nav_syntax": "Syntax & Example", "nav_condition": "The Condition", "nav_quiz": "Knowledge Check", "nav_completion": "Completion",
            "lang_en": "🇬🇧 English", "lang_pt": "🇧🇷 Português", "lang_zh": "🇨🇳 中文",
            "header_title": "Module 14: Repeating Actions with `while`", "header_subtitle": "Learn how to make Python repeat tasks as long as a condition is true.",
            "intro_title": "🔁 Repeating Actions Conditionally",
            "intro_p1": "Sometimes, you need the computer to do something over and over, but only while a certain situation is true.",
            "intro_analogy": "Imagine checking your phone for a message repeatedly, until you finally receive it.",
            "intro_p2": "Python's `while` loop is perfect for this conditional repetition.",
            "syntax_title": "⚙️ The `while` Loop Structure", "syntax_subtitle": "It checks a condition, then runs the indented code if it's true.",
            "code_comment_1": "# Start a counter", "code_comment_2": "# Loop while count is less than 3", "code_comment_3": "# Action inside the loop", "code_comment_4": "# IMPORTANT: Update the counter!", "code_comment_5": "# This runs after the loop",
            "syntax_text_p1": "The `while` statement is followed by a condition and a colon `:`.",
            "syntax_text_p2": "The code to be repeated must be indented underneath the `while` line.",
            "syntax_text_p3": "The loop continues as long as the condition is `True`. It stops when the condition becomes `False`.",
            "syntax_text_p4": "It's crucial that something inside the loop eventually makes the condition `False`! (Like `count = count + 1`).",
            "tooltip_while": "The keyword that starts the conditional loop.", "tooltip_condition": "An expression that evaluates to True or False (e.g., count < 3).", "tooltip_indentation": "Usually 4 spaces. This tells Python what's inside the loop.", "tooltip_true": "The loop keeps running.", "tooltip_false": "The loop terminates, and Python moves to the next line after the loop.",
            "condition_title": "🚦 The Condition is Key", "condition_subtitle": "The loop's fate depends entirely on the condition.",
            "condition_p1": "Before each potential repetition (iteration), Python re-evaluates the `while` condition.",
            "condition_p2": "If `True`: Run the indented code block again.",
            "condition_p3": "If `False`: Skip the block and continue after the loop.",
            "condition_p4": "Watch out! If the condition never becomes `False`, you create an infinite loop (your program gets stuck!).",
            "condition_warning_intro": "Watch out!", "condition_infinite": "infinite loop",
            "quiz_title": "🧠 Quick Check!", "quiz_next_button": "Next Question",
            "quiz_q1": "What is the main purpose of a `while` loop?",
            "quiz_q1_opt1": "To run code exactly once.", "quiz_q1_opt2": "To repeat code as long as a condition is True.", "quiz_q1_opt3": "To make decisions (like `if`).", "quiz_q1_opt4": "To store data.",
            "quiz_q2": "What happens right before Python decides whether to run the `while` loop's body again?",
            "quiz_q2_opt1": "It asks the user.", "quiz_q2_opt2": "It increments a counter automatically.", "quiz_q2_opt3": "It re-evaluates the loop's condition.", "quiz_q2_opt4": "It prints 'Checking'.",
            "quiz_q3": "What is essential to include inside a `while` loop to prevent it from running forever (infinite loop)?",
            "quiz_q3_opt1": "A `print()` statement.", "quiz_q3_opt2": "A comment explaining the loop.", "quiz_q3_opt3": "Code that eventually makes the condition False.", "quiz_q3_opt4": "An `if` statement.",
            "quiz_q4": "Consider: `x = 5` | `while x > 0:` | `  print(x)` | `  x = x - 1`. What is the last number printed?",
            "quiz_q4_opt1": "5", "quiz_q4_opt2": "1", "quiz_q4_opt3": "0", "quiz_q4_opt4": "The loop never stops.",
            "quiz_feedback_correct": "Correct! 🎉", "quiz_feedback_incorrect": "Not quite! The correct answer was: {correctAnswerText}",
            "quiz_final_score_title": "Module 14 Quiz Complete!", "quiz_final_score_summary": "You answered {score} out of {total} questions correctly.",
            "quiz_final_score_perfect": "Excellent work on `while` loops!", "quiz_final_score_good": "Good job! Practice makes perfect with loops.",
            "completion_theory_title": "Module 14 Theory Complete!",
            "completion_theory_desc": "Excellent! You've learned how the `while` loop repeats actions based on a condition. <br> Time to practice this powerful looping structure in the <strong>Practice Zone</strong> or tackle the <strong>Advanced Practice</strong>."
        },
        pt: {
            "page_title": "Módulo 14: Laços - Condicionais (while)",
            "nav_practice": "Iniciar Prática", "nav_advanced": "Prática Avançada", "nav_menu": "Menu do Curso",
            "nav_intro": "Introdução", "nav_syntax": "Sintaxe e Exemplo", "nav_condition": "A Condição", "nav_quiz": "Teste Rápido", "nav_completion": "Conclusão",
            "lang_en": "🇬🇧 English", "lang_pt": "🇧🇷 Português", "lang_zh": "🇨🇳 中文",
            "header_title": "Módulo 14: Repetindo Ações com `while`", "header_subtitle": "Aprenda como fazer o Python repetir tarefas enquanto uma condição for verdadeira.",
            "intro_title": "🔁 Repetindo Ações Condicionalmente",
            "intro_p1": "Às vezes, você precisa que o computador faça algo repetidamente, mas apenas enquanto uma certa situação for verdadeira.",
            "intro_analogy": "Imagine verificar seu celular por uma mensagem repetidamente, até que finalmente a receba.",
            "intro_p2": "O laço `while` do Python é perfeito para essa repetição condicional.",
            "syntax_title": "⚙️ A Estrutura do Laço `while`", "syntax_subtitle": "Ele verifica uma condição e executa o código indentado se for verdadeira.",
            "code_comment_1": "# Inicia um contador", "code_comment_2": "# Repete enquanto count for menor que 3", "code_comment_3": "# Ação dentro do laço", "code_comment_4": "# IMPORTANTE: Atualize o contador!", "code_comment_5": "# Isso executa após o laço",
            "syntax_text_p1": "A instrução `while` é seguida por uma condição e dois pontos `:`.",
            "syntax_text_p2": "O código a ser repetido deve ser indentado abaixo da linha `while`.",
            "syntax_text_p3": "O laço continua enquanto a condição for `True`. Ele para quando a condição se torna `False`.",
            "syntax_text_p4": "É crucial que algo dentro do laço eventualmente torne a condição `False`! (Como `count = count + 1`).",
            "tooltip_while": "A palavra-chave que inicia o laço condicional.", "tooltip_condition": "Uma expressão que avalia para True ou False (ex: count < 3).", "tooltip_indentation": "Geralmente 4 espaços. Indica ao Python o que está dentro do laço.", "tooltip_true": "O laço continua executando.", "tooltip_false": "O laço termina, e o Python passa para a próxima linha após o laço.",
            "condition_title": "🚦 A Condição é Chave", "condition_subtitle": "O destino do laço depende inteiramente da condição.",
            "condition_p1": "Antes de cada repetição potencial (iteração), o Python reavalia a condição `while`.",
            "condition_p2": "Se `True`: Executa o bloco de código indentado novamente.",
            "condition_p3": "Se `False`: Pula o bloco e continua após o laço.",
            "condition_p4": "Cuidado! Se a condição nunca se tornar `False`, você cria um laço infinito (seu programa fica preso!).",
            "condition_warning_intro": "Cuidado!", "condition_infinite": "laço infinito",
            "quiz_title": "🧠 Teste Rápido!", "quiz_next_button": "Próxima Pergunta",
            "quiz_q1": "Qual é o principal propósito de um laço `while`?",
            "quiz_q1_opt1": "Executar código exatamente uma vez.", "quiz_q1_opt2": "Repetir código enquanto uma condição for True.", "quiz_q1_opt3": "Tomar decisões (como `if`).", "quiz_q1_opt4": "Armazenar dados.",
            "quiz_q2": "O que acontece logo antes do Python decidir se executa o corpo do laço `while` novamente?",
            "quiz_q2_opt1": "Ele pergunta ao usuário.", "quiz_q2_opt2": "Ele incrementa um contador automaticamente.", "quiz_q2_opt3": "Ele reavalia a condição do laço.", "quiz_q2_opt4": "Ele imprime 'Verificando'.",
            "quiz_q3": "O que é essencial incluir dentro de um laço `while` para evitar que ele execute para sempre (laço infinito)?",
            "quiz_q3_opt1": "Uma instrução `print()`.", "quiz_q3_opt2": "Um comentário explicando o laço.", "quiz_q3_opt3": "Código que eventualmente torne a condição False.", "quiz_q3_opt4": "Uma instrução `if`.",
            "quiz_q4": "Considere: `x = 5` | `while x > 0:` | `  print(x)` | `  x = x - 1`. Qual é o último número impresso?",
            "quiz_q4_opt1": "5", "quiz_q4_opt2": "1", "quiz_q4_opt3": "0", "quiz_q4_opt4": "O laço nunca para.",
            "quiz_feedback_correct": "Correto! 🎉", "quiz_feedback_incorrect": "Não foi bem assim! A resposta correta era: {correctAnswerText}",
            "quiz_final_score_title": "Quiz Módulo 14 Completo!", "quiz_final_score_summary": "Você respondeu {score} de {total} perguntas corretamente.",
            "quiz_final_score_perfect": "Excelente trabalho com laços `while`!", "quiz_final_score_good": "Bom trabalho! A prática leva à perfeição com laços.",
            "completion_theory_title": "Teoria do Módulo 14 Completa!",
            "completion_theory_desc": "Excelente! Você aprendeu como o laço `while` repete ações com base em uma condição. <br> Hora de praticar essa poderosa estrutura de repetição na <strong>Zona de Prática</strong> ou encarar a <strong>Prática Avançada</strong>."
        },
        zh: {
            "page_title": "模块 14：循环 - 条件 (while)",
            "nav_practice": "开始练习", "nav_advanced": "高级练习", "nav_menu": "课程菜单",
            "nav_intro": "简介", "nav_syntax": "语法与示例", "nav_condition": "条件", "nav_quiz": "知识测验", "nav_completion": "完成",
            "lang_en": "🇬🇧 English", "lang_pt": "🇧🇷 Português", "lang_zh": "🇨🇳 中文",
            "header_title": "模块 14：使用 `while` 重复操作", "header_subtitle": "学习如何让 Python 在条件为真时重复执行任务。",
            "intro_title": "🔁 有条件地重复操作",
            "intro_p1": "有时，你需要计算机一遍又一遍地做某事，但前提是某个特定情况为真。",
            "intro_analogy": "想象一下，你反复检查手机是否有新消息，直到你最终收到为止。",
            "intro_p2": "Python 的 `while` 循环非常适合这种有条件的重复。",
            "syntax_title": "⚙️ `while` 循环结构", "syntax_subtitle": "它检查一个条件，如果条件为真，则运行缩进的代码。",
            "code_comment_1": "# 启动一个计数器", "code_comment_2": "# 当 count 小于 3 时循环", "code_comment_3": "# 循环内的操作", "code_comment_4": "# 重要：更新计数器！", "code_comment_5": "# 这在循环之后运行",
            "syntax_text_p1": "`while` 语句后面跟着一个条件和一个冒号 `:`。",
            "syntax_text_p2": "要重复的代码必须在 `while` 行下面进行缩进。",
            "syntax_text_p3": "只要条件为 `True`，循环就会继续。当条件变为 `False` 时，循环停止。",
            "syntax_text_p4": "至关重要的是，循环内部必须有某些东西最终使条件变为 `False`！（例如 `count = count + 1`）。",
            "tooltip_while": "启动条件循环的关键字。", "tooltip_condition": "一个计算结果为 True 或 False 的表达式（例如 count < 3）。", "tooltip_indentation": "通常是 4 个空格。它告诉 Python 循环内部包含哪些内容。", "tooltip_true": "循环继续运行。", "tooltip_false": "循环终止，Python 移动到循环之后的下一行。",
            "condition_title": "🚦 条件是关键", "condition_subtitle": "循环的命运完全取决于条件。",
            "condition_p1": "在每次潜在的重复（迭代）之前，Python 会重新评估 `while` 条件。",
            "condition_p2": "如果为 `True`：再次运行缩进的代码块。",
            "condition_p3": "如果为 `False`：跳过代码块并继续执行循环之后的代码。",
            "condition_p4": "注意！如果条件永远不会变成 `False`，你就会创建一个无限循环（你的程序会卡住！）。",
            "condition_warning_intro": "注意！", "condition_infinite": "无限循环",
            "quiz_title": "🧠 快速测验！", "quiz_next_button": "下一题",
            "quiz_q1": "`while` 循环的主要目的是什么？",
            "quiz_q1_opt1": "精确地运行一次代码。", "quiz_q1_opt2": "只要条件为 True 就重复代码。", "quiz_q1_opt3": "做决策（像 `if`）。", "quiz_q1_opt4": "存储数据。",
            "quiz_q2": "在 Python 决定是否再次运行 `while` 循环体之前，会发生什么？",
            "quiz_q2_opt1": "它会询问用户。", "quiz_q2_opt2": "它会自动增加一个计数器。", "quiz_q2_opt3": "它重新评估循环的条件。", "quiz_q2_opt4": "它打印 'Checking'。",
            "quiz_q3": "为了防止 `while` 循环永远运行下去（无限循环），在循环内部必须包含什么？",
            "quiz_q3_opt1": "一个 `print()` 语句。", "quiz_q3_opt2": "解释循环的注释。", "quiz_q3_opt3": "能最终使条件变为 False 的代码。", "quiz_q3_opt4": "一个 `if` 语句。",
            "quiz_q4": "考虑：`x = 5` | `while x > 0:` | `  print(x)` | `  x = x - 1`。打印的最后一个数字是什么？",
            "quiz_q4_opt1": "5", "quiz_q4_opt2": "1", "quiz_q4_opt3": "0", "quiz_q4_opt4": "循环永不停止。",
            "quiz_feedback_correct": "正确！🎉", "quiz_feedback_incorrect": "不太对！正确答案是：{correctAnswerText}",
            "quiz_final_score_title": "模块 14 测验完成！", "quiz_final_score_summary": "你答对了 {score} / {total} 题。",
            "quiz_final_score_perfect": "在 `while` 循环方面做得非常出色！", "quiz_final_score_good": "做得不错！熟能生巧，尤其对于循环。",
            "completion_theory_title": "模块 14 理论完成！",
            "completion_theory_desc": "太棒了！你已经学会了 `while` 循环如何根据条件重复操作。 <br> 是时候在<strong>练习区</strong>练习这个强大的循环结构，或者挑战<strong>高级练习</strong>了。"
        }
    };


    document.addEventListener('DOMContentLoaded', () => {

        // --- Language Management --- (Identical to Module 0) ---
        function getStoredLanguage() {
            const storedLang = localStorage.getItem('userLanguage');
            if (storedLang && translations[storedLang]) return storedLang;
            const browserLang = navigator.language || navigator.userLanguage;
            if (browserLang.startsWith('pt')) return 'pt';
            if (browserLang.startsWith('zh')) return 'zh';
            return 'en';
        }

        function setLanguage(lang) {
            if (!translations[lang]) lang = 'en';
            localStorage.setItem('userLanguage', lang);
            document.documentElement.lang = lang;
            translatePage(lang);
            const langSelect = document.getElementById('languageSelect');
            if (langSelect) langSelect.value = lang;
             if(quizArea && currentQuestionIndex < quizData.length) {
                 if (!quizArea.querySelector('[data-translate="quiz_final_score_title"]')) {
                    loadQuestion();
                 }
             }
             // Update code comments specifically for language
             updateCodeComments(lang);
        }

        function getTranslation(key, lang, replacements = {}) {
            let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`;
            for (const placeholder in replacements) {
                const regex = new RegExp(`\\{${placeholder}\\}`, 'g');
                text = text.replace(regex, replacements[placeholder]);
            }
            return text;
        }

        function translatePage(lang) {
             if (!translations[lang]) lang = 'en';
             document.querySelectorAll('[data-translate]').forEach(el => {
                 const key = el.getAttribute('data-translate');
                 const translation = getTranslation(key, lang);
                  if (el.tagName === 'TITLE') { document.title = translation; }
                  else if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') { /* Skip placeholders for now */ }
                  else if (el.tagName === 'OPTION') { el.textContent = translation; }
                  else {
                       if (translation.includes('<') && translation.includes('>')) {
                           el.innerHTML = translation; // Allow HTML in translations
                       } else {
                           el.textContent = translation;
                       }
                  }
             });
             document.querySelectorAll('[data-translate-placeholder]').forEach(el => {
                 const key = el.getAttribute('data-translate-placeholder');
                 el.setAttribute('placeholder', getTranslation(key, lang));
             });
             document.querySelectorAll('.code-highlight').forEach(el => {
                 const tooltipKey = el.getAttribute('data-translate-tooltip');
                 const tooltipSpan = el.querySelector('.tooltip');
                 if(tooltipSpan && tooltipKey) {
                    tooltipSpan.textContent = getTranslation(tooltipKey, lang);
                 }
             });
             // Update code comments is handled separately in setLanguage and initialization
        }

        function updateCodeComments(lang) {
            const codeBlock = document.querySelector('.code-demo');
            if (!codeBlock) return;

            const commentKeys = [
                "code_comment_1", "code_comment_2", "code_comment_3",
                "code_comment_4", "code_comment_5"
            ];

            commentKeys.forEach((key, index) => {
                const commentSpan = codeBlock.querySelector(`.code-comment[data-translate="${key}"]`);
                if (commentSpan) {
                    const translatedText = getTranslation(key, lang);
                    // Keep the '#' symbol and space
                    const commentContent = translatedText.startsWith('# ') ? translatedText.substring(2) : translatedText;
                    commentSpan.textContent = '# ' + commentContent;
                }
            });
        }

        const initialLang = getStoredLanguage();

        // --- Minimal Nav Logic --- (Identical to Module 0) ---
        const navToggleButton = document.getElementById('minimal-nav-toggle');
        const navPanel = document.getElementById('minimal-nav-panel');
        const body = document.body;

        if (navToggleButton && navPanel) {
            navToggleButton.addEventListener('click', (event) => {
                event.stopPropagation(); body.classList.toggle('nav-active');
                navToggleButton.setAttribute('aria-expanded', body.classList.contains('nav-active'));
             });
            document.addEventListener('click', (event) => {
                if (body.classList.contains('nav-active') && !navPanel.contains(event.target) &&
                    event.target !== navToggleButton && !navToggleButton.contains(event.target)) {
                    body.classList.remove('nav-active');
                    navToggleButton.setAttribute('aria-expanded', 'false');
                }
             });
            navPanel.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    body.classList.remove('nav-active');
                    navToggleButton.setAttribute('aria-expanded', 'false');
                });
             });
             document.addEventListener('keydown', (event) => {
                 if (event.key === 'Escape' && body.classList.contains('nav-active')) {
                    body.classList.remove('nav-active');
                    navToggleButton.setAttribute('aria-expanded', 'false');
                 }
             });
             // Initial state
             navToggleButton.setAttribute('aria-expanded', 'false');
        }

        // --- Language Switcher Setup --- (Identical to Module 0) ---
        const langSelect = document.getElementById('languageSelect');
        if (langSelect) {
            langSelect.addEventListener('change', (e) => {
                setLanguage(e.target.value);
            });
        }

        // --- Intersection Observer for Fade-in Animations --- (Identical to Module 0) ---
        const observerOptions = { root: null, rootMargin: '0px', threshold: 0.1 };
        const observerCallback = (entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    // Optional: unobserve after first intersection if animation shouldn't repeat
                    // observer.unobserve(entry.target);
                }
            });
        };
        const observer = new IntersectionObserver(observerCallback, observerOptions);
        // Observe all elements that need fade-in
        document.querySelectorAll('.fade-in').forEach(el => {
             observer.observe(el);
        });

        // --- `while` Loop Code Simulation ---
        const codeOutputArea = document.querySelector('#while-syntax .code-output-area');
        let simulationTimeout; // To clear timeout if needed

        function simulateCodeExecution() {
            if (!codeOutputArea) return;

            // Clear previous simulation if any
            clearTimeout(simulationTimeout);
            codeOutputArea.innerHTML = ''; // Clear previous output
            codeOutputArea.classList.remove('visible', 'typing', 'done');

            const outputLines = [
                "Count is: 0",
                "Count is: 1",
                "Count is: 2",
                "Loop finished!"
            ];
            let delay = 500; // Initial delay

            // Trigger visibility early
             requestAnimationFrame(() => {
                 codeOutputArea.classList.add('visible');
            });


             simulationTimeout = setTimeout(() => { // Add slight delay before starting typing
                  codeOutputArea.classList.add('typing');
                  outputLines.forEach((lineText, index) => {
                        simulationTimeout = setTimeout(() => {
                            const lineElement = document.createElement('span');
                            lineElement.classList.add('output-line');
                            lineElement.textContent = `> ${lineText}`;
                            codeOutputArea.appendChild(lineElement);

                             // Trigger animation for the new line
                            requestAnimationFrame(() => {
                                 requestAnimationFrame(() => { // Double request ensures class is applied after append
                                      lineElement.style.opacity = 1; // Or add a class that triggers animation
                                 });
                            });


                            // If it's the last line, remove cursor and mark as done
                            if (index === outputLines.length - 1) {
                                setTimeout(() => { // Short delay after last line appears
                                    codeOutputArea.classList.remove('typing');
                                    codeOutputArea.classList.add('done');
                                }, 300);
                            }
                        }, index * 800); // Stagger the appearance of each line
                  });
             }, 500); // Delay before typing starts
        }


        // Use Intersection Observer to trigger the simulation when visible
        const codeDemoObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    simulateCodeExecution();
                    // Optionally unobserve after running once
                    // codeDemoObserver.unobserve(entry.target);
                } else {
                     // Optional: Clear simulation if it scrolls out of view before completion?
                     // clearTimeout(simulationTimeout);
                     // if (codeOutputArea) {
                     //    codeOutputArea.innerHTML = '';
                     //    codeOutputArea.classList.remove('visible', 'typing', 'done');
                     // }
                }
            });
        }, { threshold: 0.6 }); // Trigger when 60% is visible

        const codeDemoElement = document.querySelector('.code-demo');
        if (codeDemoElement) {
            codeDemoObserver.observe(codeDemoElement);
        }

        // --- Tooltip Setup (Handled by CSS :hover) ---

        // --- Knowledge Check / Quiz ---
         const quizData = [
            { questionKey: "quiz_q1", optionKeys: ["quiz_q1_opt1", "quiz_q1_opt2", "quiz_q1_opt3", "quiz_q1_opt4"], correctAnswer: 1 },
            { questionKey: "quiz_q2", optionKeys: ["quiz_q2_opt1", "quiz_q2_opt2", "quiz_q2_opt3", "quiz_q2_opt4"], correctAnswer: 2 },
            { questionKey: "quiz_q3", optionKeys: ["quiz_q3_opt1", "quiz_q3_opt2", "quiz_q3_opt3", "quiz_q3_opt4"], correctAnswer: 2 },
            { questionKey: "quiz_q4", optionKeys: ["quiz_q4_opt1", "quiz_q4_opt2", "quiz_q4_opt3", "quiz_q4_opt4"], correctAnswer: 1 } // Prints 5, 4, 3, 2, 1. Last is 1.
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        const quizArea = document.getElementById('quiz-area');
        const feedbackArea = document.getElementById('quiz-feedback');
        const nextButton = document.getElementById('next-question-btn');

        function loadQuestion() {
             const currentLang = getStoredLanguage();
             if (!quizArea || currentQuestionIndex >= quizData.length) {
                 if (quizArea && !quizArea.querySelector('[data-translate="quiz_final_score_title"]')) {
                    showFinalScore();
                 }
                 return;
             }

             const currentQuiz = quizData[currentQuestionIndex];
             // Translate question and options
             const questionText = getTranslation(currentQuiz.questionKey, currentLang);
             const optionsHTML = currentQuiz.optionKeys.map((optionKey, index) => {
                const optionText = getTranslation(optionKey, currentLang);
                // Basic code formatting within options if needed (detect backticks)
                const formattedOptionText = optionText.replace(/`([^`]+)`/g, '<code style="font-size: 0.9em; background-color: rgba(0,0,0,0.05); padding: 1px 4px; border-radius: 3px;">$1</code>');
                 // Handle multiple code blocks separated by |
                const parts = formattedOptionText.split('|').map(part => part.trim());
                const processedParts = parts.map(part => {
                     if (part.includes('<code')) return part; // Already formatted
                     if (part.match(/^[a-zA-Z0-9_\s=<>+\-'"!]+$/) && part.includes('=')) { // Simple code detection
                          return `<code style="font-size: 0.9em; background-color: rgba(0,0,0,0.05); padding: 1px 4px; border-radius: 3px;">${part}</code>`;
                     }
                     return part;
                });
                 const finalOptionText = processedParts.join(' | ');

                return `<button class="quiz-option-btn" data-index="${index}">${finalOptionText}</button>`;
             }).join('');

             // Format question text for code blocks
             const formattedQuestionText = questionText.replace(/`([^`]+)`/g, '<code style="font-size: 0.9em; color: var(--loop-color); font-weight:bold;">$1</code>');

             quizArea.innerHTML = `
                 <div class="quiz-question">${currentQuestionIndex + 1}. ${formattedQuestionText}</div>
                 <div class="quiz-options">${optionsHTML}</div>
             `;

             feedbackArea.classList.remove('visible', 'correct', 'incorrect');
             feedbackArea.textContent = '';
             nextButton.classList.remove('visible');
             nextButton.disabled = true;

             document.querySelectorAll('.quiz-option-btn').forEach(button => {
                 button.addEventListener('click', handleAnswer);
             });
         }

         function handleAnswer(event) {
             const currentLang = getStoredLanguage();
             const selectedButton = event.target.closest('.quiz-option-btn'); // Ensure we get the button
             if (!selectedButton) return;

             const selectedIndex = parseInt(selectedButton.dataset.index);
             const correctIndex = quizData[currentQuestionIndex].correctAnswer;
             const correctOptionKey = quizData[currentQuestionIndex].optionKeys[correctIndex];
             const correctAnswerRawText = getTranslation(correctOptionKey, currentLang);
              // Format correct answer text similar to how options are formatted for display
             const correctAnswerText = correctAnswerRawText.replace(/`([^`]+)`/g, '<code style="font-size: 0.9em; background-color: rgba(0,0,0,0.05); padding: 1px 4px; border-radius: 3px;">$1</code>');
             const parts = correctAnswerText.split('|').map(part => part.trim());
             const processedParts = parts.map(part => {
                 if (part.includes('<code')) return part;
                 if (part.match(/^[a-zA-Z0-9_\s=<>+\-'"!]+$/) && part.includes('=')) {
                     return `<code style="font-size: 0.9em; background-color: rgba(0,0,0,0.05); padding: 1px 4px; border-radius: 3px;">${part}</code>`;
                 }
                 return part;
             });
             const finalCorrectAnswerText = processedParts.join(' | ');


             document.querySelectorAll('.quiz-option-btn').forEach(btn => {
                btn.disabled = true;
                btn.classList.remove('shake');
            });

             feedbackArea.classList.add('visible');

             if (selectedIndex === correctIndex) {
                 selectedButton.classList.add('correct');
                 feedbackArea.innerHTML = getTranslation('quiz_feedback_correct', currentLang);
                 feedbackArea.classList.add('correct');
                 feedbackArea.classList.remove('incorrect');
                 score++;
                 selectedButton.classList.add('tada-anim');
             } else {
                 selectedButton.classList.add('incorrect');
                 feedbackArea.innerHTML = getTranslation('quiz_feedback_incorrect', currentLang, { correctAnswerText: `<strong>${finalCorrectAnswerText}</strong>` });
                 feedbackArea.classList.add('incorrect');
                 feedbackArea.classList.remove('correct');
                 const correctButton = document.querySelector(`.quiz-option-btn[data-index="${correctIndex}"]`);
                 if(correctButton) correctButton.classList.add('correct');
                 selectedButton.classList.add('shake');
             }

              selectedButton.addEventListener('animationend', () => {
                   selectedButton.classList.remove('tada-anim', 'shake');
              }, { once: true });


             nextButton.classList.add('visible');
             nextButton.disabled = false;
         }

          function showFinalScore() {
              const currentLang = getStoredLanguage();
              const totalQuestions = quizData.length;
              let resultMessageKey = score === totalQuestions ? 'quiz_final_score_perfect' : 'quiz_final_score_good';

              quizArea.innerHTML = `
                  <div class="quiz-question text-center" data-translate="quiz_final_score_title" style="font-size: 1.5rem;">${getTranslation('quiz_final_score_title', currentLang)}</div>
                  <p class="text-center" style="font-size: 1.2rem; margin-bottom: 1rem;">${getTranslation('quiz_final_score_summary', currentLang, { score: score, total: totalQuestions })}</p>
                  <p class="text-center" style="color: ${score === totalQuestions ? 'var(--success-color)' : 'var(--primary-color)'}; font-weight: bold;">${getTranslation(resultMessageKey, currentLang)}</p>
              `;
              feedbackArea.classList.remove('visible');
              nextButton.style.display = 'none'; // Hide next button
              // Scroll smoothly to the results
               const quizContainer = document.querySelector('.quiz-container');
               if (quizContainer) {
                   quizContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
               }
          }


        nextButton.addEventListener('click', () => {
             currentQuestionIndex++;
             loadQuestion();
         });


        // --- Initial Language Application and Load ---
        setLanguage(initialLang); // Apply language FIRST (this also calls translatePage and updateCodeComments)
        if (quizArea) { loadQuestion(); } // Initial quiz load

        // Trigger initial fade-ins for elements already in view (handled by Intersection Observer now)

    }); // End DOMContentLoaded
    </script>

</body>
</html>
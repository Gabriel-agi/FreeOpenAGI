<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="page_title">Module 28: Algorithms - Sorting</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Reset & Base Styles --- */
        :root {
            --primary-color: #007bff; /* Blue */
            --secondary-color: #6c757d; /* Grey */
            --background-light: #f8f9fa;
            --background-dark: #343a40;
            --text-light: #f8f9fa;
            --text-dark: #212529;
            --accent-color: #ffc107; /* Yellow */
            --success-color: #28a745; /* Green */
            --error-color: #dc3545; /* Red */
            --info-color: #17a2b8; /* Teal */
            --border-radius: 8px;
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
             /* Nav Colors */
            --nav-primary: #6e48aa; /* Purple */
            --nav-success: #4cc9f0; /* Light Blue */
            --nav-dark: #1a1a2e; /* Dark Blue/Black */
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.7;
            background-color: var(--background-light); color: var(--text-dark);
            overflow-x: hidden; display: flex; flex-direction: column; min-height: 100vh;
        }
        main { flex-grow: 1; }

        /* --- Utility Classes --- */
        .container { max-width: 960px; margin: 0 auto; padding: 0 15px; }
        .text-center { text-align: center; }
        .highlight { color: var(--primary-color); font-weight: bold; }
        .fade-in { opacity: 0; transform: translateY(20px); animation: fadeInAnimation 0.8s ease-out forwards; }
        .fade-in.delay-1 { animation-delay: 0.2s; } .fade-in.delay-2 { animation-delay: 0.4s; }
        .fade-in.delay-3 { animation-delay: 0.6s; } .fade-in.delay-4 { animation-delay: 0.8s; }
        .fade-in.delay-5 { animation-delay: 1.0s; }
        .button-group { margin-top: 2rem; display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem; }
        .action-button {
            display: inline-flex; align-items: center; justify-content: center; gap: 0.5em;
            padding: 0.8rem 1.5rem; font-size: 1rem; font-weight: bold; color: var(--text-light);
            background-color: var(--primary-color); border: none; border-radius: var(--border-radius);
            cursor: pointer; transition: background-color var(--transition-speed), transform var(--transition-speed), filter var(--transition-speed), box-shadow var(--transition-speed);
            margin-top: 1rem; box-shadow: 0 2px 5px rgba(0,0,0,0.1); text-decoration: none; line-height: 1.2;
        }
        .action-button i.fas { /* Alignment handled by inline-flex */ }
        .action-button:hover:not(:disabled) { background-color: #0056b3; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
        .action-button:disabled { background-color: var(--secondary-color); cursor: not-allowed; transform: none; box-shadow: none; opacity: 0.7; }
        .action-button.success { background-color: var(--success-color); }
        .action-button.success:hover:not(:disabled) { background-color: #218838; }
        .action-button.secondary { background-color: var(--secondary-color); }
        .action-button.secondary:hover:not(:disabled) { background-color: #5a6268; }
        .action-button.info { background-color: var(--info-color); }
        .action-button.info:hover:not(:disabled) { background-color: #138496; }
        .action-button:active:not(:disabled) { transform: translateY(1px) scale(0.98); filter: brightness(0.95); }
        code { /* Inline code style */
            background-color: rgba(0, 123, 255, 0.1); color: #0056b3; padding: 0.2em 0.4em;
            border-radius: 4px; font-family: 'Courier New', Courier, monospace; font-weight: bold;
        }

        /* --- Animations --- */
        @keyframes fadeInAnimation { to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0% { transform: scale(1); box-shadow: 0 0 5px rgba(0, 123, 255, 0.3); } 50% { transform: scale(1.03); box-shadow: 0 0 15px rgba(0, 123, 255, 0.6); } 100% { transform: scale(1); box-shadow: 0 0 5px rgba(0, 123, 255, 0.3); } }
        @keyframes tada { from { transform: scale3d(1, 1, 1); } 10%, 20% { transform: scale3d(.9, .9, .9) rotate3d(0, 0, 1, -3deg); } 30%, 50%, 70%, 90% { transform: scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, 3deg); } 40%, 60%, 80% { transform: scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, -3deg); } to { transform: scale3d(1, 1, 1); } }
        .tada-anim { animation: tada 1s ease; }
        @keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); } }
        @keyframes iconAppearCorrect { 0% { transform: scale(0.5) rotate(-15deg); opacity: 0; } 60% { transform: scale(1.2) rotate(5deg); opacity: 1; } 100% { transform: scale(1) rotate(0deg); opacity: 1; } }

        /* --- Minimal Retractable Nav --- */
        .minimal-nav-button { position: fixed; top: 15px; right: 15px; z-index: 1001; background-color: rgba(52, 58, 64, 0.75); color: var(--text-light); border: none; border-radius: var(--border-radius); padding: 8px 12px; cursor: pointer; transition: background-color var(--transition-speed), opacity var(--transition-speed), transform var(--transition-speed); font-size: 1.1rem; opacity: 0.6; box-shadow: 0 2px 5px rgba(0,0,0,0.2); line-height: 1; }
        .minimal-nav-button:hover { background-color: rgba(52, 58, 64, 0.95); opacity: 1; transform: scale(1.05); }
        .minimal-nav { position: fixed; top: 60px; right: 15px; z-index: 1000; background-color: var(--background-dark); border-radius: var(--border-radius); box-shadow: 0 5px 15px rgba(0,0,0,0.3); padding: 0.8rem; opacity: 0; transform: translateY(-15px) scale(0.95); transform-origin: top right; pointer-events: none; transition: opacity var(--transition-speed) ease, transform var(--transition-speed) ease; min-width: 200px; }
        body.nav-active .minimal-nav { opacity: 1; transform: translateY(0) scale(1); pointer-events: auto; }
        .minimal-nav ul { list-style: none; margin: 0; padding: 0; }
        .minimal-nav ul li { margin-bottom: 5px; }
        .minimal-nav ul li:last-child { margin-bottom: 0; }
        .minimal-nav ul li a { display: flex; align-items: center; color: var(--text-light); text-decoration: none; padding: 0.6rem 1rem; border-radius: 4px; transition: background-color var(--transition-speed), color var(--transition-speed); white-space: nowrap; font-weight: 400; font-size: 0.95rem; }
        .minimal-nav ul li a i.fas { margin-right: 10px; width: 1.2em; text-align: center; opacity: 0.8; transition: opacity var(--transition-speed); }
        .minimal-nav ul li a:hover { background-color: var(--nav-primary); color: var(--text-light); }
        .minimal-nav ul li a:hover i.fas { opacity: 1; }
        .minimal-nav .language-switcher-item { padding: 0.5rem 1rem; border-top: 1px solid var(--secondary-color); margin-top: 8px; padding-top: 13px; }
        #languageSelect { width: 100%; background: rgba(255,255,255,0.1); color: white; border: 1px solid var(--nav-success); border-radius: 5px; padding: 6px 30px 6px 12px; cursor: pointer; font-size: 0.9rem; appearance: none; -webkit-appearance: none; -moz-appearance: none; background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%234CC9F0%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'); background-repeat: no-repeat; background-position: right 10px center; background-size: 10px auto; transition: background-color 0.3s ease; }
        #languageSelect:hover { background-color: rgba(255,255,255,0.15); }
        #languageSelect option { background: var(--nav-dark); color: var(--text-light); }

        /* --- Header --- */
        .main-header { background: linear-gradient(135deg, var(--info-color), #117a8b); /* Teal Gradient */ color: var(--text-light); padding: 4rem 0 6rem; text-align: center; position: relative; overflow: hidden; }
        .main-header h1 { font-family: var(--font-title); font-size: 3rem; margin-bottom: 0.5rem; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3); animation: fadeInAnimation 1s ease-out; }
        .main-header p { font-size: 1.2rem; font-weight: 300; opacity: 0.9; animation: fadeInAnimation 1s ease-out 0.3s forwards; opacity: 0; }
        .header-shape { position: absolute; border-radius: 50%; background-color: rgba(255, 255, 255, 0.1); animation: pulse 5s infinite ease-in-out alternate; }
        .shape1 { width: 150px; height: 150px; bottom: -50px; left: 10%; animation-duration: 6s; }
        .shape2 { width: 80px; height: 80px; top: 50px; right: 15%; animation-duration: 4s; }
        .shape3 { width: 50px; height: 50px; bottom: 20px; right: 30%; animation-duration: 7s; }

        /* --- Section Styling --- */
        section { padding: 4rem 0; border-bottom: 1px solid #eee; }
        main section:last-of-type { border-bottom: none; }
        section h2 { font-family: var(--font-title); font-size: 2.2rem; color: var(--info-color); /* Match Header */ margin-bottom: 2rem; text-align: center; position: relative; padding-bottom: 10px; }
        section h2::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 60px; height: 4px; background-color: var(--accent-color); border-radius: 2px; }

        /* --- Welcome Section (Module 28) --- */
        #welcome p { font-size: 1.1rem; max-width: 700px; margin: 0 auto 1rem; text-align: center; }

        /* --- What is Sorting Section --- */
        #what-is-sorting .sorting-analogy { display: flex; align-items: center; justify-content: space-around; background-color: #fff; padding: 2rem; border-radius: var(--border-radius); box-shadow: 0 5px 15px rgba(0,0,0,0.08); margin-top: 2rem; flex-wrap: wrap; gap: 1rem; }
        .analogy-part { text-align: center; max-width: 200px; opacity: 0; transform: scale(0.9); transition: opacity 0.5s ease, transform 0.5s ease; }
        .analogy-part.visible { opacity: 1; transform: scale(1); }
        .analogy-icon { font-size: 3rem; margin-bottom: 1rem; color: var(--info-color); display: inline-block; transition: transform var(--transition-speed) ease; }
        .analogy-part:hover .analogy-icon { transform: scale(1.2) rotate(5deg); }
        .analogy-arrow { font-size: 2.5rem; color: var(--secondary-color); opacity: 0; transition: opacity 0.5s ease 0.3s; }
        .analogy-arrow.visible { opacity: 0.7; }

        /* --- Why Learn Sorting Section --- */
        #why-learn-sorting .features { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-top: 2rem; }
        .feature-card { background-color: #fff; padding: 1.5rem; border-radius: var(--border-radius); box-shadow: 0 4px 10px rgba(0,0,0,0.07); text-align: center; transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease; cursor: pointer; opacity: 0; transform: translateY(20px); animation: fadeInAnimation 0.6s ease-out forwards; }
        .feature-card:nth-child(1) { animation-delay: 0.2s; } .feature-card:nth-child(2) { animation-delay: 0.4s; } .feature-card:nth-child(3) { animation-delay: 0.6s; }
        .feature-card:hover { transform: translateY(-5px) scale(1.02); box-shadow: 0 8px 20px rgba(0,0,0,0.12); }
        .feature-icon { font-size: 2.5rem; margin-bottom: 1rem; color: var(--info-color); }
        .feature-card h3 { font-family: var(--font-body); font-weight: 700; font-size: 1.3rem; margin-bottom: 0.8rem; color: var(--text-dark); }
        .feature-details { max-height: 0; overflow: hidden; transition: max-height 0.5s ease-out, margin-top 0.5s ease-out; font-size: 0.95rem; color: var(--secondary-color); margin-top: 0; }
        .feature-card.active .feature-details { max-height: 200px; margin-top: 1rem; }

        /* --- Sorting Visualization Section --- */
        #visualizing-sorting .sort-container {
            background-color: #fff; padding: 2rem; border-radius: var(--border-radius);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-top: 2rem;
        }
        .sort-visualization { display: flex; gap: 3rem; flex-wrap: wrap; justify-content: center; }
        .sort-algorithm { flex-basis: 45%; min-width: 300px; }
        .sort-algorithm h3 { text-align: center; margin-bottom: 1.5rem; font-family: var(--font-body); font-weight: 700; color: var(--primary-color); }
        .bars-container {
            display: flex; align-items: flex-end; /* Align bars at the bottom */
            height: 200px; border: 1px solid #eee; padding: 10px 10px 0; /* Padding top only */
            background-color: #f8f9fa; border-radius: var(--border-radius); margin-bottom: 1rem;
            overflow: hidden; /* Clip bars if too many */
            position: relative; /* For absolute positioning of text */
        }
        .sort-bar {
            flex-grow: 1; /* Bars share space */
            background-color: var(--secondary-color);
            margin: 0 1px; /* Small gap between bars */
            transition: height 0.3s ease, background-color 0.3s ease, transform 0.3s ease;
            position: relative; /* For value display */
            text-align: center; /* Center value */
            color: rgba(255, 255, 255, 0.8); /* Light text on bar */
            font-size: 0.8rem;
            writing-mode: vertical-rl; /* Vertical text */
            text-orientation: mixed;
            line-height: 1; /* Prevent extra space */
            padding-bottom: 3px; /* Space from bottom */
        }
         /* Bar States */
        .sort-bar.comparing { background-color: var(--accent-color); /* Yellow */ }
        .sort-bar.swapping { background-color: var(--error-color); /* Red */ transform: scaleY(1.05); }
        .sort-bar.checking { background-color: var(--info-color); /* Teal */ }
        .sort-bar.sorted { background-color: var(--success-color); /* Green */ }
        .sort-controls { text-align: center; margin-top: 1rem; display: flex; justify-content: center; gap: 0.5rem; flex-wrap: wrap;}
        .sort-controls .action-button { margin-top: 0; padding: 0.6rem 1rem; font-size: 0.9rem; }
        .sort-description {
            margin-top: 1rem; padding: 0.8rem; background-color: #e9ecef;
            border-radius: var(--border-radius); font-size: 0.95rem; min-height: 60px;
            text-align: center; color: var(--text-dark);
            transition: background-color 0.3s ease;
        }
         .sort-description code { font-size: 0.9em; } /* Slightly smaller code in description */

        /* --- Knowledge Check Section --- */
        #knowledge-check { background-color: #e9ecef; }
        .quiz-container { background-color: #fff; padding: 2rem; border-radius: var(--border-radius); box-shadow: 0 5px 15px rgba(0,0,0,0.1); max-width: 700px; margin: 2rem auto 0; }
        .quiz-question { font-size: 1.2rem; font-weight: bold; margin-bottom: 1.5rem; color: var(--text-dark); }
        .quiz-options button { display: block; width: 100%; padding: 1rem; margin-bottom: 1rem; text-align: left; font-size: 1rem; background-color: #f8f9fa; border: 1px solid #ced4da; border-radius: var(--border-radius); cursor: pointer; transition: background-color var(--transition-speed), border-color var(--transition-speed), transform var(--transition-speed); }
        .quiz-options button:not(:disabled):hover { background-color: #e2e6ea; border-color: #adb5bd; transform: translateX(5px); }
        .quiz-options button:disabled { cursor: default; opacity: 0.7; }
        .quiz-options button.correct { background-color: #d4edda; border-color: var(--success-color); color: #155724; font-weight: bold; }
        .quiz-options button.incorrect { background-color: #f8d7da; border-color: var(--error-color); color: #721c24; font-weight: bold; }
        .quiz-options button.incorrect.shake { animation: shake 0.5s ease; }
        .quiz-feedback { margin-top: 1.5rem; padding: 1rem; border-radius: var(--border-radius); font-weight: bold; text-align: center; opacity: 0; transition: opacity 0.5s ease; height: 0; overflow: hidden; }
        .quiz-feedback.visible { opacity: 1; height: auto; margin-bottom: 1rem; }
        .quiz-feedback.correct { background-color: #d4edda; color: #155724; }
        .quiz-feedback.incorrect { background-color: #f8d7da; color: #721c24; }
        #next-question-btn { display: inline-flex; align-items: center; justify-content: center; gap: 0.5em; margin: 1.5rem auto 0; padding: 0.8rem 1.5rem; font-size: 1rem; font-weight: bold; color: var(--text-light); background-color: var(--primary-color); border: none; border-radius: var(--border-radius); cursor: pointer; transition: background-color var(--transition-speed), transform var(--transition-speed), opacity 0.3s, visibility 0.3s; opacity: 0; visibility: hidden; }
        #next-question-btn:hover { background-color: #0056b3; transform: scale(1.05); }
        #next-question-btn.visible { opacity: 1; visibility: visible; }

        /* --- Completion Section Styling --- */
        .completion-section { padding: 4rem 0; text-align: center; background-color: var(--background-light); }
        .completion-section .icon { font-size: 4rem; color: var(--success-color); margin-bottom: 1rem; display: inline-block; opacity: 0; animation: iconAppearCorrect 1s ease-out 0.5s forwards; }
        .completion-section .icon .fas + .fas { margin-left: 0.75rem; }
        .completion-section h2 { font-family: var(--font-title); font-size: 2.2rem; color: var(--primary-color); margin-bottom: 1rem; }
        .completion-section h2::after { display: none; } /* Remove underline */
        .completion-section p { font-size: 1.1rem; margin-top: 1rem; color: var(--secondary-color); max-width: 700px; margin-left: auto; margin-right: auto; line-height: 1.8; }
        .completion-section .button-group { margin-top: 2.5rem; }

        /* --- Responsive Design --- */
        @media (max-width: 768px) {
            html { font-size: 15px; }
            .main-header h1 { font-size: 2.5rem; }
            .main-header p { font-size: 1.1rem; }
            section h2 { font-size: 1.8rem; }
            .sorting-analogy { flex-direction: column; gap: 1.5rem; }
            .analogy-arrow { transform: rotate(90deg); margin: 1rem 0; }
            #why-learn-sorting .features { grid-template-columns: 1fr; }
            #visualizing-sorting .sort-visualization { gap: 2rem; }
            #visualizing-sorting .sort-algorithm { flex-basis: 80%; min-width: 280px; }
            .bars-container { height: 180px; }
            .sort-bar { font-size: 0.7rem; }
            /* Nav Adjustments */
            .minimal-nav { min-width: 180px; } .minimal-nav ul li a { padding: 0.6rem 0.8rem; }
            #languageSelect { font-size: 0.85rem; padding: 5px 25px 5px 10px;}
            /* Completion Section */
            .completion-section h2 { font-size: 2rem; }
            .completion-section .button-group { flex-direction: column; align-items: center; gap: 0.8rem; }
            .completion-section .action-button { width: 80%; max-width: 350px; margin-top: 0; }
        }
        @media (max-width: 480px) {
            html { font-size: 14px; }
            .main-header h1 { font-size: 2rem; }
            .main-header p { font-size: 1rem; }
            section h2 { font-size: 1.6rem; }
            #visualizing-sorting .sort-algorithm { flex-basis: 100%; }
            .bars-container { height: 150px; }
            .sort-bar { font-size: 0.6rem; margin: 0; } /* Bars touch on smallest screens */
            .sort-controls .action-button { font-size: 0.8rem; padding: 0.5rem 0.8rem; }
            .quiz-options button { padding: 0.8rem; font-size: 0.95rem; }
            /* Nav Adjustments */
            .minimal-nav-button { top: 10px; right: 10px; padding: 6px 10px; font-size: 1rem; }
            .minimal-nav { top: 48px; right: 10px; min-width: 160px; }
            .minimal-nav ul li a { padding: 0.5rem 0.7rem; font-size: 0.9rem;}
            .minimal-nav ul li a i.fas { margin-right: 8px; }
            #languageSelect { font-size: 0.8rem; padding: 4px 20px 4px 8px;}
            /* Completion Section */
            .completion-section .icon { font-size: 3.5rem; }
            .completion-section h2 { font-size: 1.8rem; }
            .completion-section p { font-size: 1rem; }
            .completion-section .action-button { width: 90%; max-width: 300px; }
        }

    </style>
</head>
<body>

    <!-- ========= Minimal Nav Handle ========= -->
    <button id="minimal-nav-toggle" class="minimal-nav-button" aria-label="Toggle Navigation Menu">
        <i class="fas fa-bars"></i>
    </button>

    <!-- ========= Minimal Nav Panel (with Language Switcher) ========= -->
    <nav id="minimal-nav-panel" class="minimal-nav">
        <ul>
            <!-- Links to OTHER main pages (Module 28) -->
            <li><a href="ctp-practice-28.html"><i class="fas fa-pencil-alt fa-fw"></i> <span data-translate="nav_practice">Practice</span></a></li>
            <li><a href="ctp-advanced-28.html"><i class="fas fa-flask fa-fw"></i> <span data-translate="nav_advanced">Advanced Practice</span></a></li>
            <li><a href="ctp-dashboard.html"><i class="fas fa-list fa-fw"></i> <span data-translate="nav_menu">Course Menu</span></a></li>
             <hr style="border: none; border-top: 1px solid var(--secondary-color); margin: 8px 0;">
             <!-- Links to sections on THIS page -->
             <li><a href="#welcome"><i class="fas fa-door-open fa-fw"></i> <span data-translate="nav_welcome">Welcome</span></a></li>
             <li><a href="#what-is-sorting"><i class="fas fa-random fa-fw"></i> <span data-translate="nav_what_is_sorting">What is Sorting?</span></a></li>
             <li><a href="#why-learn-sorting"><i class="fas fa-lightbulb fa-fw"></i> <span data-translate="nav_why_learn">Why Learn?</span></a></li>
             <li><a href="#visualizing-sorting"><i class="fas fa-eye fa-fw"></i> <span data-translate="nav_visualize">Visualize</span></a></li>
             <li><a href="#knowledge-check"><i class="fas fa-check-double fa-fw"></i> <span data-translate="nav_quiz">Knowledge Check</span></a></li>
            <!-- Language Switcher Item -->
            <li class="language-switcher-item">
                 <select id="languageSelect" aria-label="Select Language">
                     <option value="en" data-translate="lang_en">🇬🇧 English</option>
                     <option value="pt" data-translate="lang_pt">🇧🇷 Português</option>
                     <option value="zh" data-translate="lang_zh">🇨🇳 中文</option>
                 </select>
            </li>
        </ul>
    </nav>

    <header class="main-header">
        <!-- Decorative shapes -->
        <div class="header-shape shape1"></div>
        <div class="header-shape shape2"></div>
        <div class="header-shape shape3"></div>

        <div class="container">
            <h1 data-translate="header_title">Module 28: Sorting Algorithms</h1>
            <p data-translate="header_subtitle">Learning how computers efficiently organize data.</p>
        </div>
    </header>

    <main>
        <!-- ========= Welcome Section ========= -->
        <section id="welcome">
            <div class="container">
                <h2 class="fade-in" data-translate="welcome_title">🚀 Organizing the Chaos</h2>
                <p class="fade-in delay-1" data-translate="welcome_p1">
                    Computers deal with vast amounts of data. To make sense of it, we often need to <span class="highlight">sort</span> it – arrange it in a specific order (like numbers smallest to largest, or names alphabetically).
                </p>
                <p class="fade-in delay-2" data-translate="welcome_p2">
                    In this module, we'll explore fundamental <span class="highlight">sorting algorithms</span> like <code>Bubble Sort</code> and <code>Selection Sort</code>. Understanding how they work is key to designing efficient solutions.
                </p>
            </div>
        </section>

        <!-- ========= What is Sorting Section ========= -->
        <section id="what-is-sorting">
            <div class="container">
                <h2 class="fade-in" data-translate="what_is_sorting_title">❓ What Does Sorting Mean?</h2>
                <p class="text-center fade-in delay-1" data-translate="what_is_sorting_subtitle">It's like tidying up a messy bookshelf!</p>

                <div class="sorting-analogy fade-in delay-2">
                     <!-- We'll use JS to add 'visible' class on scroll -->
                    <div class="analogy-part">
                        <span class="analogy-icon">📚</span>
                        <h3 data-translate="analogy_unsorted_title">Unsorted Data</h3>
                        <p data-translate="analogy_unsorted_text">Items are mixed up, hard to find (e.g., random numbers).</p>
                    </div>
                    <div class="analogy-arrow">➡️</div>
                    <div class="analogy-part">
                        <span class="analogy-icon">⚙️</span>
                        <h3 data-translate="analogy_algorithm_title">Sorting Algorithm</h3>
                        <p data-translate="analogy_algorithm_text">A step-by-step process (the recipe) to arrange the items.</p>
                    </div>
                     <div class="analogy-arrow">➡️</div>
                    <div class="analogy-part">
                        <span class="analogy-icon">📊</span>
                        <h3 data-translate="analogy_sorted_title">Sorted Data</h3>
                        <p data-translate="analogy_sorted_text">Items are in order, easy to search and use.</p>
                    </div>
                </div>

                 <p class="text-center fade-in delay-3" style="margin-top: 2rem;" data-translate="what_is_sorting_conclusion">Sorting algorithms provide the method to transform disorder into order.</p>

            </div>
        </section>

        <!-- ========= Why Learn Sorting Section ========= -->
        <section id="why-learn-sorting">
            <div class="container">
                <h2 class="fade-in" data-translate="why_learn_title">💡 Why Learn Sorting?</h2>
                <p class="text-center fade-in delay-1" data-translate="why_learn_subtitle">Understanding sorting is more than just arranging lists:</p>

                <div class="features">
                    <!-- Card 1: Foundational -->
                    <div class="feature-card" id="card-foundation">
                        <span class="feature-icon">🧱</span>
                        <h3 data-translate="feature_foundation_title">Fundamental Concept</h3>
                        <div class="feature-details">
                            <p data-translate="feature_foundation_text">Sorting is a core problem in computer science. Learning basic algorithms builds a strong foundation for tackling more complex problems.</p>
                        </div>
                    </div>

                    <!-- Card 2: Efficiency -->
                    <div class="feature-card" id="card-efficiency">
                        <span class="feature-icon">⏱️</span>
                        <h3 data-translate="feature_efficiency_title">Understanding Efficiency</h3>
                        <div class="feature-details">
                            <p data-translate="feature_efficiency_text">Different algorithms have different speeds (efficiency). Comparing simple sorts helps you appreciate why more advanced algorithms exist.</p>
                        </div>
                    </div>

                    <!-- Card 3: Building Block -->
                    <div class="feature-card" id="card-buildingblock">
                        <span class="feature-icon">🧩</span>
                        <h3 data-translate="feature_buildingblock_title">Basis for Other Tasks</h3>
                        <div class="feature-details">
                            <p data-translate="feature_buildingblock_text">Many other tasks, like searching for data quickly, often rely on the data being sorted first. Knowing how to sort is essential.</p>
                        </div>
                    </div>
                </div>
                 <p class="text-center fade-in delay-4" style="margin-top: 2rem;" data-translate="feature_cta">Click on the cards above to reveal more!</p>
            </div>
        </section>


        <!-- ========= Sorting Visualization Section ========= -->
        <section id="visualizing-sorting">
             <div class="container">
                 <h2 class="fade-in" data-translate="visualize_title">👀 Visualizing Simple Sorts</h2>
                 <p class="text-center fade-in delay-1" data-translate="visualize_subtitle">Let's see <code>Bubble Sort</code> and <code>Selection Sort</code> in action. Use the controls!</p>

                 <div class="sort-container fade-in delay-2">
                    <div class="sort-visualization">
                        <!-- Bubble Sort -->
                        <div class="sort-algorithm">
                             <h3 data-translate="bubble_sort_title">Bubble Sort</h3>
                             <div class="bars-container" id="bubble-sort-bars">
                                 <!-- Bars generated by JS -->
                             </div>
                             <div class="sort-description" id="bubble-sort-desc" data-translate="sort_initial_desc">Initial state. Click 'Step' or 'Reset'.</div>
                             <div class="sort-controls">
                                 <button class="action-button info" id="bubble-step-btn"><i class="fas fa-step-forward"></i> <span data-translate="step_btn">Step</span></button>
                                 <button class="action-button secondary" id="bubble-reset-btn"><i class="fas fa-undo"></i> <span data-translate="reset_btn">Reset</span></button>
                             </div>
                        </div>

                        <!-- Selection Sort -->
                        <div class="sort-algorithm">
                             <h3 data-translate="selection_sort_title">Selection Sort</h3>
                             <div class="bars-container" id="selection-sort-bars">
                                 <!-- Bars generated by JS -->
                             </div>
                             <div class="sort-description" id="selection-sort-desc" data-translate="sort_initial_desc">Initial state. Click 'Step' or 'Reset'.</div>
                             <div class="sort-controls">
                                 <button class="action-button info" id="selection-step-btn"><i class="fas fa-step-forward"></i> <span data-translate="step_btn">Step</span></button>
                                 <button class="action-button secondary" id="selection-reset-btn"><i class="fas fa-undo"></i> <span data-translate="reset_btn">Reset</span></button>
                             </div>
                        </div>
                    </div>
                 </div>
             </div>
        </section>

        <!-- ========= Knowledge Check Section ========= -->
        <section id="knowledge-check">
            <div class="container">
                <h2 class="fade-in" data-translate="quiz_title">🧠 Quick Check!</h2>
                <div class="quiz-container fade-in delay-1">
                    <div id="quiz-area">
                        <!-- Quiz questions will be loaded here by JavaScript -->
                    </div>
                    <div id="quiz-feedback" class="quiz-feedback">
                        <!-- Feedback (Correct/Incorrect) shown here -->
                    </div>
                    <button id="next-question-btn" data-translate="quiz_next_button">Next Question</button>
                </div>
            </div>
        </section>

        <!-- ========= Completion Section ========= -->
        <section class="completion-section">
            <div class="container">
                 <div class="icon"> <!-- Animation applied via CSS -->
                    <i class="fas fa-sort-amount-up"></i>
                    <i class="fas fa-brain"></i>
                    <i class="fas fa-star"></i>
                </div>
                <h2 class="fade-in delay-1" data-translate="completion_theory_title">Module 28 Theory Complete!</h2>
                <p class="fade-in delay-2" data-translate="completion_theory_desc">
                    You've explored the basics of sorting and seen simple algorithms at work! Ready to implement them yourself? <br>
                    Head to the <strong>Practice Zone</strong> or challenge yourself with the <strong>Advanced Practice</strong>.
                </p>
                <div class="button-group">
                    <!-- Button Order: Menu (Left, Grey), Practice (Center, Green), Advanced (Right, Grey) -->
                    <a href="ctp-dashboard.html" class="action-button secondary fade-in delay-3"><i class="fas fa-list"></i> <span data-translate="nav_menu">Course Menu</span></a>
                    <a href="ctp-practice-28.html" class="action-button success fade-in delay-4"><i class="fas fa-pencil-alt"></i> <span data-translate="nav_practice">Start Practice</span></a>
                    <a href="ctp-advanced-28.html" class="action-button secondary fade-in delay-5"><i class="fas fa-flask"></i> <span data-translate="nav_advanced">Advanced Practice</span></a>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer Removed as requested -->

    <script>
    // --- Translations Object ---
    const translations = {
        en: {
            "page_title": "Module 28: Algorithms - Sorting",
            "nav_practice": "Start Practice", "nav_advanced": "Advanced Practice", "nav_menu": "Course Menu",
            "nav_welcome": "Welcome", "nav_what_is_sorting": "What is Sorting?", "nav_why_learn": "Why Learn?", "nav_visualize": "Visualize", "nav_quiz": "Knowledge Check",
            "lang_en": "🇬🇧 English", "lang_pt": "🇧🇷 Português", "lang_zh": "🇨🇳 中文",
            "header_title": "Module 28: Sorting Algorithms", "header_subtitle": "Learning how computers efficiently organize data.",
            "welcome_title": "🚀 Organizing the Chaos",
            "welcome_p1": "Computers deal with vast amounts of data. To make sense of it, we often need to <span class=\"highlight\">sort</span> it – arrange it in a specific order (like numbers smallest to largest, or names alphabetically).",
            "welcome_p2": "In this module, we'll explore fundamental <span class=\"highlight\">sorting algorithms</span> like <code>Bubble Sort</code> and <code>Selection Sort</code>. Understanding how they work is key to designing efficient solutions.",
            "what_is_sorting_title": "❓ What Does Sorting Mean?", "what_is_sorting_subtitle": "It's like tidying up a messy bookshelf!",
            "analogy_unsorted_title": "Unsorted Data", "analogy_unsorted_text": "Items are mixed up, hard to find (e.g., random numbers).",
            "analogy_algorithm_title": "Sorting Algorithm", "analogy_algorithm_text": "A step-by-step process (the recipe) to arrange the items.",
            "analogy_sorted_title": "Sorted Data", "analogy_sorted_text": "Items are in order, easy to search and use.",
            "what_is_sorting_conclusion": "Sorting algorithms provide the method to transform disorder into order.",
            "why_learn_title": "💡 Why Learn Sorting?", "why_learn_subtitle": "Understanding sorting is more than just arranging lists:",
            "feature_foundation_title": "Fundamental Concept", "feature_foundation_text": "Sorting is a core problem in computer science. Learning basic algorithms builds a strong foundation for tackling more complex problems.",
            "feature_efficiency_title": "Understanding Efficiency", "feature_efficiency_text": "Different algorithms have different speeds (efficiency). Comparing simple sorts helps you appreciate why more advanced algorithms exist.",
            "feature_buildingblock_title": "Basis for Other Tasks", "feature_buildingblock_text": "Many other tasks, like searching for data quickly, often rely on the data being sorted first. Knowing how to sort is essential.",
            "feature_cta": "Click on the cards above to reveal more!",
            "visualize_title": "👀 Visualizing Simple Sorts", "visualize_subtitle": "Let's see <code>Bubble Sort</code> and <code>Selection Sort</code> in action. Use the controls!",
            "bubble_sort_title": "Bubble Sort", "selection_sort_title": "Selection Sort",
            "sort_initial_desc": "Initial state. Click 'Step' or 'Reset'.",
            "step_btn": "Step", "reset_btn": "Reset",
            "bubble_desc_compare": "Comparing {val1} and {val2}.",
            "bubble_desc_swap": "Swapping {val1} and {val2} because {val1} > {val2}.",
            "bubble_desc_noswap": "No swap needed ({val1} <= {val2}).",
            "bubble_desc_pass_complete": "Pass {passNum} complete. Largest element bubbled up.",
            "bubble_desc_sorted": "Array is sorted!",
            "selection_desc_find_min": "Finding minimum in unsorted part (index {startIdx} onwards).",
            "selection_desc_comparing": "Comparing current min {minVal} with {currentVal}.",
            "selection_desc_new_min": "Found new minimum: {newMinVal} at index {newMinIdx}.",
            "selection_desc_swap": "Swapping minimum {minVal} (at index {minIdx}) with element at index {swapIdx}.",
            "selection_desc_pass_complete": "Pass {passNum} complete. Smallest unsorted element moved to position {posIdx}.",
            "selection_desc_sorted": "Array is sorted!",
            "quiz_title": "🧠 Quick Check!", "quiz_next_button": "Next Question",
            "quiz_q1": "What is the main goal of a sorting algorithm?",
            "quiz_q1_opt1": "To make data look random.", "quiz_q1_opt2": "To arrange data in a specific order.", "quiz_q1_opt3": "To count the number of items.", "quiz_q1_opt4": "To delete duplicate items.",
            "quiz_q2": "Which of these describes how Bubble Sort generally works?",
            "quiz_q2_opt1": "Finds the smallest item and puts it first.", "quiz_q2_opt2": "Repeatedly compares adjacent items and swaps them if they are in the wrong order.", "quiz_q2_opt3": "Divides the list into two halves and sorts them.", "quiz_q2_opt4": "Picks a random item and places it correctly.",
            "quiz_q3": "How does Selection Sort typically place elements in their final sorted position?",
            "quiz_q3_opt1": "By swapping adjacent elements continuously.", "quiz_q3_opt2": "By finding the smallest (or largest) unsorted element and swapping it into its correct place.", "quiz_q3_opt3": "By merging already sorted sublists.", "quiz_q3_opt4": "By guessing the correct position.",
            "quiz_q4": "Comparing Bubble Sort and Selection Sort on most random lists, which statement is generally true about their *efficiency* (speed)?",
            "quiz_q4_opt1": "Bubble Sort is always much faster.", "quiz_q4_opt2": "Selection Sort is always much faster.", "quiz_q4_opt3": "They are both very fast, optimal algorithms.", "quiz_q4_opt4": "They are both relatively slow compared to more advanced algorithms.",
            "quiz_feedback_correct": "Correct! 🎉", "quiz_feedback_incorrect": "Not quite! The correct answer was: {correctAnswerText}",
            "quiz_final_score_title": "Module 28 Complete!", "quiz_final_score_summary": "You answered {score} out of {total} questions correctly.",
            "quiz_final_score_perfect": "Excellent work! You've grasped the basics of simple sorting.", "quiz_final_score_good": "Great start! Keep practicing, and you'll master these concepts.",
            "completion_theory_title": "Module 28 Theory Complete!",
            "completion_theory_desc": "You've explored the basics of sorting and seen simple algorithms at work! Ready to implement them yourself? <br> Head to the <strong>Practice Zone</strong> or challenge yourself with the <strong>Advanced Practice</strong>."
        },
        pt: {
            "page_title": "Módulo 28: Algoritmos - Ordenação",
            "nav_practice": "Iniciar Prática", "nav_advanced": "Prática Avançada", "nav_menu": "Menu do Curso",
            "nav_welcome": "Boas-vindas", "nav_what_is_sorting": "O que é Ordenar?", "nav_why_learn": "Por que Aprender?", "nav_visualize": "Visualizar", "nav_quiz": "Teste Rápido",
            "lang_en": "🇬🇧 English", "lang_pt": "🇧🇷 Português", "lang_zh": "🇨🇳 中文",
            "header_title": "Módulo 28: Algoritmos de Ordenação", "header_subtitle": "Aprendendo como computadores organizam dados eficientemente.",
            "welcome_title": "🚀 Organizando o Caos",
            "welcome_p1": "Computadores lidam com grandes quantidades de dados. Para entendê-los, frequentemente precisamos <span class=\"highlight\">ordená-los</span> – organizá-los em uma ordem específica (como números do menor para o maior, ou nomes em ordem alfabética).",
            "welcome_p2": "Neste módulo, exploraremos <span class=\"highlight\">algoritmos de ordenação</span> fundamentais como <code>Bubble Sort</code> e <code>Selection Sort</code>. Entender como eles funcionam é chave para projetar soluções eficientes.",
            "what_is_sorting_title": "❓ O que Significa Ordenar?", "what_is_sorting_subtitle": "É como arrumar uma estante de livros bagunçada!",
            "analogy_unsorted_title": "Dados Desordenados", "analogy_unsorted_text": "Itens misturados, difíceis de encontrar (ex: números aleatórios).",
            "analogy_algorithm_title": "Algoritmo de Ordenação", "analogy_algorithm_text": "Um processo passo a passo (a receita) para organizar os itens.",
            "analogy_sorted_title": "Dados Ordenados", "analogy_sorted_text": "Itens em ordem, fáceis de pesquisar e usar.",
            "what_is_sorting_conclusion": "Algoritmos de ordenação fornecem o método para transformar desordem em ordem.",
            "why_learn_title": "💡 Por que Aprender Ordenação?", "why_learn_subtitle": "Entender ordenação é mais do que apenas organizar listas:",
            "feature_foundation_title": "Conceito Fundamental", "feature_foundation_text": "Ordenação é um problema central na ciência da computação. Aprender algoritmos básicos constrói uma base forte para enfrentar problemas mais complexos.",
            "feature_efficiency_title": "Entender Eficiência", "feature_efficiency_text": "Algoritmos diferentes têm velocidades (eficiência) diferentes. Comparar ordenações simples ajuda a apreciar por que algoritmos mais avançados existem.",
            "feature_buildingblock_title": "Base para Outras Tarefas", "feature_buildingblock_text": "Muitas outras tarefas, como buscar dados rapidamente, frequentemente dependem de os dados estarem ordenados primeiro. Saber ordenar é essencial.",
            "feature_cta": "Clique nos cards acima para revelar mais!",
            "visualize_title": "👀 Visualizando Ordenações Simples", "visualize_subtitle": "Vamos ver <code>Bubble Sort</code> e <code>Selection Sort</code> em ação. Use os controles!",
            "bubble_sort_title": "Bubble Sort", "selection_sort_title": "Selection Sort",
            "sort_initial_desc": "Estado inicial. Clique em 'Passo' ou 'Resetar'.",
            "step_btn": "Passo", "reset_btn": "Resetar",
            "bubble_desc_compare": "Comparando {val1} e {val2}.",
            "bubble_desc_swap": "Trocando {val1} e {val2} porque {val1} > {val2}.",
            "bubble_desc_noswap": "Troca não necessária ({val1} <= {val2}).",
            "bubble_desc_pass_complete": "Passo {passNum} completo. Maior elemento 'borbulhou' para o final.",
            "bubble_desc_sorted": "Array está ordenado!",
            "selection_desc_find_min": "Encontrando mínimo na parte não ordenada (a partir do índice {startIdx}).",
            "selection_desc_comparing": "Comparando mínimo atual {minVal} com {currentVal}.",
            "selection_desc_new_min": "Novo mínimo encontrado: {newMinVal} no índice {newMinIdx}.",
            "selection_desc_swap": "Trocando mínimo {minVal} (no índice {minIdx}) com elemento no índice {swapIdx}.",
            "selection_desc_pass_complete": "Passo {passNum} completo. Menor elemento não ordenado movido para a posição {posIdx}.",
            "selection_desc_sorted": "Array está ordenado!",
            "quiz_title": "🧠 Teste Rápido!", "quiz_next_button": "Próxima Pergunta",
            "quiz_q1": "Qual é o objetivo principal de um algoritmo de ordenação?",
            "quiz_q1_opt1": "Fazer os dados parecerem aleatórios.", "quiz_q1_opt2": "Organizar os dados em uma ordem específica.", "quiz_q1_opt3": "Contar o número de itens.", "quiz_q1_opt4": "Deletar itens duplicados.",
            "quiz_q2": "Qual destas descreve como o Bubble Sort geralmente funciona?",
            "quiz_q2_opt1": "Encontra o menor item e o coloca primeiro.", "quiz_q2_opt2": "Compara repetidamente itens adjacentes e os troca se estiverem na ordem errada.", "quiz_q2_opt3": "Divide a lista em duas metades e as ordena.", "quiz_q2_opt4": "Escolhe um item aleatório e o coloca corretamente.",
            "quiz_q3": "Como o Selection Sort tipicamente coloca os elementos em sua posição final ordenada?",
            "quiz_q3_opt1": "Trocando elementos adjacentes continuamente.", "quiz_q3_opt2": "Encontrando o menor (ou maior) elemento não ordenado e trocando-o para seu lugar correto.", "quiz_q3_opt3": "Mesclando sublistas já ordenadas.", "quiz_q3_opt4": "Adivinhando a posição correta.",
            "quiz_q4": "Comparando Bubble Sort e Selection Sort na maioria das listas aleatórias, qual afirmação é geralmente verdadeira sobre sua *eficiência* (velocidade)?",
            "quiz_q4_opt1": "Bubble Sort é sempre muito mais rápido.", "quiz_q4_opt2": "Selection Sort é sempre muito mais rápido.", "quiz_q4_opt3": "Ambos são algoritmos ótimos e muito rápidos.", "quiz_q4_opt4": "Ambos são relativamente lentos comparados a algoritmos mais avançados.",
            "quiz_feedback_correct": "Correto! 🎉", "quiz_feedback_incorrect": "Não foi bem assim! A resposta correta era: {correctAnswerText}",
            "quiz_final_score_title": "Módulo 28 Completo!", "quiz_final_score_summary": "Você respondeu {score} de {total} perguntas corretamente.",
            "quiz_final_score_perfect": "Excelente trabalho! Você compreendeu o básico de ordenação simples.", "quiz_final_score_good": "Ótimo começo! Continue praticando e você dominará esses conceitos.",
            "completion_theory_title": "Teoria do Módulo 28 Completa!",
            "completion_theory_desc": "Você explorou o básico de ordenação e viu algoritmos simples em ação! Pronto para implementá-los você mesmo? <br> Vá para a <strong>Zona de Prática</strong> ou desafie-se com a <strong>Prática Avançada</strong>."
        },
        zh: {
            "page_title": "模块 28：算法 - 排序",
            "nav_practice": "开始练习", "nav_advanced": "高级练习", "nav_menu": "课程菜单",
            "nav_welcome": "欢迎", "nav_what_is_sorting": "什么是排序?", "nav_why_learn": "为何学习?", "nav_visualize": "可视化", "nav_quiz": "知识测验",
            "lang_en": "🇬🇧 English", "lang_pt": "🇧🇷 Português", "lang_zh": "🇨🇳 中文",
            "header_title": "模块 28：排序算法", "header_subtitle": "学习计算机如何高效地组织数据。",
            "welcome_title": "🚀 整理混乱",
            "welcome_p1": "计算机处理大量数据。为了理解这些数据，我们经常需要对其进行<span class=\"highlight\">排序</span>——将其按特定顺序排列（例如数字从小到大，或名称按字母顺序）。",
            "welcome_p2": "在本模块中，我们将探讨基本的<span class=\"highlight\">排序算法</span>，如<code>冒泡排序</code> (Bubble Sort) 和<code>选择排序</code> (Selection Sort)。理解它们的工作原理是设计高效解决方案的关键。",
            "what_is_sorting_title": "❓ 排序意味着什么？", "what_is_sorting_subtitle": "就像整理一个凌乱的书架！",
            "analogy_unsorted_title": "未排序数据", "analogy_unsorted_text": "项目混乱，难以查找（例如，随机数字）。",
            "analogy_algorithm_title": "排序算法", "analogy_algorithm_text": "一个用于排列项目的分步过程（方法）。",
            "analogy_sorted_title": "已排序数据", "analogy_sorted_text": "项目有序，易于搜索和使用。",
            "what_is_sorting_conclusion": "排序算法提供了将无序转化为有序的方法。",
            "why_learn_title": "💡 为何学习排序？", "why_learn_subtitle": "理解排序不仅仅是排列列表：",
            "feature_foundation_title": "基本概念", "feature_foundation_text": "排序是计算机科学中的核心问题。学习基本算法为解决更复杂的问题奠定了坚实的基础。",
            "feature_efficiency_title": "理解效率", "feature_efficiency_text": "不同的算法有不同的速度（效率）。比较简单的排序有助于您理解为什么存在更高级的算法。",
            "feature_buildingblock_title": "其他任务的基础", "feature_buildingblock_text": "许多其他任务，例如快速搜索数据，通常依赖于首先对数据进行排序。了解如何排序至关重要。",
            "feature_cta": "点击上面的卡片以了解更多！",
            "visualize_title": "👀 可视化简单排序", "visualize_subtitle": "让我们看看<code>冒泡排序</code>和<code>选择排序</code>的实际操作。请使用控件！",
            "bubble_sort_title": "冒泡排序", "selection_sort_title": "选择排序",
            "sort_initial_desc": "初始状态。点击“步进”或“重置”。",
            "step_btn": "步进", "reset_btn": "重置",
            "bubble_desc_compare": "比较 {val1} 和 {val2}。",
            "bubble_desc_swap": "交换 {val1} 和 {val2}，因为 {val1} > {val2}。",
            "bubble_desc_noswap": "无需交换 ({val1} <= {val2})。",
            "bubble_desc_pass_complete": "第 {passNum} 轮完成。最大元素已冒泡到末尾。",
            "bubble_desc_sorted": "数组已排序！",
            "selection_desc_find_min": "在未排序部分（从索引 {startIdx} 开始）查找最小值。",
            "selection_desc_comparing": "比较当前最小值 {minVal} 和 {currentVal}。",
            "selection_desc_new_min": "找到新的最小值：{newMinVal}，位于索引 {newMinIdx}。",
            "selection_desc_swap": "将最小值 {minVal}（在索引 {minIdx}）与索引 {swapIdx} 处的元素交换。",
            "selection_desc_pass_complete": "第 {passNum} 轮完成。最小的未排序元素已移至位置 {posIdx}。",
            "selection_desc_sorted": "数组已排序！",
            "quiz_title": "🧠 快速测验！", "quiz_next_button": "下一题",
            "quiz_q1": "排序算法的主要目标是什么？",
            "quiz_q1_opt1": "使数据看起来随机。", "quiz_q1_opt2": "按特定顺序排列数据。", "quiz_q1_opt3": "计算项目数量。", "quiz_q1_opt4": "删除重复项目。",
            "quiz_q2": "以下哪项描述了冒泡排序通常如何工作？",
            "quiz_q2_opt1": "找到最小的项目并将其放在第一位。", "quiz_q2_opt2": "重复比较相邻项目，如果顺序错误则交换它们。", "quiz_q2_opt3": "将列表分成两半并对其进行排序。", "quiz_q2_opt4": "选择一个随机项目并将其正确放置。",
            "quiz_q3": "选择排序通常如何将元素放置在其最终排序位置？",
            "quiz_q3_opt1": "通过连续交换相邻元素。", "quiz_q3_opt2": "通过找到最小（或最大）的未排序元素并将其交换到正确的位置。", "quiz_q3_opt3": "通过合并已排序的子列表。", "quiz_q3_opt4": "通过猜测正确的位置。",
            "quiz_q4": "在大多数随机列表上比较冒泡排序和选择排序，关于它们的*效率*（速度），哪种说法通常是正确的？",
            "quiz_q4_opt1": "冒泡排序总是快得多。", "quiz_q4_opt2": "选择排序总是快得多。", "quiz_q4_opt3": "它们都是非常快速、最优的算法。", "quiz_q4_opt4": "与更高级的算法相比，它们都相对较慢。",
            "quiz_feedback_correct": "正确！🎉", "quiz_feedback_incorrect": "不太对哦！正确答案是：{correctAnswerText}",
            "quiz_final_score_title": "模块 28 完成！", "quiz_final_score_summary": "你答对了 {score} / {total} 题。",
            "quiz_final_score_perfect": "非常棒！你已经掌握了简单排序的基础知识。", "quiz_final_score_good": "很不错的开始！继续练习，你会掌握这些概念的。",
            "completion_theory_title": "模块 28 理论完成！",
            "completion_theory_desc": "您已经探索了排序的基础知识，并看到了简单算法的运作！准备好自己实现它们了吗？<br> 前往<strong>练习区</strong>或通过<strong>高级练习</strong>挑战自己。"
        }
    };

    // --- Sorting Visualization State & Logic ---
    let bubbleSortState = {};
    let selectionSortState = {};
    const initialArray = [65, 55, 45, 35, 75, 25, 85]; // Example Array

    function resetBubbleSortState() {
        bubbleSortState = {
            arr: [...initialArray],
            pass: 0,
            comparison: 0,
            sorted: false,
            isSwappedInPass: false,
            sortedUpTo: initialArray.length
        };
        renderBars('bubble-sort-bars', bubbleSortState.arr);
        updateDescription('bubble-sort-desc', 'sort_initial_desc');
        setButtonState('bubble-step-btn', true);
    }

    function resetSelectionSortState() {
        selectionSortState = {
            arr: [...initialArray],
            pass: 0, // Outer loop index (where the min element will be placed)
            comparison: 1, // Inner loop index for comparison
            minIndex: 0, // Index of the minimum element found so far in the unsorted part
            sorted: false
        };
        renderBars('selection-sort-bars', selectionSortState.arr);
        updateDescription('selection-sort-desc', 'sort_initial_desc');
        setButtonState('selection-step-btn', true);
    }

    function renderBars(containerId, arr, highlights = {}) {
        const container = document.getElementById(containerId);
        if (!container) return;
        container.innerHTML = '';
        const maxValue = Math.max(...arr, 1); // Avoid division by zero if array is empty/all zeros
        arr.forEach((value, index) => {
            const bar = document.createElement('div');
            bar.classList.add('sort-bar');
            bar.style.height = `${(value / maxValue) * 100}%`;
            bar.textContent = value; // Display value on the bar

            if (highlights.comparing?.includes(index)) bar.classList.add('comparing');
            if (highlights.swapping?.includes(index)) bar.classList.add('swapping');
            if (highlights.checking?.includes(index)) bar.classList.add('checking'); // For selection sort min tracking
            if (highlights.sortedIndices?.includes(index)) bar.classList.add('sorted');

            container.appendChild(bar);
        });
    }

    function updateDescription(descId, translationKey, replacements = {}) {
        const descElement = document.getElementById(descId);
        if (descElement) {
            const currentLang = getStoredLanguage();
            descElement.innerHTML = getTranslation(translationKey, currentLang, replacements);
        }
    }

    function setButtonState(buttonId, enabled) {
        const button = document.getElementById(buttonId);
        if (button) button.disabled = !enabled;
    }

    function bubbleSortStep() {
        let { arr, pass, comparison, sorted, isSwappedInPass, sortedUpTo } = bubbleSortState;
        const lang = getStoredLanguage();

        if (sorted) {
             updateDescription('bubble-sort-desc', 'bubble_desc_sorted');
             setButtonState('bubble-step-btn', false); // Disable step button when sorted
             renderBars('bubble-sort-bars', arr, { sortedIndices: arr.map((_, i) => i) });
             return;
        }

        // Highlights for the current step BEFORE potential swap
        const highlights = { comparing: [comparison, comparison + 1], sortedIndices: [] };
        for (let k = sortedUpTo; k < arr.length; k++) { highlights.sortedIndices.push(k); } // Mark already sorted elements
        renderBars('bubble-sort-bars', arr, highlights);

        let descKey = 'bubble_desc_compare';
        let descParams = { val1: arr[comparison], val2: arr[comparison + 1] };

        // Perform comparison and potential swap
        if (arr[comparison] > arr[comparison + 1]) {
            [arr[comparison], arr[comparison + 1]] = [arr[comparison + 1], arr[comparison]]; // Swap
            highlights.swapping = [comparison, comparison + 1]; // Highlight swap
            descKey = 'bubble_desc_swap';
            isSwappedInPass = true;
            // Re-render immediately after swap to show the result
            renderBars('bubble-sort-bars', arr, highlights);
        } else {
            descKey = 'bubble_desc_noswap';
        }
        updateDescription('bubble-sort-desc', descKey, descParams);


        // Move to next comparison or next pass
        comparison++;
        if (comparison >= sortedUpTo - 1) { // End of a pass
            pass++;
            if (!isSwappedInPass && pass > 0) { // Optimization: if no swaps in a pass, it's sorted
                 sorted = true;
            } else {
                 // After pass description: (Wait briefly before showing pass complete?)
                 // setTimeout(() => {
                 //     updateDescription('bubble-sort-desc', 'bubble_desc_pass_complete', { passNum: pass });
                 // }, 400); // Slight delay
                 updateDescription('bubble-sort-desc', 'bubble_desc_pass_complete', { passNum: pass });
                 comparison = 0;
                 sortedUpTo--; // The last element of the pass is now sorted
                 isSwappedInPass = false; // Reset swap flag for next pass
            }
        }

        bubbleSortState = { arr, pass, comparison, sorted, isSwappedInPass, sortedUpTo };

        if (sorted) {
            // Final update after loop finishes or early exit
            setTimeout(() => { // Delay final "sorted" message slightly
                updateDescription('bubble-sort-desc', 'bubble_desc_sorted');
                renderBars('bubble-sort-bars', arr, { sortedIndices: arr.map((_, i) => i) });
                setButtonState('bubble-step-btn', false);
            }, 500);
        }
    }


    function selectionSortStep() {
        let { arr, pass, comparison, minIndex, sorted } = selectionSortState;
        const lang = getStoredLanguage();

        if (sorted || pass >= arr.length - 1) {
            updateDescription('selection-sort-desc', 'selection_desc_sorted');
            renderBars('selection-sort-bars', arr, { sortedIndices: arr.map((_, i) => i) });
            setButtonState('selection-step-btn', false);
            selectionSortState.sorted = true; // Ensure state reflects sorted
            return;
        }

        const highlights = { sortedIndices: [] };
        for (let k = 0; k < pass; k++) { highlights.sortedIndices.push(k); } // Mark already sorted elements

        // Are we starting a new pass? Initialize minIndex and describe the goal.
        if (comparison === pass + 1) {
             minIndex = pass;
             updateDescription('selection-sort-desc', 'selection_desc_find_min', { startIdx: pass });
             highlights.checking = [minIndex]; // Highlight initial min guess
             highlights.comparing = [comparison]; // Highlight first comparison element
             renderBars('selection-sort-bars', arr, highlights);
        } else {
             // Continue comparing within the pass
             highlights.checking = [minIndex]; // Highlight current minimum
             highlights.comparing = [comparison]; // Highlight element being compared
             updateDescription('selection-sort-desc', 'selection_desc_comparing', { minVal: arr[minIndex], currentVal: arr[comparison] });
             renderBars('selection-sort-bars', arr, highlights); // Show comparison

             if (arr[comparison] < arr[minIndex]) {
                 minIndex = comparison;
                 // Update description after finding a new minimum
                 setTimeout(() => { // Slight delay for effect
                     updateDescription('selection-sort-desc', 'selection_desc_new_min', { newMinVal: arr[minIndex], newMinIdx: minIndex });
                     highlights.checking = [minIndex]; // Update highlight to new minimum
                     renderBars('selection-sort-bars', arr, highlights);
                 }, 300);
             }
        }


        // Move to the next comparison element
        comparison++;

        // Have we reached the end of the unsorted part for this pass?
        if (comparison >= arr.length) {
             // Perform the swap if the minimum isn't already in place
            let swapDescNeeded = false;
            if (minIndex !== pass) {
                 [arr[pass], arr[minIndex]] = [arr[minIndex], arr[pass]];
                 swapDescNeeded = true;
            }

             // Update description AFTER swap (or to show pass completion)
             setTimeout(() => { // Delay swap description / pass completion
                 if (swapDescNeeded) {
                    updateDescription('selection-sort-desc', 'selection_desc_swap', { minVal: arr[pass], minIdx: minIndex, swapIdx: pass }); // Values after swap
                 } else {
                     updateDescription('selection-sort-desc', 'selection_desc_pass_complete', { passNum: pass + 1, posIdx: pass });
                 }
                 highlights.swapping = swapDescNeeded ? [pass, minIndex] : [];
                 highlights.checking = []; highlights.comparing = [];
                 highlights.sortedIndices.push(pass); // Mark the newly sorted element
                 renderBars('selection-sort-bars', arr, highlights); // Render final state of the pass

                 // Prepare for the next pass
                 pass++;
                 comparison = pass + 1; // Start comparison from the element after the new pass index
                 minIndex = pass; // Reset minIndex guess for the new pass

                 selectionSortState = { arr, pass, comparison, minIndex, sorted: (pass >= arr.length - 1) };

                 if (selectionSortState.sorted) { // Check if array became sorted AFTER this pass
                    setTimeout(() => {
                        updateDescription('selection-sort-desc', 'selection_desc_sorted');
                        renderBars('selection-sort-bars', arr, { sortedIndices: arr.map((_, i) => i) });
                        setButtonState('selection-step-btn', false);
                    }, 500);
                 }

            }, 400); // Delay after last comparison/finding min


        } else {
              // Just update state if still comparing within the pass
              selectionSortState = { arr, pass, comparison, minIndex, sorted };
        }
    }


    document.addEventListener('DOMContentLoaded', () => {

        // --- Language Management (Reused from Module 0) ---
        function getStoredLanguage() { /* ... same as Module 0 ... */
            const storedLang = localStorage.getItem('userLanguage');
            if (storedLang && translations[storedLang]) return storedLang;
            const browserLang = navigator.language || navigator.userLanguage;
            if (browserLang.startsWith('pt')) return 'pt';
            if (browserLang.startsWith('zh')) return 'zh';
            return 'en'; // Default to English
         }

        function setLanguage(lang) { /* ... mostly same as Module 0 ... */
            if (!translations[lang]) lang = 'en'; // Fallback
            localStorage.setItem('userLanguage', lang);
            document.documentElement.lang = lang;
            translatePage(lang);
            const langSelect = document.getElementById('languageSelect');
            if (langSelect) langSelect.value = lang;

             // Update quiz if language changes mid-quiz
             if(quizArea && currentQuestionIndex < quizData.length) {
                if (!quizArea.querySelector('[data-translate="quiz_final_score_title"]')) {
                    loadQuestion(); // Reload current question
                }
             }
             // Reset Sort descriptions on language change
             if (typeof bubbleSortState.arr !== 'undefined') { // Check if initialized
                 updateDescription('bubble-sort-desc', 'sort_initial_desc'); // Or get current state desc key
             }
              if (typeof selectionSortState.arr !== 'undefined') {
                 updateDescription('selection-sort-desc', 'sort_initial_desc'); // Or get current state desc key
             }
        }

        function getTranslation(key, lang, replacements = {}) { /* ... same as Module 0 ... */
            let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`; // Fallback shows key
            for (const placeholder in replacements) {
                const regex = new RegExp(`\\{${placeholder}\\}`, 'g');
                text = text.replace(regex, replacements[placeholder]);
            }
             // Simple replacement for code tags if needed within description strings
             text = text.replace(/`([^`]+)`/g, '<code>$1</code>');
            return text;
        }

        function translatePage(lang) { /* ... mostly same as Module 0 ... */
             if (!translations[lang]) lang = 'en';
             document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.getAttribute('data-translate');
                const translation = getTranslation(key, lang); // Use getTranslation to handle replacements/code tags
                 if (el.tagName === 'TITLE') { document.title = translation; }
                 else if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') { /* Skip placeholders for now */ }
                 else if (el.tagName === 'OPTION') { el.textContent = translation; }
                 else {
                     // Use innerHTML because descriptions/etc might contain <code> generated by getTranslation
                      el.innerHTML = translation;
                 }
             });
              // Translate placeholders (if any added later)
              // Translate tooltips (if any added later)
              // Translate specific elements if needed beyond data-translate
        }

        // --- Initialize Language ---
        const initialLang = getStoredLanguage();

        // --- Minimal Nav Logic (Reused from Module 0) ---
        const navToggleButton = document.getElementById('minimal-nav-toggle');
        const navPanel = document.getElementById('minimal-nav-panel');
        const body = document.body;
        if (navToggleButton && navPanel) { /* ... same event listeners as Module 0 ... */
             navToggleButton.addEventListener('click', (event) => { event.stopPropagation(); body.classList.toggle('nav-active'); navToggleButton.setAttribute('aria-expanded', body.classList.contains('nav-active')); });
             document.addEventListener('click', (event) => { if (body.classList.contains('nav-active') && !navPanel.contains(event.target) && event.target !== navToggleButton && !navToggleButton.contains(event.target)) { body.classList.remove('nav-active'); navToggleButton.setAttribute('aria-expanded', 'false'); } });
             navPanel.querySelectorAll('a').forEach(link => { link.addEventListener('click', () => { body.classList.remove('nav-active'); navToggleButton.setAttribute('aria-expanded', 'false'); }); });
             document.addEventListener('keydown', (event) => { if (event.key === 'Escape' && body.classList.contains('nav-active')) { body.classList.remove('nav-active'); navToggleButton.setAttribute('aria-expanded', 'false'); } });
             navToggleButton.setAttribute('aria-expanded', 'false');
        }

        // --- Language Switcher Setup (Reused from Module 0) ---
        const langSelect = document.getElementById('languageSelect');
        if (langSelect) { langSelect.addEventListener('change', (e) => { setLanguage(e.target.value); }); }

        // --- Intersection Observer for Animations (Reused from Module 0) ---
        const observerOptions = { root: null, rootMargin: '0px', threshold: 0.1 };
        const observerCallback = (entries, observer) => { entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('visible'); } }); };
        const observer = new IntersectionObserver(observerCallback, observerOptions);
        document.querySelectorAll('.analogy-part, .analogy-arrow').forEach(el => { observer.observe(el); });

        // --- Feature Card Interactivity (Reused from Module 0) ---
        const featureCards = document.querySelectorAll('.feature-card');
        featureCards.forEach(card => { card.addEventListener('click', () => { featureCards.forEach(otherCard => { if (otherCard !== card && otherCard.classList.contains('active')) { otherCard.classList.remove('active'); } }); card.classList.toggle('active'); }); });

        // --- Initialize Sorting Visualizations ---
        resetBubbleSortState();
        resetSelectionSortState();

        // --- Sorting Control Event Listeners ---
        document.getElementById('bubble-step-btn')?.addEventListener('click', bubbleSortStep);
        document.getElementById('bubble-reset-btn')?.addEventListener('click', resetBubbleSortState);
        document.getElementById('selection-step-btn')?.addEventListener('click', selectionSortStep);
        document.getElementById('selection-reset-btn')?.addEventListener('click', resetSelectionSortState);

        // --- Knowledge Check / Quiz (Updated for Module 28) ---
        const quizData = [
            { questionKey: "quiz_q1", optionKeys: ["quiz_q1_opt1", "quiz_q1_opt2", "quiz_q1_opt3", "quiz_q1_opt4"], correctAnswer: 1 }, // Arrange data
            { questionKey: "quiz_q2", optionKeys: ["quiz_q2_opt1", "quiz_q2_opt2", "quiz_q2_opt3", "quiz_q2_opt4"], correctAnswer: 1 }, // Compares adjacent
            { questionKey: "quiz_q3", optionKeys: ["quiz_q3_opt1", "quiz_q3_opt2", "quiz_q3_opt3", "quiz_q3_opt4"], correctAnswer: 1 }, // Finds min/max and swaps
            { questionKey: "quiz_q4", optionKeys: ["quiz_q4_opt1", "quiz_q4_opt2", "quiz_q4_opt3", "quiz_q4_opt4"], correctAnswer: 3 }  // Both relatively slow
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        const quizArea = document.getElementById('quiz-area');
        const feedbackArea = document.getElementById('quiz-feedback');
        const nextButton = document.getElementById('next-question-btn');

        function loadQuestion() { /* ... same as Module 0, uses getTranslation ... */
             const currentLang = getStoredLanguage();
             if (!quizArea || currentQuestionIndex >= quizData.length) {
                 if (quizArea && !quizArea.querySelector('[data-translate="quiz_final_score_title"]')) {
                    showFinalScore();
                 }
                 return;
             }

             const currentQuiz = quizData[currentQuestionIndex];
             const questionText = getTranslation(currentQuiz.questionKey, currentLang);
             quizArea.innerHTML = `
                 <div class="quiz-question">${currentQuestionIndex + 1}. ${questionText}</div>
                 <div class="quiz-options">
                     ${currentQuiz.optionKeys.map((optionKey, index) => `
                         <button class="quiz-option-btn" data-index="${index}">${getTranslation(optionKey, currentLang)}</button>
                     `).join('')}
                 </div>
             `;

             feedbackArea.classList.remove('visible', 'correct', 'incorrect');
             feedbackArea.textContent = '';
             nextButton.classList.remove('visible');
             nextButton.disabled = true;

             document.querySelectorAll('.quiz-option-btn').forEach(button => {
                 button.addEventListener('click', handleAnswer);
             });
        }

        function handleAnswer(event) { /* ... same as Module 0, uses getTranslation ... */
             const currentLang = getStoredLanguage();
             const selectedButton = event.target;
             const selectedIndex = parseInt(selectedButton.dataset.index);
             const correctIndex = quizData[currentQuestionIndex].correctAnswer;
             const correctOptionKey = quizData[currentQuestionIndex].optionKeys[correctIndex];
             const correctAnswerText = getTranslation(correctOptionKey, currentLang);

             document.querySelectorAll('.quiz-option-btn').forEach(btn => {
                btn.disabled = true;
                btn.classList.remove('shake');
            });

             feedbackArea.classList.add('visible');

             if (selectedIndex === correctIndex) {
                 selectedButton.classList.add('correct');
                 feedbackArea.innerHTML = getTranslation('quiz_feedback_correct', currentLang);
                 feedbackArea.classList.add('correct');
                 feedbackArea.classList.remove('incorrect');
                 score++;
                 selectedButton.classList.add('tada-anim');
             } else {
                 selectedButton.classList.add('incorrect');
                 feedbackArea.innerHTML = getTranslation('quiz_feedback_incorrect', currentLang, { correctAnswerText: `<strong>${correctAnswerText}</strong>` });
                 feedbackArea.classList.add('incorrect');
                 feedbackArea.classList.remove('correct');
                 const correctButton = document.querySelector(`.quiz-option-btn[data-index="${correctIndex}"]`);
                 if(correctButton) correctButton.classList.add('correct');
                 selectedButton.classList.add('shake');
             }

              selectedButton.addEventListener('animationend', () => {
                   selectedButton.classList.remove('tada-anim', 'shake');
              }, { once: true });

             nextButton.classList.add('visible');
             nextButton.disabled = false;
        }

        function showFinalScore() { /* ... same as Module 0, uses getTranslation ... */
            const currentLang = getStoredLanguage();
            const totalQuestions = quizData.length;
            let resultMessageKey = score === totalQuestions ? 'quiz_final_score_perfect' : 'quiz_final_score_good';

            // Determine result message based on score
            if (score === totalQuestions) {
                resultMessageKey = 'quiz_final_score_perfect';
            } else if (score >= totalQuestions * 0.6) { // Adjust threshold if needed
                resultMessageKey = 'quiz_final_score_good';
            } else {
                 resultMessageKey = 'quiz_final_score_good'; // Default to "good start" even for lower scores
            }


            quizArea.innerHTML = `
                <div class="quiz-question text-center" data-translate="quiz_final_score_title" style="font-size: 1.5rem;">${getTranslation('quiz_final_score_title', currentLang)}</div>
                <p class="text-center" style="font-size: 1.2rem; margin-bottom: 1rem;">${getTranslation('quiz_final_score_summary', currentLang, { score: score, total: totalQuestions })}</p>
                <p class="text-center" style="color: ${score === totalQuestions ? 'var(--success-color)' : 'var(--primary-color)'}; font-weight: bold;">${getTranslation(resultMessageKey, currentLang)}</p>
            `;
            feedbackArea.classList.remove('visible');
            nextButton.style.display = 'none'; // Hide next button
             // Ensure the completion section is visible if quiz was last element
             const completionSection = document.querySelector('.completion-section');
             if (completionSection) {
                 completionSection.style.opacity = 1; // Make sure it's visible
             }
             quizArea.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }


        nextButton.addEventListener('click', () => { /* ... same as Module 0 ... */
             currentQuestionIndex++;
             loadQuestion();
        });

        // --- Initial Language Application and Load ---
        setLanguage(initialLang); // Apply language FIRST
        if (quizArea) { loadQuestion(); } // Initial quiz load

        // Trigger fade-in animations for elements initially in view
         document.querySelectorAll('.fade-in').forEach(el => { /* ... same as Module 0 ... */
             const rect = el.getBoundingClientRect();
             if(rect.top < window.innerHeight && rect.bottom >= 0) {
                 // Element is initially visible, CSS animation runs automatically
             }
         });

    }); // End DOMContentLoaded
    </script>

</body>
</html>
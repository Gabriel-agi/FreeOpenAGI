<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="page_title">Knowledge Check: Module 30 - Complete Python</title>
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Base Styles & Variables (Mostly from Dashboard) --- */
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-page: #f0f2f5;
            --background-card: #ffffff;
            --text-light: #f8f9fa;
            --text-dark: #343a40;
            --text-muted: #6c757d;
            --accent-color: #ffc107;
            --success-color: #198754;
            --error-color: #dc3545;
            --check-color: #6f42c1; /* Knowledge Check specific */
            --border-color: #dee2e6;
            --border-radius: 8px;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
             /* Colors for lang switcher */
             --lang-select-border: var(--check-color);
             --lang-select-bg: rgba(255, 255, 255, 0.1);
             --lang-select-bg-hover: rgba(255, 255, 255, 0.15);
             --lang-option-bg: var(--background-card);
             --lang-option-text: var(--text-dark);
             --lang-arrow-color: var(--check-color);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.6;
            background-color: var(--background-page); color: var(--text-dark);
            display: flex; flex-direction: column; min-height: 100vh;
        }

        /* --- Quiz Header --- */
        .quiz-header {
            background: linear-gradient(135deg, var(--check-color), #5a379b); /* KC themed gradient */
            color: var(--text-light);
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap; /* Allow wrapping */
            gap: 1rem; /* Space between elements */
        }

        .return-button {
            color: var(--text-light);
            text-decoration: none;
            font-size: 0.95rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            padding: 0.4rem 0.8rem;
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 5px;
            transition: background-color var(--transition-speed), border-color var(--transition-speed);
        }
        .return-button:hover {
            background-color: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.8);
        }
        .return-button i {
            margin-right: 6px;
        }

        .quiz-header h1 {
            font-family: var(--font-title);
            font-size: 1.6rem;
            text-align: center;
            flex-grow: 1; /* Allow title to take space */
            margin: 0; /* Remove default margin */
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            min-width: 200px; /* Prevent title from becoming too small */
        }

        /* --- Language Switcher Styles (Adapted from Sidebar) --- */
         .language-switcher { min-width: 150px; /* Ensure minimum width */ }
         #languageSelect {
            width: 100%;
            background: var(--lang-select-bg);
            color: var(--text-light);
            border: 1px solid var(--lang-select-border);
            border-radius: 5px;
            padding: 8px 35px 8px 15px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            appearance: none; -webkit-appearance: none; -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23${encodeURIComponent(getComputedStyle(document.documentElement).getPropertyValue('--text-light').trim().substring(1))}%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 10px auto;
            transition: border-color 0.3s ease, background-color 0.3s ease;
         }
         #languageSelect:hover { background-color: var(--lang-select-bg-hover); }
         #languageSelect:focus { outline: none; border-color: var(--accent-color); box-shadow: 0 0 0 2px rgba(255, 193, 7, 0.3); }
         #languageSelect option {
              background: var(--lang-option-bg);
              color: var(--lang-option-text);
              padding: 5px;
         }

        /* --- Main Quiz Container --- */
        .quiz-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 1.5rem;
            background-color: var(--background-card);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            flex-grow: 1; /* Take available vertical space */
        }

        .quiz-intro {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        .quiz-intro h2 {
            font-family: var(--font-title);
            color: var(--check-color);
            margin-bottom: 0.5rem;
            font-size: 1.5rem;
        }
        .quiz-intro p {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        /* --- Question Styling --- */
        #question-container { display: flex; flex-direction: column; gap: 1.5rem; }
        .question-card {
            background-color: #fdfdff; /* Slightly off-white */
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            box-shadow: 0 2px 5px rgba(0,0,0,0.04);
        }
        .question-text {
            font-weight: 500;
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: var(--text-dark);
        }
        .question-text .q-number {
             display: inline-block;
             background-color: var(--check-color);
             color: var(--text-light);
             border-radius: 50%;
             width: 24px; height: 24px;
             line-height: 24px;
             text-align: center;
             font-size: 0.85rem;
             font-weight: 700;
             margin-right: 10px;
        }

        .options-container { display: flex; flex-direction: column; gap: 0.8rem; }
        .options-container label {
            display: block;
            padding: 0.8rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            cursor: pointer;
            transition: background-color var(--transition-speed), border-color var(--transition-speed);
            font-size: 0.95rem;
        }
        .options-container label:hover { background-color: #f0eaff; border-color: var(--check-color); }
        .options-container input[type="radio"] { margin-right: 10px; accent-color: var(--check-color); }
        /* Styling for selected answer (optional, can be added via JS) */
        .options-container input[type="radio"]:checked + span { font-weight: 500; }

        /* --- Buttons --- */
        #submit-button, #retry-button {
            display: block;
            width: 100%;
            max-width: 250px; /* Limit button width */
            margin: 2rem auto 0 auto;
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            font-weight: 500;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color var(--transition-speed), transform var(--transition-speed);
            text-align: center;
        }
        #submit-button { background-color: var(--check-color); color: var(--text-light); }
        #submit-button:hover { background-color: #5a379b; transform: translateY(-2px); }
        #retry-button { background-color: var(--secondary-color); color: var(--text-light); margin-top: 1rem; }
        #retry-button:hover { background-color: #5a6268; transform: translateY(-2px); }

        /* --- Results Area --- */
        #results-container {
            margin-top: 2rem;
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            background-color: #f8f9fa;
            text-align: center;
        }
        #results-container h2 {
            font-family: var(--font-title);
            color: var(--check-color);
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }
        #score-display { font-size: 1.2rem; font-weight: 700; margin-bottom: 0.5rem; }
        #feedback-message { font-size: 1rem; font-weight: 500; padding: 0.8rem; border-radius: 5px; margin-top: 1rem; }
        #feedback-message.success { background-color: #d1e7dd; color: #0f5132; border: 1px solid #badbcc; }
        #feedback-message.failure { background-color: #f8d7da; color: #842029; border: 1px solid #f5c2c7; }
        #feedback-message i { margin-right: 8px; }

        /* --- Footer --- */
        footer {
            text-align: center;
            padding: 1.5rem;
            margin-top: auto; /* Push footer to bottom */
            background-color: var(--background-card);
            border-top: 1px solid var(--border-color);
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* --- Responsive Design --- */
        @media (max-width: 768px) {
            html { font-size: 15px; }
            .quiz-header { padding: 1rem; flex-direction: column; text-align: center; }
            .quiz-header h1 { font-size: 1.4rem; order: 1; width: 100%; margin-bottom: 0.5rem; }
            .return-button { order: 0; margin-bottom: 0.5rem; }
            .language-switcher { order: 2; width: 100%; max-width: 250px; margin: 0 auto; }
            .quiz-container { margin: 1rem; padding: 1rem; }
            .question-card { padding: 1rem; }
            .options-container label { padding: 0.7rem 0.9rem; }
        }
        @media (max-width: 576px) {
            html { font-size: 14px; }
            .quiz-header h1 { font-size: 1.3rem; }
            .question-text { font-size: 1rem; }
            .options-container label { font-size: 0.9rem; }
             #submit-button, #retry-button { max-width: none; } /* Full width on small screens */
        }

    </style>
</head>
<body>

    <header class="quiz-header">
        <a href="ctp-dashboard.html" class="return-button" data-translate="return_button">
            <i class="fas fa-arrow-left"></i> <span data-translate="return_button_text">Return to Dashboard</span>
        </a>
        <h1 data-translate="quiz_page_title_header">Module 30: Recursion Check</h1>
         <div class="language-switcher">
            <select id="languageSelect" data-translate-aria-label="lang_select_aria" aria-label="Select Language">
                <option value="en" data-translate="lang_en">üá¨üáß English</option>
                <option value="pt" data-translate="lang_pt">üáßüá∑ Portugu√™s</option>
                <option value="zh" data-translate="lang_zh">üá®üá≥ ‰∏≠Êñá</option>
            </select>
        </div>
    </header>

    <main class="quiz-container">
        <div class="quiz-intro">
            <h2 data-translate="quiz_intro_title">Knowledge Check</h2>
            <p data-translate="quiz_intro_instructions">Test your understanding of Recursion. Select the best answer for each question. You need at least 6 correct answers to pass.</p>
        </div>

        <form id="quiz-form">
            <div id="question-container">
                <!-- Questions will be loaded here by JavaScript -->
            </div>
            <button type="submit" id="submit-button" data-translate="submit_button">Submit Answers</button>
        </form>

        <div id="results-container" style="display: none;">
            <h2 data-translate="results_title">Results</h2>
            <p id="score-display"></p> <!-- e.g., "Your Score: 8 / 10" -->
            <div id="feedback-message"></div> <!-- Success or failure message -->
            <button id="retry-button" data-translate="retry_button">Retry Quiz</button>
        </div>
    </main>

    <footer data-translate="footer_text">
        Part of the Road to Free Open AGI Project
    </footer>

    <script>
        const MODULE_ID = 30;
        const PASSING_SCORE = 6;
        const KNOWLEDGE_CHECK_STORAGE_KEY = 'knowledgeCheckStatus_v1'; // Same key as dashboard
        const LANGUAGE_STORAGE_KEY = 'userLanguage'; // Same key as dashboard

        // --- Quiz Data for Module 30 ---
        const quizData = {
            [MODULE_ID]: [
                {
                    question_key: "q1_text",
                    options: [
                        { value: "A", key: "q1_optA" }, // A loop repeating itself
                        { value: "B", key: "q1_optB" }, // A function calling another function
                        { value: "C", key: "q1_optC" }, // A function calling itself
                        { value: "D", key: "q1_optD" }  // A data structure storing previous results
                    ],
                    correctAnswer: "C"
                },
                {
                    question_key: "q2_text",
                    options: [
                        { value: "A", key: "q2_optA" }, // The recursive step
                        { value: "B", key: "q2_optB" }, // The base case
                        { value: "C", key: "q2_optC" }, // The input parameter
                        { value: "D", key: "q2_optD" }  // The return value
                    ],
                    correctAnswer: "B"
                },
                 {
                    question_key: "q3_text",
                    options: [
                        { value: "A", key: "q3_optA" }, // The program runs faster
                        { value: "B", key: "q3_optB" }, // The function might never stop calling itself
                        { value: "C", key: "q3_optC" }, // The function returns an incorrect value
                        { value: "D", key: "q3_optD" }  // The computer uses less memory
                    ],
                    correctAnswer: "B"
                },
                 {
                    question_key: "q4_text",
                    options: [
                        { value: "A", key: "q4_optA" }, // Base Case
                        { value: "B", key: "q4_optB" }, // Recursive Step
                        { value: "C", key: "q4_optC" }, // Iterative Loop
                        { value: "D", key: "q4_optD" }  // Function Call
                    ],
                    correctAnswer: "B"
                },
                 {
                    question_key: "q5_text",
                    options: [
                        { value: "A", key: "q5_optA" }, // By repeating a block of code a fixed number of times
                        { value: "B", key: "q5_optB" }, // By breaking a problem into smaller, similar subproblems
                        { value: "C", key: "q5_optC" }, // By storing results in a dictionary
                        { value: "D", key: "q5_optD" }  // By using conditional (if/else) statements only
                    ],
                    correctAnswer: "B"
                },
                 {
                    question_key: "q6_text",
                    options: [
                        { value: "A", key: "q6_optA" }, // factorial(n) = n * factorial(n-1)
                        { value: "B", key: "q6_optB" }, // factorial(0) = 1
                        { value: "C", key: "q6_optC" }, // factorial(n) = n + factorial(n-1)
                        { value: "D", key: "q6_optD" }  // factorial(1) = 0
                    ],
                    correctAnswer: "B"
                },
                 {
                    question_key: "q7_text",
                    options: [
                        { value: "A", key: "q7_optA" }, // It always uses less memory
                        { value: "B", key: "q7_optB" }, // It can lead to stack overflow errors for deep recursion
                        { value: "C", key: "q7_optC" }, // It is always easier to read than iteration
                        { value: "D", key: "q7_optD" }  // It cannot be used for problems solvable by loops
                    ],
                    correctAnswer: "B"
                },
                 {
                    question_key: "q8_text",
                    options: [
                        { value: "A", key: "q8_optA" }, // A List
                        { value: "B", key: "q8_optB" }, // A Dictionary
                        { value: "C", key: "q8_optC" }, // The Call Stack
                        { value: "D", key: "q8_optD" }  // A Tuple
                    ],
                    correctAnswer: "C"
                },
                 {
                    question_key: "q9_text",
                    options: [
                        { value: "A", key: "q9_optA" }, // Yes, always
                        { value: "B", key: "q9_optB" }, // No, never
                        { value: "C", key: "q9_optC" }, // Yes, they can often solve the same problems, just differently
                        { value: "D", key: "q9_optD" }  // Only if the problem involves numbers
                    ],
                    correctAnswer: "C"
                },
                 {
                    question_key: "q10_text",
                    options: [
                        { value: "A", key: "q10_optA" }, // Defining a class with methods
                        { value: "B", key: "q10_optB" }, // Calculating the sum of numbers in a list using a `for` loop
                        { value: "C", key: "q10_optC" }, // Calculating Fibonacci numbers where fib(n) = fib(n-1) + fib(n-2)
                        { value: "D", key: "q10_optD" }  // Reading data line by line from a file
                    ],
                    correctAnswer: "C"
                }
            ]
        };

        // --- Translations Object ---
        const translations = {
             en: {
                 "page_title": "Knowledge Check: Module 30 - Complete Python",
                 "quiz_page_title_header": "Module 30: Recursion Check",
                 "return_button": "<i class=\"fas fa-arrow-left\"></i> Return to Dashboard",
                 "return_button_text": "Return to Dashboard",
                 "quiz_intro_title": "Knowledge Check",
                 "quiz_intro_instructions": "Test your understanding of Recursion. Select the best answer for each question. You need at least 6 correct answers to pass.",
                 "submit_button": "Submit Answers",
                 "results_title": "Results",
                 "retry_button": "Retry Quiz",
                 "score_display_text": "Your Score: {score} / {total}",
                 "feedback_pass": "<i class=\"fas fa-check-circle\"></i> Congratulations! You passed the knowledge check for this module.",
                 "feedback_fail": "<i class=\"fas fa-times-circle\"></i> You need {passingScore} correct answers to pass. Please review the material and try again!",
                 "lang_select_aria": "Select Language",
                 "lang_en": "üá¨üáß English",
                 "lang_pt": "üáßüá∑ Portugu√™s",
                 "lang_zh": "üá®üá≥ ‰∏≠Êñá",
                 "footer_text": "Part of the Road to Free Open AGI Project",
                 // Questions M30
                 "q1_text": "What is the fundamental concept of recursion in programming?",
                 "q1_optA": "A loop that repeats itself a specific number of times.",
                 "q1_optB": "A function that calls a different function to perform a task.",
                 "q1_optC": "A function that calls itself within its own definition.",
                 "q1_optD": "A data structure that stores results of previous computations.",
                 "q2_text": "What is the essential component of a recursive function that prevents infinite loops?",
                 "q2_optA": "The recursive step where the function calls itself.",
                 "q2_optB": "The base case that defines a condition to stop recursion.",
                 "q2_optC": "The input parameter passed to the function.",
                 "q2_optD": "The value returned by the function.",
                 "q3_text": "What is a common problem if a recursive function lacks a proper base case or never reaches it?",
                 "q3_optA": "The program usually runs much faster.",
                 "q3_optB": "It leads to infinite recursion and likely a stack overflow error.",
                 "q3_optC": "The function always returns the wrong value.",
                 "q3_optD": "The computer uses significantly less memory.",
                 "q4_text": "In a recursive function definition, what is the part called where the function calls itself with a modified argument?",
                 "q4_optA": "Base Case",
                 "q4_optB": "Recursive Step",
                 "q4_optC": "Iterative Loop",
                 "q4_optD": "Function Call",
                 "q5_text": "How does recursion typically solve complex problems?",
                 "q5_optA": "By repeating a block of code exactly 10 times.",
                 "q5_optB": "By breaking the problem down into smaller, self-similar subproblems until a base case is reached.",
                 "q5_optC": "By storing all possible answers in a large dictionary.",
                 "q5_optD": "By exclusively using if/else statements to choose a path.",
                 "q6_text": "Consider the mathematical definition of factorial (n!). Which part represents the base case for a recursive implementation?",
                 "q6_optA": "factorial(n) = n * factorial(n-1)",
                 "q6_optB": "factorial(0) = 1",
                 "q6_optC": "factorial(n) = n + factorial(n-1)",
                 "q6_optD": "factorial(1) = 0",
                 "q7_text": "What is a potential disadvantage of using recursion compared to iteration (loops)?",
                 "q7_optA": "Recursive functions always use less memory.",
                 "q7_optB": "Each function call adds to the call stack, potentially causing a stack overflow for very deep recursion.",
                 "q7_optC": "Recursive solutions are always easier to understand and debug.",
                 "q7_optD": "Recursion cannot solve problems that involve repeating tasks.",
                 "q8_text": "What underlying data structure implicitly manages the function calls and local variables during recursion?",
                 "q8_optA": "A List",
                 "q8_optB": "A Dictionary",
                 "q8_optC": "The Call Stack",
                 "q8_optD": "A Tuple",
                 "q9_text": "Can problems solved using recursion also be solved using iteration (loops)?",
                 "q9_optA": "Yes, recursion is always the only way.",
                 "q9_optB": "No, they are used for completely different types of problems.",
                 "q9_optC": "Yes, often a recursive solution can be translated into an iterative one, and vice versa.",
                 "q9_optD": "Only if the problem involves processing text strings.",
                 "q10_text": "Which of the following problems is most naturally suited for a recursive solution?",
                 "q10_optA": "Defining a 'Car' class with 'start_engine' and 'stop_engine' methods.",
                 "q10_optB": "Calculating the sum of all numbers in a list using a `for` loop.",
                 "q10_optC": "Calculating the Nth Fibonacci number, defined as fib(n) = fib(n-1) + fib(n-2) with base cases fib(0)=0, fib(1)=1.",
                 "q10_optD": "Reading customer data line by line from a text file."
             },
             pt: {
                 "page_title": "Verifica√ß√£o de Conhecimento: M√≥dulo 30 - Python Completo",
                 "quiz_page_title_header": "M√≥dulo 30: Verifica√ß√£o de Recurs√£o",
                 "return_button": "<i class=\"fas fa-arrow-left\"></i> Voltar ao Painel",
                 "return_button_text": "Voltar ao Painel",
                 "quiz_intro_title": "Verifica√ß√£o de Conhecimento",
                 "quiz_intro_instructions": "Teste seu entendimento sobre Recurs√£o. Selecione a melhor resposta para cada pergunta. Voc√™ precisa de pelo menos 6 respostas corretas para passar.",
                 "submit_button": "Enviar Respostas",
                 "results_title": "Resultados",
                 "retry_button": "Tentar Novamente",
                 "score_display_text": "Sua Pontua√ß√£o: {score} / {total}",
                 "feedback_pass": "<i class=\"fas fa-check-circle\"></i> Parab√©ns! Voc√™ passou na verifica√ß√£o de conhecimento para este m√≥dulo.",
                 "feedback_fail": "<i class=\"fas fa-times-circle\"></i> Voc√™ precisa de {passingScore} respostas corretas para passar. Por favor, revise o material e tente novamente!",
                 "lang_select_aria": "Selecionar Idioma",
                 "lang_en": "üá¨üáß English",
                 "lang_pt": "üáßüá∑ Portugu√™s",
                 "lang_zh": "üá®üá≥ ‰∏≠Êñá",
                 "footer_text": "Parte do Projeto Road to Free Open AGI",
                 // Questions M30 - PT
                 "q1_text": "Qual √© o conceito fundamental da recurs√£o em programa√ß√£o?",
                 "q1_optA": "Um loop que se repete um n√∫mero espec√≠fico de vezes.",
                 "q1_optB": "Uma fun√ß√£o que chama uma fun√ß√£o diferente para realizar uma tarefa.",
                 "q1_optC": "Uma fun√ß√£o que chama a si mesma dentro de sua pr√≥pria defini√ß√£o.",
                 "q1_optD": "Uma estrutura de dados que armazena resultados de computa√ß√µes anteriores.",
                 "q2_text": "Qual √© o componente essencial de uma fun√ß√£o recursiva que previne loops infinitos?",
                 "q2_optA": "O passo recursivo onde a fun√ß√£o chama a si mesma.",
                 "q2_optB": "O caso base que define uma condi√ß√£o para parar a recurs√£o.",
                 "q2_optC": "O par√¢metro de entrada passado para a fun√ß√£o.",
                 "q2_optD": "O valor retornado pela fun√ß√£o.",
                 "q3_text": "Qual √© um problema comum se uma fun√ß√£o recursiva n√£o tiver um caso base adequado ou nunca o alcan√ßar?",
                 "q3_optA": "O programa geralmente roda muito mais r√°pido.",
                 "q3_optB": "Leva √† recurs√£o infinita e provavelmente a um erro de estouro de pilha (stack overflow).",
                 "q3_optC": "A fun√ß√£o sempre retorna o valor errado.",
                 "q3_optD": "O computador usa significativamente menos mem√≥ria.",
                 "q4_text": "Na defini√ß√£o de uma fun√ß√£o recursiva, como se chama a parte onde a fun√ß√£o chama a si mesma com um argumento modificado?",
                 "q4_optA": "Caso Base",
                 "q4_optB": "Passo Recursivo",
                 "q4_optC": "Loop Iterativo",
                 "q4_optD": "Chamada de Fun√ß√£o",
                 "q5_text": "Como a recurs√£o tipicamente resolve problemas complexos?",
                 "q5_optA": "Repetindo um bloco de c√≥digo exatamente 10 vezes.",
                 "q5_optB": "Quebrando o problema em subproblemas menores e auto-semelhantes at√© que um caso base seja alcan√ßado.",
                 "q5_optC": "Armazenando todas as respostas poss√≠veis em um grande dicion√°rio.",
                 "q5_optD": "Usando exclusivamente declara√ß√µes if/else para escolher um caminho.",
                 "q6_text": "Considere a defini√ß√£o matem√°tica de fatorial (n!). Qual parte representa o caso base para uma implementa√ß√£o recursiva?",
                 "q6_optA": "fatorial(n) = n * fatorial(n-1)",
                 "q6_optB": "fatorial(0) = 1",
                 "q6_optC": "fatorial(n) = n + fatorial(n-1)",
                 "q6_optD": "fatorial(1) = 0",
                 "q7_text": "Qual √© uma desvantagem potencial do uso da recurs√£o em compara√ß√£o com a itera√ß√£o (loops)?",
                 "q7_optA": "Fun√ß√µes recursivas sempre usam menos mem√≥ria.",
                 "q7_optB": "Cada chamada de fun√ß√£o adiciona √† pilha de chamadas, podendo causar um estouro de pilha (stack overflow) para recurs√£o muito profunda.",
                 "q7_optC": "Solu√ß√µes recursivas s√£o sempre mais f√°ceis de entender e depurar.",
                 "q7_optD": "A recurs√£o n√£o pode resolver problemas que envolvem a repeti√ß√£o de tarefas.",
                 "q8_text": "Qual estrutura de dados subjacente gerencia implicitamente as chamadas de fun√ß√£o e vari√°veis locais durante a recurs√£o?",
                 "q8_optA": "Uma Lista (List)",
                 "q8_optB": "Um Dicion√°rio (Dictionary)",
                 "q8_optC": "A Pilha de Chamadas (Call Stack)",
                 "q8_optD": "Uma Tupla (Tuple)",
                 "q9_text": "Problemas resolvidos usando recurs√£o tamb√©m podem ser resolvidos usando itera√ß√£o (loops)?",
                 "q9_optA": "Sim, a recurs√£o √© sempre a √∫nica maneira.",
                 "q9_optB": "N√£o, eles s√£o usados para tipos de problemas completamente diferentes.",
                 "q9_optC": "Sim, frequentemente uma solu√ß√£o recursiva pode ser traduzida em uma iterativa, e vice-versa.",
                 "q9_optD": "Apenas se o problema envolver o processamento de strings de texto.",
                 "q10_text": "Qual dos seguintes problemas √© mais naturalmente adequado para uma solu√ß√£o recursiva?",
                 "q10_optA": "Definir uma classe 'Carro' com m√©todos 'ligar_motor' e 'desligar_motor'.",
                 "q10_optB": "Calcular a soma de todos os n√∫meros em uma lista usando um loop `for`.",
                 "q10_optC": "Calcular o N-√©simo n√∫mero de Fibonacci, definido como fib(n) = fib(n-1) + fib(n-2) com casos base fib(0)=0, fib(1)=1.",
                 "q10_optD": "Ler dados de clientes linha por linha de um arquivo de texto."
             },
             zh: {
                 "page_title": "Áü•ËØÜÊµãÈ™åÔºöÊ®°Âùó 30 - Python ÂÆåÂÖ®ÊåáÂçó",
                 "quiz_page_title_header": "Ê®°Âùó 30ÔºöÈÄíÂΩíÊµãÈ™å",
                 "return_button": "<i class=\"fas fa-arrow-left\"></i> ËøîÂõû‰ª™Ë°®Êùø",
                 "return_button_text": "ËøîÂõû‰ª™Ë°®Êùø",
                 "quiz_intro_title": "Áü•ËØÜÊµãÈ™å",
                 "quiz_intro_instructions": "ÊµãËØïÊÇ®ÂØπÈÄíÂΩíÁöÑÁêÜËß£„ÄÇ‰∏∫ÊØè‰∏™ÈóÆÈ¢òÈÄâÊã©ÊúÄ‰Ω≥Á≠îÊ°à„ÄÇÊÇ®ÈúÄË¶ÅÁ≠îÂØπËá≥Â∞ë 6 È¢òÊâçËÉΩÈÄöËøá„ÄÇ",
                 "submit_button": "Êèê‰∫§Á≠îÊ°à",
                 "results_title": "ÁªìÊûú",
                 "retry_button": "ÈáçËØïÊµãÈ™å",
                 "score_display_text": "ÊÇ®ÁöÑÂàÜÊï∞Ôºö{score} / {total}",
                 "feedback_pass": "<i class=\"fas fa-check-circle\"></i> ÊÅ≠ÂñúÔºÅÊÇ®ÈÄöËøá‰∫ÜÊú¨Ê®°ÂùóÁöÑÁü•ËØÜÊµãÈ™å„ÄÇ",
                 "feedback_fail": "<i class=\"fas fa-times-circle\"></i> ÊÇ®ÈúÄË¶ÅÁ≠îÂØπ {passingScore} È¢òÊâçËÉΩÈÄöËøá„ÄÇËØ∑Â§ç‰π†Áõ∏ÂÖ≥ÂÜÖÂÆπÂêéÈáçËØïÔºÅ",
                 "lang_select_aria": "ÈÄâÊã©ËØ≠Ë®Ä",
                 "lang_en": "üá¨üáß English",
                 "lang_pt": "üáßüá∑ Portugu√™s",
                 "lang_zh": "üá®üá≥ ‰∏≠Êñá",
                 "footer_text": "ÈÄöÂæÄËá™Áî±ÂºÄÊîæAGI‰πãË∑ØÈ°πÁõÆÁöÑ‰∏ÄÈÉ®ÂàÜ",
                  // Questions M30 - ZH
                 "q1_text": "ÁºñÁ®ã‰∏≠ÈÄíÂΩíÁöÑÂü∫Êú¨Ê¶ÇÂøµÊòØ‰ªÄ‰πàÔºü",
                 "q1_optA": "ÈáçÂ§çÁâπÂÆöÊ¨°Êï∞ÁöÑÂæ™ÁéØ„ÄÇ",
                 "q1_optB": "Ë∞ÉÁî®Âè¶‰∏Ä‰∏™‰∏çÂêåÂáΩÊï∞Êù•ÊâßË°å‰ªªÂä°ÁöÑÂáΩÊï∞„ÄÇ",
                 "q1_optC": "Âú®Ëá™Ë∫´ÂÆö‰πâ‰∏≠Ë∞ÉÁî®Ëá™Â∑±ÁöÑÂáΩÊï∞„ÄÇ",
                 "q1_optD": "Â≠òÂÇ®ÂÖàÂâçËÆ°ÁÆóÁªìÊûúÁöÑÊï∞ÊçÆÁªìÊûÑ„ÄÇ",
                 "q2_text": "ÈÄíÂΩíÂáΩÊï∞‰∏≠Èò≤Ê≠¢Êó†ÈôêÂæ™ÁéØÁöÑÂü∫Êú¨Ë¶ÅÁ¥†ÊòØ‰ªÄ‰πàÔºü",
                 "q2_optA": "ÂáΩÊï∞Ë∞ÉÁî®Ëá™Ë∫´ÁöÑÈÄíÂΩíÊ≠•È™§„ÄÇ",
                 "q2_optB": "ÂÆö‰πâÂÅúÊ≠¢ÈÄíÂΩíÊù°‰ª∂ÁöÑÂü∫ÂáÜÊÉÖÂÜµÔºàbase caseÔºâ„ÄÇ",
                 "q2_optC": "‰º†ÈÄíÁªôÂáΩÊï∞ÁöÑËæìÂÖ•ÂèÇÊï∞„ÄÇ",
                 "q2_optD": "ÂáΩÊï∞ËøîÂõûÁöÑÂÄº„ÄÇ",
                 "q3_text": "Â¶ÇÊûúÈÄíÂΩíÂáΩÊï∞Áº∫Â∞ëÈÄÇÂΩìÁöÑÂü∫ÂáÜÊÉÖÂÜµÊàñÊ∞∏ËøúËææ‰∏çÂà∞ÂÆÉÔºåÂ∏∏ËßÅÁöÑÈóÆÈ¢òÊòØ‰ªÄ‰πàÔºü",
                 "q3_optA": "Á®ãÂ∫èÈÄöÂ∏∏ËøêË°åÂæóÊõ¥Âø´„ÄÇ",
                 "q3_optB": "ÂØºËá¥Êó†ÈôêÈÄíÂΩíÔºåÂπ∂ÂèØËÉΩÂºïÂèëÂ†ÜÊ†àÊ∫¢Âá∫ÈîôËØØ„ÄÇ",
                 "q3_optC": "ÂáΩÊï∞ÊÄªÊòØËøîÂõûÈîôËØØÁöÑÂÄº„ÄÇ",
                 "q3_optD": "ËÆ°ÁÆóÊú∫‰ΩøÁî®ÁöÑÂÜÖÂ≠òÊòæËëóÂáèÂ∞ë„ÄÇ",
                 "q4_text": "Âú®ÈÄíÂΩíÂáΩÊï∞ÂÆö‰πâ‰∏≠ÔºåÂáΩÊï∞‰ΩøÁî®‰øÆÊîπÂêéÁöÑÂèÇÊï∞Ë∞ÉÁî®Ëá™Ë∫´ÁöÑÈÉ®ÂàÜÁß∞‰∏∫‰ªÄ‰πàÔºü",
                 "q4_optA": "Âü∫ÂáÜÊÉÖÂÜµ (Base Case)",
                 "q4_optB": "ÈÄíÂΩíÊ≠•È™§ (Recursive Step)",
                 "q4_optC": "Ëø≠‰ª£Âæ™ÁéØ (Iterative Loop)",
                 "q4_optD": "ÂáΩÊï∞Ë∞ÉÁî® (Function Call)",
                 "q5_text": "ÈÄíÂΩíÈÄöÂ∏∏Â¶Ç‰ΩïËß£ÂÜ≥Â§çÊùÇÈóÆÈ¢òÔºü",
                 "q5_optA": "ÈÄöËøáÁ≤æÁ°ÆÈáçÂ§ç‰∏Ä‰∏™‰ª£Á†ÅÂùó 10 Ê¨°„ÄÇ",
                 "q5_optB": "ÈÄöËøáÂ∞ÜÈóÆÈ¢òÂàÜËß£‰∏∫Êõ¥Â∞èÁöÑ„ÄÅËá™Áõ∏‰ººÁöÑÂ≠êÈóÆÈ¢òÔºåÁõ¥Âà∞ËææÂà∞Âü∫ÂáÜÊÉÖÂÜµ„ÄÇ",
                 "q5_optC": "ÈÄöËøáÂ∞ÜÊâÄÊúâÂèØËÉΩÁöÑÁ≠îÊ°àÂ≠òÂÇ®Âú®‰∏Ä‰∏™Â§ßÂûãÂ≠óÂÖ∏‰∏≠„ÄÇ",
                 "q5_optD": "ÈÄöËøá‰ªÖ‰ΩøÁî® if/else ËØ≠Âè•Êù•ÈÄâÊã©Ë∑ØÂæÑ„ÄÇ",
                 "q6_text": "ËÄÉËôëÈò∂‰πò (n!) ÁöÑÊï∞Â≠¶ÂÆö‰πâ„ÄÇÂì™‰∏™ÈÉ®ÂàÜ‰ª£Ë°®ÈÄíÂΩíÂÆûÁé∞ÁöÑÂü∫ÂáÜÊÉÖÂÜµÔºü",
                 "q6_optA": "factorial(n) = n * factorial(n-1)",
                 "q6_optB": "factorial(0) = 1",
                 "q6_optC": "factorial(n) = n + factorial(n-1)",
                 "q6_optD": "factorial(1) = 0",
                 "q7_text": "‰∏éËø≠‰ª£ÔºàÂæ™ÁéØÔºâÁõ∏ÊØîÔºå‰ΩøÁî®ÈÄíÂΩíÁöÑ‰∏Ä‰∏™ÊΩúÂú®Áº∫ÁÇπÊòØ‰ªÄ‰πàÔºü",
                 "q7_optA": "ÈÄíÂΩíÂáΩÊï∞ÊÄªÊòØ‰ΩøÁî®Êõ¥Â∞ëÁöÑÂÜÖÂ≠ò„ÄÇ",
                 "q7_optB": "ÊØèÊ¨°ÂáΩÊï∞Ë∞ÉÁî®ÈÉΩ‰ºöÂ¢ûÂä†Ë∞ÉÁî®Â†ÜÊ†àÁöÑË¥üÊãÖÔºåÂØπ‰∫éÈùûÂ∏∏Ê∑±ÁöÑÈÄíÂΩíÂèØËÉΩÂØºËá¥Â†ÜÊ†àÊ∫¢Âá∫„ÄÇ",
                 "q7_optC": "ÈÄíÂΩíËß£ÂÜ≥ÊñπÊ°àÊÄªÊòØÊõ¥ÂÆπÊòìÁêÜËß£ÂíåË∞ÉËØï„ÄÇ",
                 "q7_optD": "ÈÄíÂΩí‰∏çËÉΩËß£ÂÜ≥Ê∂âÂèäÈáçÂ§ç‰ªªÂä°ÁöÑÈóÆÈ¢ò„ÄÇ",
                 "q8_text": "Âú®ÈÄíÂΩíËøáÁ®ã‰∏≠ÔºåÂì™‰∏™Â∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÈöêÂºèÂú∞ÁÆ°ÁêÜÂáΩÊï∞Ë∞ÉÁî®ÂíåÂ±ÄÈÉ®ÂèòÈáèÔºü",
                 "q8_optA": "ÂàóË°® (List)",
                 "q8_optB": "Â≠óÂÖ∏ (Dictionary)",
                 "q8_optC": "Ë∞ÉÁî®Â†ÜÊ†à (Call Stack)",
                 "q8_optD": "ÂÖÉÁªÑ (Tuple)",
                 "q9_text": "‰ΩøÁî®ÈÄíÂΩíËß£ÂÜ≥ÁöÑÈóÆÈ¢òÊòØÂê¶‰πüÂèØ‰ª•‰ΩøÁî®Ëø≠‰ª£ÔºàÂæ™ÁéØÔºâÊù•Ëß£ÂÜ≥Ôºü",
                 "q9_optA": "ÊòØÁöÑÔºåÈÄíÂΩíÊÄªÊòØÂîØ‰∏ÄÁöÑÊñπÊ≥ï„ÄÇ",
                 "q9_optB": "‰∏çÔºåÂÆÉ‰ª¨Áî®‰∫éÂÆåÂÖ®‰∏çÂêåÁ±ªÂûãÁöÑÈóÆÈ¢ò„ÄÇ",
                 "q9_optC": "ÊòØÁöÑÔºåÈÄöÂ∏∏ÈÄíÂΩíËß£ÂÜ≥ÊñπÊ°àÂèØ‰ª•ËΩ¨Êç¢‰∏∫Ëø≠‰ª£Ëß£ÂÜ≥ÊñπÊ°àÔºåÂèç‰πã‰∫¶ÁÑ∂„ÄÇ",
                 "q9_optD": "‰ªÖÂΩìÈóÆÈ¢òÊ∂âÂèäÂ§ÑÁêÜÊñáÊú¨Â≠óÁ¨¶‰∏≤Êó∂„ÄÇ",
                 "q10_text": "‰ª•‰∏ãÂì™‰∏™ÈóÆÈ¢òÊúÄËá™ÁÑ∂Âú∞ÈÄÇÂêàÈÄíÂΩíËß£ÂÜ≥ÊñπÊ°àÔºü",
                 "q10_optA": "ÂÆö‰πâ‰∏Ä‰∏™Â∏¶Êúâ 'start_engine' Âíå 'stop_engine' ÊñπÊ≥ïÁöÑ 'Car' Á±ª„ÄÇ",
                 "q10_optB": "‰ΩøÁî® `for` Âæ™ÁéØËÆ°ÁÆóÂàóË°®‰∏≠ÊâÄÊúâÊï∞Â≠óÁöÑÊÄªÂíå„ÄÇ",
                 "q10_optC": "ËÆ°ÁÆóÁ¨¨ N ‰∏™ÊñêÊ≥¢ÈÇ£Â•ëÊï∞ÔºåÂÆö‰πâ‰∏∫ fib(n) = fib(n-1) + fib(n-2)ÔºåÂü∫ÂáÜÊÉÖÂÜµ‰∏∫ fib(0)=0, fib(1)=1„ÄÇ",
                 "q10_optD": "‰ªéÊñáÊú¨Êñá‰ª∂‰∏≠ÈÄêË°åËØªÂèñÂÆ¢Êà∑Êï∞ÊçÆ„ÄÇ"
             }
        };

        // --- DOM Elements ---
        const questionContainer = document.getElementById('question-container');
        const quizForm = document.getElementById('quiz-form');
        const resultsContainer = document.getElementById('results-container');
        const scoreDisplay = document.getElementById('score-display');
        const feedbackMessage = document.getElementById('feedback-message');
        const submitButton = document.getElementById('submit-button');
        const retryButton = document.getElementById('retry-button');
        const languageSelectElement = document.getElementById('languageSelect');

        // --- Translation Functions (Copied from Dashboard) ---
        function getStoredLanguage() {
            const storedLang = localStorage.getItem(LANGUAGE_STORAGE_KEY);
            if (storedLang && translations[storedLang]) return storedLang;
            const browserLang = navigator.language || navigator.userLanguage;
            if (browserLang.startsWith('pt')) return 'pt';
            if (browserLang.startsWith('zh')) return 'zh';
            return 'en';
        }

        function setLanguage(lang) {
            if (!translations[lang]) lang = 'en'; // Fallback
            localStorage.setItem(LANGUAGE_STORAGE_KEY, lang);
            document.documentElement.lang = lang;
            if (languageSelectElement) languageSelectElement.value = lang;
            translatePage(lang);
            renderQuiz(lang); // Re-render quiz with new language
            // If results are visible, re-translate them
            if (resultsContainer.style.display !== 'none') {
                 const score = parseInt(scoreDisplay.dataset.score || "0");
                 const total = parseInt(scoreDisplay.dataset.total || "0");
                 const passed = score >= PASSING_SCORE;
                 displayResults(score, total, passed); // Re-display results with translated text
            }
        }

        function getTranslation(key, lang, replacements = {}) {
             let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`;
             for (const placeholder in replacements) {
                 const regex = new RegExp(`\\{${placeholder}\\}`, 'g');
                 text = text.replace(regex, replacements[placeholder]);
             }
             return text;
         }

        function translatePage(lang) {
            if (!translations[lang]) lang = 'en';
            document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.getAttribute('data-translate');
                const translation = getTranslation(key, lang);
                if (el.tagName === 'TITLE') {
                    document.title = translation;
                } else if (translation.includes('<') && translation.includes('>')) { // Handle HTML in translations (like icons)
                    el.innerHTML = translation;
                } else {
                    el.textContent = translation;
                }
            });
             document.querySelectorAll('[data-translate-aria-label]').forEach(el => {
                 const key = el.getAttribute('data-translate-aria-label');
                 el.setAttribute('aria-label', getTranslation(key, lang));
             });
        }

        // --- LocalStorage Functions ---
        function loadKnowledgeCheckStatus() {
            try {
                const storedStatus = localStorage.getItem(KNOWLEDGE_CHECK_STORAGE_KEY);
                const parsed = storedStatus ? JSON.parse(storedStatus) : {};
                return typeof parsed === 'object' && parsed !== null ? parsed : {};
            } catch (e) {
                console.error("Error reading KC status from localStorage:", e);
                return {};
            }
        }

        function saveKnowledgeCheckStatus(moduleId, isComplete) {
            const statusObject = loadKnowledgeCheckStatus();
            statusObject[moduleId] = isComplete;
            try {
                localStorage.setItem(KNOWLEDGE_CHECK_STORAGE_KEY, JSON.stringify(statusObject));
                console.log(`KC Status saved for module ${moduleId}: ${isComplete}`);
            } catch (e) {
                console.error("Error saving KC status to localStorage:", e);
            }
        }

        // --- Quiz Logic ---
        function renderQuiz(lang) {
            questionContainer.innerHTML = ''; // Clear previous questions
            const questions = quizData[MODULE_ID];
            if (!questions) {
                questionContainer.innerHTML = `<p>${getTranslation('error_no_questions', lang)}</p>`; // Add translation for this
                return;
            }

            questions.forEach((q, index) => {
                const questionCard = document.createElement('div');
                questionCard.className = 'question-card';
                questionCard.dataset.questionIndex = index;

                const questionText = document.createElement('p');
                questionText.className = 'question-text';
                 // Add question number visually
                const qNumberSpan = document.createElement('span');
                qNumberSpan.className = 'q-number';
                qNumberSpan.textContent = index + 1;
                questionText.appendChild(qNumberSpan);
                questionText.appendChild(document.createTextNode(getTranslation(q.question_key, lang))); // Append text node


                const optionsContainer = document.createElement('div');
                optionsContainer.className = 'options-container';

                q.options.forEach(opt => {
                    const label = document.createElement('label');
                    const radio = document.createElement('input');
                    radio.type = 'radio';
                    radio.name = `q${index}`;
                    radio.value = opt.value;
                    radio.required = true; // Make selection mandatory

                    const optionText = document.createElement('span');
                    optionText.textContent = ` ${getTranslation(opt.key, lang)}`; // Add space before text

                    label.appendChild(radio);
                    label.appendChild(optionText);
                    optionsContainer.appendChild(label);
                });

                questionCard.appendChild(questionText);
                questionCard.appendChild(optionsContainer);
                questionContainer.appendChild(questionCard);
            });
             // Ensure submit button is visible if it was hidden by results
             submitButton.style.display = 'block';
        }

        function handleSubmit(event) {
            event.preventDefault();
            const questions = quizData[MODULE_ID];
            let score = 0;
            const formData = new FormData(quizForm);

            questions.forEach((q, index) => {
                const selectedAnswer = formData.get(`q${index}`);
                if (selectedAnswer === q.correctAnswer) {
                    score++;
                }
            });

            const passed = score >= PASSING_SCORE;
            displayResults(score, questions.length, passed);

            if (passed) {
                saveKnowledgeCheckStatus(MODULE_ID, true);
            }

            // Hide form, show results
            quizForm.style.display = 'none';
            resultsContainer.style.display = 'block';
            window.scrollTo({ top: resultsContainer.offsetTop - 30, behavior: 'smooth' });
        }

        function displayResults(score, total, passed) {
            const lang = getStoredLanguage();
            scoreDisplay.textContent = getTranslation('score_display_text', lang, { score: score, total: total });
            // Store score and total for potential re-translation on language change
            scoreDisplay.dataset.score = score;
            scoreDisplay.dataset.total = total;

            if (passed) {
                feedbackMessage.innerHTML = getTranslation('feedback_pass', lang);
                feedbackMessage.className = 'success';
            } else {
                feedbackMessage.innerHTML = getTranslation('feedback_fail', lang, { passingScore: PASSING_SCORE });
                feedbackMessage.className = 'failure';
            }
        }

        function handleRetry() {
            resultsContainer.style.display = 'none';
            quizForm.style.display = 'block';
            quizForm.reset(); // Clear selections
             // Optional: Re-render if needed, but reset should suffice
            // renderQuiz(getStoredLanguage());
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // Set up language switcher
            const initialLang = getStoredLanguage();
            if (languageSelectElement) {
                languageSelectElement.value = initialLang;
                languageSelectElement.addEventListener('change', (e) => {
                    setLanguage(e.target.value);
                });
            }

            // Initial Page Load
            translatePage(initialLang); // Translate static elements
            renderQuiz(initialLang);    // Render the quiz questions

            // Add Event Listeners
            quizForm.addEventListener('submit', handleSubmit);
            retryButton.addEventListener('click', handleRetry);
        });

    </script>

</body>
</html>

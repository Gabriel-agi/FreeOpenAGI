<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="page_title">Knowledge Check - Module 24</title>
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Base Styles & Variables --- */
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-page: #f0f2f5;
            --background-card: #ffffff;
            --background-sidebar: #ffffff;
            --background-header: linear-gradient(135deg, #0d6efd, #0a58ca);
            --text-light: #f8f9fa;
            --text-dark: #343a40;
            --text-muted: #6c757d;
            --accent-color: #ffc107;
            --success-color: #198754;
            --error-color: #dc3545;
            --info-color: #0dcaf0;
            --video-color: #fd7e14;
            --check-color: #6f42c1;
            --certificate-color: #d63384;
            --chat-panel-bg: #ffffff;
            --chat-box-bg: #f8f9fa;
            --chat-bot-bg: #e9ecef;
            --chat-bot-text: #343a40;
            --chat-user-bg: #d1e7ff;
            --chat-user-text: #0a58ca;
            --chat-error-bg: #f8d7da;
            --chat-error-text: #842029;
            --chat-border-color: #dee2e6;
            --progress-bg: #e9ecef;
            --progress-fill: var(--check-color);
            --border-color: #dee2e6;
            --border-radius: 8px;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            --card-shadow-hover: 0 6px 18px rgba(0, 0, 0, 0.1);
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
            --sidebar-width: 260px;
             /* Colors for lang switcher */
             --lang-select-border: var(--certificate-color);
             --lang-select-bg: rgba(255, 255, 255, 0.1);
             --lang-select-bg-hover: rgba(255, 255, 255, 0.15);
             --lang-option-bg: var(--background-card);
             --lang-option-text: var(--text-dark);
             --lang-arrow-color: var(--certificate-color);
             /* KC Specific */
             --kc-question-bg: #ffffff;
             --kc-option-hover-bg: #eef6ff;
             --kc-correct-bg: #d1e7dd;
             --kc-incorrect-bg: #f8d7da;
             --kc-correct-text: #0f5132;
             --kc-incorrect-text: #842029;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.6;
            background-color: var(--background-page); color: var(--text-dark);
            overflow-x: hidden;
        }
        body.chat-open { overflow: hidden; }

        /* --- Animations --- */
        .card-fade-in { opacity: 0; transform: translateY(20px); animation: fadeInAnimation 0.6s ease-out forwards; }
        @keyframes fadeInAnimation { to { opacity: 1; transform: translateY(0); } }

        /* --- Dashboard Header (Adapted for KC Page) --- */
        .kc-header { background: var(--background-header); color: var(--text-light); padding: 1.5rem; margin-bottom: 2rem; position: relative; display: flex; justify-content: space-between; align-items: center; }
        .kc-header-content { max-width: 1200px; margin: 0 auto; flex-grow: 1; display: flex; align-items: center; justify-content: space-between;}
        .kc-header h1 { font-family: var(--font-title); font-size: 1.8rem; margin: 0; text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2); }
        .kc-header .header-controls { display: flex; align-items: center; gap: 1rem;}
        .return-button {
            background-color: rgba(255, 255, 255, 0.15);
            color: var(--text-light);
            border: 1px solid rgba(255, 255, 255, 0.5);
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: background-color var(--transition-speed), border-color var(--transition-speed);
            display: inline-flex;
            align-items: center;
        }
        .return-button i { margin-right: 6px; }
        .return-button:hover { background-color: rgba(255, 255, 255, 0.25); border-color: rgba(255, 255, 255, 0.8); }
        /* Language Switcher Styles (Adapted for Header) */
         .language-switcher-kc { position: relative; }
         #languageSelect {
            background: var(--lang-select-bg);
            color: var(--text-light);
            border: 1px solid var(--lang-select-border);
            border-radius: 5px;
            padding: 8px 35px 8px 15px;
            cursor: pointer;
            font-size: 0.9rem; /* Slightly smaller */
            font-weight: 500;
            appearance: none; -webkit-appearance: none; -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23${encodeURIComponent(getComputedStyle(document.documentElement).getPropertyValue('--text-light').trim().substring(1))}%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 10px center; /* Adjusted */
            background-size: 8px auto; /* Adjusted */
            transition: border-color 0.3s ease, background-color 0.3s ease;
         }
         #languageSelect:hover { background-color: var(--lang-select-bg-hover); }
         #languageSelect:focus { outline: none; border-color: var(--accent-color); }
         #languageSelect option { background: var(--lang-option-bg); color: var(--lang-option-text); }

        /* --- Main Content Area --- */
        .kc-container {
            max-width: 900px; /* Wider for questions */
            margin: 0 auto;
            padding: 0 1.5rem 2rem 1.5rem; /* Added bottom padding */
            background-color: var(--background-card);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
        }
        .kc-intro {
            padding: 1.5rem 0;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        .kc-intro h2 {
            font-family: var(--font-title);
            font-size: 1.6rem;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
        }
        .kc-intro h2 i { margin-right: 10px; color: var(--check-color); }
        .kc-intro p { color: var(--text-muted); font-size: 0.95rem; margin-bottom: 0.3rem; }
        .kc-intro strong { color: var(--text-dark); }

        /* --- Knowledge Check Form Styling --- */
        #kc-form { display: flex; flex-direction: column; gap: 1.8rem; }
        .kc-question {
            background-color: var(--kc-question-bg); /* White background for contrast */
            padding: 1.5rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            transition: box-shadow var(--transition-speed);
        }
        .kc-question:focus-within { box-shadow: 0 0 0 2px var(--primary-color); } /* Highlight when interacting */
        .kc-question p {
            font-weight: 500;
            margin-bottom: 1rem;
            font-size: 1.05rem;
            line-height: 1.5;
        }
        .kc-question p strong { /* Question Number */
            color: var(--primary-color);
            margin-right: 5px;
            font-family: var(--font-title);
            display: inline-block;
        }
        .kc-question code {
            font-size: 0.9em;
            background: #eee;
            padding: 2px 5px;
            border-radius: 3px;
            color: #c7254e;
            font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
        }
        .kc-options { display: flex; flex-direction: column; gap: 0.7rem; }
        .kc-option label {
            display: block;
            padding: 0.8rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            cursor: pointer;
            transition: background-color var(--transition-speed), border-color var(--transition-speed);
            position: relative;
            padding-left: 35px; /* Space for radio */
        }
        .kc-option input[type="radio"] {
            position: absolute;
            opacity: 0;
            pointer-events: none; /* Hide default radio */
        }
        .kc-option label::before { /* Custom radio button */
            content: '';
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            width: 18px;
            height: 18px;
            border: 2px solid var(--secondary-color);
            border-radius: 50%;
            transition: border-color 0.2s;
        }
        .kc-option label::after { /* Custom radio button checkmark */
             content: '';
             position: absolute;
             left: 15px; /* Center inside */
             top: 50%;
             transform: translateY(-50%) scale(0); /* Hidden by default */
             width: 8px;
             height: 8px;
             background-color: var(--primary-color);
             border-radius: 50%;
             transition: transform 0.2s ease-out;
        }
        .kc-option input[type="radio"]:checked + label::before { border-color: var(--primary-color); }
        .kc-option input[type="radio"]:checked + label::after { transform: translateY(-50%) scale(1); }
        .kc-option label:hover { background-color: var(--kc-option-hover-bg); border-color: var(--primary-color); }
        .kc-option input[type="radio"]:focus + label { outline: 2px solid var(--accent-color); outline-offset: 2px; }

        /* --- Submit Button --- */
        #kc-submit-button {
            padding: 0.8rem 1.5rem;
            font-size: 1.1rem;
            font-weight: 500;
            font-family: var(--font-title);
            background-color: var(--check-color);
            color: var(--text-light);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color var(--transition-speed), transform var(--transition-speed);
            align-self: center; /* Center button */
            margin-top: 1rem;
            min-width: 150px;
        }
        #kc-submit-button:hover { background-color: #5a359a; transform: translateY(-2px); }
        #kc-submit-button:disabled { background-color: var(--secondary-color); cursor: not-allowed; transform: none; }

        /* --- Results Area --- */
        #kc-results {
            margin-top: 2rem;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            text-align: center;
            border: 2px solid; /* Border color set by JS */
            background-color: #f8f9fa;
            scroll-margin-top: 30px; /* For smooth scroll */
        }
        #kc-results h3 {
            font-family: var(--font-title);
            font-size: 1.4rem;
            margin-bottom: 0.8rem;
        }
        #kc-results p { font-size: 1.1rem; margin-bottom: 1rem; }
        #kc-results.pass { border-color: var(--success-color); background-color: var(--kc-correct-bg); }
        #kc-results.pass h3 { color: var(--success-color); }
        #kc-results.fail { border-color: var(--error-color); background-color: var(--kc-incorrect-bg); }
        #kc-results.fail h3 { color: var(--error-color); }
        #kc-retry-button {
            padding: 0.6rem 1.2rem;
            font-size: 1rem;
            font-weight: 500;
            background-color: var(--primary-color);
            color: var(--text-light);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color var(--transition-speed);
            margin-top: 0.5rem;
        }
        #kc-retry-button:hover { background-color: #0a58ca; }

        /* --- Footer --- */
        footer { text-align: center; padding: 1.5rem; margin-top: 3rem; background-color: var(--background-card); border-top: 1px solid var(--border-color); color: var(--text-muted); font-size: 0.9rem; }

        /* --- Floating Action Button (FAB) & Chat --- */
        /* (Keep the FAB and Chat styles exactly as in ctp-dashboard.html) */
        #chatbot-fab { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; background: linear-gradient(45deg, var(--primary-color), #0b5ed7); color: white; border: none; border-radius: 50%; font-size: 1.8rem; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2); transition: all var(--transition-speed) ease; z-index: 1010; }
        #chatbot-fab:hover { transform: scale(1.1); box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25); }
        #chatbot-fab i { transition: transform 0.3s ease; }
        body.chat-open #chatbot-fab { background: linear-gradient(45deg, var(--secondary-color), #5a6268); }
        body.chat-open #chatbot-fab i { transform: rotate(135deg); }
        #chat-panel-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.3); backdrop-filter: blur(2px); opacity: 0; visibility: hidden; transition: opacity var(--transition-speed) ease, visibility 0s var(--transition-speed); z-index: 1000; }
        body.chat-open #chat-panel-overlay { opacity: 1; visibility: visible; transition-delay: 0s; }
        #chat-panel { position: fixed; bottom: 30px; right: 100px; width: 90vw; max-width: 450px; height: 75vh; max-height: 650px; background-color: var(--chat-panel-bg); border-radius: var(--border-radius); box-shadow: 0 10px 30px rgba(0,0,0,0.15); border: 1px solid var(--chat-border-color); display: flex; flex-direction: column; z-index: 1005; opacity: 0; transform: translateY(20px) scale(0.98); visibility: hidden; transition: opacity var(--transition-speed) cubic-bezier(0.165, 0.84, 0.44, 1), transform var(--transition-speed) cubic-bezier(0.165, 0.84, 0.44, 1), visibility 0s var(--transition-speed); transform-origin: bottom right; }
        body.chat-open #chat-panel { opacity: 1; transform: translateY(0) scale(1); visibility: visible; transition-delay: 0s; }
        .chat-panel-header { display: flex; justify-content: space-between; align-items: center; padding: 0.8rem 1.2rem; border-bottom: 1px solid var(--chat-border-color); background-color: var(--background-page); border-top-left-radius: var(--border-radius); border-top-right-radius: var(--border-radius); }
        .chat-panel-header h5 { margin: 0; font-family: var(--font-title); font-size: 1.1rem; color: var(--primary-color); display: flex; align-items: center; }
        .chat-panel-header h5 i { margin-right: 8px; color: var(--certificate-color); }
        #chat-close-button { background: none; border: none; font-size: 1.5rem; color: var(--text-muted); cursor: pointer; padding: 0.2rem; line-height: 1; transition: color var(--transition-speed); }
        #chat-close-button:hover { color: var(--text-dark); }
        #chatbox { flex-grow: 1; overflow-y: auto; padding: 1.5rem; background-color: var(--chat-box-bg); font-family: var(--font-body); line-height: 1.6; scrollbar-width: thin; scrollbar-color: var(--secondary-color) var(--chat-box-bg); }
        #chatbox::-webkit-scrollbar { width: 6px; }
        #chatbox::-webkit-scrollbar-track { background: var(--chat-box-bg); }
        #chatbox::-webkit-scrollbar-thumb { background-color: var(--secondary-color); border-radius: 3px; }
        #chatbox .message-container { display: flex; margin-bottom: 1rem; align-items: flex-end; }
        #chatbox .message-avatar { width: 35px; height: 35px; border-radius: 50%; background-color: var(--secondary-color); color: white; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; flex-shrink: 0; margin-right: 10px; }
        #chatbox .user-message-container .message-avatar { background-color: var(--chat-user-color); color: white;}
        #chatbox .bot-message-container .message-avatar { background-color: var(--certificate-color); color: white; }
        #chatbox .message { padding: 10px 15px; border-radius: 18px; max-width: 80%; word-wrap: break-word; font-size: 0.95rem; position: relative; border: 1px solid var(--chat-border-color); box-shadow: 0 1px 3px rgba(0,0,0,0.04); }
        #chatbox .user-message-container { justify-content: flex-end; }
        #chatbox .user-message-container .message-avatar { margin-right: 0; margin-left: 10px; order: 2; }
        #chatbox .user-message-container .message { order: 1; }
        #chatbox .user-message { background-color: var(--chat-user-bg); color: var(--chat-user-text); border-color: var(--chat-user-bg); border-top-right-radius: 4px; }
        #chatbox .bot-message { background-color: var(--chat-bot-bg); color: var(--chat-bot-text); border-color: var(--chat-bot-bg); border-top-left-radius: 4px; }
        #chatbox .error-message { background-color: var(--chat-error-bg); color: var(--chat-error-text); border-color: #f5c6cb; margin-bottom: 1rem; }
        #chatbox .message strong { display: none; }
        #chatbox .typing-indicator { display: flex; align-items: center; color: var(--text-muted); font-style: italic; margin-bottom: 1rem; padding: 8px 15px; font-size: 0.9rem; }
        #chatbox .typing-indicator i { margin-right: 8px; color: var(--certificate-color); }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1.0); } }
        .typing-dot { width: 6px; height: 6px; background-color: var(--text-muted); border-radius: 50%; display: inline-block; margin: 0 2px; animation: bounce 1.4s infinite ease-in-out both; }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        #input-area { display: flex; padding: 0.8rem; border-top: 1px solid var(--chat-border-color); background-color: var(--background-page); align-items: center; }
        #userInput { flex-grow: 1; border: 1px solid var(--chat-border-color); border-radius: 18px; padding: 0.7rem 1rem; font-size: 0.95rem; background-color: var(--background-card); color: var(--text-dark); outline: none; transition: border-color var(--transition-speed); resize: none; max-height: 80px; font-family: var(--font-body); }
        #userInput:focus { border-color: var(--primary-color); }
        #sendButton { background-color: var(--primary-color); color: var(--text-light); border: none; border-radius: 50%; width: 40px; height: 40px; margin-left: 0.7rem; padding: 0; cursor: pointer; font-size: 1.1rem; transition: background-color var(--transition-speed); display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        #sendButton:hover { background-color: #0b5ed7; }
        #sendButton:disabled { background-color: var(--secondary-color); cursor: not-allowed; opacity: 0.7; }

        /* --- Responsive Design --- */
        /* (Keep the media queries exactly as in ctp-dashboard.html, they should adapt well) */
        @media (max-width: 992px) { .kc-container { max-width: 700px; } .kc-header h1 { font-size: 1.6rem; } }
        @media (max-width: 768px) { html { font-size: 15px; } .kc-header { padding: 1.2rem; } .kc-header h1 { font-size: 1.4rem; } .return-button { padding: 0.4rem 0.8rem; font-size: 0.85rem;} #languageSelect { padding: 6px 30px 6px 12px; font-size: 0.85rem;} .kc-container { padding: 0 1rem 1.5rem 1rem; } .kc-question { padding: 1.2rem; } .kc-option label { padding: 0.7rem 0.9rem; padding-left: 30px; } #kc-submit-button { font-size: 1rem; } #chat-panel { right: 30px; bottom: 90px; max-width: 400px; height: 70vh;} }
        @media (max-width: 576px) { html { font-size: 14px; } .kc-header { flex-direction: column; gap: 1rem; text-align: center; } .kc-header-content { flex-direction: column; gap: 0.5rem; width: 100%; } .kc-header .header-controls { width: 100%; justify-content: space-between;} .kc-header h1 { font-size: 1.3rem; } .kc-intro h2 { font-size: 1.4rem; } .kc-question p { font-size: 1rem; } .kc-option label { padding: 0.6rem 0.8rem; padding-left: 30px; font-size: 0.9rem;} #kc-submit-button { width: 100%; } #kc-results h3 { font-size: 1.2rem; } #kc-results p { font-size: 1rem; } #chatbot-fab { width: 50px; height: 50px; font-size: 1.5rem; bottom: 20px; right: 20px; } #chat-panel { bottom: 75px; right: 10px; left: 10px; height: 60vh; } #chatbox { padding: 1rem; } #chatbox .message-avatar { width: 30px; height: 30px; font-size: 1rem; } #chatbox .message { font-size: 0.9rem; padding: 8px 12px;} #input-area { padding: 0.6rem; } #userInput { padding: 0.6rem 0.8rem; font-size: 0.9rem; border-radius: 15px;} #sendButton { width: 35px; height: 35px; font-size: 1rem; margin-left: 0.5rem;} }

    </style>
</head>
<body>

    <header class="kc-header">
        <div class="kc-header-content">
            <h1 data-translate="kc_page_header">Module 24 Check</h1>
            <div class="header-controls">
                 <a href="ctp-dashboard.html" class="return-button">
                     <i class="fas fa-arrow-left"></i> <span data-translate="return_to_dashboard">Return to Dashboard</span>
                 </a>
                <!-- Language Switcher Widget -->
                <div class="language-switcher-kc">
                    <select id="languageSelect" data-translate-aria-label="lang_select_aria" aria-label="Select Language">
                        <option value="en" data-translate="lang_en">🇬🇧 English</option>
                        <option value="pt" data-translate="lang_pt">🇧🇷 Português</option>
                        <option value="zh" data-translate="lang_zh">🇨🇳 中文</option>
                    </select>
                </div>
            </div>
        </div>
    </header>

    <main class="kc-container">

        <div class="kc-intro">
            <h2 data-translate="kc_title"><i class="fas fa-file-alt"></i> Module 24: Writing to Files</h2>
            <p data-translate="kc_instructions_1">Answer the following 10 questions about writing to files in Python.</p>
            <p data-translate="kc_instructions_2">You need to score at least <strong>6 out of 10</strong> to pass this knowledge check.</p>
            <p data-translate="kc_instructions_3">You can attempt this check as many times as you like. Passing will update your progress.</p>
        </div>

        <form id="kc-form">

            <!-- Question 1 -->
            <div class="kc-question">
                <p><strong data-translate="kc_question_label" data-replacements='{"num": 1}'>Question 1:</strong> <span data-translate="q24_1_text">Which mode should you use with `open()` to write to a file, creating it if it doesn't exist and overwriting it if it does?</span></p>
                <div class="kc-options">
                    <div class="kc-option">
                        <input type="radio" id="q1_opt1" name="q1" value="a" required>
                        <label for="q1_opt1" data-translate="q24_1_opt1"><code>'a'</code> (append)</label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q1_opt2" name="q1" value="r">
                        <label for="q1_opt2" data-translate="q24_1_opt2"><code>'r'</code> (read)</label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q1_opt3" name="q1" value="w">
                        <label for="q1_opt3" data-translate="q24_1_opt3"><code>'w'</code> (write)</label>
                    </div>
                     <div class="kc-option">
                        <input type="radio" id="q1_opt4" name="q1" value="x">
                        <label for="q1_opt4" data-translate="q24_1_opt4"><code>'x'</code> (exclusive creation)</label>
                    </div>
                </div>
            </div>

            <!-- Question 2 -->
            <div class="kc-question">
                <p><strong data-translate="kc_question_label" data-replacements='{"num": 2}'>Question 2:</strong> <span data-translate="q24_2_text">What is the primary advantage of using the `with open(...) as ...:` syntax?</span></p>
                <div class="kc-options">
                    <div class="kc-option">
                        <input type="radio" id="q2_opt1" name="q2" value="shorter">
                        <label for="q2_opt1" data-translate="q24_2_opt1">It makes the code slightly shorter.</label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q2_opt2" name="q2" value="faster">
                        <label for="q2_opt2" data-translate="q24_2_opt2">It makes file operations significantly faster.</label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q2_opt3" name="q2" value="auto_close">
                        <label for="q2_opt3" data-translate="q24_2_opt3">It automatically closes the file, even if errors occur.</label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q2_opt4" name="q2" value="read_only">
                        <label for="q2_opt4" data-translate="q24_2_opt4">It can only be used for reading files, not writing.</label>
                    </div>
                </div>
            </div>

            <!-- Question 3 -->
            <div class="kc-question">
                 <p><strong data-translate="kc_question_label" data-replacements='{"num": 3}'>Question 3:</strong> <span data-translate="q24_3_text">Which method is used to write a string to an open file object?</span></p>
                <div class="kc-options">
                    <div class="kc-option">
                        <input type="radio" id="q3_opt1" name="q3" value="print">
                        <label for="q3_opt1" data-translate="q24_3_opt1"><code>print()</code></label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q3_opt2" name="q3" value="write">
                        <label for="q3_opt2" data-translate="q24_3_opt2"><code>.write()</code></label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q3_opt3" name="q3" value="append">
                        <label for="q3_opt3" data-translate="q24_3_opt3"><code>.append()</code></label>
                    </div>
                     <div class="kc-option">
                        <input type="radio" id="q3_opt4" name="q3" value="save">
                        <label for="q3_opt4" data-translate="q24_3_opt4"><code>.save()</code></label>
                    </div>
                </div>
            </div>

             <!-- Question 4 -->
            <div class="kc-question">
                <p><strong data-translate="kc_question_label" data-replacements='{"num": 4}'>Question 4:</strong> <span data-translate="q24_4_text">If you want to add text to the *end* of an existing file without deleting its current contents, which mode should you use with `open()`?</span></p>
                <div class="kc-options">
                    <div class="kc-option">
                        <input type="radio" id="q4_opt1" name="q4" value="w">
                        <label for="q4_opt1" data-translate="q24_4_opt1"><code>'w'</code></label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q4_opt2" name="q4" value="r+">
                        <label for="q4_opt2" data-translate="q24_4_opt2"><code>'r+'</code></label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q4_opt3" name="q4" value="a">
                        <label for="q4_opt3" data-translate="q24_4_opt3"><code>'a'</code></label>
                    </div>
                     <div class="kc-option">
                        <input type="radio" id="q4_opt4" name="q4" value="w+">
                        <label for="q4_opt4" data-translate="q24_4_opt4"><code>'w+'</code></label>
                    </div>
                </div>
            </div>

             <!-- Question 5 -->
            <div class="kc-question">
                <p><strong data-translate="kc_question_label" data-replacements='{"num": 5}'>Question 5:</strong> <span data-translate="q24_5_text">What character sequence represents a newline character, often needed when writing multiple lines to a file?</span></p>
                <div class="kc-options">
                    <div class="kc-option">
                        <input type="radio" id="q5_opt1" name="q5" value="slash_n">
                        <label for="q5_opt1" data-translate="q24_5_opt1"><code>/n</code></label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q5_opt2" name="q5" value="br">
                        <label for="q5_opt2" data-translate="q24_5_opt2"><code>&lt;br&gt;</code></label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q5_opt3" name="q5" value="backslash_n">
                        <label for="q5_opt3" data-translate="q24_5_opt3"><code>\n</code></label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q5_opt4" name="q5" value="enter">
                        <label for="q5_opt4" data-translate="q24_5_opt4"><code>ENTER</code></label>
                    </div>
                </div>
            </div>

             <!-- Question 6 -->
            <div class="kc-question">
                 <p><strong data-translate="kc_question_label" data-replacements='{"num": 6}'>Question 6:</strong> <span data-translate="q24_6_text">Consider this code:</span>
                 <pre><code style="display: block; padding: 10px; margin-top: 5px;">with open('data.txt', 'w') as f:
    f.write("Hello")
with open('data.txt', 'w') as f:
    f.write("World")</code></pre>
                 <span data-translate="q24_6_text_after">What will be the final content of `data.txt`?</span>
                 </p>
                <div class="kc-options">
                    <div class="kc-option">
                        <input type="radio" id="q6_opt1" name="q6" value="HelloWorld">
                        <label for="q6_opt1" data-translate="q24_6_opt1"><code>HelloWorld</code></label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q6_opt2" name="q6" value="Hello\nWorld">
                        <label for="q6_opt2" data-translate="q24_6_opt2"><code>Hello</code> followed by <code>World</code> on a new line</label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q6_opt3" name="q6" value="World">
                        <label for="q6_opt3" data-translate="q24_6_opt3"><code>World</code></label>
                    </div>
                     <div class="kc-option">
                        <input type="radio" id="q6_opt4" name="q6" value="Hello">
                        <label for="q6_opt4" data-translate="q24_6_opt4"><code>Hello</code></label>
                    </div>
                </div>
            </div>

             <!-- Question 7 -->
            <div class="kc-question">
                <p><strong data-translate="kc_question_label" data-replacements='{"num": 7}'>Question 7:</strong> <span data-translate="q24_7_text">What happens if you use mode `'a'` (append) to open a file that does *not* currently exist?</span></p>
                <div class="kc-options">
                    <div class="kc-option">
                        <input type="radio" id="q7_opt1" name="q7" value="error">
                        <label for="q7_opt1" data-translate="q24_7_opt1">It raises a `FileNotFoundError`.</label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q7_opt2" name="q7" value="creates">
                        <label for="q7_opt2" data-translate="q24_7_opt2">It creates a new, empty file.</label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q7_opt3" name="q7" value="nothing">
                        <label for="q7_opt3" data-translate="q24_7_opt3">Nothing happens, the operation silently fails.</label>
                    </div>
                     <div class="kc-option">
                        <input type="radio" id="q7_opt4" name="q7" value="prompts">
                        <label for="q7_opt4" data-translate="q24_7_opt4">It prompts the user to create the file.</label>
                    </div>
                </div>
            </div>

            <!-- Question 8 -->
            <div class="kc-question">
                 <p><strong data-translate="kc_question_label" data-replacements='{"num": 8}'>Question 8:</strong> <span data-translate="q24_8_text">If you want to write numbers to a file using `.write()`, what must you typically do first?</span></p>
                <div class="kc-options">
                    <div class="kc-option">
                        <input type="radio" id="q8_opt1" name="q8" value="nothing">
                        <label for="q8_opt1" data-translate="q24_8_opt1">Nothing, `.write()` can handle numbers directly.</label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q8_opt2" name="q8" value="convert_str">
                        <label for="q8_opt2" data-translate="q24_8_opt2">Convert the number to a string using `str()`.</label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q8_opt3" name="q8" value="convert_int">
                        <label for="q8_opt3" data-translate="q24_8_opt3">Convert the number to an integer using `int()`.</label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q8_opt4" name="q8" value="use_print">
                        <label for="q8_opt4" data-translate="q24_8_opt4">Use the `print()` function instead of `.write()`.</label>
                    </div>
                </div>
            </div>

             <!-- Question 9 -->
            <div class="kc-question">
                 <p><strong data-translate="kc_question_label" data-replacements='{"num": 9}'>Question 9:</strong> <span data-translate="q24_9_text">Consider this code:</span>
                 <pre><code style="display: block; padding: 10px; margin-top: 5px;">lines = ["First line.\n", "Second line.\n"]
with open('output.txt', 'w') as f:
    f.write(lines)</code></pre>
                 <span data-translate="q24_9_text_after">What is the likely outcome?</span>
                 </p>
                <div class="kc-options">
                    <div class="kc-option">
                        <input type="radio" id="q9_opt1" name="q9" value="works">
                        <label for="q9_opt1" data-translate="q24_9_opt1">It successfully writes both lines to the file.</label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q9_opt2" name="q9" value="error">
                        <label for="q9_opt2" data-translate="q24_9_opt2">It will cause a `TypeError` because `.write()` expects a string, not a list.</label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q9_opt3" name="q9" value="first_only">
                        <label for="q9_opt3" data-translate="q24_9_opt3">It only writes the first line ("First line.\n") to the file.</label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q9_opt4" name="q9" value="no_newline">
                        <label for="q9_opt4" data-translate="q24_9_opt4">It writes the lines but ignores the newline characters.</label>
                    </div>
                </div>
            </div>

             <!-- Question 10 -->
            <div class="kc-question">
                <p><strong data-translate="kc_question_label" data-replacements='{"num": 10}'>Question 10:</strong> <span data-translate="q24_10_text">Which method is specifically designed to write a list of strings to a file, often used after reading lines?</span></p>
                <div class="kc-options">
                    <div class="kc-option">
                        <input type="radio" id="q10_opt1" name="q10" value="write">
                        <label for="q10_opt1" data-translate="q24_10_opt1"><code>.write()</code></label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q10_opt2" name="q10" value="writelines">
                        <label for="q10_opt2" data-translate="q24_10_opt2"><code>.writelines()</code></label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q10_opt3" name="q10" value="appendlines">
                        <label for="q10_opt3" data-translate="q24_10_opt3"><code>.appendlines()</code></label>
                    </div>
                    <div class="kc-option">
                        <input type="radio" id="q10_opt4" name="q10" value="writelist">
                        <label for="q10_opt4" data-translate="q24_10_opt4"><code>.writelist()</code></label>
                    </div>
                </div>
            </div>

            <button type="submit" id="kc-submit-button" data-translate="kc_submit_button">Submit Answers</button>

        </form>

        <div id="kc-results" style="display: none;">
            <h3 id="kc-result-title"></h3>
            <p id="kc-result-score"></p>
            <p id="kc-result-message"></p>
            <button id="kc-retry-button" data-translate="kc_retry_button">Retry Check</button>
        </div>

    </main>

    <!-- Chat Panel Overlay -->
    <div id="chat-panel-overlay"></div>

    <!-- Chat Panel -->
    <div id="chat-panel">
        <div class="chat-panel-header">
            <h5 data-translate="chat_title"><i class="fas fa-cat"></i> Cat Assistant</h5>
            <button id="chat-close-button" data-translate-aria-label="chat_close_button_aria" aria-label="Close Chat">&times;</button>
        </div>
        <div id="chatbox" aria-live="polite">
            <!-- Chat messages dynamically added -->
        </div>
        <div id="input-area">
            <input id="userInput" type="text" autofocus data-translate-placeholder="chat_input_placeholder" placeholder="Ask Cat Assistant...">
            <button id="sendButton" data-translate-aria-label="chat_send_button_aria" aria-label="Send Message"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <!-- Floating Chatbot Button -->
    <button id="chatbot-fab" data-translate-aria-label="chat_open_button_aria" aria-label="Open Course Assistant">
        <i class="fas fa-comment-dots"></i>
    </button>


    <footer>
        <p data-translate="footer_text">Part of the Road to Free Open AGI Project</p>
    </footer>

    <script>
        const moduleId = 24; // <-- SET THE MODULE ID FOR THIS KNOWLEDGE CHECK
        const passMark = 6;  // <-- SET THE PASS MARK

        // --- Translations Object (Add KC specific keys) ---
        const translations = {
             en: {
                 "page_title": "Knowledge Check - Module 24: Writing Files",
                 "kc_page_header": "Module 24 Check",
                 "return_to_dashboard": "Return to Dashboard",
                 "kc_title": "Module 24: Writing to Files",
                 "kc_instructions_1": "Answer the following 10 questions about writing to files in Python.",
                 "kc_instructions_2": "You need to score at least <strong>{passMark} out of 10</strong> to pass this knowledge check.",
                 "kc_instructions_3": "You can attempt this check as many times as you like. Passing will update your progress.",
                 "kc_question_label": "Question {num}:",
                 "kc_submit_button": "Submit Answers",
                 "kc_retry_button": "Retry Check",
                 "kc_result_title_pass": "Check Passed!",
                 "kc_result_title_fail": "Check Not Passed",
                 "kc_result_score": "Your score: {score}/10",
                 "kc_result_message_pass": "Great job! Your progress for this module has been updated.",
                 "kc_result_message_fail": "Don't worry, review the material and try again!",
                 // Module 24 Questions & Answers
                 "q24_1_text": "Which mode should you use with `open()` to write to a file, creating it if it doesn't exist and overwriting it if it does?",
                 "q24_1_opt1": "`'a'` (append)", "q24_1_opt2": "`'r'` (read)", "q24_1_opt3": "`'w'` (write)", "q24_1_opt4": "`'x'` (exclusive creation)",
                 "q24_2_text": "What is the primary advantage of using the `with open(...) as ...:` syntax?",
                 "q24_2_opt1": "It makes the code slightly shorter.", "q24_2_opt2": "It makes file operations significantly faster.", "q24_2_opt3": "It automatically closes the file, even if errors occur.", "q24_2_opt4": "It can only be used for reading files, not writing.",
                 "q24_3_text": "Which method is used to write a string to an open file object?",
                 "q24_3_opt1": "`print()`", "q24_3_opt2": "`.write()`", "q24_3_opt3": "`.append()`", "q24_3_opt4": "`.save()`",
                 "q24_4_text": "If you want to add text to the *end* of an existing file without deleting its current contents, which mode should you use with `open()`?",
                 "q24_4_opt1": "`'w'`", "q24_4_opt2": "`'r+'`", "q24_4_opt3": "`'a'`", "q24_4_opt4": "`'w+'`",
                 "q24_5_text": "What character sequence represents a newline character, often needed when writing multiple lines to a file?",
                 "q24_5_opt1": "`/n`", "q24_5_opt2": "`<br>`", "q24_5_opt3": "`\\n`", "q24_5_opt4": "`ENTER`",
                 "q24_6_text": "Consider this code:",
                 "q24_6_text_after": "What will be the final content of `data.txt`?",
                 "q24_6_opt1": "`HelloWorld`", "q24_6_opt2": "`Hello` followed by `World` on a new line", "q24_6_opt3": "`World`", "q24_6_opt4": "`Hello`",
                 "q24_7_text": "What happens if you use mode `'a'` (append) to open a file that does *not* currently exist?",
                 "q24_7_opt1": "It raises a `FileNotFoundError`.", "q24_7_opt2": "It creates a new, empty file.", "q24_7_opt3": "Nothing happens, the operation silently fails.", "q24_7_opt4": "It prompts the user to create the file.",
                 "q24_8_text": "If you want to write numbers to a file using `.write()`, what must you typically do first?",
                 "q24_8_opt1": "Nothing, `.write()` can handle numbers directly.", "q24_8_opt2": "Convert the number to a string using `str()`.", "q24_8_opt3": "Convert the number to an integer using `int()`.", "q24_8_opt4": "Use the `print()` function instead of `.write()`.",
                 "q24_9_text": "Consider this code:",
                 "q24_9_text_after": "What is the likely outcome?",
                 "q24_9_opt1": "It successfully writes both lines to the file.", "q24_9_opt2": "It will cause a `TypeError` because `.write()` expects a string, not a list.", "q24_9_opt3": "It only writes the first line (\"First line.\\n\") to the file.", "q24_9_opt4": "It writes the lines but ignores the newline characters.",
                 "q24_10_text": "Which method is specifically designed to write a list of strings to a file, often used after reading lines?",
                 "q24_10_opt1": "`.write()`", "q24_10_opt2": "`.writelines()`", "q24_10_opt3": "`.appendlines()`", "q24_10_opt4": "`.writelist()`",
                 // Other keys (Copy from dashboard JS if needed, only including required ones here)
                  "lang_select_aria": "Select Language", "lang_en": "🇬🇧 English", "lang_pt": "🇧🇷 Português", "lang_zh": "🇨🇳 中文", "chat_title": "Cat Assistant", "chat_initial_greeting": "Meow! How can I help with this Knowledge Check?", "chat_typing_indicator": "Cat Assistant is pondering", "chat_input_placeholder": "Ask Cat Assistant...", "chat_close_button_aria": "Close Chat", "chat_send_button_aria": "Send Message", "chat_open_button_aria": "Open Course Assistant", "footer_text": "Part of the Road to Free Open AGI Project"
             },
             pt: {
                 "page_title": "Verificação de Conhecimento - Módulo 24: Escrevendo Arquivos",
                 "kc_page_header": "Verificação Módulo 24",
                 "return_to_dashboard": "Voltar ao Painel",
                 "kc_title": "Módulo 24: Escrevendo em Arquivos",
                 "kc_instructions_1": "Responda às 10 perguntas seguintes sobre escrita em arquivos em Python.",
                 "kc_instructions_2": "Você precisa acertar pelo menos <strong>{passMark} de 10</strong> para passar nesta verificação.",
                 "kc_instructions_3": "Você pode tentar quantas vezes quiser. Passar atualizará seu progresso.",
                 "kc_question_label": "Questão {num}:",
                 "kc_submit_button": "Enviar Respostas",
                 "kc_retry_button": "Tentar Novamente",
                 "kc_result_title_pass": "Verificação Concluída!",
                 "kc_result_title_fail": "Verificação Não Concluída",
                 "kc_result_score": "Sua pontuação: {score}/10",
                 "kc_result_message_pass": "Ótimo trabalho! Seu progresso para este módulo foi atualizado.",
                 "kc_result_message_fail": "Não se preocupe, revise o material e tente novamente!",
                 // Module 24 Questions & Answers - PT
                 "q24_1_text": "Qual modo você deve usar com `open()` para escrever em um arquivo, criando-o se não existir e sobrescrevendo-o se existir?",
                 "q24_1_opt1": "`'a'` (append/anexar)", "q24_1_opt2": "`'r'` (read/leitura)", "q24_1_opt3": "`'w'` (write/escrita)", "q24_1_opt4": "`'x'` (criação exclusiva)",
                 "q24_2_text": "Qual é a principal vantagem de usar a sintaxe `with open(...) as ...:`?",
                 "q24_2_opt1": "Torna o código um pouco mais curto.", "q24_2_opt2": "Torna as operações de arquivo significativamente mais rápidas.", "q24_2_opt3": "Fecha automaticamente o arquivo, mesmo se ocorrerem erros.", "q24_2_opt4": "Só pode ser usado para ler arquivos, não para escrever.",
                 "q24_3_text": "Qual método é usado para escrever uma string em um objeto de arquivo aberto?",
                 "q24_3_opt1": "`print()`", "q24_3_opt2": "`.write()`", "q24_3_opt3": "`.append()`", "q24_3_opt4": "`.save()`",
                 "q24_4_text": "Se você quiser adicionar texto ao *final* de um arquivo existente sem apagar seu conteúdo atual, qual modo deve usar com `open()`?",
                 "q24_4_opt1": "`'w'`", "q24_4_opt2": "`'r+'`", "q24_4_opt3": "`'a'`", "q24_4_opt4": "`'w+'`",
                 "q24_5_text": "Qual sequência de caracteres representa um caractere de nova linha, frequentemente necessário ao escrever múltiplas linhas em um arquivo?",
                 "q24_5_opt1": "`/n`", "q24_5_opt2": "`<br>`", "q24_5_opt3": "`\\n`", "q24_5_opt4": "`ENTER`",
                 "q24_6_text": "Considere este código:",
                 "q24_6_text_after": "Qual será o conteúdo final de `data.txt`?",
                 "q24_6_opt1": "`HelloWorld`", "q24_6_opt2": "`Hello` seguido por `World` em uma nova linha", "q24_6_opt3": "`World`", "q24_6_opt4": "`Hello`",
                 "q24_7_text": "O que acontece se você usar o modo `'a'` (append) para abrir um arquivo que *não* existe atualmente?",
                 "q24_7_opt1": "Levanta um `FileNotFoundError`.", "q24_7_opt2": "Cria um novo arquivo vazio.", "q24_7_opt3": "Nada acontece, a operação falha silenciosamente.", "q24_7_opt4": "Solicita ao usuário para criar o arquivo.",
                 "q24_8_text": "Se você quiser escrever números em um arquivo usando `.write()`, o que você normalmente deve fazer primeiro?",
                 "q24_8_opt1": "Nada, `.write()` pode lidar com números diretamente.", "q24_8_opt2": "Converter o número para uma string usando `str()`.", "q24_8_opt3": "Converter o número para um inteiro usando `int()`.", "q24_8_opt4": "Usar a função `print()` em vez de `.write()`.",
                 "q24_9_text": "Considere este código:",
                 "q24_9_text_after": "Qual é o resultado provável?",
                 "q24_9_opt1": "Escreve com sucesso ambas as linhas no arquivo.", "q24_9_opt2": "Causará um `TypeError` porque `.write()` espera uma string, não uma lista.", "q24_9_opt3": "Escreve apenas a primeira linha (\"First line.\\n\") no arquivo.", "q24_9_opt4": "Escreve as linhas, mas ignora os caracteres de nova linha.",
                 "q24_10_text": "Qual método é projetado especificamente para escrever uma lista de strings em um arquivo, frequentemente usado após ler linhas?",
                 "q24_10_opt1": "`.write()`", "q24_10_opt2": "`.writelines()`", "q24_10_opt3": "`.appendlines()`", "q24_10_opt4": "`.writelist()`",
                 // Other keys
                  "lang_select_aria": "Selecionar Idioma", "lang_en": "🇬🇧 English", "lang_pt": "🇧🇷 Português", "lang_zh": "🇨🇳 中文", "chat_title": "Gato Assistente", "chat_initial_greeting": "Miau! Como posso ajudar com esta Verificação de Conhecimento?", "chat_typing_indicator": "Gato Assistente está pensando", "chat_input_placeholder": "Pergunte ao Gato Assistente...", "chat_close_button_aria": "Fechar Chat", "chat_send_button_aria": "Enviar Mensagem", "chat_open_button_aria": "Abrir Assistente do Curso", "footer_text": "Parte do Projeto Road to Free Open AGI"
             },
             zh: {
                 "page_title": "知识测验 - 模块 24: 写入文件",
                 "kc_page_header": "模块 24 测验",
                 "return_to_dashboard": "返回仪表板",
                 "kc_title": "模块 24: 写入文件",
                 "kc_instructions_1": "回答以下关于 Python 文件写入的 10 个问题。",
                 "kc_instructions_2": "您需要至少答对 <strong>10 题中的 {passMark} 题</strong> 才能通过此知识测验。",
                 "kc_instructions_3": "您可以不限次数地尝试此测验。通过后将更新您的进度。",
                 "kc_question_label": "问题 {num}:",
                 "kc_submit_button": "提交答案",
                 "kc_retry_button": "重新测验",
                 "kc_result_title_pass": "测验通过！",
                 "kc_result_title_fail": "测验未通过",
                 "kc_result_score": "您的得分: {score}/10",
                 "kc_result_message_pass": "做得好！您在此模块的进度已更新。",
                 "kc_result_message_fail": "别担心，复习一下材料再试一次吧！",
                  // Module 24 Questions & Answers - ZH
                 "q24_1_text": "使用 `open()` 写入文件时，如果文件不存在则创建，如果文件存在则覆盖，应该使用哪种模式？",
                 "q24_1_opt1": "`'a'` (append/追加)", "q24_1_opt2": "`'r'` (read/读取)", "q24_1_opt3": "`'w'` (write/写入)", "q24_1_opt4": "`'x'` (exclusive creation/独占创建)",
                 "q24_2_text": "使用 `with open(...) as ...:` 语法的主要优点是什么？",
                 "q24_2_opt1": "它使代码稍微短一些。", "q24_2_opt2": "它使文件操作明显更快。", "q24_2_opt3": "即使发生错误，它也会自动关闭文件。", "q24_2_opt4": "它只能用于读取文件，不能用于写入。",
                 "q24_3_text": "哪个方法用于将字符串写入打开的文件对象？",
                 "q24_3_opt1": "`print()`", "q24_3_opt2": "`.write()`", "q24_3_opt3": "`.append()`", "q24_3_opt4": "`.save()`",
                 "q24_4_text": "如果你想在不删除现有文件内容的情况下，将文本添加到文件*末尾*，应该使用 `open()` 的哪种模式？",
                 "q24_4_opt1": "`'w'`", "q24_4_opt2": "`'r+'`", "q24_4_opt3": "`'a'`", "q24_4_opt4": "`'w+'`",
                 "q24_5_text": "哪个字符序列代表换行符，在向文件写入多行时经常需要用到？",
                 "q24_5_opt1": "`/n`", "q24_5_opt2": "`<br>`", "q24_5_opt3": "`\\n`", "q24_5_opt4": "`ENTER`",
                 "q24_6_text": "考虑以下代码:",
                 "q24_6_text_after": "`data.txt` 的最终内容将是什么？",
                 "q24_6_opt1": "`HelloWorld`", "q24_6_opt2": "`Hello` 后面换行跟着 `World`", "q24_6_opt3": "`World`", "q24_6_opt4": "`Hello`",
                 "q24_7_text": "如果你使用模式 `'a'` (append) 打开一个当前*不存在*的文件，会发生什么？",
                 "q24_7_opt1": "引发 `FileNotFoundError`。", "q24_7_opt2": "创建一个新的空文件。", "q24_7_opt3": "什么也不发生，操作静默失败。", "q24_7_opt4": "提示用户创建文件。",
                 "q24_8_text": "如果你想使用 `.write()` 将数字写入文件，通常首先需要做什么？",
                 "q24_8_opt1": "什么都不用做，`.write()` 可以直接处理数字。", "q24_8_opt2": "使用 `str()` 将数字转换为字符串。", "q24_8_opt3": "使用 `int()` 将数字转换为整数。", "q24_8_opt4": "使用 `print()` 函数代替 `.write()`。",
                 "q24_9_text": "考虑以下代码:",
                 "q24_9_text_after": "可能的结果是什么？",
                 "q24_9_opt1": "成功将两行都写入文件。", "q24_9_opt2": "将导致 `TypeError`，因为 `.write()` 需要一个字符串，而不是列表。", "q24_9_opt3": "只将第一行（\"First line.\\n\"）写入文件。", "q24_9_opt4": "写入了行，但忽略了换行符。",
                 "q24_10_text": "哪个方法专门用于将字符串列表写入文件，通常在读取行后使用？",
                 "q24_10_opt1": "`.write()`", "q24_10_opt2": "`.writelines()`", "q24_10_opt3": "`.appendlines()`", "q24_10_opt4": "`.writelist()`",
                 // Other keys
                 "lang_select_aria": "选择语言", "lang_en": "🇬🇧 English", "lang_pt": "🇧🇷 Português", "lang_zh": "🇨🇳 中文", "chat_title": "猫咪助手", "chat_initial_greeting": "喵！关于这个知识测验，我能帮上什么忙吗？", "chat_typing_indicator": "猫咪助手正在思考中", "chat_input_placeholder": "询问猫咪助手...", "chat_close_button_aria": "关闭聊天", "chat_send_button_aria": "发送消息", "chat_open_button_aria": "打开课程助手", "footer_text": "通往自由开放AGI之路项目的一部分"
             }
         };

        // --- Core JS Logic (Adapted for KC) ---
        document.addEventListener('DOMContentLoaded', () => {

            const KNOWLEDGE_CHECK_STORAGE_KEY = 'knowledgeCheckStatus_v1';
            const LANGUAGE_STORAGE_KEY = 'userLanguage';

            // --- Correct Answers for THIS module ---
            const correctAnswers = {
                q1: 'w', q2: 'auto_close', q3: 'write', q4: 'a', q5: 'backslash_n',
                q6: 'World', q7: 'creates', q8: 'convert_str', q9: 'error', q10: 'writelines'
            };
            const totalQuestions = Object.keys(correctAnswers).length;

            // --- DOM Elements ---
            const form = document.getElementById('kc-form');
            const resultsDiv = document.getElementById('kc-results');
            const resultTitle = document.getElementById('kc-result-title');
            const resultScore = document.getElementById('kc-result-score');
            const resultMessage = document.getElementById('kc-result-message');
            const retryButton = document.getElementById('kc-retry-button');
            const submitButton = document.getElementById('kc-submit-button');
            const languageSelectElement = document.getElementById('languageSelect');
            // Chat elements (optional interaction, mainly for UI consistency)
            const chatbotFab = document.getElementById('chatbot-fab');
            const chatPanel = document.getElementById('chat-panel');
            const chatCloseButton = document.getElementById('chat-close-button');
            const chatPanelOverlay = document.getElementById('chat-panel-overlay');
            const userInputEl = document.getElementById('userInput'); // Chat input
            const bodyEl = document.body;

             // --- Data Loading & Saving (LocalStorage) ---
             function loadKnowledgeCheckStatus() { try { const storedStatus = localStorage.getItem(KNOWLEDGE_CHECK_STORAGE_KEY); const parsed = storedStatus ? JSON.parse(storedStatus) : {}; return typeof parsed === 'object' && parsed !== null ? parsed : {}; } catch (e) { console.error("Error reading KC status from localStorage:", e); return {}; } }
             function saveKnowledgeCheckStatus(statusObject) { try { localStorage.setItem(KNOWLEDGE_CHECK_STORAGE_KEY, JSON.stringify(statusObject)); } catch (e) { console.error("Error saving KC status to localStorage:", e); } }

            // --- Translation Functions ---
            function getStoredLanguage() { const storedLang = localStorage.getItem(LANGUAGE_STORAGE_KEY); if (storedLang && translations[storedLang]) return storedLang; const browserLang = navigator.language || navigator.userLanguage; if (browserLang.startsWith('pt')) return 'pt'; if (browserLang.startsWith('zh')) return 'zh'; return 'en'; }
            function setLanguage(lang) { if (!translations[lang]) lang = 'en'; localStorage.setItem(LANGUAGE_STORAGE_KEY, lang); document.documentElement.lang = lang; if (languageSelectElement) languageSelectElement.value = lang; updateUI(); } // Update UI after language change
            function getTranslation(key, lang, replacements = {}) {
                let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`;
                 // Add replacement for passMark here specifically
                replacements['passMark'] = passMark;
                replacements['score'] = replacements['score'] ?? 0; // Ensure score is defined

                for (const placeholder in replacements) { const regex = new RegExp(`\\{${placeholder}\\}`, 'g'); text = text.replace(regex, replacements[placeholder]); } return text;
             }

            function translatePage(lang) {
                 if (!translations[lang]) lang = 'en';
                 document.querySelectorAll('[data-translate]').forEach(el => { const key = el.getAttribute('data-translate'); const replacements = JSON.parse(el.getAttribute('data-replacements') || '{}'); const translation = getTranslation(key, lang, replacements); if (el.tagName === 'TITLE') { document.title = translation; } else if (translation.includes('<') && translation.includes('>')) { el.innerHTML = translation; } else { el.textContent = translation; } });
                 document.querySelectorAll('[data-translate-placeholder]').forEach(el => { const key = el.getAttribute('data-translate-placeholder'); el.setAttribute('placeholder', getTranslation(key, lang)); });
                 document.querySelectorAll('[data-translate-aria-label]').forEach(el => { const key = el.getAttribute('data-translate-aria-label'); el.setAttribute('aria-label', getTranslation(key, lang)); });
            }

             // --- Quiz Logic ---
            function handleSubmit(event) {
                event.preventDefault();
                let score = 0;
                const formData = new FormData(form);

                for (let i = 1; i <= totalQuestions; i++) {
                    const questionKey = `q${i}`;
                    const selectedAnswer = formData.get(questionKey);
                    if (selectedAnswer === correctAnswers[questionKey]) {
                        score++;
                    }
                }

                displayResults(score);
                form.style.display = 'none'; // Hide form after submission
                submitButton.style.display = 'none';
                resultsDiv.style.display = 'block';
                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });

                // Update LocalStorage only if passed
                if (score >= passMark) {
                    const knowledgeCheckStatus = loadKnowledgeCheckStatus();
                    knowledgeCheckStatus[moduleId] = true;
                    saveKnowledgeCheckStatus(knowledgeCheckStatus);
                }
            }

            function displayResults(score) {
                const lang = getStoredLanguage();
                const passed = score >= passMark;

                resultsDiv.className = passed ? 'pass' : 'fail'; // Add class for styling
                resultTitle.textContent = getTranslation(passed ? 'kc_result_title_pass' : 'kc_result_title_fail', lang);
                resultScore.textContent = getTranslation('kc_result_score', lang, { score: score });
                resultMessage.textContent = getTranslation(passed ? 'kc_result_message_pass' : 'kc_result_message_fail', lang);
            }

            function resetQuiz() {
                form.reset();
                resultsDiv.style.display = 'none';
                resultsDiv.className = ''; // Reset result styling
                form.style.display = 'flex'; // Show form again
                submitButton.style.display = 'block'; // Show submit button again
            }

            // --- UI Update Function ---
            function updateUI() {
                const lang = getStoredLanguage();
                translatePage(lang);
                // Update any other language-dependent elements if needed
            }

            // --- Event Listeners ---
            form.addEventListener('submit', handleSubmit);
            retryButton.addEventListener('click', resetQuiz);
            if (languageSelectElement) {
                languageSelectElement.value = getStoredLanguage(); // Set initial value
                languageSelectElement.addEventListener('change', (e) => {
                    setLanguage(e.target.value);
                });
            }

            // --- Chat Panel Logic (Minimal for UI) ---
             function openChatPanel() { bodyEl.classList.add('chat-open'); chatbotFab.setAttribute('aria-expanded', 'true'); userInputEl.focus(); }
             function closeChatPanel() { bodyEl.classList.remove('chat-open'); chatbotFab.setAttribute('aria-expanded', 'false'); }
             if (chatbotFab && chatPanel && chatCloseButton && chatPanelOverlay && userInputEl) {
                chatbotFab.addEventListener('click', () => { bodyEl.classList.contains('chat-open') ? closeChatPanel() : openChatPanel(); });
                chatCloseButton.addEventListener('click', closeChatPanel);
                chatPanelOverlay.addEventListener('click', closeChatPanel);
                document.addEventListener('keydown', (event) => { if (event.key === 'Escape' && bodyEl.classList.contains('chat-open')) { closeChatPanel(); } });
             }
              // --- Chat Initial Message ---
             function initializeChat() {
                 const lang = getStoredLanguage();
                 const initialGreeting = getTranslation('chat_initial_greeting', lang);
                 const chatboxEl = document.getElementById('chatbox');
                 if(chatboxEl) {
                     chatboxEl.innerHTML = ''; // Clear previous
                     const messageContainer = document.createElement('div'); messageContainer.classList.add('message-container', 'bot-message-container');
                     const avatar = document.createElement('div'); avatar.classList.add('message-avatar'); avatar.innerHTML = '<i class="fas fa-cat"></i>';
                     const messageBubble = document.createElement('div'); messageBubble.classList.add('message', 'bot-message');
                     messageBubble.textContent = initialGreeting;
                     messageContainer.appendChild(avatar); messageContainer.appendChild(messageBubble); chatboxEl.appendChild(messageContainer);
                 }
             }


            // --- Initial Load ---
            updateUI(); // Load translations and set initial UI state
            initializeChat(); // Load initial chat message

        }); // End DOMContentLoaded
    </script>

</body>
</html>
<!DOCTYPE html>
<!-- Language set by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title set by JS -->
    <title data-translate="page_title">Module 31: Final Project Prep!</title>
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- Base Styles & Variables (Copied from Module 0) --- */
        :root {
            --primary-color: #007bff; /* Blue */
            --secondary-color: #6c757d; /* Grey */
            --background-light: #f8f9fa;
            --background-medium: #e9ecef;
            --background-dark: #343a40;
            --text-light: #f8f9fa;
            --text-dark: #212529;
            --accent-color: #ffc107; /* Yellow */
            --success-color: #28a745; /* Green */
            --error-color: #dc3545;   /* Red */
            --info-color: #17a2b8;    /* Teal */
            --project-planning-color: #6f42c1; /* Purple for project theme */
            --border-radius: 8px;
            --transition-speed: 0.3s;
            --font-body: 'Roboto', sans-serif;
            --font-title: 'Orbitron', sans-serif;
            --selection-highlight-bg: rgba(0, 123, 255, 0.1);
            --selection-highlight-border: rgba(0, 123, 255, 0.4);
            /* Colors matching news.html for consistency in switcher potentially */
            --nav-primary: #6e48aa;
            --nav-success: #4cc9f0;
            --nav-dark: #1a1a2e;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-body); line-height: 1.7;
            background-color: var(--background-light); color: var(--text-dark);
            overflow-x: hidden;
        }

        /* --- Utility Classes (Copied from Module 0) --- */
        .container { max-width: 960px; margin: 0 auto; padding: 0 15px; }
        .text-center { text-align: center; }
        .highlight { color: var(--primary-color); font-weight: bold; }
        .code-font { font-family: 'Courier New', Courier, monospace; } /* Kept for potential code snippets in text */
        .hidden { display: none !important; }
        .button-group {
            margin-top: 2rem; display: flex; flex-wrap: wrap;
            justify-content: center; gap: 1rem;
        }

        /* --- Advanced Animations (Copied from Module 0) --- */
        .fade-in { opacity: 0; transform: translateY(20px); animation: fadeInAnimation 0.8s ease-out forwards; }
        .fade-in.delay-1 { animation-delay: 0.2s; }
        .fade-in.delay-2 { animation-delay: 0.4s; }
        .fade-in.delay-3 { animation-delay: 0.6s; }
        .fade-in.delay-4 { animation-delay: 0.8s; }
        @keyframes fadeInAnimation { to { opacity: 1; transform: translateY(0); } }
        @keyframes pulseHeaderIcon {
            0% { transform: scale(1); opacity: 0.1; filter: brightness(1); }
            50% { transform: scale(1.05); opacity: 0.25; filter: brightness(1.2); }
            100% { transform: scale(1); opacity: 0.1; filter: brightness(1); }
        }
        @keyframes successGlow { /* Keep for general feedback */
             0% { box-shadow: 0 0 3px rgba(40, 167, 69, 0.3); transform: scale(1); }
             50% { box-shadow: 0 0 12px 5px rgba(40, 167, 69, 0.5); transform: scale(1.01); }
             100% { box-shadow: 0 0 3px rgba(40, 167, 69, 0.3); transform: scale(1); }
        }
        .success-glow-anim { animation: successGlow 0.9s ease-out; }
        @keyframes shake { /* Keep for general feedback */
          10%, 90% { transform: translate3d(-2px, 0, 0); } 20%, 80% { transform: translate3d(3px, 0, 0); }
          30%, 50%, 70% { transform: translate3d(-5px, 0, 0); } 40%, 60% { transform: translate3d(5px, 0, 0); }
        }
        .shake-anim { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes iconAppearCorrect { /* Keep for general feedback/completion */
            0% { transform: scale(0.5) rotate(-15deg); opacity: 0; }
            60% { transform: scale(1.2) rotate(5deg); opacity: 1; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
        /* Add simple confirmation animation */
        @keyframes popConfirm {
            0% { transform: scale(0.9); opacity: 0.5; }
            70% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
        .pop-confirm-anim { animation: popConfirm 0.4s ease-out forwards; }

        .action-button:active:not(:disabled) {
            transform: translateY(1px) scale(0.98);
            filter: brightness(0.95);
        }

        /* --- Minimal Retractable Nav (Copied from Module 0) --- */
        .minimal-nav-button {
            position: fixed; top: 15px; right: 15px; z-index: 1001;
            background-color: rgba(52, 58, 64, 0.75); color: var(--text-light);
            border: none; border-radius: var(--border-radius); padding: 8px 12px;
            cursor: pointer; transition: background-color var(--transition-speed), opacity var(--transition-speed), transform var(--transition-speed);
            font-size: 1.1rem; opacity: 0.6; box-shadow: 0 2px 5px rgba(0,0,0,0.2); line-height: 1;
        }
        .minimal-nav-button:hover {
            background-color: rgba(52, 58, 64, 0.95); opacity: 1; transform: scale(1.05);
        }
        .minimal-nav {
            position: fixed; top: 60px; right: 15px; z-index: 1000;
            background-color: var(--background-dark); border-radius: var(--border-radius);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); padding: 0.8rem; opacity: 0;
            transform: translateY(-15px) scale(0.95); transform-origin: top right;
            pointer-events: none; transition: opacity var(--transition-speed) ease, transform var(--transition-speed) ease;
            min-width: 200px;
        }
        body.nav-active .minimal-nav {
            opacity: 1; transform: translateY(0) scale(1); pointer-events: auto;
        }
        .minimal-nav ul { list-style: none; margin: 0; padding: 0; }
        .minimal-nav ul li { margin-bottom: 5px; }
        .minimal-nav ul li:last-child { margin-bottom: 0; }
        .minimal-nav ul li a {
            display: flex; align-items: center; color: var(--text-light);
            text-decoration: none; padding: 0.6rem 1rem; border-radius: 4px;
            transition: background-color var(--transition-speed), color var(--transition-speed);
            white-space: nowrap; font-weight: 400; font-size: 0.95rem;
        }
        .minimal-nav ul li a i.fas {
            margin-right: 10px; width: 1.2em; text-align: center;
            opacity: 0.8; transition: opacity var(--transition-speed);
        }
        .minimal-nav ul li a:hover {
            background-color: var(--primary-color); color: var(--text-light);
        }
        .minimal-nav ul li a:hover i.fas { opacity: 1; }
        /* Language Switcher Styles (Copied from Module 0) */
        .minimal-nav .language-switcher-item {
            padding: 0.5rem 1rem; border-top: 1px solid var(--secondary-color);
            margin-top: 8px; padding-top: 13px;
        }
        #languageSelect {
            width: 100%; background: rgba(255,255,255,0.1); color: white;
            border: 1px solid var(--nav-success); border-radius: 5px;
            padding: 6px 30px 6px 12px; cursor: pointer; font-size: 0.9rem;
            appearance: none; -webkit-appearance: none; -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%234CC9F0%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat; background-position: right 10px center;
            background-size: 10px auto; transition: background-color 0.3s ease;
        }
        #languageSelect:hover { background-color: rgba(255,255,255,0.15); }
        #languageSelect option { background: var(--nav-dark); color: var(--text-light); }
        /* --- End Minimal Retractable Nav --- */

        /* --- Practice Header (Adapted for Module 31) --- */
        .practice-header {
            background: linear-gradient(135deg, var(--project-planning-color), #4a2380); /* Purple gradient */
            color: var(--text-light); padding: 3rem 0 4rem; text-align: center;
            position: relative; overflow: hidden; border-bottom: 5px solid var(--accent-color);
        }
        .practice-header h1 {
            font-family: var(--font-title); font-size: 2.8rem; margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3); animation: fadeInAnimation 1s ease-out;
        }
        .practice-header p {
            font-size: 1.1rem; font-weight: 300; opacity: 0.9;
            animation: fadeInAnimation 1s ease-out 0.3s forwards; opacity: 0;
        }
        .header-icon {
             position: absolute; font-size: 4rem; color: var(--text-light);
             animation: pulseHeaderIcon 6s infinite ease-in-out alternate;
        }
        .icon1 { top: 20%; left: 15%; animation-duration: 7s; } /* Keep icons */
        .icon2 { bottom: 15%; right: 20%; animation-duration: 5s; }

        /* --- Practice Section Styling (Copied from Module 0) --- */
        .practice-section { padding: 3rem 0; background-color: var(--background-medium); border-bottom: 1px solid #d6d8db; }
        .practice-section:nth-child(odd) { background-color: var(--background-light); }
        .practice-section:last-of-type { border-bottom: none; }
        .practice-section h2 {
             font-family: var(--font-title); font-size: 1.8rem;
             color: var(--project-planning-color); /* Use purple */
             margin-bottom: 1rem; text-align: center;
        }
        .practice-section .section-description {
            text-align: center; margin-bottom: 2.5rem; color: var(--secondary-color);
            font-size: 1.05rem; max-width: 700px; margin-left: auto; margin-right: auto;
        }

        /* --- General Interactive Elements (Copied/Adapted from Module 0) --- */
        .interactive-area {
            background-color: #fff; padding: 2rem; border-radius: var(--border-radius);
            box-shadow: 0 5px 15px rgba(0,0,0,0.08); margin-top: 1.5rem; position: relative;
            transition: box-shadow 0.5s ease-out;
        }
        .feedback-message {
            padding: 0.8rem 1rem; margin-top: 1rem; border-radius: var(--border-radius);
            font-weight: bold; text-align: center; opacity: 0; max-height: 0; overflow: hidden;
            transition: opacity var(--transition-speed) ease, max-height var(--transition-speed) ease, margin-top var(--transition-speed) ease;
        }
        .feedback-message.visible { opacity: 1; max-height: 100px; margin-top: 1.5rem; }
        .feedback-message.correct { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .feedback-message.incorrect { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .feedback-message.info { background-color: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .feedback-message .fas { margin: 0 3px; } /* Spacing for icons in feedback */
        .action-button {
             display: inline-block; padding: 0.8rem 1.5rem; font-size: 1rem; font-weight: bold;
             color: var(--text-light); background-color: var(--primary-color); border: none;
             border-radius: var(--border-radius); cursor: pointer;
             transition: background-color var(--transition-speed), transform var(--transition-speed), filter var(--transition-speed), box-shadow var(--transition-speed);
             margin-top: 1rem; vertical-align: middle; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
             text-decoration: none;
        }
        .action-button:hover:not(:disabled) { background-color: #0056b3; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
        .action-button:disabled { background-color: var(--secondary-color); cursor: not-allowed; transform: none; box-shadow: none; opacity: 0.7; }
        .action-button.success { background-color: var(--success-color); }
        .action-button.success:hover:not(:disabled) { background-color: #218838; }
        .action-button.secondary { background-color: var(--secondary-color); }
        .action-button.secondary:hover:not(:disabled) { background-color: #5a6268; }
        .action-button.planning { background-color: var(--project-planning-color); } /* Purple button */
        .action-button.planning:hover:not(:disabled) { background-color: #5a37a0; }

        /* --- Styles for Module 31 Activities --- */

        /* General styles for prompt/input sections */
        .planning-prompt {
            margin-bottom: 1.5rem;
            padding: 1rem;
            border-left: 4px solid var(--info-color);
            background-color: rgba(23, 162, 184, 0.05);
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
        }
        .planning-prompt label {
            display: block; font-weight: bold; margin-bottom: 0.5rem;
            color: var(--info-color);
        }
        .planning-prompt textarea,
        .planning-prompt input[type="text"] {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ced4da;
            border-radius: var(--border-radius);
            font-family: var(--font-body);
            font-size: 1rem;
            line-height: 1.5;
            resize: vertical;
            min-height: 80px;
        }
        .planning-prompt textarea:focus,
        .planning-prompt input[type="text"]:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
        }

        /* Activity 2: Abstraction Checkboxes */
        #abstraction-concepts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        .concept-label {
            display: flex;
            align-items: center;
            padding: 0.8rem 1rem;
            background-color: var(--background-light);
            border: 1px solid var(--background-medium);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: background-color var(--transition-speed), border-color var(--transition-speed), box-shadow var(--transition-speed);
        }
        .concept-label:hover {
            background-color: #e2e6ea;
            border-color: #dae0e5;
        }
        .concept-label input[type="checkbox"] {
            margin-right: 0.8rem;
            transform: scale(1.2);
            accent-color: var(--project-planning-color); /* Purple checkboxes */
        }
        .concept-label input[type="checkbox"]:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }
        .concept-label.selected { /* Optional visual feedback on select */
             background-color: rgba(111, 66, 193, 0.1); /* Light purple */
             border-color: var(--project-planning-color);
             box-shadow: 0 0 5px rgba(111, 66, 193, 0.2);
        }

        /* --- Completion Section (Copied from Module 0, text will be changed) --- */
        .completion-section { padding: 4rem 0; text-align: center; }
        .completion-section .icon {
            font-size: 4rem; color: var(--success-color); margin-bottom: 1rem;
            display: inline-block;
            opacity: 0; /* Start hidden for animation */
            animation: iconAppearCorrect 1s ease-out 0.5s forwards; /* Use icon animation */
        }
        .completion-section h2 { font-family: var(--font-title); font-size: 2.2rem; color: var(--project-planning-color); } /* Use purple */
        .completion-section p { font-size: 1.1rem; margin-top: 1rem; color: var(--secondary-color); }

        /* --- Responsive Design (Copied/Adjusted from Module 0) --- */
        @media (max-width: 768px) {
            html { font-size: 15px; }
            .practice-header h1 { font-size: 2.2rem; }
            .practice-section h2 { font-size: 1.6rem; }
            .interactive-area { padding: 1.5rem; }
            .planning-prompt textarea { min-height: 70px; font-size: 0.95rem;}
            #abstraction-concepts { grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 0.8rem;}
            .concept-label { padding: 0.7rem 0.9rem; }
            .button-group { flex-direction: column; align-items: center; }
            .minimal-nav { min-width: 180px; }
            .minimal-nav ul li a { padding: 0.6rem 0.8rem; }
            #languageSelect { font-size: 0.85rem; padding: 5px 25px 5px 10px;}
        }
        @media (max-width: 480px) {
            html { font-size: 14px; }
            .practice-header h1 { font-size: 1.8rem; }
            .practice-header p { font-size: 1rem; }
            .practice-section h2 { font-size: 1.4rem; }
            .interactive-area { padding: 1rem; }
            .action-button { font-size: 0.9rem; padding: 0.7rem 1.2rem; width: 90%; max-width: 300px;}
            .planning-prompt textarea { min-height: 60px; font-size: 0.9rem;}
            #abstraction-concepts { grid-template-columns: 1fr; gap: 0.6rem;} /* Single column on very small screens */
            .concept-label { padding: 0.6rem 0.8rem; }
            .button-group a.action-button { width: 90%; max-width: 300px; margin-bottom: 0.5rem; }
            .minimal-nav-button { top: 10px; right: 10px; padding: 6px 10px; font-size: 1rem; }
            .minimal-nav { top: 48px; right: 10px; min-width: 160px; }
            .minimal-nav ul li a { padding: 0.5rem 0.7rem; font-size: 0.9rem;}
            .minimal-nav ul li a i.fas { margin-right: 8px; }
            #languageSelect { font-size: 0.8rem; padding: 4px 20px 4px 8px;}
        }
    </style>
</head>
<body>

    <!-- ========= Minimal Nav Handle ========= -->
    <button id="minimal-nav-toggle" class="minimal-nav-button" aria-label="Toggle Navigation Menu">
        <i class="fas fa-bars"></i>
    </button>

    <!-- ========= Minimal Nav Panel (with Language Switcher) ========= -->
    <nav id="minimal-nav-panel" class="minimal-nav">
        <ul>
            <!-- *** UPDATED MODULE NUMBER *** -->
            <li><a href="ctp-theory-31.html"><i class="fas fa-book-open fa-fw"></i> <span data-translate="nav_theory">View Theory</span></a></li>
            <li><a href="ctp-advanced-31.html"><i class="fas fa-flask fa-fw"></i> <span data-translate="nav_advanced">Advanced Ideas</span></a></li> <!-- Adjusted text slightly -->
            <li><a href="ctp-dashboard.html"><i class="fas fa-list fa-fw"></i> <span data-translate="nav_menu">Course Menu</span></a></li>
            <hr style="border: none; border-top: 1px solid var(--secondary-color); margin: 8px 0;">
            <!-- *** UPDATED SECTION LINKS *** -->
            <li><a href="#project-decomposition"><i class="fas fa-puzzle-piece fa-fw"></i> <span data-translate="nav_decomposition">Decomposition</span></a></li>
            <li><a href="#project-abstraction"><i class="fas fa-filter fa-fw"></i> <span data-translate="nav_abstraction">Abstraction</span></a></li>
            <li><a href="#project-design"><i class="fas fa-drafting-compass fa-fw"></i> <span data-translate="nav_design">Design</span></a></li>
            <li><a href="#project-evaluation"><i class="fas fa-check-double fa-fw"></i> <span data-translate="nav_evaluation">Evaluation</span></a></li>
            <!-- Language Switcher Item -->
            <li class="language-switcher-item">
                 <select id="languageSelect" aria-label="Select Language">
                     <option value="en" data-translate="lang_en">üá¨üáß English</option>
                     <option value="pt" data-translate="lang_pt">üáßüá∑ Portugu√™s</option>
                     <option value="zh" data-translate="lang_zh">üá®üá≥ ‰∏≠Êñá</option>
                 </select>
            </li>
        </ul>
    </nav>

    <!-- ========= Header ========= -->
    <header class="practice-header">
        <!-- *** UPDATED ICONS *** -->
        <i class="fas fa-project-diagram header-icon icon1"></i>
        <i class="fas fa-lightbulb header-icon icon2"></i>
        <div class="container">
            <!-- *** UPDATED TEXT *** -->
            <h1 data-translate="header_title">Module 31: Final Project Prep</h1>
            <p data-translate="header_subtitle">Let's apply Computational Thinking to plan your awesome final project!</p>
        </div>
    </header>

    <!-- ========= Main Content ========= -->
    <main>
        <!-- ========= Activity 1: Decomposition ========= -->
        <section id="project-decomposition" class="practice-section">
             <div class="container">
                 <h2 class="fade-in"><i class="fas fa-puzzle-piece"></i> <span data-translate="decomp_title">Decomposition: Break It Down</span></h2>
                 <p class="section-description fade-in delay-1" data-translate="decomp_desc">
                     Think about a project you'd like to build. What are the main parts or steps involved? List them below. Don't worry about details yet!
                 </p>
                 <div class="interactive-area fade-in delay-2">
                     <div class="planning-prompt">
                         <label for="decomp-input" data-translate="decomp_label">Project Idea & Main Parts:</label>
                         <textarea id="decomp-input" rows="5" data-translate-placeholder="decomp_placeholder" placeholder="e.g., Idea: AI Cat Detector. Parts: Get images, Train model, Build simple web interface, Test with cat pictures..."></textarea>
                     </div>
                     <div class="text-center">
                         <button id="decomp-save-btn" class="action-button planning" data-translate="button_save_notes">Note Down Ideas</button>
                     </div>
                     <div id="decomp-feedback" class="feedback-message"></div>
                 </div>
             </div>
        </section>

        <!-- ========= Activity 2: Abstraction ========= -->
        <section id="project-abstraction" class="practice-section">
             <div class="container">
                 <h2 class="fade-in"><i class="fas fa-filter"></i> <span data-translate="abstract_title">Abstraction: Identify Essentials</span></h2>
                 <p class="section-description fade-in delay-1" data-translate="abstract_desc">
                     What core concepts or tools from the course might be useful for your project idea? Focus on the key elements. Check all that apply.
                 </p>
                 <div class="interactive-area fade-in delay-2">
                     <div id="abstraction-concepts">
                         <!-- Checkboxes generated by JS -->
                     </div>
                      <div class="text-center">
                         <button id="abstract-confirm-btn" class="action-button planning" data-translate="button_confirm_selection">Confirm Concepts</button>
                     </div>
                     <div id="abstract-feedback" class="feedback-message"></div>
                      <!-- Hidden template for concept items -->
                     <div id="concept-template" style="display: none;">
                        <label class="concept-label">
                            <input type="checkbox" value="{value}">
                            <span data-translate="{key}">{text}</span>
                        </label>
                     </div>
                     <!-- Hidden data for concepts -->
                     <div id="concepts-data" style="display: none;">
                         <span data-key="concept_data_handling" data-value="data_handling">Data Handling (Pandas, NumPy)</span>
                         <span data-key="concept_visualization" data-value="visualization">Data Visualization (Matplotlib, Seaborn)</span>
                         <span data-key="concept_ml_basics" data-value="ml_basics">Machine Learning Basics (Scikit-learn)</span>
                         <span data-key="concept_classification" data-value="classification">Classification Models</span>
                         <span data-key="concept_regression" data-value="regression">Regression Models</span>
                         <span data-key="concept_clustering" data-value="clustering">Clustering</span>
                         <span data-key="concept_nlp" data-value="nlp">Natural Language Processing (NLP)</span>
                         <span data-key="concept_cv" data-value="cv">Computer Vision (Basics)</span>
                         <span data-key="concept_api" data-value="api">Using APIs</span>
                         <span data-key="concept_web_basic" data-value="web_basic">Basic Web App (Flask/Streamlit)</span>
                         <span data-key="concept_ethics" data-value="ethics">AI Ethics Considerations</span>
                         <span data-key="concept_other" data-value="other">Other (Specify if needed)</span>
                     </div>
                 </div>
             </div>
        </section>

         <!-- ========= Activity 3: Design ========= -->
        <section id="project-design" class="practice-section">
             <div class="container">
                 <h2 class="fade-in"><i class="fas fa-drafting-compass"></i> <span data-translate="design_title">Design: Plan Your Approach</span></h2>
                 <p class="section-description fade-in delay-1" data-translate="design_desc">
                     How will your project work? Think about the flow and the main logic. Jot down some initial thoughts on these design aspects.
                 </p>
                 <div class="interactive-area fade-in delay-2">
                     <div class="planning-prompt">
                         <label for="design-flow-input" data-translate="design_label_flow">Data Flow:</label>
                         <textarea id="design-flow-input" rows="3" data-translate-placeholder="design_placeholder_flow" placeholder="How will data move through your project? Where does it start and end?"></textarea>
                     </div>
                      <div class="planning-prompt">
                         <label for="design-algo-input" data-translate="design_label_algo">Main Algorithm/Model:</label>
                         <textarea id="design-algo-input" rows="3" data-translate-placeholder="design_placeholder_algo" placeholder="What's the core logic? Which type of model or technique seems most suitable?"></textarea>
                     </div>
                     <div class="planning-prompt">
                          <label for="design-ui-input" data-translate="design_label_ui">User Interaction (if any):</label>
                          <textarea id="design-ui-input" rows="3" data-translate-placeholder="design_placeholder_ui" placeholder="How will someone use your project? Simple input/output? Web interface?"></textarea>
                     </div>
                     <div class="text-center">
                         <button id="design-save-btn" class="action-button planning" data-translate="button_save_notes">Note Down Design</button>
                     </div>
                     <div id="design-feedback" class="feedback-message"></div>
                 </div>
             </div>
        </section>

         <!-- ========= Activity 4: Evaluation ========= -->
        <section id="project-evaluation" class="practice-section">
            <div class="container">
                <h2 class="fade-in"><i class="fas fa-check-double"></i> <span data-translate="eval_title">Evaluation: Define Success</span></h2>
                <p class="section-description fade-in delay-1" data-translate="eval_desc">
                    How will you know if your project is successful? How will you test it? What challenges might you face?
                </p>
                <div class="interactive-area fade-in delay-2">
                    <div class="planning-prompt">
                        <label for="eval-success-input" data-translate="eval_label_success">Success Criteria:</label>
                        <textarea id="eval-success-input" rows="3" data-translate-placeholder="eval_placeholder_success" placeholder="What does 'working well' mean for this project? (e.g., accuracy > 80%, processes data quickly, easy to use)"></textarea>
                    </div>
                     <div class="planning-prompt">
                        <label for="eval-testing-input" data-translate="eval_label_testing">Testing Strategy:</label>
                        <textarea id="eval-testing-input" rows="3" data-translate-placeholder="eval_placeholder_testing" placeholder="How will you test different parts? What kind of data will you use for testing?"></textarea>
                    </div>
                    <div class="planning-prompt">
                         <label for="eval-challenges-input" data-translate="eval_label_challenges">Potential Challenges:</label>
                         <textarea id="eval-challenges-input" rows="3" data-translate-placeholder="eval_placeholder_challenges" placeholder="What difficulties do you anticipate? (e.g., finding good data, model tuning, unexpected errors)"></textarea>
                     </div>
                     <div class="text-center">
                         <button id="eval-save-btn" class="action-button planning" data-translate="button_save_notes">Note Down Evaluation</button>
                     </div>
                     <div id="eval-feedback" class="feedback-message"></div>
                </div>
            </div>
        </section>

         <!-- ========= Completion Section ========= -->
        <section class="completion-section">
            <div class="container">
                 <!-- *** UPDATED ICON *** -->
                <div class="icon fade-in" style="animation: iconAppearCorrect 1s ease-out 0.5s forwards;">
                    <i class="fas fa-rocket"></i> <i class="fas fa-graduation-cap"></i> <i class="fas fa-cogs"></i>
                </div>
                 <!-- *** UPDATED TEXT *** -->
                <h2 class="fade-in delay-1" data-translate="completion_title">Ready to Build!</h2>
                <p class="fade-in delay-2" data-translate="completion_desc">
                    You've applied Computational Thinking to outline your final project. Excellent preparation! <br>
                    Remember, this is your project ‚Äì explore, learn, and create something amazing! Good luck!
                </p>
                <div class="button-group">
                    <!-- *** UPDATED BUTTONS *** -->
                    <a href="ctp-theory-31.html" class="action-button secondary fade-in delay-3"><i class="fas fa-book-open"></i> <span data-translate="button_review_theory">Review Theory</span></a>
                    <a href="ctp-dashboard.html" class="action-button success fade-in delay-4"><i class="fas fa-list"></i> <span data-translate="button_back_menu">Back to Course Menu</span></a>
                    <!-- Optional: Link to an "Ideas Gallery" or similar if exists -->
                    <!-- <a href="project-ideas.html" class="action-button info fade-in delay-3"><i class="fas fa-lightbulb"></i> Project Ideas</a> -->
                </div>
            </div>
        </section>
    </main>

    <!-- ========= Script ========= -->
    <script>
    // --- Translations Object (NEW for Module 31) ---
    const translations = {
        en: {
            "page_title": "Module 31: Final Project Prep!",
            "nav_theory": "View Theory", "nav_advanced": "Advanced Ideas", "nav_menu": "Course Menu",
            "nav_decomposition": "Decomposition", "nav_abstraction": "Abstraction", "nav_design": "Design", "nav_evaluation": "Evaluation",
            "lang_en": "üá¨üáß English", "lang_pt": "üáßüá∑ Portugu√™s", "lang_zh": "üá®üá≥ ‰∏≠Êñá",
            "header_title": "Module 31: Final Project Prep", "header_subtitle": "Let's apply Computational Thinking to plan your awesome final project!",
            // Decomposition
            "decomp_title": "Decomposition: Break It Down", "decomp_desc": "Think about a project you'd like to build. What are the main parts or steps involved? List them below. Don't worry about details yet!",
            "decomp_label": "Project Idea & Main Parts:", "decomp_placeholder": "e.g., Idea: AI Cat Detector. Parts: Get images, Train model, Build simple web interface, Test with cat pictures...",
            "feedback_decomp_saved": "Ideas noted! Good start.",
            // Abstraction
            "abstract_title": "Abstraction: Identify Essentials", "abstract_desc": "What core concepts or tools from the course might be useful for your project idea? Focus on the key elements. Check all that apply.",
            "button_confirm_selection": "Confirm Concepts", "feedback_abstract_saved": "Core concepts selected!",
            "concept_data_handling": "Data Handling (Pandas, NumPy)", "concept_visualization": "Data Visualization (Matplotlib, Seaborn)", "concept_ml_basics": "Machine Learning Basics (Scikit-learn)",
            "concept_classification": "Classification Models", "concept_regression": "Regression Models", "concept_clustering": "Clustering", "concept_nlp": "Natural Language Processing (NLP)",
            "concept_cv": "Computer Vision (Basics)", "concept_api": "Using APIs", "concept_web_basic": "Basic Web App (Flask/Streamlit)", "concept_ethics": "AI Ethics Considerations", "concept_other": "Other (Specify if needed)",
            // Design
            "design_title": "Design: Plan Your Approach", "design_desc": "How will your project work? Think about the flow and the main logic. Jot down some initial thoughts on these design aspects.",
            "design_label_flow": "Data Flow:", "design_placeholder_flow": "How will data move through your project? Where does it start and end?",
            "design_label_algo": "Main Algorithm/Model:", "design_placeholder_algo": "What's the core logic? Which type of model or technique seems most suitable?",
            "design_label_ui": "User Interaction (if any):", "design_placeholder_ui": "How will someone use your project? Simple input/output? Web interface?",
            "feedback_design_saved": "Design thoughts captured!",
            // Evaluation
            "eval_title": "Evaluation: Define Success", "eval_desc": "How will you know if your project is successful? How will you test it? What challenges might you face?",
            "eval_label_success": "Success Criteria:", "eval_placeholder_success": "What does 'working well' mean for this project? (e.g., accuracy > 80%, processes data quickly, easy to use)",
            "eval_label_testing": "Testing Strategy:", "eval_placeholder_testing": "How will you test different parts? What kind of data will you use for testing?",
            "eval_label_challenges": "Potential Challenges:", "eval_placeholder_challenges": "What difficulties do you anticipate? (e.g., finding good data, model tuning, unexpected errors)",
            "feedback_eval_saved": "Evaluation strategy noted!",
            // General Buttons / Completion
            "button_save_notes": "Note Down Ideas", // Reused text
            "completion_title": "Ready to Build!", "completion_desc": "You've applied Computational Thinking to outline your final project. Excellent preparation! <br> Remember, this is your project ‚Äì explore, learn, and create something amazing! Good luck!",
            "button_review_theory": "Review Theory", "button_back_menu": "Back to Course Menu"
        },
        pt: {
            "page_title": "M√≥dulo 31: Prepara√ß√£o Projeto Final!",
            "nav_theory": "Ver Teoria", "nav_advanced": "Ideias Avan√ßadas", "nav_menu": "Menu do Curso",
            "nav_decomposition": "Decomposi√ß√£o", "nav_abstraction": "Abstra√ß√£o", "nav_design": "Design", "nav_evaluation": "Avalia√ß√£o",
            "lang_en": "üá¨üáß English", "lang_pt": "üáßüá∑ Portugu√™s", "lang_zh": "üá®üá≥ ‰∏≠Êñá",
            "header_title": "M√≥dulo 31: Prepara√ß√£o Projeto Final", "header_subtitle": "Vamos aplicar o Pensamento Computacional para planejar seu incr√≠vel projeto final!",
            // Decomposition
            "decomp_title": "Decomposi√ß√£o: Dividir para Conquistar", "decomp_desc": "Pense em um projeto que voc√™ gostaria de construir. Quais s√£o as partes ou etapas principais envolvidas? Liste-as abaixo. N√£o se preocupe com detalhes ainda!",
            "decomp_label": "Ideia do Projeto & Partes Principais:", "decomp_placeholder": "ex: Ideia: Detector de Gatos AI. Partes: Obter imagens, Treinar modelo, Construir interface web simples, Testar com fotos de gatos...",
            "feedback_decomp_saved": "Ideias anotadas! Bom come√ßo.",
            // Abstraction
            "abstract_title": "Abstra√ß√£o: Identificar Essenciais", "abstract_desc": "Quais conceitos ou ferramentas centrais do curso podem ser √∫teis para sua ideia de projeto? Concentre-se nos elementos-chave. Marque todos que se aplicam.",
            "button_confirm_selection": "Confirmar Conceitos", "feedback_abstract_saved": "Conceitos centrais selecionados!",
            "concept_data_handling": "Manuseio de Dados (Pandas, NumPy)", "concept_visualization": "Visualiza√ß√£o de Dados (Matplotlib, Seaborn)", "concept_ml_basics": "Fundamentos de Machine Learning (Scikit-learn)",
            "concept_classification": "Modelos de Classifica√ß√£o", "concept_regression": "Modelos de Regress√£o", "concept_clustering": "Agrupamento (Clustering)", "concept_nlp": "Processamento de Linguagem Natural (PLN)",
            "concept_cv": "Vis√£o Computacional (B√°sico)", "concept_api": "Uso de APIs", "concept_web_basic": "App Web B√°sico (Flask/Streamlit)", "concept_ethics": "Considera√ß√µes √âticas em IA", "concept_other": "Outro (Especifique se necess√°rio)",
            // Design
            "design_title": "Design: Planejar sua Abordagem", "design_desc": "Como seu projeto funcionar√°? Pense no fluxo e na l√≥gica principal. Anote algumas ideias iniciais sobre esses aspectos do design.",
            "design_label_flow": "Fluxo de Dados:", "design_placeholder_flow": "Como os dados se mover√£o pelo seu projeto? Onde come√ßam e terminam?",
            "design_label_algo": "Algoritmo/Modelo Principal:", "design_placeholder_algo": "Qual √© a l√≥gica central? Que tipo de modelo ou t√©cnica parece mais adequado?",
            "design_label_ui": "Intera√ß√£o do Usu√°rio (se houver):", "design_placeholder_ui": "Como algu√©m usar√° seu projeto? Entrada/sa√≠da simples? Interface web?",
            "feedback_design_saved": "Ideias de design capturadas!",
            // Evaluation
            "eval_title": "Avalia√ß√£o: Definir Sucesso", "eval_desc": "Como voc√™ saber√° se seu projeto foi bem-sucedido? Como voc√™ o testar√°? Que desafios pode enfrentar?",
            "eval_label_success": "Crit√©rios de Sucesso:", "eval_placeholder_success": "O que significa 'funcionar bem' para este projeto? (ex: precis√£o > 80%, processa dados rapidamente, f√°cil de usar)",
            "eval_label_testing": "Estrat√©gia de Teste:", "eval_placeholder_testing": "Como voc√™ testar√° as diferentes partes? Que tipo de dados usar√° para testar?",
            "eval_label_challenges": "Desafios Potenciais:", "eval_placeholder_challenges": "Quais dificuldades voc√™ antecipa? (ex: encontrar bons dados, ajuste fino do modelo, erros inesperados)",
            "feedback_eval_saved": "Estrat√©gia de avalia√ß√£o anotada!",
            // General Buttons / Completion
            "button_save_notes": "Anotar Ideias",
            "completion_title": "Pronto para Construir!", "completion_desc": "Voc√™ aplicou o Pensamento Computacional para delinear seu projeto final. Excelente prepara√ß√£o! <br> Lembre-se, este √© o seu projeto ‚Äì explore, aprenda e crie algo incr√≠vel! Boa sorte!",
            "button_review_theory": "Revisar Teoria", "button_back_menu": "Voltar ao Menu do Curso"
        },
        zh: {
            "page_title": "Ê®°Âùó 31ÔºöÊúÄÁªàÈ°πÁõÆÂáÜÂ§áÔºÅ",
            "nav_theory": "Êü•ÁúãÁêÜËÆ∫", "nav_advanced": "È´òÁ∫ßÊÉ≥Ê≥ï", "nav_menu": "ËØæÁ®ãËèúÂçï",
            "nav_decomposition": "ÂàÜËß£", "nav_abstraction": "ÊäΩË±°", "nav_design": "ËÆæËÆ°", "nav_evaluation": "ËØÑ‰º∞",
            "lang_en": "üá¨üáß English", "lang_pt": "üáßüá∑ Portugu√™s", "lang_zh": "üá®üá≥ ‰∏≠Êñá",
            "header_title": "Ê®°Âùó 31ÔºöÊúÄÁªàÈ°πÁõÆÂáÜÂ§á", "header_subtitle": "ËÆ©Êàë‰ª¨ËøêÁî®ËÆ°ÁÆóÊÄùÁª¥Êù•ËßÑÂàí‰Ω†Ë∂ÖÊ£íÁöÑÊúÄÁªàÈ°πÁõÆÔºÅ",
            // Decomposition
            "decomp_title": "ÂàÜËß£ÔºöÂåñÊï¥‰∏∫Èõ∂", "decomp_desc": "ÊûÑÊÄù‰∏Ä‰∏™‰Ω†ÊÉ≥ÊûÑÂª∫ÁöÑÈ°πÁõÆ„ÄÇÊ∂âÂèäÁöÑ‰∏ªË¶ÅÈÉ®ÂàÜÊàñÊ≠•È™§ÊúâÂì™‰∫õÔºüÂú®‰∏ãÈù¢ÂàóÂá∫Êù•„ÄÇÊöÇÊó∂‰∏çÁî®ÊãÖÂøÉÁªÜËäÇÔºÅ",
            "decomp_label": "È°πÁõÆÊÉ≥Ê≥ï‰∏é‰∏ªË¶ÅÈÉ®ÂàÜÔºö", "decomp_placeholder": "‰æãÂ¶ÇÔºåÊÉ≥Ê≥ïÔºöAI Áå´Âí™Ê£ÄÊµãÂô®„ÄÇÈÉ®ÂàÜÔºöËé∑ÂèñÂõæÂÉè„ÄÅËÆ≠ÁªÉÊ®°Âûã„ÄÅÊûÑÂª∫ÁÆÄÂçï Web ÁïåÈù¢„ÄÅÁî®Áå´Âí™ÂõæÁâáÊµãËØï...",
            "feedback_decomp_saved": "ÊÉ≥Ê≥ïÂ∑≤ËÆ∞ÂΩïÔºÅÂ•ΩÁöÑÂºÄÂßã„ÄÇ",
            // Abstraction
            "abstract_title": "ÊäΩË±°ÔºöËØÜÂà´Ë¶ÅÁÇπ", "abstract_desc": "ËØæÁ®ã‰∏≠ÁöÑÂì™‰∫õÊ†∏ÂøÉÊ¶ÇÂøµÊàñÂ∑•ÂÖ∑ÂèØËÉΩÂØπ‰Ω†ÁöÑÈ°πÁõÆÊÉ≥Ê≥ïÊúâÁî®ÔºüÂÖ≥Ê≥®ÂÖ≥ÈîÆË¶ÅÁ¥†„ÄÇÂãæÈÄâÊâÄÊúâÈÄÇÁî®ÁöÑÈÄâÈ°π„ÄÇ",
            "button_confirm_selection": "Á°ÆËÆ§Ê¶ÇÂøµ", "feedback_abstract_saved": "Ê†∏ÂøÉÊ¶ÇÂøµÂ∑≤ÈÄâÊã©ÔºÅ",
            "concept_data_handling": "Êï∞ÊçÆÂ§ÑÁêÜ (Pandas, NumPy)", "concept_visualization": "Êï∞ÊçÆÂèØËßÜÂåñ (Matplotlib, Seaborn)", "concept_ml_basics": "Êú∫Âô®Â≠¶‰π†Âü∫Á°Ä (Scikit-learn)",
            "concept_classification": "ÂàÜÁ±ªÊ®°Âûã", "concept_regression": "ÂõûÂΩíÊ®°Âûã", "concept_clustering": "ËÅöÁ±ª", "concept_nlp": "Ëá™ÁÑ∂ËØ≠Ë®ÄÂ§ÑÁêÜ (NLP)",
            "concept_cv": "ËÆ°ÁÆóÊú∫ËßÜËßâ (Âü∫Á°Ä)", "concept_api": "‰ΩøÁî® API", "concept_web_basic": "Âü∫Á°Ä Web Â∫îÁî® (Flask/Streamlit)", "concept_ethics": "AI ‰º¶ÁêÜËÄÉÈáè", "concept_other": "ÂÖ∂‰ªñ (Â¶ÇÈúÄË¶ÅËØ∑ËØ¥Êòé)",
            // Design
            "design_title": "ËÆæËÆ°ÔºöËßÑÂàíÊñπÊ≥ï", "design_desc": "‰Ω†ÁöÑÈ°πÁõÆÂ∞ÜÂ¶Ç‰ΩïËøê‰ΩúÔºüËÄÉËôëÊµÅÁ®ãÂíå‰∏ªË¶ÅÈÄªËæë„ÄÇËÆ∞‰∏ãÂÖ≥‰∫éËøô‰∫õËÆæËÆ°ÊñπÈù¢ÁöÑ‰∏Ä‰∫õÂàùÊ≠•ÊÉ≥Ê≥ï„ÄÇ",
            "design_label_flow": "Êï∞ÊçÆÊµÅÔºö", "design_placeholder_flow": "Êï∞ÊçÆÂ∞ÜÂ¶Ç‰ΩïÂú®‰Ω†ÁöÑÈ°πÁõÆ‰∏≠ÊµÅÂä®Ôºü‰ªéÂì™ÈáåÂºÄÂßãÔºåÂà∞Âì™ÈáåÁªìÊùüÔºü",
            "design_label_algo": "‰∏ªË¶ÅÁÆóÊ≥ï/Ê®°ÂûãÔºö", "design_placeholder_algo": "Ê†∏ÂøÉÈÄªËæëÊòØ‰ªÄ‰πàÔºüÂì™ÁßçÁ±ªÂûãÁöÑÊ®°ÂûãÊàñÊäÄÊúØ‰ºº‰πéÊúÄÂêàÈÄÇÔºü",
            "design_label_ui": "Áî®Êà∑‰∫§‰∫í (Â¶ÇÊúâ)Ôºö", "design_placeholder_ui": "Áî®Êà∑Â∞ÜÂ¶Ç‰Ωï‰ΩøÁî®‰Ω†ÁöÑÈ°πÁõÆÔºüÁÆÄÂçïÁöÑËæìÂÖ•/ËæìÂá∫ÔºüWeb ÁïåÈù¢Ôºü",
            "feedback_design_saved": "ËÆæËÆ°ÊÄùË∑ØÂ∑≤ÊçïÊçâÔºÅ",
            // Evaluation
            "eval_title": "ËØÑ‰º∞ÔºöÂÆö‰πâÊàêÂäü", "eval_desc": "‰Ω†Â∞ÜÂ¶Ç‰ΩïÁü•ÈÅì‰Ω†ÁöÑÈ°πÁõÆÊòØÂê¶ÊàêÂäüÔºü‰Ω†Â∞ÜÂ¶Ç‰ΩïÊµãËØïÂÆÉÔºü‰Ω†ÂèØËÉΩ‰ºöÈÅáÂà∞Âì™‰∫õÊåëÊàòÔºü",
            "eval_label_success": "ÊàêÂäüÊ†áÂáÜÔºö", "eval_placeholder_success": "ÂØπ‰∫éËøô‰∏™È°πÁõÆÔºå‚ÄúËøêË°åËâØÂ•Ω‚ÄùÊÑèÂë≥ÁùÄ‰ªÄ‰πàÔºüÔºà‰æãÂ¶ÇÔºåÂáÜÁ°ÆÁéá > 80%ÔºåÂø´ÈÄüÂ§ÑÁêÜÊï∞ÊçÆÔºåÊòì‰∫é‰ΩøÁî®Ôºâ",
            "eval_label_testing": "ÊµãËØïÁ≠ñÁï•Ôºö", "eval_placeholder_testing": "‰Ω†Â∞ÜÂ¶Ç‰ΩïÊµãËØï‰∏çÂêåÁöÑÈÉ®ÂàÜÔºü‰Ω†Â∞Ü‰ΩøÁî®‰ªÄ‰πàÊ†∑ÁöÑÊï∞ÊçÆËøõË°åÊµãËØïÔºü",
            "eval_label_challenges": "ÊΩúÂú®ÊåëÊàòÔºö", "eval_placeholder_challenges": "‰Ω†È¢ÑËÆ°‰ºöÈÅáÂà∞Âì™‰∫õÂõ∞ÈöæÔºüÔºà‰æãÂ¶ÇÔºåÊâæÂà∞Â•ΩÁöÑÊï∞ÊçÆÔºåÊ®°ÂûãË∞É‰ºòÔºåÊÑèÂ§ñÈîôËØØÔºâ",
            "feedback_eval_saved": "ËØÑ‰º∞Á≠ñÁï•Â∑≤ËÆ∞ÂΩïÔºÅ",
            // General Buttons / Completion
            "button_save_notes": "ËÆ∞‰∏ãÊÉ≥Ê≥ï",
            "completion_title": "ÂáÜÂ§áÂºÄÂ∑•ÔºÅ", "completion_desc": "‰Ω†Â∑≤ÁªèËøêÁî®ËÆ°ÁÆóÊÄùÁª¥Êù•ÂãæÂãí‰Ω†ÁöÑÊúÄÁªàÈ°πÁõÆËΩÆÂªì„ÄÇÂáÜÂ§áÂæóÈùûÂ∏∏ÂÖÖÂàÜÔºÅ<br> ËÆ∞‰ΩèÔºåËøôÊòØ‰Ω†ÁöÑÈ°πÁõÆ‚Äî‚ÄîÂéªÊé¢Á¥¢„ÄÅÂ≠¶‰π†ÔºåÂπ∂ÂàõÈÄ†Âá∫‰ª§‰∫∫ÊÉäÂèπÁöÑ‰∏úË•øÂêßÔºÅÁ•ù‰Ω†Â•ΩËøêÔºÅ",
            "button_review_theory": "Â§ç‰π†ÁêÜËÆ∫", "button_back_menu": "ËøîÂõûËØæÁ®ãËèúÂçï"
         }
    };


    document.addEventListener('DOMContentLoaded', () => {

        // --- Language Management Functions (Copied from Module 0) ---
        function getStoredLanguage() {
            const storedLang = localStorage.getItem('userLanguage');
            if (storedLang && translations[storedLang]) return storedLang;
            const browserLang = navigator.language || navigator.userLanguage;
            if (browserLang.startsWith('pt')) return 'pt';
            if (browserLang.startsWith('zh')) return 'zh';
            return 'en'; // Default to English
        }

        function setLanguage(lang) {
            if (!translations[lang]) lang = 'en'; // Fallback
            localStorage.setItem('userLanguage', lang);
            document.documentElement.lang = lang;
            translatePage(lang); // Apply generic translations first

            // Update language selector dropdown
            const langSelect = document.getElementById('languageSelect');
            if (langSelect) langSelect.value = lang;

             // Re-initialize or update language-dependent interactive content
             // For Module 31, this primarily means re-populating the checkboxes
             populateAbstractionCheckboxes();
             // Also, clear any existing feedback messages as they might become irrelevant
             clearAllFeedbackMessages();
        }

        function getTranslation(key, lang, replacements = {}) {
            let text = translations[lang]?.[key] ?? translations['en']?.[key] ?? `[${key}]`;
            for (const placeholder in replacements) {
                const regex = new RegExp(`\\{${placeholder}\\}`, 'g');
                text = text.replace(regex, replacements[placeholder]);
            }
            return text;
        }

        function translatePage(lang) {
            if (!translations[lang]) lang = 'en';

            document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.getAttribute('data-translate');
                const translation = getTranslation(key, lang);
                 if (el.tagName === 'TITLE') document.title = translation;
                 else if (el.tagName === 'OPTION') el.textContent = translation;
                 else {
                    if (translation.includes('<') && translation.includes('>')) el.innerHTML = translation;
                     else el.textContent = translation;
                 }
            });

            document.querySelectorAll('[data-translate-placeholder]').forEach(el => {
                const key = el.getAttribute('data-translate-placeholder');
                const translation = getTranslation(key, lang);
                el.setAttribute('placeholder', translation);
            });

             document.querySelectorAll('[data-translate-title]').forEach(el => {
                 const key = el.getAttribute('data-translate-title');
                 const translation = getTranslation(key, lang);
                 el.setAttribute('title', translation);
             });
        }

        // --- Initialize Language (Called later) ---
        const initialLang = getStoredLanguage();

        // --- Minimal Nav Logic (Copied from Module 0) ---
        const navToggleButton = document.getElementById('minimal-nav-toggle');
        const navPanel = document.getElementById('minimal-nav-panel');
        const body = document.body;
        if (navToggleButton && navPanel) {
            navToggleButton.addEventListener('click', (event) => { event.stopPropagation(); body.classList.toggle('nav-active'); navToggleButton.setAttribute('aria-expanded', body.classList.contains('nav-active')); });
            document.addEventListener('click', (event) => { if (body.classList.contains('nav-active') && !navPanel.contains(event.target) && event.target !== navToggleButton && !navToggleButton.contains(event.target) ) { body.classList.remove('nav-active'); navToggleButton.setAttribute('aria-expanded', 'false'); } });
            navPanel.querySelectorAll('a').forEach(link => { link.addEventListener('click', () => { body.classList.remove('nav-active'); navToggleButton.setAttribute('aria-expanded', 'false'); }); });
            document.addEventListener('keydown', (event) => { if (event.key === 'Escape' && body.classList.contains('nav-active')) { body.classList.remove('nav-active'); navToggleButton.setAttribute('aria-expanded', 'false'); } });
            navToggleButton.setAttribute('aria-expanded', 'false');
        }

        // --- Language Switcher Setup (Copied from Module 0) ---
        const langSelect = document.getElementById('languageSelect');
        if (langSelect) {
            langSelect.addEventListener('change', (e) => { setLanguage(e.target.value); });
        }

        // --- Helper Function for Feedback (Copied from Module 0, slightly simplified use) ---
        function showFeedback(elementId, messageKey, type = 'info', replacements = {}) {
            const feedbackEl = document.getElementById(elementId);
            if (!feedbackEl) { console.error(`Feedback element not found: ${elementId}`); return; }
            const currentLang = getStoredLanguage();
            const translatedMessage = getTranslation(messageKey, currentLang, replacements);
             if (translatedMessage.includes('<') && translatedMessage.includes('>')) { feedbackEl.innerHTML = translatedMessage; }
             else { feedbackEl.textContent = translatedMessage; }
            feedbackEl.className = 'feedback-message'; // Reset classes
            feedbackEl.classList.add('visible', type);

            // Simple pop animation for info/success feedback in this context
             if (type === 'info' || type === 'correct') {
                feedbackEl.classList.add('pop-confirm-anim');
                 // Remove animation class after it finishes to allow re-triggering
                 feedbackEl.addEventListener('animationend', () => {
                     feedbackEl.classList.remove('pop-confirm-anim');
                 }, { once: true });
             }
        }

        function clearAllFeedbackMessages() {
            document.querySelectorAll('.feedback-message').forEach(el => {
                el.classList.remove('visible', 'correct', 'incorrect', 'info');
                el.textContent = '';
            });
        }

        // --- Module 31 Activity Logic ---

        // Activity 1: Decomposition
        const decompBtn = document.getElementById('decomp-save-btn');
        const decompInput = document.getElementById('decomp-input');
        if (decompBtn && decompInput) {
            decompBtn.addEventListener('click', () => {
                if (decompInput.value.trim()) {
                     showFeedback('decomp-feedback', 'feedback_decomp_saved', 'info');
                 } else {
                     // Optional: Add feedback if empty, but prompt is enough for now
                 }
            });
        }

        // Activity 2: Abstraction
        const conceptsContainer = document.getElementById('abstraction-concepts');
        const conceptTemplate = document.getElementById('concept-template');
        const conceptsData = document.getElementById('concepts-data');
        const abstractConfirmBtn = document.getElementById('abstract-confirm-btn');

        function populateAbstractionCheckboxes() {
            if (!conceptsContainer || !conceptTemplate || !conceptsData) return;
            const currentLang = getStoredLanguage();
            conceptsContainer.innerHTML = ''; // Clear existing
            const templateHTML = conceptTemplate.innerHTML;

            conceptsData.querySelectorAll('span[data-key]').forEach(span => {
                 const key = span.dataset.key;
                 const value = span.dataset.value;
                 const defaultText = span.textContent; // Use as fallback
                 const translatedText = getTranslation(key, currentLang) || defaultText;

                 const itemHTML = templateHTML
                     .replace('{value}', value)
                     .replace('{key}', key) // Keep key for potential future use
                     .replace('{text}', translatedText);

                 const tempDiv = document.createElement('div');
                 tempDiv.innerHTML = itemHTML;
                 const labelElement = tempDiv.firstElementChild;
                 conceptsContainer.appendChild(labelElement);

                 // Add listener for visual feedback on check (optional)
                 const checkbox = labelElement.querySelector('input[type="checkbox"]');
                 checkbox.addEventListener('change', () => {
                     labelElement.classList.toggle('selected', checkbox.checked);
                 });
             });
         }

        if (abstractConfirmBtn && conceptsContainer) {
             abstractConfirmBtn.addEventListener('click', () => {
                 const checkedBoxes = conceptsContainer.querySelectorAll('input[type="checkbox"]:checked');
                 if (checkedBoxes.length > 0) {
                     showFeedback('abstract-feedback', 'feedback_abstract_saved', 'info');
                 } else {
                     // Optional: Feedback if nothing selected
                 }
             });
         }

        // Activity 3: Design
        const designBtn = document.getElementById('design-save-btn');
        const designInputs = document.querySelectorAll('#project-design textarea');
        if (designBtn && designInputs.length > 0) {
            designBtn.addEventListener('click', () => {
                 // Check if at least one input has content
                let hasContent = false;
                designInputs.forEach(input => { if (input.value.trim()) hasContent = true; });
                if (hasContent) {
                    showFeedback('design-feedback', 'feedback_design_saved', 'info');
                }
            });
        }

        // Activity 4: Evaluation
        const evalBtn = document.getElementById('eval-save-btn');
        const evalInputs = document.querySelectorAll('#project-evaluation textarea');
        if (evalBtn && evalInputs.length > 0) {
            evalBtn.addEventListener('click', () => {
                let hasContent = false;
                evalInputs.forEach(input => { if (input.value.trim()) hasContent = true; });
                if (hasContent) {
                    showFeedback('eval-feedback', 'feedback_eval_saved', 'info');
                }
            });
        }


        // --- Fade-in animations on scroll (Copied from Module 0) ---
        const fadeElements = document.querySelectorAll('.fade-in');
        const animateOnScroll = () => {
             const windowHeight = window.innerHeight;
             fadeElements.forEach(el => {
                 if (el.style.opacity === '1') return; // Already visible
                 const rect = el.getBoundingClientRect();
                 // Check if element is within viewport range for animation
                 if (rect.top < windowHeight - 80 && rect.bottom >= 50) {
                     el.style.opacity = '1';
                     el.style.transform = 'translateY(0)';
                 }
             });
        };
        const scrollHandler = () => window.requestAnimationFrame(animateOnScroll);
        window.addEventListener('scroll', scrollHandler);


        // --- Initial Setup Calls ---
        setLanguage(initialLang); // Apply language FIRST
        animateOnScroll(); // Trigger initial animation check after content is placed


    }); // End DOMContentLoaded
    </script>

</body>
</html>